!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("muze",[],t):"object"==typeof exports?exports.muze=t():e.muze=t()}(window,function(){return function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=5)}([function(e,t,n){},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={init:function init(e){var t=e.document,n=e.navigator.userAgent,i=Math.ceil,a=Math.floor,o="fusioncharts-smartlabel-",s=o+"container",c=o+"tag";return r={win:e,containerClass:s,classNameWithTag:c,classNameWithTagBR:"fusioncharts-smartlabel-br",maxDefaultCacheLimit:500,classNameReg:new RegExp("\b"+c+"\b"),classNameBrReg:new RegExp("\bfusioncharts-smartlabel-br\b"),spanAdditionRegx:/(<[^<\>]+?\>)|(&(?:[a-z]+|#[0-9]+);|.)/gi,spanAdditionReplacer:'$1<span class="'+c+'">$2</span>',spanRemovalRegx:new RegExp("\\<span[^\\>]+?"+c+"[^\\>]{0,}\\>(.*?)\\<\\/span\\>","ig"),xmlTagRegEx:new RegExp("<[^>][^<]*[^>]+>","i"),ltgtRegex:/&lt;|&gt;/g,brReplaceRegex:/<br\/>/gi,testStrAvg:"WgI",parentContainerStyle:{position:"absolute",top:"-9999em",whiteSpace:"nowrap",padding:"0px",width:"1px",height:"1px",overflow:"hidden"},supportedStyle:{font:"font",fontFamily:"font-family","font-family":"font-family",fontWeight:"font-weight","font-weight":"font-weight",fontSize:"font-size","font-size":"font-size",lineHeight:"line-height","line-height":"line-height",fontStyle:"font-style","font-style":"font-style"},getDocumentSupport:function getDocumentSupport(){var r,i,a;return t.getElementsByClassName?(r="getElementsByClassName",i=c,a=!0):(r="getElementsByTagName",i="span",a=!1),{isIE:/msie/i.test(n)&&!e.opera,hasSVG:Boolean(e.SVGAngle||t.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),isHeadLess:new RegExp(" HtmlUnit").test(n),isWebKit:new RegExp(" AppleWebKit/").test(n),childRetriverFn:r,childRetriverString:i,noClassTesting:a}},createContainer:function createContainer(e){var n,r;if(e&&(e.offsetWidth||e.offsetHeight)){if(e.appendChild)return e.appendChild(r=t.createElement("DIV")),r.className=s,r.setAttribute("aria-hidden","true"),r.setAttribute("role","presentation"),r}else if((n=t.getElementsByTagName("body")[0])&&n.appendChild)return(r=t.createElement("DIV")).className=s,r.setAttribute("aria-hidden","true"),r.setAttribute("role","presentation"),1,n.appendChild(r),r},getNearestBreakIndex:function getNearestBreakIndex(e,t,n){if(!e||!e.length)return 0;var r,o=n._getWidthFn(),s=0,c=0,l=o(e),u=l/e.length;if(r=t,s=i(t/u),l<t)return e.length-1;for(s>e.length&&(r=t-l,s=e.length);r>0;){if(r=t-o(e.substr(0,s)),!(c=a(r/u)))return s;s+=c}for(;r<0;){if(r=t-o(e.substr(0,s)),!(c=a(r/u)))return s;s+=c}return s},setLineHeight:function setLineHeight(e){var t=e.fontSize=e.fontSize||"12px";return e.lineHeight=e.lineHeight||e["line-height"]||1.2*parseInt(t,10)+"px",e}}}};t.default=r,e.exports=t.default},function(e,t,n){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=_interopRequireDefault(n(1)),a=_interopRequireDefault(n(6)),o=i.default.init("undefined"!=typeof window?window:void 0),s=o.win.document,c=o.win.Math,l=c.max,u=c.round,f={" ":"&nbsp;"},h=o.getDocumentSupport(),d=h.isWebKit?0:4.5;function SmartLabelManager(e,t,n,i){var c,l,u,f,d=!1,_=SmartLabelManager.store;if(void 0!==e&&"object"!==(void 0===e?"undefined":r(e))){for(l in(f=_[e])&&f.dispose(),_[e]=this,(i=i||{}).maxCacheLimit=isFinite(u=i.maxCacheLimit)?u:o.maxDefaultCacheLimit,"string"==typeof t&&(t=s.getElementById(t)),(c=o.createContainer(t)).innerHTML=o.testStrAvg,!h.isHeadLess&&(h.isIE||c.offsetHeight||c.offsetWidth)||(d=!0),c.innerHTML="",o.parentContainerStyle)c.style[l]=o.parentContainerStyle[l];this.id=e,this.parentContainer=c,this._containerManager=new a.default(c,d,10),this._showNoEllipses=!n,this._init=!0,this.style={},this.options=i,this.setStyle()}}SmartLabelManager.textToLines=function(e){return(e=e||{}).text?"string"!=typeof e.text&&(e.text=e.text.toString()):e.text="",e.lines=e.text.split(/\n|<br\s*?\/?>/gi),e},SmartLabelManager.store={},SmartLabelManager.prototype._calCharDimWithCache=function(e,t,n){if(!this._init)return!1;var r,i,a,o,s,c,l=this.options.maxCacheLimit,u=this._container,h=this.style||{},d=this._advancedCache||(this._advancedCache={}),_=this._advancedCacheKey||(this._advancedCacheKey=[]),p=e+(h.fontSize||"")+(h.fontFamily||"")+(h.fontWeight||"")+(h.fontStyle||""),y=e+"init"+(h.fontSize||"")+(h.fontFamily||"")+(h.fontWeight||"")+(h.fontStyle||"");return f[e]&&(e=f[e]),t?void 0===(c=d[y])&&(u.innerHTML=e.repeat?e.repeat(n):Array(n+1).join(e),a=u.offsetWidth,u.innerHTML=e,o=u.offsetWidth,c=d[y]=(a-n*o)/(n+1),_.push(y),_.length>l&&delete d[_.shift()]):c=0,(s=d[p])?(i=s.split(","),{width:parseFloat(i[0],10),height:parseFloat(i[1],10)}):(u.innerHTML=e,r={height:u.offsetHeight,width:u.offsetWidth+c},d[p]=r.width+","+r.height,_.push(p),_.length>l&&delete d[_.shift()],r)},SmartLabelManager.prototype._getWidthFn=function(){var e=this._containerObj,t=this._container,n=e.svgText;return n?function(e){var t,r;return n.textContent=e,(r=(t=n.getBBox()).width-d)<1&&(r=t.width),r}:function(e){return t.innerHTML=e,t.offsetWidth}},SmartLabelManager.prototype.setStyle=function(e){return this._init?e!==this.style||this._styleNotSet?(e||(e=this.style),o.setLineHeight(e),this.style=e,this._containerObj=t=this._containerManager.get(e),this._containerObj?(this._container=t.node,this._context=t.context,this._cache=t.charCache,this._lineHeight=t.lineHeight,this._styleNotSet=!1):this._styleNotSet=!0,this):void 0:this;var t},SmartLabelManager.prototype.useEllipsesOnOverflow=function(e){return this._init?(this._showNoEllipses=!e,this):this},SmartLabelManager.prototype.getSmartText=function(e,t,n,r){if(!this._init)return!1;void 0===e||null===e?e="":"string"!=typeof e&&(e=e.toString());var i,a,c,u,f,d,_,p,y,g,m,v,b,x,w,C,k,S,M,P,E,T,A,O,N,R,F=!1,D=0,L=-1,I=-1,j=-1,z=0,B=0,H=[],U=0,V=this._showNoEllipses?"":"...",q=this._lineHeight,W=this._context,G=this._container,Y=this._containerObj,X=Y.ellipsesWidth,$=Y.dotWidth,Z=[],K=-1,J=-1,Q=-1,ee=function fastTrim(e){for(var t=/\s/,n=(e=e.replace(/^\s\s*/,"")).length;t.test(e.charAt(n-=1)););return e.slice(0,n+1)},te={text:e,maxWidth:t,maxHeight:n,width:null,height:null,oriTextWidth:null,oriTextHeight:null,oriText:e,isTruncated:!1};if(v=this._getWidthFn(),n===q&&(n*=1.2),G){if(!h.isBrowserLess){if((F=o.xmlTagRegEx.test(e))?(G.innerHTML=e,te.oriTextWidth=_=G.offsetWidth,te.oriTextHeight=p=G.offsetHeight):(u=e.replace(o.ltgtRegex,function(e){return"&lt;"===e?"<":">"}),w=this.getOriSize(u,!0),te.oriTextWidth=_=w.width,te.oriTextHeight=p=w.height),p<=n&&_<=t)return te.width=te.oriTextWidth=_,te.height=te.oriTextHeight=p,te;if(q>n)return te.text="",te.width=te.oriTextWidth=0,te.height=te.oriTextHeight=0,te}if(e=ee(e).replace(/(\s+)/g," "),f=this._showNoEllipses?t:t-X,!F){if(i=(H=e.split("")).length,a="",c=[],m=H[0],this._cache[m]?M=this._cache[m].width:(M=v(m),this._cache[m]={width:M}),f>M)U=(c=e.substr(0,o.getNearestBreakIndex(e,f,this)).split("")).length;else{if(M>t)return te.text="",te.width=te.oriTextWidth=te.height=te.oriTextHeight=0,te;V&&((f=t-2*$)>M?V="..":(f=t-$)>M?V=".":(f=0,V=""))}if(z=v(c.join("")),B=this._lineHeight,r){for(;U<i;U+=1)if(m=c[U]=H[U],this._cache[m]?M=this._cache[m].width:(w&&(M=w.detailObj[m])||(M=v(m)),this._cache[m]={width:M}),(z+=M)>f&&(a||(a=c.slice(0,-1).join("")),z>t))return te.text=ee(a)+V,te.tooltext=te.oriText,te.width=v(te.text),te.height=this._lineHeight,te;return te.text=c.join(""),te.width=z,te.height=this._lineHeight,te}for(;U<i;U+=1)if(" "!==(m=c[U]=H[U])||W||(m="&nbsp;"),this._cache[m]?M=this._cache[m].width:(w&&(M=w.detailObj[m])||(M=v(m)),this._cache[m]={width:M}),(z+=M)>f&&(a||(a=c.slice(0,-1).join("")),z>t)){if(I=e.substr(0,c.length).lastIndexOf(" "),L=e.substr(0,c.length).lastIndexOf("-"),I>j?(z=v(c.slice(j+1,I).join("")),c.splice(I,1,"<br/>"),j=I,y=I+1):L>j?(L===c.length-1?(z=v(c.slice(j+1,I).join("")),c.splice(L,1,"<br/>-")):(z=v(c.slice(j+1,I).join("")),c.splice(L,1,"-<br/>")),j=L,y=L+1):(c.splice(c.length-1,1,"<br/>"+H[U]),Q=c.length-2,z=v(c.slice(j+1,Q+1).join("")),j=Q,y=U),(B+=this._lineHeight)>n)return te.text=ee(a)+V,te.tooltext=te.oriText,te.width=t,te.height=B-this._lineHeight,te;D=l(D,z),a=null,g=o.getNearestBreakIndex(e.substr(y),f,this),z=v(e.substr(y,g||1)),c.length<y+g&&(U=(c=c.concat(e.substr(c.length,y+g-c.length).split(""))).length-1)}return D=l(D,z),te.text=c.join(""),te.width=D,te.height=B,te}for(d=e.replace(o.spanAdditionRegx,"$2"),e=(e=e.replace(o.spanAdditionRegx,o.spanAdditionReplacer)).replace(/(<br\s*\/*\>)/g,'<span class="'+[o.classNameWithTag," ",o.classNameWithTagBR].join("")+'">$1</span>'),G.innerHTML=e,k=0,S=(C=G[h.childRetriverFn](h.childRetriverString)).length;k<S;k+=1)P=C[k],(h.noClassTesting||o.classNameReg.test(P.className))&&""!==(E=P.innerHTML)&&(" "===E?J=Z.length:"-"===E&&(K=Z.length),Z.push({spaceIdx:J,dashIdx:K,elem:P}),H.push(E));if(U=0,i=Z.length,(M=Z[0].elem.offsetWidth)>t)return te.text="",te.width=te.oriTextWidth=te.height=te.oriTextHeight=0,te;if(M>f&&!this._showNoEllipses&&((f=t-2*$)>M?V="..":(f=t-$)>M?V=".":(f=0,V="")),b=Z[0].elem.offsetLeft,x=Z[0].elem.offsetTop,r)for(;U<i;U+=1)(T=(P=Z[U].elem).offsetLeft-b+P.offsetWidth)>f&&(R||(R=U),G.offsetWidth>t&&(N=U,U=i));else for(;U<i;U+=1)A=(P=Z[U].elem).offsetHeight+(P.offsetTop-x),O=null,(T=P.offsetLeft-b+P.offsetWidth)>f?(R||(R=U),T>t&&(I=Z[U].spaceIdx,L=Z[U].dashIdx,I>j?(Z[I].elem.innerHTML="<br/>",j=I):L>j?(Z[L].elem.innerHTML=L===U?"<br/>-":"-<br/>",j=L):P.parentNode.insertBefore(O=s.createElement("br"),P),P.offsetHeight+P.offsetTop>n?(O?O.parentNode.removeChild(O):j===L?Z[L].elem.innerHTML="-":Z[I].elem.innerHTML=" ",N=U,U=i):R=null)):A>n&&(N=U,U=i);if(N<i){for(te.isTruncated=!0,R=R||N,U=i-1;U>=R;U-=1)(P=Z[U].elem).parentNode.removeChild(P);for(;U>=0;U-=1)P=Z[U].elem,o.classNameBrReg.test(P.className)?P.parentNode.removeChild(P):U=0}return te.text=G.innerHTML.replace(o.spanRemovalRegx,"$1").replace(/\&amp\;/g,"&"),te.isTruncated&&(te.text+=V,te.tooltext=d),te.height=G.offsetHeight,te.width=G.offsetWidth,te}return te.error=new Error("Body Tag Missing!"),te},SmartLabelManager.prototype.getOriSize=function(e,t){if(!this._init)return!1;var n,r,i,a,o,s=0,c=0,f={};if(!t)return this._calCharDimWithCache(e);for(a=0,o=(n=e.split("")).length;a<o;a++)r=n[a],i=this._calCharDimWithCache(r,!0,n.length),c=l(c,i.height),s+=i.width,f[r]=i.width;return{width:u(s),height:c,detailObj:f}},SmartLabelManager.prototype.dispose=function(){return this._init?(this._containerManager&&this._containerManager.dispose&&this._containerManager.dispose(),delete this._container,delete this._context,delete this._cache,delete this._containerManager,delete this._containerObj,delete this.id,delete this.style,delete this.parentContainer,delete this._showNoEllipses,this):this},t.default=SmartLabelManager,e.exports=t.default},function(e){e.exports={name:"datamodel",description:"A model which has been built on the concept of relational algebra",homepage:"https://bitbucket.org/fusioncharts/datamodel",version:"1.0.0",license:"ISC",main:"src/index.js",author:"FusionCharts Technologies <support@fusioncharts.com> (https://fusioncharts.com)",keywords:["datamodel","data","relational","algebra","model"],repository:{type:"git",url:"https://bitbucket.org/fusioncharts/datamodel.git"},contributors:[{name:"Akash Ghoswami",email:"akash@fusioncharts.com"},{name:"Subhash Haldar",email:"subhash@fusioncharts.com"},{name:"Rousan Ali",email:"rousan@fusioncharts.com",url:"https://rousan.io"},{name:"Ujjal Kumar Dutta",email:"ujjal@fusioncharts.com"}],dependencies:{"d3-dsv":"^1.0.8","muze-utils":"^1.0.0"}}},function(e){e.exports={name:"muze",version:"1.0.0",description:"JavaScript Data Visualization Library based on Relational Algebra",homepage:"https://charts.com/muze",license:"MIT",author:"Charts.com <support@charts.com>",contributors:[{name:"Akash Ghoswami",email:"akash@fusioncharts.com"},{name:"Ranajit Banerjee",email:"ranajit.banerjee@fusioncharts.com",url:"https://github.com/ranajitbanerjee"},{name:"Mridul Meharia",email:"mridul@fusioncharts.com",url:"https://github.com/mridulmeh"},{name:"Subhash Haldar",email:"subhash@fusioncharts.com"},{name:"Sandeep Acharya",email:"sandeep@fusioncharts.com"},{name:"Rousan Ali",email:"rousan@fusioncharts.com",url:"https://rousan.io"},{name:"Ujjal Kumar Dutta",email:"ujjal@fusioncharts.com"}],main:"src/index.js",keywords:["muze","svg","vector","graphics","data-visualization","visualization","renderer","fusioncharts","relational","algebra","relation"],repository:{type:"git",url:"https://bitbucket.org/fusioncharts/muze"},dependencies:{datamodel:"^1.0.0","fusioncharts-smartlabel":"^1.0.2","@chartshq/layout":"^1.0.0","@chartshq/muze-firebolt":"^1.0.0","@chartshq/muze-legend":"^1.0.0","muze-utils":"^1.0.0","@chartshq/visual-cell":"^1.0.0","@chartshq/visual-group":"^1.0.0","@chartshq/visual-layer":"^1.0.0","@chartshq/visual-unit":"^1.0.0"}}},function(e,t,n){var r=n(38);e.exports=r.default?r.default:r},function(e,t,n){"use strict";var r=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(n(1)).default.init("undefined"!=typeof window?window:void 0),i=r.win.document,a=r.getDocumentSupport(),o=a.isWebKit?0:4.5;function ContainerManager(e,t,n){var r;n=(n=n>5?n:5)<20?n:20,this.maxContainers=n,this.first=null,this.last=null,this.containers={},this.length=0,this.rootNode=e,t&&((r=i.createElementNS("http://www.w3.org/2000/svg","svg")).setAttributeNS("http://www.w3.org/2000/svg","xlink","http://www.w3.org/1999/xlink"),r.setAttributeNS("http://www.w3.org/2000/svg","height","0"),r.setAttributeNS("http://www.w3.org/2000/svg","width","0"),this.svgRoot=r,this.rootNode.appendChild(r))}ContainerManager.prototype.get=function(e){var t,n,i,a=this.containers,o=this.length,s=this.maxContainers,c="";for(n in r.supportedStyle)void 0!==e[n]&&(c+=r.supportedStyle[n]+":"+e[n]+";");if(!c)return!1;if(i=a[c])this.first!==i&&(i.prev&&(i.prev.next=i.next),i.next&&(i.next.prev=i.prev),i.next=this.first,i.next.prev=i,this.last===i&&(this.last=i.prev),i.prev=null,this.first=i);else{if(o>=s)for(t=o-s+1;t--;)this.removeContainer(this.last);i=this.addContainer(c)}return i},ContainerManager.prototype.addContainer=function(e){var t,n;return this.containers[e]=n={next:null,prev:null,node:null,ellipsesWidth:0,lineHeight:0,dotWidth:0,avgCharWidth:4,keyStr:e,charCache:{}},n.next=this.first,n.next&&(n.next.prev=n),this.first=n,this.last||(this.last=n),this.length+=1,t=n.node=i.createElement("div"),this.rootNode.appendChild(t),a.isIE&&!a.hasSVG?t.style.setAttribute("cssText",e):t.setAttribute("style",e),t.setAttribute("aria-hidden","true"),t.setAttribute("role","presentation"),t.style.display="inline-block",t.innerHTML=r.testStrAvg,n.lineHeight=t.offsetHeight,n.avgCharWidth=t.offsetWidth/3,a.isBrowserLess?((t=n.svgText=i.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("style",e),this.svgRoot.appendChild(t),t.textContent=r.testStrAvg,n.lineHeight=t.getBBox().height,n.avgCharWidth=(t.getBBox().width-o)/3,t.textContent="...",n.ellipsesWidth=t.getBBox().width-o,t.textContent=".",n.dotWidth=t.getBBox().width-o):(t.innerHTML="...",n.ellipsesWidth=t.offsetWidth,t.innerHTML=".",n.dotWidth=t.offsetWidth,t.innerHTML=""),n},ContainerManager.prototype.removeContainer=function(e){var t=e.keyStr;t&&this.length&&e&&(this.length-=1,e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev),e.node.parentNode.removeChild(e.node),delete this.containers[t])},ContainerManager.prototype.dispose=function(){var e,t=this.containers;for(e in this.maxContainers=null,t)this.removeContainer(t[e]);this.rootNode.parentNode.removeChild(this.rootNode),this.rootNode=null,this.first=null,this.last=null},e.exports=ContainerManager},function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,,function(e,t,n){},,function(e,t,n){},,function(e,t,n){},,function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"BRUSH",function(){return li}),n.d(r,"HIGHLIGHT",function(){return ui}),n.d(r,"TOOLTIP",function(){return fi}),n.d(r,"FILTER",function(){return hi}),n.d(r,"SELECT",function(){return di});var i={};n.r(i),n.d(i,"HighlightBeahviour",function(){return pi}),n.d(i,"BrushBehaviour",function(){return gi}),n.d(i,"FilterBehaviour",function(){return vi}),n.d(i,"SelectBehaviour",function(){return ki});var a={};n.r(a),n.d(a,"DRAG",function(){return Ti}),n.d(a,"HOVER",function(){return Ai}),n.d(a,"SELECTIONDRAG",function(){return Oi}),n.d(a,"CLICK",function(){return Ni}),n.d(a,"LONGTOUCH",function(){return Ri}),n.d(a,"TOUCHDRAG",function(){return Fi});var o={};n.r(o),n.d(o,"SelectionBox",function(){return Gi}),n.d(o,"Tooltip",function(){return va}),n.d(o,"Crossline",function(){return xa}),n.d(o,"PlotHighlighter",function(){return ka}),n.d(o,"FilterEffect",function(){return Ma}),n.d(o,"PersistentAnchors",function(){return Oa}),n.d(o,"AnchorEffect",function(){return Ea});var s={};n.r(s),n.d(s,"BOTTOM",function(){return Dl}),n.d(s,"TOP",function(){return Ll}),n.d(s,"LEFT",function(){return Il}),n.d(s,"RIGHT",function(){return jl}),n.d(s,"axisOrientationMap",function(){return zl});var c={};n.r(c),n.d(c,"LINEAR",function(){return Bl}),n.d(c,"BAND",function(){return Hl}),n.d(c,"TIME",function(){return Ul}),n.d(c,"COLOR",function(){return Vl}),n.d(c,"ORDINAL",function(){return ql}),n.d(c,"QUANTIZE",function(){return Wl}),n.d(c,"QUANTILE",function(){return Gl}),n.d(c,"LOG",function(){return Yl}),n.d(c,"POW",function(){return Xl}),n.d(c,"IDENTITY",function(){return $l}),n.d(c,"SEQUENTIAL",function(){return Zl}),n.d(c,"THRESHOLD",function(){return Kl});var l={};n.r(l),n.d(l,"createBinnedFieldData",function(){return createBinnedFieldData}),n.d(l,"selectIterator",function(){return selectIterator}),n.d(l,"calculatedVariableIterator",function(){return calculatedVariableIterator}),n.d(l,"projectIterator",function(){return projectIterator}),n.d(l,"groupByIterator",function(){return groupByIterator}),n.d(l,"compose",function(){return bp}),n.d(l,"bin",function(){return xp}),n.d(l,"select",function(){return wp}),n.d(l,"project",function(){return Cp}),n.d(l,"groupby",function(){}),n.d(l,"calculateVariable",function(){return kp}),n.d(l,"sort",function(){return Sp}),n.d(l,"crossProduct",function(){return crossProduct}),n.d(l,"dataBuilder",function(){return dataBuilder}),n.d(l,"difference",function(){return difference_difference}),n.d(l,"getCommonSchema",function(){return getCommonSchema}),n.d(l,"defReducer",function(){return group_by_function_sum}),n.d(l,"fnList",function(){return Np}),n.d(l,"groupBy",function(){return group_by_groupBy}),n.d(l,"getFieldArr",function(){return getFieldArr}),n.d(l,"getReducerObj",function(){return getReducerObj}),n.d(l,"mergeSort",function(){return mergeSort}),n.d(l,"naturalJoinFilter",function(){return naturalJoinFilter}),n.d(l,"naturalJoin",function(){return natural_join_naturalJoin}),n.d(l,"leftOuterJoin",function(){return leftOuterJoin}),n.d(l,"rightOuterJoin",function(){return rightOuterJoin}),n.d(l,"fullOuterJoin",function(){return fullOuterJoin}),n.d(l,"rowDiffsetIterator",function(){return rowDiffsetIterator}),n.d(l,"union",function(){return union_union});var u={};n.r(u),n.d(u,"DSVArr",function(){return Kp}),n.d(u,"DSVStr",function(){return oy}),n.d(u,"FlatJSON",function(){return sy}),n.d(u,"Auto",function(){return cy});var f={};n.r(f),n.d(f,"sum",function(){return ky}),n.d(f,"avg",function(){return Sy}),n.d(f,"min",function(){return My}),n.d(f,"max",function(){return Py}),n.d(f,"first",function(){return Ey}),n.d(f,"last",function(){return Ty}),n.d(f,"count",function(){return Ay}),n.d(f,"sd",function(){return Oy});var h={};n.r(h),n.d(h,"CONFIG",function(){return Vg}),n.d(h,"DATA",function(){return qg}),n.d(h,"AXES",function(){return Wg}),n.d(h,"LAYERDEFS",function(){return Gg}),n.d(h,"WIDTH",function(){return Yg}),n.d(h,"HEIGHT",function(){return Xg}),n.d(h,"MOUNT",function(){return $g}),n.d(h,"primaryXAxisUpdated",function(){return Zg}),n.d(h,"primaryYAxisUpdated",function(){return Kg}),n.d(h,"secondaryXAxisUpdated",function(){return Jg}),n.d(h,"secondaryYAxisUpdated",function(){return Qg}),n.d(h,"TRANSFORM",function(){return em}),n.d(h,"DATADOMAIN",function(){return tm}),n.d(h,"LAYERSCREATED",function(){return nm}),n.d(h,"FIELDS",function(){return rm}),n.d(h,"TIMEDIFFS",function(){return im}),n.d(h,"LAYERAXISINDEX",function(){return am});var d={};n.r(d),n.d(d,"SelectionBox",function(){return vv}),n.d(d,"LegendHighlighter",function(){return wv});var _={};n.r(_),n.d(_,"share",function(){return yb}),n.d(_,"html",function(){return operators_html});var y=n(2),g=n.n(y),m={FLAT_JSON:"FlatJSON",DSV_STR:"DSVStr",DSV_ARR:"DSVArr",AUTO:"Auto"},v={CATEGORICAL:"categorical",TEMPORAL:"temporal",GEO:"geo"},b={MEASURE:"measure",DIMENSION:"dimension"},x={NORMAL:"normal",INVERSE:"inverse",ALL:"all"},w={ROW_ID:"__id__"},C={ACTION_INF:"actionInf",ON_LAYER_DRAW:"onlayerdraw"};function convertToNativeDate(e){return e instanceof Date?e:new Date(e)}function date_time_formatter_pad(e){return e<10?"0"+e:e}function DateTimeFormatter(e){this.format=e,this.dtParams=void 0,this.nativeDate=void 0}RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},DateTimeFormatter.TOKEN_PREFIX="%",DateTimeFormatter.DATETIME_PARAM_SEQUENCE={YEAR:0,MONTH:1,DAY:2,HOUR:3,MINUTE:4,SECOND:5,MILLISECOND:6},DateTimeFormatter.defaultNumberParser=function(e){return function(t){var n;return isFinite(n=parseInt(t,10))?n:e}},DateTimeFormatter.defaultRangeParser=function(e,t){return function(n){var r,i,a=void 0;if(!n)return t;for(r=n.toLowerCase(),a=0,i=e.length;a<i;a++)if(e[a].toLowerCase()===r)return a;return void 0===a?t:null}},DateTimeFormatter.getTokenDefinitions=function(){var e={short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},t={short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],long:["January","February","March","April","May","June","July","August","September","October","November","December"]};return{H:{name:"H",index:3,extract:function extract(){return"(\\d+)"},parser:DateTimeFormatter.defaultNumberParser(),formatter:function formatter(e){return convertToNativeDate(e).getHours().toString()}},l:{name:"l",index:3,extract:function extract(){return"(\\d+)"},parser:DateTimeFormatter.defaultNumberParser(),formatter:function formatter(e){var t=convertToNativeDate(e).getHours()%12;return(0===t?12:t).toString()}},p:{name:"p",index:3,extract:function extract(){return"(AM|PM)"},parser:function parser(e){return e?e.toLowerCase():null},formatter:function formatter(e){return convertToNativeDate(e).getHours()<12?"AM":"PM"}},P:{name:"P",index:3,extract:function extract(){return"(am|pm)"},parser:function parser(e){return e?e.toLowerCase():null},formatter:function formatter(e){return convertToNativeDate(e).getHours()<12?"am":"pm"}},M:{name:"M",index:4,extract:function extract(){return"(\\d+)"},parser:DateTimeFormatter.defaultNumberParser(),formatter:function formatter(e){return date_time_formatter_pad(convertToNativeDate(e).getMinutes())}},S:{name:"S",index:5,extract:function extract(){return"(\\d+)"},parser:DateTimeFormatter.defaultNumberParser(),formatter:function formatter(e){return date_time_formatter_pad(convertToNativeDate(e).getSeconds())}},K:{name:"K",index:6,extract:function extract(){return"(\\d+)"},parser:DateTimeFormatter.defaultNumberParser(),formatter:function formatter(e){return convertToNativeDate(e).getMilliseconds().toString()}},a:{name:"a",index:2,extract:function extract(){return"("+e.short.join("|")+")"},parser:DateTimeFormatter.defaultRangeParser(e.short),formatter:function formatter(t){var n=convertToNativeDate(t).getDay();return e.short[n].toString()}},A:{name:"A",index:2,extract:function extract(){return"("+e.long.join("|")+")"},parser:DateTimeFormatter.defaultRangeParser(e.long),formatter:function formatter(t){var n=convertToNativeDate(t).getDay();return e.long[n].toString()}},e:{name:"e",index:2,extract:function extract(){return"(\\d+)"},parser:DateTimeFormatter.defaultNumberParser(),formatter:function formatter(e){return convertToNativeDate(e).getDate().toString()}},d:{name:"d",index:2,extract:function extract(){return"(\\d+)"},parser:DateTimeFormatter.defaultNumberParser(),formatter:function formatter(e){return date_time_formatter_pad(convertToNativeDate(e).getDate())}},b:{name:"b",index:1,extract:function extract(){return"("+t.short.join("|")+")"},parser:DateTimeFormatter.defaultRangeParser(t.short),formatter:function formatter(e){var n=convertToNativeDate(e).getMonth();return t.short[n].toString()}},B:{name:"B",index:1,extract:function extract(){return"("+t.long.join("|")+")"},parser:DateTimeFormatter.defaultNumberParser(t.long),formatter:function formatter(e){var n=convertToNativeDate(e).getMonth();return t.long[n].toString()}},m:{name:"m",index:1,extract:function extract(){return"(\\d+)"},parser:function parser(e){return DateTimeFormatter.defaultNumberParser()(e)-1},formatter:function formatter(e){return date_time_formatter_pad(convertToNativeDate(e).getMonth()+1)}},y:{name:"y",index:0,extract:function extract(){return"(\\d{4})"},parser:function parser(e){var t=void 0;return e&&(t=e.length,e=e.substring(t-2,t)),DateTimeFormatter.defaultNumberParser()(e)},formatter:function formatter(e){var t=convertToNativeDate(e).getFullYear().toString(),n=void 0;return t&&(n=t.length,t=t.substring(n-2,n)),t}},Y:{name:"Y",index:0,extract:function extract(){return"(\\d{4})"},parser:DateTimeFormatter.defaultNumberParser(),formatter:function formatter(e){return convertToNativeDate(e).getFullYear().toString()}}}},DateTimeFormatter.getTokenFormalNames=function(){var e=DateTimeFormatter.getTokenDefinitions();return{HOUR:e.H,HOUR_12:e.l,AMPM_UPPERCASE:e.p,AMPM_LOWERCASE:e.P,MINUTE:e.M,SECOND:e.S,SHORT_DAY:e.a,LONG_DAY:e.A,DAY_OF_MONTH:e.e,DAY_OF_MONTH_CONSTANT_WIDTH:e.d,SHORT_MONTH:e.b,LONG_MONTH:e.B,MONTH_OF_YEAR:e.m,SHORT_YEAR:e.y,LONG_YEAR:e.Y}},DateTimeFormatter.tokenResolver=function(){var e=DateTimeFormatter.getTokenDefinitions(),t=function defaultResolver(){for(var e=0,t=arguments.length,n=void 0,r=void 0;e<t;e++)n=arguments.length<=e?void 0:arguments[e],(arguments.length<=e?void 0:arguments[e])&&(r=n);return r?r[0].parser(r[1]):null};return{YEAR:[e.y,e.Y,t],MONTH:[e.b,e.B,e.m,t],DAY:[e.a,e.A,e.e,e.d,t],HOUR:[e.H,e.l,e.p,e.P,function(e,t,n,r){var i=void 0,a=void 0,o=void 0,s=void 0;return t&&(a=n||r)?("pm"===a[0].parser(a[1])&&(o=!0),i=t):i=t||e,i?(s=i[0].parser(i[1]),o&&(s+=12),s):null}],MINUTE:[e.M,t],SECOND:[e.S,t]}},DateTimeFormatter.findTokens=function(e){for(var t=DateTimeFormatter.TOKEN_PREFIX,n=DateTimeFormatter.getTokenDefinitions(),r=Object.keys(n),i=[],a=void 0,o=void 0;(a=e.indexOf(t,a+1))>=0;)o=e[a+1],-1!==r.indexOf(o)&&i.push({index:a,token:o});return i},DateTimeFormatter.formatAs=function(e,t){var n,r=convertToNativeDate(e),i=DateTimeFormatter.findTokens(t),a=DateTimeFormatter.getTokenDefinitions(),o=String(t),s=DateTimeFormatter.TOKEN_PREFIX,c=void 0,l=void 0,u=void 0;for(u=0,n=i.length;u<n;u++)l=a[c=i[u].token].formatter(r),o=o.replace(new RegExp(s+c,"g"),l);return o},DateTimeFormatter.prototype.parse=function(e,t){var n=DateTimeFormatter.tokenResolver(),r=this.extractTokenValue(e),i=DateTimeFormatter.DATETIME_PARAM_SEQUENCE,a=t&&t.noBreak,o=[],s=[],c=void 0,l=void 0,u=void 0,f=void 0,h=void 0,d=void 0,_=void 0,p=void 0;for(c in n)if({}.hasOwnProperty.call(n,c)){for(s.length=0,u=(l=n[c]).splice(l.length-1,1)[0],h=0,p=l.length;h<p;h++)void 0===(f=r[(d=l[h]).name])?s.push(null):s.push([d,f]);if((void 0===(_=u.apply(this,s))||null===_)&&!a)break;o[i[c]]=_}return o},DateTimeFormatter.prototype.extractTokenValue=function(e){var t,n,r,i=this.format,a=DateTimeFormatter.getTokenDefinitions(),o=DateTimeFormatter.TOKEN_PREFIX,s=DateTimeFormatter.findTokens(i),c={},l=void 0,u=void 0,f=void 0,h=void 0,d=void 0,_=void 0,p=void 0;for(d=String(i),t=s.map(function(e){return e.token}),p=(n=s.length)-1;p>=0;p--)(f=s[p].index)+1!==d.length-1?(void 0===l&&(l=d.length),h=d.substring(f+2,l),d=d.substring(0,f+2)+RegExp.escape(h)+d.substring(l,d.length),l=f):l=f;for(p=0;p<n;p++)u=s[p],d=d.replace(o+u.token,a[u.token].extract());for((_=e.match(new RegExp(d))||[]).shift(),p=0,r=t.length;p<r;p++)c[t[p]]=_[p];return c},DateTimeFormatter.prototype.getNativeDate=function(e){if(e instanceof Date)return e;if(isFinite(e)&&this.format)return new Date(e);var t=this.dtParams=this.parse(e);return t.unshift(null),this.nativeDate=new(Function.prototype.bind.apply(Date,t))},DateTimeFormatter.prototype.formatAs=function(e,t){var n=void 0;return t?n=this.nativeDate=this.getNativeDate(t):(n=this.nativeDate)||(n=this.getNativeDate(t)),DateTimeFormatter.formatAs(n,e)};var k=Math.PI,S=2*k,M=S-1e-6;function Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function path_path(){return new Path}Path.prototype=path_path.prototype={constructor:Path,moveTo:function moveTo(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function lineTo(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function quadraticCurveTo(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function arcTo(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,c=r-t,l=a-e,u=o-t,f=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>1e-6)if(Math.abs(u*s-c*l)>1e-6&&i){var h=n-a,d=r-o,_=s*s+c*c,p=h*h+d*d,y=Math.sqrt(_),g=Math.sqrt(f),m=i*Math.tan((k-Math.acos((_+f-p)/(2*y*g)))/2),v=m/g,b=m/y;Math.abs(v-1)>1e-6&&(this._+="L"+(e+v*l)+","+(t+v*u)),this._+="A"+i+","+i+",0,0,"+ +(u*h>l*d)+","+(this._x1=e+b*s)+","+(this._y1=t+b*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function arc(e,t,n,r,i,a){e=+e,t=+t;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=e+o,l=t+s,u=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+c+","+l),n&&(f<0&&(f=f%S+S),f>M?this._+="A"+n+","+n+",0,1,"+u+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=k)+","+u+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function rect(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function toString(){return this._}};Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt;var P=1e-12,E=Math.PI,T=2*E;function Linear(e){this._context=e}Linear.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var A=function(e){return new Linear(e)};curveRadial(A);function Radial(e){this._curve=e}function curveRadial(e){function radial(t){return new Radial(e(t))}return radial._curve=e,radial}Radial.prototype={areaStart:function areaStart(){this._curve.areaStart()},areaEnd:function areaEnd(){this._curve.areaEnd()},lineStart:function lineStart(){this._curve.lineStart()},lineEnd:function lineEnd(){this._curve.lineEnd()},point:function point(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};Array.prototype.slice;var O={draw:function draw(e,t){var n=Math.sqrt(t/E);e.moveTo(n,0),e.arc(0,0,n,0,T)}},N={draw:function draw(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},R=Math.sqrt(1/3),F=2*R,D={draw:function draw(e,t){var n=Math.sqrt(t/F),r=n*R;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},L=Math.sin(E/10)/Math.sin(7*E/10),I=Math.sin(T/10)*L,j=-Math.cos(T/10)*L,z={draw:function draw(e,t){var n=Math.sqrt(.8908130915292852*t),r=I*n,i=j*n;e.moveTo(0,-n),e.lineTo(r,i);for(var a=1;a<5;++a){var o=T*a/5,s=Math.cos(o),c=Math.sin(o);e.lineTo(c*n,-s*n),e.lineTo(s*r-c*i,c*r+s*i)}e.closePath()}},B={draw:function draw(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},H=Math.sqrt(3),U={draw:function draw(e,t){var n=-Math.sqrt(t/(3*H));e.moveTo(0,2*n),e.lineTo(-H*n,-n),e.lineTo(H*n,-n),e.closePath()}},V=Math.sqrt(3)/2,q=1/Math.sqrt(12),W=3*(q/2+1),G={draw:function draw(e,t){var n=Math.sqrt(t/W),r=n/2,i=n*q,a=r,o=n*q+n,s=-a,c=o;e.moveTo(r,i),e.lineTo(a,o),e.lineTo(s,c),e.lineTo(-.5*r-V*i,V*r+-.5*i),e.lineTo(-.5*a-V*o,V*a+-.5*o),e.lineTo(-.5*s-V*c,V*s+-.5*c),e.lineTo(-.5*r+V*i,-.5*i-V*r),e.lineTo(-.5*a+V*o,-.5*o-V*a),e.lineTo(-.5*s+V*c,-.5*c-V*s),e.closePath()}},Y=function(){};function _point(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Basis(e){this._context=e}Basis.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 3:_point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function BasisClosed(e){this._context=e}BasisClosed.prototype={areaStart:Y,areaEnd:Y,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function BasisOpen(e){this._context=e}BasisOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Bundle(e,t){this._basis=new Basis(e),this._beta=t}Bundle.prototype={lineStart:function lineStart(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],a=t[0],o=e[n]-i,s=t[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+r*o),this._beta*t[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};(function custom(e){function bundle(t){return 1===e?new Basis(t):new Bundle(t,e)}return bundle.beta=function(e){return custom(+e)},bundle})(.85);function cardinal_point(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function Cardinal(e,t){this._context=e,this._k=(1-t)/6}Cardinal.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:cardinal_point(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new Cardinal(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function CardinalClosed(e,t){this._context=e,this._k=(1-t)/6}CardinalClosed.prototype={areaStart:Y,areaEnd:Y,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new CardinalClosed(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function CardinalOpen(e,t){this._context=e,this._k=(1-t)/6}CardinalOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new CardinalOpen(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function catmullRom_point(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>P){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>P){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function CatmullRom(e,t){this._context=e,this._alpha=t}CatmullRom.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new CatmullRom(t,e):new Cardinal(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function CatmullRomClosed(e,t){this._context=e,this._alpha=t}CatmullRomClosed.prototype={areaStart:Y,areaEnd:Y,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new CatmullRomClosed(t,e):new CardinalClosed(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function CatmullRomOpen(e,t){this._context=e,this._alpha=t}CatmullRomOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new CatmullRomOpen(t,e):new CardinalOpen(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function LinearClosed(e){this._context=e}LinearClosed.prototype={areaStart:Y,areaEnd:Y,lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){this._point&&this._context.closePath()},point:function point(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function monotone_sign(e){return e<0?-1:1}function slope3(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(monotone_sign(a)+monotone_sign(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function monotone_point(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function MonotoneX(e){this._context=e}function MonotoneY(e){this._context=new ReflectContext(e)}function ReflectContext(e){this._context=e}function Natural(e){this._context=e}function controlPoints(e){var t,n,r=e.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}MonotoneX.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:monotone_point(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,monotone_point(this,slope2(this,n=slope3(this,e,t)),n);break;default:monotone_point(this,this._t0,n=slope3(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(e,t){MonotoneX.prototype.point.call(this,t,e)},ReflectContext.prototype={moveTo:function moveTo(e,t){this._context.moveTo(t,e)},closePath:function closePath(){this._context.closePath()},lineTo:function lineTo(e,t){this._context.lineTo(t,e)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},Natural.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=[],this._y=[]},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=controlPoints(e),i=controlPoints(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};function Step(e,t){this._context=e,this._t=t}Step.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=this._y=NaN,this._point=0},lineEnd:function lineEnd(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var X=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function extend(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Color(){}var $="\\s*([+-]?\\d+)\\s*",Z="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",K="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",J=/^#([0-9a-f]{3})$/,Q=/^#([0-9a-f]{6})$/,ee=new RegExp("^rgb\\("+[$,$,$]+"\\)$"),te=new RegExp("^rgb\\("+[K,K,K]+"\\)$"),ne=new RegExp("^rgba\\("+[$,$,$,Z]+"\\)$"),re=new RegExp("^rgba\\("+[K,K,K,Z]+"\\)$"),ie=new RegExp("^hsl\\("+[Z,K,K]+"\\)$"),ae=new RegExp("^hsla\\("+[Z,K,K,Z]+"\\)$"),oe={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_color(e){var t;return e=(e+"").trim().toLowerCase(),(t=J.exec(e))?new Rgb((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=Q.exec(e))?rgbn(parseInt(t[1],16)):(t=ee.exec(e))?new Rgb(t[1],t[2],t[3],1):(t=te.exec(e))?new Rgb(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=ne.exec(e))?rgba(t[1],t[2],t[3],t[4]):(t=re.exec(e))?rgba(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ie.exec(e))?hsla(t[1],t[2]/100,t[3]/100,1):(t=ae.exec(e))?hsla(t[1],t[2]/100,t[3]/100,t[4]):oe.hasOwnProperty(e)?rgbn(oe[e]):"transparent"===e?new Rgb(NaN,NaN,NaN,0):null}function rgbn(e){return new Rgb(e>>16&255,e>>8&255,255&e,1)}function rgba(e,t,n,r){return r<=0&&(e=t=n=NaN),new Rgb(e,t,n,r)}function rgbConvert(e){return e instanceof Color||(e=color_color(e)),e?new Rgb((e=e.rgb()).r,e.g,e.b,e.opacity):new Rgb}function color_rgb(e,t,n,r){return 1===arguments.length?rgbConvert(e):new Rgb(e,t,n,null==r?1:r)}function Rgb(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function _hex(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function hsla(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Hsl(e,t,n,r)}function hsl(e,t,n,r){return 1===arguments.length?function hslConvert(e){if(e instanceof Hsl)return new Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof Color||(e=color_color(e)),!e)return new Hsl;if(e instanceof Hsl)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new Hsl(o,s,c,e.opacity)}(e):new Hsl(e,t,n,null==r?1:r)}function Hsl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function hsl2rgb(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}X(Color,color_color,{displayable:function displayable(){return this.rgb().displayable()},hex:function hex(){return this.rgb().hex()},toString:function toString(){return this.rgb()+""}}),X(Rgb,color_rgb,extend(Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function rgb(){return this},displayable:function displayable(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function hex(){return"#"+_hex(this.r)+_hex(this.g)+_hex(this.b)},toString:function toString(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),X(Hsl,hsl,extend(Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new Hsl(this.h,this.s,this.l*e,this.opacity)},rgb:function rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Rgb(hsl2rgb(e>=240?e-240:e+120,i,r),hsl2rgb(e,i,r),hsl2rgb(e<120?e+240:e-120,i,r),this.opacity)},displayable:function displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var se=Math.PI/180,ce=180/Math.PI,le=.96422,ue=1,fe=.82521,he=4/29,de=6/29,_e=3*de*de,pe=de*de*de;function labConvert(e){if(e instanceof Lab)return new Lab(e.l,e.a,e.b,e.opacity);if(e instanceof Hcl){if(isNaN(e.h))return new Lab(e.l,0,0,e.opacity);var t=e.h*se;return new Lab(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof Rgb||(e=rgbConvert(e));var n,r,i=rgb2lrgb(e.r),a=rgb2lrgb(e.g),o=rgb2lrgb(e.b),s=xyz2lab((.2225045*i+.7168786*a+.0606169*o)/ue);return i===a&&a===o?n=r=s:(n=xyz2lab((.4360747*i+.3850649*a+.1430804*o)/le),r=xyz2lab((.0139322*i+.0971045*a+.7141733*o)/fe)),new Lab(116*s-16,500*(n-s),200*(s-r),e.opacity)}function lab(e,t,n,r){return 1===arguments.length?labConvert(e):new Lab(e,t,n,null==r?1:r)}function Lab(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function xyz2lab(e){return e>pe?Math.pow(e,1/3):e/_e+he}function lab2xyz(e){return e>de?e*e*e:_e*(e-he)}function lrgb2rgb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function rgb2lrgb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function hclConvert(e){if(e instanceof Hcl)return new Hcl(e.h,e.c,e.l,e.opacity);if(e instanceof Lab||(e=labConvert(e)),0===e.a&&0===e.b)return new Hcl(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*ce;return new Hcl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function hcl(e,t,n,r){return 1===arguments.length?hclConvert(e):new Hcl(e,t,n,null==r?1:r)}function Hcl(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}X(Lab,lab,extend(Color,{brighter:function brighter(e){return new Lab(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function darker(e){return new Lab(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new Rgb(lrgb2rgb(3.1338561*(t=le*lab2xyz(t))-1.6168667*(e=ue*lab2xyz(e))-.4906146*(n=fe*lab2xyz(n))),lrgb2rgb(-.9787684*t+1.9161415*e+.033454*n),lrgb2rgb(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),X(Hcl,hcl,extend(Color,{brighter:function brighter(e){return new Hcl(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function darker(e){return new Hcl(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function rgb(){return labConvert(this).rgb()}}));var ye=-.14861,ge=1.78277,me=-.29227,ve=-.90649,be=1.97294,xe=be*ve,we=be*ge,Ce=ge*me-ve*ye;function cubehelix_cubehelix(e,t,n,r){return 1===arguments.length?function cubehelixConvert(e){if(e instanceof Cubehelix)return new Cubehelix(e.h,e.s,e.l,e.opacity);e instanceof Rgb||(e=rgbConvert(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Ce*r+xe*t-we*n)/(Ce+xe-we),a=r-i,o=(be*(n-i)-me*a)/ve,s=Math.sqrt(o*o+a*a)/(be*i*(1-i)),c=s?Math.atan2(o,a)*ce-120:NaN;return new Cubehelix(c<0?c+360:c,s,i,e.opacity)}(e):new Cubehelix(e,t,n,null==r?1:r)}function Cubehelix(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function basis_basis(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}X(Cubehelix,cubehelix_cubehelix,extend(Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new Cubehelix(this.h,this.s,this.l*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new Cubehelix(this.h,this.s,this.l*e,this.opacity)},rgb:function rgb(){var e=isNaN(this.h)?0:(this.h+120)*se,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new Rgb(255*(t+n*(ye*r+ge*i)),255*(t+n*(me*r+ve*i)),255*(t+n*(be*r)),this.opacity)}}));var ke=function(e){return function(){return e}};function color_linear(e,t){return function(n){return e+n*t}}function color_hue(e,t){var n=t-e;return n?color_linear(e,n>180||n<-180?n-360*Math.round(n/360):n):ke(isNaN(e)?t:e)}function gamma(e){return 1==(e=+e)?nogamma:function(t,n){return n-t?function exponential(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):ke(isNaN(t)?n:t)}}function nogamma(e,t){var n=t-e;return n?color_linear(e,n):ke(isNaN(e)?t:e)}var Se=function rgbGamma(e){var t=gamma(e);function rgb(e,n){var r=t((e=color_rgb(e)).r,(n=color_rgb(n)).r),i=t(e.g,n.g),a=t(e.b,n.b),o=nogamma(e.opacity,n.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return rgb.gamma=rgbGamma,rgb}(1);function rgbSpline(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=color_rgb(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}rgbSpline(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return basis_basis((n-r/t)*t,o,i,a,s)}}),rgbSpline(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return basis_basis((n-r/t)*t,i,a,o,s)}});var Me=function(e,t){return t-=e=+e,function(n){return e+t*n}},Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ee=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Te=new RegExp(Ee.source,"g");var Ae,Oe,Ne,Re,Fe=function(e,t){var n,r,i,a=Ee.lastIndex=Te.lastIndex=0,o=-1,s=[],c=[];for(e+="",t+="";(n=Ee.exec(e))&&(r=Te.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Me(n,r)})),a=Te.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function one(e){return function(t){return e(t)+""}}(c[0].x):function string_zero(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,r=0;r<t;++r)s[(n=c[r]).i]=n.x(e);return s.join("")})},De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le=function(e,t){var n,r=void 0===t?"undefined":De(t);return null==t||"boolean"===r?ke(t):("number"===r?Me:"string"===r?(n=color_color(t))?(t=n,Se):Fe:t instanceof color_color?Se:t instanceof Date?function(e,t){var n=new Date;return t-=e=+e,function(r){return n.setTime(e+t*r),n}}:Array.isArray(t)?function(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=Le(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?function(e,t){var n,r={},i={};for(n in null!==e&&"object"===(void 0===e?"undefined":Pe(e))||(e={}),null!==t&&"object"===(void 0===t?"undefined":Pe(t))||(t={}),t)n in e?r[n]=Le(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}:Me)(e,t)},Ie=180/Math.PI,je={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},ze=function(e,t,n,r,i,a){var o,s,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*Ie,skewX:Math.atan(c)*Ie,scaleX:o,scaleY:s}};function interpolateTransform(e,t,n,r){function pop(e){return e.length?e.pop()+" ":""}return function(i,a){var o=[],s=[];return i=e(i),a=e(a),function translate(e,r,i,a,o,s){if(e!==i||r!==a){var c=o.push("translate(",null,t,null,n);s.push({i:c-4,x:Me(e,i)},{i:c-2,x:Me(r,a)})}else(i||a)&&o.push("translate("+i+t+a+n)}(i.translateX,i.translateY,a.translateX,a.translateY,o,s),function rotate(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(pop(n)+"rotate(",null,r)-2,x:Me(e,t)})):t&&n.push(pop(n)+"rotate("+t+r)}(i.rotate,a.rotate,o,s),function skewX(e,t,n,i){e!==t?i.push({i:n.push(pop(n)+"skewX(",null,r)-2,x:Me(e,t)}):t&&n.push(pop(n)+"skewX("+t+r)}(i.skewX,a.skewX,o,s),function scale(e,t,n,r,i,a){if(e!==n||t!==r){var o=i.push(pop(i)+"scale(",null,",",null,")");a.push({i:o-4,x:Me(e,n)},{i:o-2,x:Me(t,r)})}else 1===n&&1===r||i.push(pop(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,o,s),i=a=null,function(e){for(var t,n=-1,r=s.length;++n<r;)o[(t=s[n]).i]=t.x(e);return o.join("")}}}var Be=interpolateTransform(function parseCss(e){return"none"===e?je:(Ae||(Ae=document.createElement("DIV"),Oe=document.documentElement,Ne=document.defaultView),Ae.style.transform=e,e=Ne.getComputedStyle(Oe.appendChild(Ae),null).getPropertyValue("transform"),Oe.removeChild(Ae),e=e.slice(7,-1).split(","),ze(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),He=interpolateTransform(function parseSvg(e){return null==e?je:(Re||(Re=document.createElementNS("http://www.w3.org/2000/svg","g")),Re.setAttribute("transform",e),(e=Re.transform.baseVal.consolidate())?(e=e.matrix,ze(e.a,e.b,e.c,e.d,e.e,e.f)):je)},", ",")",")");Math.SQRT2;function hsl_hsl(e){return function(t,n){var r=e((t=hsl(t)).h,(n=hsl(n)).h),i=nogamma(t.s,n.s),a=nogamma(t.l,n.l),o=nogamma(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=a(e),t.opacity=o(e),t+""}}}hsl_hsl(color_hue),hsl_hsl(nogamma);function hcl_hcl(e){return function(t,n){var r=e((t=hcl(t)).h,(n=hcl(n)).h),i=nogamma(t.c,n.c),a=nogamma(t.l,n.l),o=nogamma(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=a(e),t.opacity=o(e),t+""}}}hcl_hcl(color_hue),hcl_hcl(nogamma);function src_cubehelix_cubehelix(e){return function cubehelixGamma(t){function cubehelix(n,r){var i=e((n=cubehelix_cubehelix(n)).h,(r=cubehelix_cubehelix(r)).h),a=nogamma(n.s,r.s),o=nogamma(n.l,r.l),s=nogamma(n.opacity,r.opacity);return function(e){return n.h=i(e),n.s=a(e),n.l=o(Math.pow(e,t)),n.opacity=s(e),n+""}}return t=+t,cubehelix.gamma=cubehelixGamma,cubehelix}(1)}src_cubehelix_cubehelix(color_hue),src_cubehelix_cubehelix(nogamma);function piecewise_piecewise(e,t){for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(r-1,Math.floor(e*=r)));return a[t](e-t)}}function cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}(function custom(e){function polyIn(t){return Math.pow(t,e)}return e=+e,polyIn.exponent=custom,polyIn})(3),function custom(e){function polyOut(t){return 1-Math.pow(1-t,e)}return e=+e,polyOut.exponent=custom,polyOut}(3);var Ue=function custom(e){function polyInOut(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,polyInOut.exponent=custom,polyInOut}(3);Math.PI;var Ve=4/11,qe=6/11,We=8/11,Ge=.75,Ye=9/11,Xe=10/11,$e=.9375,Ze=21/22,Ke=63/64,Je=1/Ve/Ve;function bounceOut(e){return(e=+e)<Ve?Je*e*e:e<We?Je*(e-=qe)*e+Ge:e<Xe?Je*(e-=Ye)*e+$e:Je*(e-=Ze)*e+Ke}(function custom(e){function backIn(t){return t*t*((e+1)*t-e)}return e=+e,backIn.overshoot=custom,backIn})(1.70158),function custom(e){function backOut(t){return--t*t*((e+1)*t+e)+1}return e=+e,backOut.overshoot=custom,backOut}(1.70158);var Qe=function custom(e){function backInOut(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,backInOut.overshoot=custom,backInOut}(1.70158),et=2*Math.PI,tt=(function custom(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=et);function elasticIn(r){return e*Math.pow(2,10*--r)*Math.sin((n-r)/t)}return elasticIn.amplitude=function(e){return custom(e,t*et)},elasticIn.period=function(t){return custom(e,t)},elasticIn}(1,.3),function custom(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=et);function elasticOut(r){return 1-e*Math.pow(2,-10*(r=+r))*Math.sin((r+n)/t)}return elasticOut.amplitude=function(e){return custom(e,t*et)},elasticOut.period=function(t){return custom(e,t)},elasticOut}(1,.3)),nt=(function custom(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=et);function elasticInOut(r){return((r=2*r-1)<0?e*Math.pow(2,10*r)*Math.sin((n-r)/t):2-e*Math.pow(2,-10*r)*Math.sin((n+r)/t))/2}return elasticInOut.amplitude=function(e){return custom(e,t*et)},elasticInOut.period=function(t){return custom(e,t)},elasticInOut}(1,.3),function(e){return function(){return e}});function src_point_x(e){return e[0]}function src_point_y(e){return e[1]}function RedBlackTree(){this._=null}function RedBlackNode(e){e.U=e.C=e.L=e.R=e.P=e.N=null}function RedBlackRotateLeft(e,t){var n=t,r=t.R,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function RedBlackRotateRight(e,t){var n=t,r=t.L,i=n.U;i?i.L===n?i.L=r:i.R=r:e._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function RedBlackFirst(e){for(;e.L;)e=e.L;return e}RedBlackTree.prototype={constructor:RedBlackTree,insert:function insert(e,t){var n,r,i;if(e){if(t.P=e,t.N=e.N,e.N&&(e.N.P=t),e.N=t,e.R){for(e=e.R;e.L;)e=e.L;e.L=t}else e.R=t;n=e}else this._?(e=RedBlackFirst(this._),t.P=null,t.N=e,e.P=e.L=t,n=e):(t.P=t.N=null,this._=t,n=null);for(t.L=t.R=null,t.U=n,t.C=!0,e=t;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.R&&(RedBlackRotateLeft(this,n),n=(e=n).U),n.C=!1,r.C=!0,RedBlackRotateRight(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,e=r):(e===n.L&&(RedBlackRotateRight(this,n),n=(e=n).U),n.C=!1,r.C=!0,RedBlackRotateLeft(this,r)),n=e.U;this._.C=!1},remove:function remove(e){e.N&&(e.N.P=e.P),e.P&&(e.P.N=e.N),e.N=e.P=null;var t,n,r,i=e.U,a=e.L,o=e.R;if(n=a?o?RedBlackFirst(o):a:o,i?i.L===e?i.L=n:i.R=n:this._=n,a&&o?(r=n.C,n.C=e.C,n.L=a,a.U=n,n!==o?(i=n.U,n.U=e.U,e=n.R,i.L=e,n.R=o,o.U=n):(n.U=i,i=n,e=n.R)):(r=e.C,e=n),e&&(e.U=i),!r)if(e&&e.C)e.C=!1;else{do{if(e===this._)break;if(e===i.L){if((t=i.R).C&&(t.C=!1,i.C=!0,RedBlackRotateLeft(this,i),t=i.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,RedBlackRotateRight(this,t),t=i.R),t.C=i.C,i.C=t.R.C=!1,RedBlackRotateLeft(this,i),e=this._;break}}else if((t=i.L).C&&(t.C=!1,i.C=!0,RedBlackRotateRight(this,i),t=i.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,RedBlackRotateLeft(this,t),t=i.L),t.C=i.C,i.C=t.L.C=!1,RedBlackRotateRight(this,i),e=this._;break}t.C=!0,e=i,i=i.U}while(!e.C);e&&(e.C=!1)}}};var rt=RedBlackTree;function createEdge(e,t,n,r){var i=[null,null],a=ut.push(i)-1;return i.left=e,i.right=t,n&&setEdgeEnd(i,e,t,n),r&&setEdgeEnd(i,t,e,r),ct[e.index].halfedges.push(a),ct[t.index].halfedges.push(a),i}function createBorderEdge(e,t,n){var r=[t,n];return r.left=e,r}function setEdgeEnd(e,t,n,r){e[0]||e[1]?e.left===n?e[1]=r:e[0]=r:(e[0]=r,e.left=t,e.right=n)}function clipEdge(e,t,n,r,i){var a,o=e[0],s=e[1],c=o[0],l=o[1],u=0,f=1,h=s[0]-c,d=s[1]-l;if(a=t-c,h||!(a>0)){if(a/=h,h<0){if(a<u)return;a<f&&(f=a)}else if(h>0){if(a>f)return;a>u&&(u=a)}if(a=r-c,h||!(a<0)){if(a/=h,h<0){if(a>f)return;a>u&&(u=a)}else if(h>0){if(a<u)return;a<f&&(f=a)}if(a=n-l,d||!(a>0)){if(a/=d,d<0){if(a<u)return;a<f&&(f=a)}else if(d>0){if(a>f)return;a>u&&(u=a)}if(a=i-l,d||!(a<0)){if(a/=d,d<0){if(a>f)return;a>u&&(u=a)}else if(d>0){if(a<u)return;a<f&&(f=a)}return!(u>0||f<1)||(u>0&&(e[0]=[c+u*h,l+u*d]),f<1&&(e[1]=[c+f*h,l+f*d]),!0)}}}}}function connectEdge(e,t,n,r,i){var a=e[1];if(a)return!0;var o,s,c=e[0],l=e.left,u=e.right,f=l[0],h=l[1],d=u[0],_=u[1],p=(f+d)/2,y=(h+_)/2;if(_===h){if(p<t||p>=r)return;if(f>d){if(c){if(c[1]>=i)return}else c=[p,n];a=[p,i]}else{if(c){if(c[1]<n)return}else c=[p,i];a=[p,n]}}else if(s=y-(o=(f-d)/(_-h))*p,o<-1||o>1)if(f>d){if(c){if(c[1]>=i)return}else c=[(n-s)/o,n];a=[(i-s)/o,i]}else{if(c){if(c[1]<n)return}else c=[(i-s)/o,i];a=[(n-s)/o,n]}else if(h<_){if(c){if(c[0]>=r)return}else c=[t,o*t+s];a=[r,o*r+s]}else{if(c){if(c[0]<t)return}else c=[r,o*r+s];a=[t,o*t+s]}return e[0]=c,e[1]=a,!0}function cellHalfedgeAngle(e,t){var n=e.site,r=t.left,i=t.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=t[1],i=t[0]):(r=t[0],i=t[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function cellHalfedgeStart(e,t){return t[+(t.left!==e.site)]}function cellHalfedgeEnd(e,t){return t[+(t.left===e.site)]}var it,at=[];function attachCircle(e){var t=e.P,n=e.N;if(t&&n){var r=t.site,i=e.site,a=n.site;if(r!==a){var o=i[0],s=i[1],c=r[0]-o,l=r[1]-s,u=a[0]-o,f=a[1]-s,h=2*(c*f-l*u);if(!(h>=-ht)){var d=c*c+l*l,_=u*u+f*f,p=(f*d-l*_)/h,y=(c*_-u*d)/h,g=at.pop()||new function Circle(){RedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null};g.arc=e,g.site=i,g.x=p+o,g.y=(g.cy=y+s)+Math.sqrt(p*p+y*y),e.circle=g;for(var m=null,v=lt._;v;)if(g.y<v.y||g.y===v.y&&g.x<=v.x){if(!v.L){m=v.P;break}v=v.L}else{if(!v.R){m=v;break}v=v.R}lt.insert(m,g),m||(it=g)}}}}function detachCircle(e){var t=e.circle;t&&(t.P||(it=t.N),lt.remove(t),at.push(t),RedBlackNode(t),e.circle=null)}var ot=[];function createBeach(e){var t=ot.pop()||new function Beach(){RedBlackNode(this),this.edge=this.site=this.circle=null};return t.site=e,t}function detachBeach(e){detachCircle(e),st.remove(e),ot.push(e),RedBlackNode(e)}function removeBeach(e){var t=e.circle,n=t.x,r=t.cy,i=[n,r],a=e.P,o=e.N,s=[e];detachBeach(e);for(var c=a;c.circle&&Math.abs(n-c.circle.x)<ft&&Math.abs(r-c.circle.cy)<ft;)a=c.P,s.unshift(c),detachBeach(c),c=a;s.unshift(c),detachCircle(c);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<ft&&Math.abs(r-l.circle.cy)<ft;)o=l.N,s.push(l),detachBeach(l),l=o;s.push(l),detachCircle(l);var u,f=s.length;for(u=1;u<f;++u)l=s[u],c=s[u-1],setEdgeEnd(l.edge,c.site,l.site,i);c=s[0],(l=s[f-1]).edge=createEdge(c.site,l.site,null,i),attachCircle(c),attachCircle(l)}function addBeach(e){for(var t,n,r,i,a=e[0],o=e[1],s=st._;s;)if((r=leftBreakPoint(s,o)-a)>ft)s=s.L;else{if(!((i=a-rightBreakPoint(s,o))>ft)){r>-ft?(t=s.P,n=s):i>-ft?(t=s,n=s.N):t=n=s;break}if(!s.R){t=s;break}s=s.R}!function createCell(e){return ct[e.index]={site:e,halfedges:[]}}(e);var c=createBeach(e);if(st.insert(t,c),t||n){if(t===n)return detachCircle(t),n=createBeach(t.site),st.insert(c,n),c.edge=n.edge=createEdge(t.site,c.site),attachCircle(t),void attachCircle(n);if(n){detachCircle(t),detachCircle(n);var l=t.site,u=l[0],f=l[1],h=e[0]-u,d=e[1]-f,_=n.site,p=_[0]-u,y=_[1]-f,g=2*(h*y-d*p),m=h*h+d*d,v=p*p+y*y,b=[(y*m-d*v)/g+u,(h*v-p*m)/g+f];setEdgeEnd(n.edge,l,_,b),c.edge=createEdge(l,e,null,b),n.edge=createEdge(e,_,null,b),attachCircle(t),attachCircle(n)}else c.edge=createEdge(t.site,c.site)}}function leftBreakPoint(e,t){var n=e.site,r=n[0],i=n[1],a=i-t;if(!a)return r;var o=e.P;if(!o)return-1/0;var s=(n=o.site)[0],c=n[1],l=c-t;if(!l)return s;var u=s-r,f=1/a-1/l,h=u/l;return f?(-h+Math.sqrt(h*h-2*f*(u*u/(-2*l)-c+l/2+i-a/2)))/f+r:(r+s)/2}function rightBreakPoint(e,t){var n=e.N;if(n)return leftBreakPoint(n,t);var r=e.site;return r[1]===t?r[0]:1/0}var st,ct,lt,ut,ft=1e-6,ht=1e-12;function triangleArea(e,t,n){return(e[0]-n[0])*(t[1]-e[1])-(e[0]-t[0])*(n[1]-e[1])}function lexicographic(e,t){return t[1]-e[1]||t[0]-e[0]}function Diagram(e,t){var n,r,i,a=e.sort(lexicographic).pop();for(ut=[],ct=new Array(e.length),st=new rt,lt=new rt;;)if(i=it,a&&(!i||a[1]<i.y||a[1]===i.y&&a[0]<i.x))a[0]===n&&a[1]===r||(addBeach(a),n=a[0],r=a[1]),a=e.pop();else{if(!i)break;removeBeach(i.arc)}if(function sortCellHalfedges(){for(var e,t,n,r,i=0,a=ct.length;i<a;++i)if((e=ct[i])&&(r=(t=e.halfedges).length)){var o=new Array(r),s=new Array(r);for(n=0;n<r;++n)o[n]=n,s[n]=cellHalfedgeAngle(e,ut[t[n]]);for(o.sort(function(e,t){return s[t]-s[e]}),n=0;n<r;++n)s[n]=t[o[n]];for(n=0;n<r;++n)t[n]=s[n]}}(),t){var o=+t[0][0],s=+t[0][1],c=+t[1][0],l=+t[1][1];!function clipEdges(e,t,n,r){for(var i,a=ut.length;a--;)connectEdge(i=ut[a],e,t,n,r)&&clipEdge(i,e,t,n,r)&&(Math.abs(i[0][0]-i[1][0])>ft||Math.abs(i[0][1]-i[1][1])>ft)||delete ut[a]}(o,s,c,l),function clipCells(e,t,n,r){var i,a,o,s,c,l,u,f,h,d,_,p,y=ct.length,g=!0;for(i=0;i<y;++i)if(a=ct[i]){for(o=a.site,s=(c=a.halfedges).length;s--;)ut[c[s]]||c.splice(s,1);for(s=0,l=c.length;s<l;)_=(d=cellHalfedgeEnd(a,ut[c[s]]))[0],p=d[1],f=(u=cellHalfedgeStart(a,ut[c[++s%l]]))[0],h=u[1],(Math.abs(_-f)>ft||Math.abs(p-h)>ft)&&(c.splice(s,0,ut.push(createBorderEdge(o,d,Math.abs(_-e)<ft&&r-p>ft?[e,Math.abs(f-e)<ft?h:r]:Math.abs(p-r)<ft&&n-_>ft?[Math.abs(h-r)<ft?f:n,r]:Math.abs(_-n)<ft&&p-t>ft?[n,Math.abs(f-n)<ft?h:t]:Math.abs(p-t)<ft&&_-e>ft?[Math.abs(h-t)<ft?f:e,t]:null))-1),++l);l&&(g=!1)}if(g){var m,v,b,x=1/0;for(i=0,g=null;i<y;++i)(a=ct[i])&&(b=(m=(o=a.site)[0]-e)*m+(v=o[1]-t)*v)<x&&(x=b,g=a);if(g){var w=[e,t],C=[e,r],k=[n,r],S=[n,t];g.halfedges.push(ut.push(createBorderEdge(o=g.site,w,C))-1,ut.push(createBorderEdge(o,C,k))-1,ut.push(createBorderEdge(o,k,S))-1,ut.push(createBorderEdge(o,S,w))-1)}}for(i=0;i<y;++i)(a=ct[i])&&(a.halfedges.length||delete ct[i])}(o,s,c,l)}this.edges=ut,this.cells=ct,st=lt=ut=ct=null}Diagram.prototype={constructor:Diagram,polygons:function polygons(){var e=this.edges;return this.cells.map(function(t){var n=t.halfedges.map(function(n){return cellHalfedgeStart(t,e[n])});return n.data=t.site.data,n})},triangles:function triangles(){var triangles=[],e=this.edges;return this.cells.forEach(function(t,n){if(i=(r=t.halfedges).length)for(var r,i,a,o=t.site,s=-1,c=e[r[i-1]],l=c.left===o?c.right:c.left;++s<i;)a=l,l=(c=e[r[s]]).left===o?c.right:c.left,a&&l&&n<a.index&&n<l.index&&triangleArea(o,a,l)<0&&triangles.push([o.data,a.data,l.data])}),triangles},links:function links(){return this.edges.filter(function(e){return e.right}).map(function(e){return{source:e.left.data,target:e.right.data}})},find:function find(e,t,n){for(var r,i,a=this,o=a._found||0,s=a.cells.length;!(i=a.cells[o]);)if(++o>=s)return null;var c=e-i.site[0],l=t-i.site[1],u=c*c+l*l;do{i=a.cells[r=o],o=null,i.halfedges.forEach(function(n){var r=a.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var c=e-s[0],l=t-s[1],f=c*c+l*l;f<u&&(u=f,o=s.index)}})}while(null!==o);return a._found=r,null==n||u<=n*n?i.site:null}};var dt=function(){var e=src_point_x,t=src_point_y,n=null;function voronoi(r){return new Diagram(r.map(function(n,i){var a=[Math.round(e(n,i,r)/ft)*ft,Math.round(t(n,i,r)/ft)*ft];return a.index=i,a.data=n,a}),n)}return voronoi.polygons=function(e){return voronoi(e).polygons()},voronoi.links=function(e){return voronoi(e).links()},voronoi.triangles=function(e){return voronoi(e).triangles()},voronoi.x=function(t){return arguments.length?(e="function"==typeof t?t:nt(+t),voronoi):e},voronoi.y=function(e){return arguments.length?(t="function"==typeof e?e:nt(+e),voronoi):t},voronoi.extent=function(e){return arguments.length?(n=null==e?null:[[+e[0][0],+e[0][1]],[+e[1][0],+e[1][1]]],voronoi):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},voronoi.size=function(e){return arguments.length?(n=null==e?null:[[0,0],[+e[0],+e[1]]],voronoi):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},voronoi},_t=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var pt=function makeEntry(e,t){e.forEach(function(e){void 0!==e&&null!==e&&(t[e]=1)})},yt=function(){function ForeignSet(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ForeignSet),this._set={},pt(e,this._set)}return _t(ForeignSet,[{key:"append",value:function append(e){return pt(e,this._set),this}},{key:"toArray",value:function toArray(){return Object.keys(this._set)}}],[{key:"difference",value:function difference(e,t){var n=void 0,r=[],i=e._set,a=t._set;for(n in i)({}).hasOwnProperty.call(i,n)&&(n in a||r.push(n));return new ForeignSet(r)}}]),ForeignSet}(),gt=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var vt=function isSimpleObject(e){if("object"===(void 0===e?"undefined":mt(e))){if(null===e)return!1;if("[object Object]"===Object.prototype.toString.call(e))return"Object"===(e.constructor.toString().match(/^function (.*)\(\)/m)||[])[1]}return!1},bt="undefined"==typeof window?{}:window,xt=bt.requestAnimationFrame||bt.webkitRequestAnimationFrame||bt.mozRequestAnimationFrame||bt.oRequestAnimationFrame||bt.msRequestAnimationFrame||function(e){setTimeout(e,16)},wt=function getTimeBasedId(){return getTimeBasedId.__lastTime===(new Date).getTime()?getTimeBasedId.__lastTime.toString()+(getTimeBasedId.__id++).toString():(getTimeBasedId.__id=0,(getTimeBasedId.__lastTime=(new Date).getTime()).toString()+(getTimeBasedId.__id++).toString())},Ct=function flat(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=[];return t.forEach(function(e){return r.push.apply(r,_toConsumableArray(e))}),r},kt=function scheduler(e){var t=[],n=null;return e=e&&"function"==typeof e&&e||function(){},function(r){[].push.apply(t,r),null===n&&(n=xt(function(){(function unique(e){return e.reduce(function(e,t){return t.__id in e.map?e:(e.map[t.__id]=1,e.unique.push(t),e)},{map:{},unique:[]}).unique})(t).forEach(function(e){return e()}),e(),n=null,t.length=0}))}},St=function fetch(e){return function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.map(function(t){var n=e[t];return{name:n.name,qualifiedName:n.qualifiedName,value:n.seed}})}},Mt=function fetchAggregator(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{dependencies:t.slice(0,t.length-1),fn:t[t.length-1]}},Pt=function getUpstreamNodes(e){var t=[],n={};return e.forEach(function(e){return n[e.qualifiedName]=-1}),function rec(e){e.forEach(function(e){var r,i=void 0,a=void 0,o=void 0;(r=e.qualifiedName)in n?-1!==(i=n[r])&&i!==t.length-1&&(a=t.slice(0,i),o=t.slice(i+1),t=a.concat(o),o.forEach(function(e,t){return n[e.qualifiedName]=t+a.length}),n[r]=t.push(e)-1):n[r]=t.push(e)-1,rec(e.outgoingEdges)})}(e),t},Et={accumulate:function accumulate(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r={};return t.forEach(function(e){Object.assign(r,function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},e.name,e.value))}),r},identity:function identity(e){return e.value}};var Tt=function(){function CustomResolver(e){!function utils_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CustomResolver),this.fn=e,this.dep=[]}return gt(CustomResolver,[{key:"addDependencies",value:function addDependencies(){var e;return(e=this.dep).push.apply(e,arguments),this}},{key:"getDependencies",value:function getDependencies(){return this.dep}},{key:"get",value:function get(){return this.fn}}]),CustomResolver}(),At=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function graph_node_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Ot=function(){function GraphNode(e,t,n){!function graph_node_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GraphNode),n=n||{},this.name=e,this.qualifiedName=t,this.edges=[],this.outgoingEdges=[],this._seed=null,this.requireResolve=!0,this.retriever=n.retriever,this.history=[],this.resolver=null,this.electricEdges=[]}return At(GraphNode,[{key:"addDependencies",value:function addDependencies(){for(var e,t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return(e=this.edges).push.apply(e,r),r.forEach(function(e){return e.outgoingEdges.push(t)}),this}},{key:"addElectricNode",value:function addElectricNode(e){return this.electricEdges.push(e),this}},{key:"resolve",value:function resolve(){return this.seed=this.resolver.apply(this,graph_node_toConsumableArray(this.retrieveDetails())),this.history.push(this.seed),this.requireResolve=!1,this}},{key:"retrieveDetails",value:function retrieveDetails(){return 0===this.edges.length?[{name:this.name,qualifiedName:this.qualifiedName,value:this.seed}]:this.retriever.apply(this,graph_node_toConsumableArray(this.edges.map(function(e){return e.qualifiedName})))}},{key:"repeatHead",value:function repeatHead(){var e=this.history,t=e[e.length-1];return 0===e.length?this:(e.push(t),this)}},{key:"flush",value:function flush(){var e=this.history,t=e[e.length-1];return e.length=0,e.push(t),this}},{key:"isRoot",value:function isRoot(){return null===this.name}},{key:"seed",get:function get(){return this._seed},set:function set(e){return this._seed=e,this.requireResolve=!0,this}}]),GraphNode}(),Nt=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Rt=function(){function ElectricNode(){!function electric_node_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ElectricNode),this.edges=[],this.listeners={nextFrame:[],currentFrame:[]}}return Nt(ElectricNode,[{key:"addEdges",value:function addEdges(){var e;return(e=this.edges).push.apply(e,arguments),this}},{key:"regListenerForCurrFrame",value:function regListenerForCurrFrame(e){var t=this,n=this.listeners.currentFrame,r=n.push(function pullableRecent(e,t){var n=function nFn(){t.apply(void 0,_toConsumableArray(e.map(function(e){var t=e.history,n=t.length-1;return[t[n-1<0?0:n-1],t[n]]})))};return n.__id=wt(),n}(this.edges,e))-1;return function(){t.listeners.currentFrame=n.filter(function(e,t){return t!==r})}}},{key:"regListenerForNextFrame",value:function regListenerForNextFrame(e){var t=this,n=this.listeners.nextFrame,r=n.push(function pullableEnd(e,t){var n=function nFn(){t.apply(void 0,_toConsumableArray(e.map(function(e){var t=e.history;return[t[0],t[t.length-1]]})))};return n.__id=wt(),n}(this.edges,e))-1;return function(){t.listeners.nextFrame=n.filter(function(e,t){return t!==r})}}},{key:"hasNextFrameListener",value:function hasNextFrameListener(){return!!this.listeners.nextFrame.length}}]),ElectricNode}(),Ft=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function graph_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Dt=function(){function Graph(){var e=this;!function graph_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Graph),this.qualifiedNodeMap={},this.retriever=St(this.qualifiedNodeMap),this.root=new Ot(null,null,{retriever:this.retriever}),this.root.resolver=Et.accumulate,this._wholeSet=null,this._propagate=!0,this.propagationOverride={currentFrameListeners:!1,nextFrameListeners:!1},this._schedule=kt(function(){var t=void 0;for(t in e.qualifiedNodeMap){if(!{}.hasOwnProperty.call(e.qualifiedNodeMap,t))return;e.qualifiedNodeMap[t].flush()}})}return Ft(Graph,[{key:"createNodesFrom",value:function createNodesFrom(e,t){var n=void 0,r=void 0,i=this.qualifiedNodeMap,a=this.root,o=this.retriever;return function rec(e,t,r){var s=void 0,c=void 0,l=void 0,u=void 0;for(s in e)if({}.hasOwnProperty.call(e,s))if(u=new Ot(s,c=""+t+s,{retriever:o}),i[c]=u,void 0!==(l=r.perv)?l.addDependencies(u):a.addDependencies(u),vt(n=e[s]))rec(n,""+t+s+".",{perv:u}),u.resolver=Et.accumulate;else if(n instanceof Tt){var f;u.resolver=n.get(),(f=u).addDependencies.apply(f,graph_toConsumableArray(n.getDependencies().map(function(e){return i[e]})))}else u.resolver=Et.identity,u.seed=n}(e,null===t?"":t+".",{perv:i[t]}),this._wholeSet=new yt(Object.keys(this.qualifiedNodeMap)),(r=this.constructor.getResolvedList(a).concat(a).filter(function(e){return e.requireResolve})).forEach(function(e){return e.resolve()}),Pt(r).forEach(function(e){return e.resolve()}),this}},{key:"getNodeValue",value:function getNodeValue(e){if(e in this.qualifiedNodeMap)return this.qualifiedNodeMap[e].seed}},{key:"createElectricNodeOf",value:function createElectricNodeOf(e,t){var n,r=this,i=e.map(function(e){return r.qualifiedNodeMap[e]}),a=(n=new Rt).addEdges.apply(n,graph_toConsumableArray(i));return i.forEach(function(e){return e.addElectricNode(a)}),a["regListenerFor"+t.type](t.fn)}},{key:"update",value:function update(){for(var e=void 0,t=void 0,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=[],o=r.map(function(e){return e[0].seed=e[1],e[0]});return o.forEach(function(e){return e.resolve()}),a.push.apply(a,graph_toConsumableArray(Ct.apply(void 0,graph_toConsumableArray(o.map(function(e){return e.electricEdges}))))),e=new yt(o.map(function(e){return e.qualifiedName})),this._propagate?((t=Pt(o)).forEach(function(e){return e.resolve()}),e.append(t.map(function(e){return e.qualifiedName})),a.push.apply(a,graph_toConsumableArray(Ct.apply(void 0,graph_toConsumableArray(t.map(function(e){return e.electricEdges}))))),this.__execUniqueElectricEdges(Array.from(new Set(a)),e),this):(this.__execUniqueElectricEdges(a),this._propagate=!0,this)}},{key:"__execUniqueElectricEdges",value:function __execUniqueElectricEdges(e,t){var n=this,r=[],i=[];t&&yt.difference(this._wholeSet,t).toArray().forEach(function(e){return n.qualifiedNodeMap[e].repeatHead()});return e.forEach(function(e){r.push.apply(r,graph_toConsumableArray(e.listeners.currentFrame))}),e.forEach(function(e){i.push.apply(i,graph_toConsumableArray(e.listeners.nextFrame))}),!this.propagationOverride.currentFrameListeners&&r.forEach(function(e){return e()}),!this.propagationOverride.nextFrameListeners&&this._schedule(i),this.resetPropagationOverride(),this}},{key:"resetNodeValue",value:function resetNodeValue(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.map(function(t){return e.qualifiedNodeMap[t]}).map(function(e){return[e,e.seed]});return this.update.apply(this,graph_toConsumableArray(i)),this}},{key:"stopPropagation",value:function stopPropagation(){return this._propagate=!1,this}},{key:"resetPropagationOverride",value:function resetPropagationOverride(){return this.propagationOverride.currentFrameListeners=!1,this.propagationOverride.nextFrameListeners=!1,this}},{key:"setPropagationOverride",value:function setPropagationOverride(e){return this.propagationOverride[e+"Listeners"]=!0,this}},{key:"getNodeFromQualifiedName",value:function getNodeFromQualifiedName(e){return this.qualifiedNodeMap[e]}}],[{key:"getResolvedList",value:function getResolvedList(e){var t=[];return function resolveDependencyOrder(e,t,n){var r=void 0;e.edges.forEach(function(e){resolveDependencyOrder(e,t,n)}),e.isRoot()||(r=e.qualifiedName)in n||(t.push(e),n[r]=1)}(e,t,{}),t}}]),Graph}(),Lt=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function model_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var It=function(){function Model(){!function model_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Model),this._graph=new Dt,this._lockFlag=!1,this._reqQ=[]}return Lt(Model,[{key:"append",value:function append(){var e=void 0,t=void 0;return 1===arguments.length?(e=null,t=arguments.length<=0?void 0:arguments[0]):(e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1]),this._addPropInModel(e,t),this}},{key:"calculatedProp",value:function calculatedProp(){var e,t,n,r=void 0,i=void 0,a=void 0;return arguments.length>2?(i=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1],a=arguments.length<=2?void 0:arguments[2]):(i=null,r=arguments.length<=0?void 0:arguments[0],a=arguments.length<=1?void 0:arguments[1]),t=a(Mt),(e=n=new Tt(t.fn)).addDependencies.apply(e,model_toConsumableArray(t.dependencies)),this._addPropInModel(i,function model_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,n)),this}},{key:"_addPropInModel",value:function _addPropInModel(e,t){return this._graph.createNodesFrom(t,e),this}},{key:"on",value:function on(e,t,n){var r,i=e instanceof Array?e:[e],a=this._graph.createElectricNodeOf(i,{type:"CurrFrame",fn:t});n&&(r=this._graph.stopPropagation().setPropagationOverride("nextFrame")).resetNodeValue.apply(r,model_toConsumableArray(e));return a}},{key:"next",value:function next(e,t,n){var r,i=e instanceof Array?e:[e],a=this._graph.createElectricNodeOf(i,{type:"NextFrame",fn:t});n&&(r=this._graph.stopPropagation().setPropagationOverride("currentFrame")).resetNodeValue.apply(r,model_toConsumableArray(e));return a}},{key:"lock",value:function lock(){return this._lockFlag=!0,this._reqQ.length=0,this}},{key:"unlock",value:function unlock(){return this._lockFlag=!1,this.setProp.apply(this,model_toConsumableArray(this._reqQ)),this._reqQ.length=0,this}},{key:"prop",value:function prop(){var e,prop=void 0,t=void 0;switch(e=arguments.length){case 1:prop=arguments.length<=0?void 0:arguments[0];break;case 2:prop=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1];break;default:return this}return 2===e?(this._lockFlag?this._reqQ.push([prop,t]):this.setProp([prop,t]),this):this._graph.getNodeValue(prop)}},{key:"setProp",value:function setProp(){for(var e,t=this,n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];return 0===r.length?this:((e=this._graph).update.apply(e,model_toConsumableArray(r.map(function(e){return[t._graph.getNodeFromQualifiedName(e[0]),e[1]]}))),this)}},{key:"graph",value:function graph(){return this._graph}},{key:"serialize",value:function serialize(){return this._graph.root.seed}}],[{key:"create",value:function create(e){return(new Model)._addPropInModel(null,e)}}]),Model}(),jt=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),zt=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),Bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function common_utils_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function common_utils_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}window.HTMLElement,window.document;var Ht=function getUniqueId(){return"id-"+(new Date).getTime()+Math.round(1e4*Math.random())},Ut=function typeObj(e,t){if("object"!==(void 0===t?"undefined":Bt(t)))return Error("Argument type object expected");var n=function checkExistence(e,t){var n=[];return e.forEach(function(e){e in t||n.push(e)}),n}(e,t);return n.length?Error("Missing keys from parameter "+n.join(", ")):t},Vt=function getMax(e,t){return Math.max.apply(Math,common_utils_toConsumableArray(e.filter(function(e){return!isNaN(e[t])}).map(function(e){return e[t]})))},qt=function getMin(e,t){return Math.min.apply(Math,common_utils_toConsumableArray(e.filter(function(e){return!isNaN(e[t])}).map(function(e){return e[t]})))},Wt=function getDomainFromData(e,t,n){var r,i=void 0,a=void 0;switch(e=e[0]instanceof Array?e:[e],n){case v.CATEGORICAL:i=(r=[]).concat.apply(r,common_utils_toConsumableArray(e.map(function(e){return e.map(function(e){return e[t[0]]}).filter(function(e){return void 0!==e})})));break;default:a=e.map(function(e){var n=qt(e,t[0]),r=qt(e,t[1]),i=Vt(e,t[0]),a=Vt(e,t[1]);return[Math.min(n,r),Math.max(i,a)]}),i=[Math.min.apply(Math,common_utils_toConsumableArray(a.map(function(e){return e[0]}))),Math.max.apply(Math,common_utils_toConsumableArray(a.map(function(e){return e[1]})))]}return i},Gt={circle:O,cross:N,diamond:D,square:B,star:z,wye:G,triangle:U},Yt={cubic:cubicInOut,bounce:bounceOut,linear:function linear_linear(e){return+e},elastic:tt,back:Qe,poly:Ue,circle:function circleInOut(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}},Xt=function getClosestIndexOf(e,t,n){for(var r,i=0,a=e.length-1,o=void 0,s=void 0;i<a;)o=Math.floor((i+a)/2),s=Math.abs(e[o]-t),Math.abs(e[o+1]-t)<=s?i=o+1:a=o;return n?(r=e[a])===t?a:r>t?0===a?a:"left"===n?a-1:a:a===e.length-1?a:"left"===n?a:a+1:a},$t=(requestAnimationFrame,cancelAnimationFrame,function capitalizeFirst(e){return(e=e.toLowerCase()).replace(/\w\S*/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1)})}),Zt=function unique(e){return[].concat(common_utils_toConsumableArray(new Set(e)))},Kt=function getMinDiff(e,t){var n=void 0,r=void 0;if((r=Zt(void 0!==t?e.map(function(e){return e[t]}):e)).length>1){n=Math.abs(r[1]-r[0]);for(var i=2,a=r.length;i<a;i++)n=Math.min(n,Math.abs(r[i]-r[i-1]))}else n=r[0];return n},Jt=function getQualifiedClassName(e,t,n){return[n+"-"+(e=e.replace(/^\.*/,"")),n+"-"+e+"-"+t]},Qt=function defaultValue(e,t){return void 0===e||"object"===(void 0===e?"undefined":Bt(e))&&!e?t:e},en=function objectIterator(e,t){for(var n in e)Object.hasOwnProperty.call(e,n)&&t(n,e)},tn=function(){function Voronoi(e){common_utils_classCallCheck(this,Voronoi),this._voronoi=dt().x(function(e){return e.x}).y(function(e){return e.y}),this.data(e)}return zt(Voronoi,[{key:"data",value:function data(e){return e&&(this._voronoiFn=this._voronoi(e)),this}},{key:"find",value:function find(e,t,n){return this._voronoiFn.find(e,t,n)}}]),Voronoi}(),nn=function(){function Store(e){common_utils_classCallCheck(this,Store),this.model=It.create(e),this._listeners=[]}return zt(Store,[{key:"serialize",value:function serialize(){return this.model.serialize()}},{key:"commit",value:function commit(e,t){this.model.prop(e,t)}},{key:"registerChangeListener",value:function registerChangeListener(e,t,n){var r=e;Array.isArray(e)||(r=[e]);var i=this.model.next(r,t,n);return this._listeners.push(i),this}},{key:"registerImmediateListener",value:function registerImmediateListener(e,t,n){var r=e;Array.isArray(e)||(r=[e]);var i=this.model.on(r,t,n);return this._listeners.push(i),this}},{key:"get",value:function get(e){return this.model.prop(e)}},{key:"computed",value:function computed(e,t){return this.model.calculatedProp(e,t)}},{key:"unsubscribeAll",value:function unsubscribeAll(){this._listeners.forEach(function(e){return e()})}}]),Store}(),rn=function intSanitizer(e){var t=e.toString().match(/(\d+)(px)*/g);return t?parseInt(t[0],10):null},an=function transactor(e,t,n){var r=void 0,i=n&&n instanceof It?n:It.create({}),a=function _loop(n){({}).hasOwnProperty.call(t,n)&&(r=t[n],i.prop(n)||i.append(function common_utils_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,r.value)),e[n]=function(t,r,a){return function(){for(var o=arguments.length,s=Array(o),c=0;c<o;c++)s[c]=arguments[c];var l=void 0,u=void 0,f=s.length,h=i.prop(n);if(f){var d=a&&a.spreadParams;l=s;var _=[];if(a){for(var p=0;p<f;p++){l=s[p];var y=a.sanitization&&(d?a.sanitization[p]:a.sanitization),g=a.typeCheck&&(d?a.typeCheck[p]:a.typeCheck);if(y&&"function"==typeof y&&(l=y(l,h,e)),g)if("function"==typeof g){var m=a.typeExpected;m&&d&&(m=m[p]),u=m||!0,g(l)===u&&_.push(l)}else if("string"==typeof g){if("constructor"===g){var v=d?a.typeExpected[p]:a.typeExpected;l&&l.constructor.name===v&&_.push(l)}}else _.push(l);else _.push(l)}var b=a.preset,x=t.prop(r);b&&b(_[0],e),d&&x.forEach(function(e,t){void 0===_[t]&&(_[t]=e)}),_.length&&t.prop(r,d?_:_[0])}else t.prop(r,d?l:l[0]);return e}return t.prop(r)}}(i,n,r.meta))};for(var o in t)a(o);return[e,i]},sn=function generateGetterSetters(e,t){Object.entries(t).forEach(function(t){var n=t[0],r=t[1].typeChecker,i=t[1].sanitization;e[n]=function(){if(arguments.length){var t=arguments.length<=0?void 0:arguments[0];return i&&(t=i(e,arguments.length<=0?void 0:arguments[0])),r&&!r(t)?e["_"+n]:(e["_"+n]=t,e)}return e["_"+n]}})},cn=function isEqual(e){return function(t,n){return"Array"===e?!!t&&function arraysEqual(e,t){if(e.length!==t.length)return!1;for(var n=e.length;n--;)if(e[n]!==t[n])return!1;return!0}(t,n):"Object"===e?Object.is(t,n):t===n}},ln={INTERFACE_IMPL:"Method not implemented"},un=function isSimpleObject(e){if("object"===(void 0===e?"undefined":Bt(e))){if(null===e)return!1;if("[object Object]"===Object.prototype.toString.call(e))return"Object"===(e.constructor.toString().match(/^function (.*)\(\)/m)||[])[1]}return!1},hn=function mergeRecursive(e,t){for(var n in t)un(e[n])&&un(t[n])?mergeRecursive(e[n],t[n]):t[n]instanceof Object&&t[n].constructor===Object?(e[n]={},mergeRecursive(e[n],t[n])):e[n]=t[n];return e},dn=function numberInterpolator(){return Me},_n=function piecewiseInterpolator(){return piecewise_piecewise},pn=function rgbToHsv(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;e=+e,t=+t,n=+n,r=+r,e/=255,t/=255,n/=255;var i=Math.max(e,t,n),a=Math.min(e,t,n),o=void 0,s=void 0,c=(i+a)/2;if(i===a)o=s=0;else{var l=i-a;switch(s=c>.5?l/(2-i-a):l/(i+a),i){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4}o/=6}return[o,s,c,r]},yn=function detectColor(e){return/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/.test(e)||/rgba?\(((25[0-5]|2[0-4]\d|1\d{1,2}|\d\d?)\s*,\s*?){2}(25[0-5]|2[0-4]\d|1\d{1,2}|\d\d?)\s*,?\s*([01]\.?\d*?)?\)/.test(e)?"rgb":/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(e)||/^hsla\((0|360|35\d|3[0-4]\d|[12]\d\d|0?\d?\d),(0|100|\d{1,2})%,(0|100|\d{1,2})%,(0?\.\d|1(\.0)?)\)$/.test(e)?"hsl":/^#([0-9a-f]{3}){1,2}$/i.test(e)?"hex":e},gn=function getDataModelFromRange(e,t,n){if(null===t)return null;var r=Object.keys(t);return e.select(function selFn(e){return r.every(function(n){var r=e[n].value,i=void 0;return"string"==typeof(i=t[n][0]instanceof Array?t[n][0]:t[n])[0]?void 0!==i.find(function(e){return e===r}):!i||r>=i[0]&&r<=i[1]})},{saveChild:!1,mode:n})},mn=function getDataModelFromIdentifiers(e,t,n){var r=void 0;if(t instanceof Array){var i=e.getFieldsConfig(),a=w.ROW_ID,o=t.slice(1,t.length);if(t instanceof Function)r=t(e,{},!1);else if(t instanceof Array&&t[0].length){var s=t[0].filter(function(e){return e in i||e===a});r=e.select(function(e,t){var n=!0;return s.forEach(function(r,i){var s=void 0;s=r===a?t:e[r].valueOf();var c=o.findIndex(function(e){return e[i]===s});n=n&&-1!==c}),n},{saveChild:!1,mode:n})}}else r=gn(e,t,n);return r},vn=function registerListeners(e,t){var n=t(e);for(var r in n)if({}.hasOwnProperty.call(n,r)){var i=n[r],a=i.type,o=i.props,s=i.listener;e.store()[a](o,s)}},bn=function getObjProp(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(void 0===e||null===e)return e;for(var i=e,a=0,o=n.length;a<o&&(void 0!==(i=i[n[a]])&&null!==i);a++);return i},xn=function toArray(e){return e instanceof Array?e:[e]},wn="http://www.w3.org/1999/xhtml",Cn={svg:"http://www.w3.org/2000/svg",xhtml:wn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},kn=function(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),Cn.hasOwnProperty(t)?{space:Cn[t],local:e}:e};var Sn=function(e){var t=kn(e);return(t.local?function creatorFixed(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}:function creatorInherit(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===wn&&t.documentElement.namespaceURI===wn?t.createElement(e):t.createElementNS(n,e)}})(t)};function selector_none(){}var Mn=function(e){return null==e?selector_none:function(){return this.querySelector(e)}};function selectorAll_empty(){return[]}var Pn=function(e){return null==e?selectorAll_empty:function(){return this.querySelectorAll(e)}},En=function matcher(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var Tn=document.documentElement;if(!Tn.matches){var An=Tn.webkitMatchesSelector||Tn.msMatchesSelector||Tn.mozMatchesSelector||Tn.oMatchesSelector;En=function matcher(e){return function(){return An.call(this,e)}}}}var On=En,Nn=function(e){return new Array(e.length)};function EnterNode(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}EnterNode.prototype={constructor:EnterNode,appendChild:function appendChild(e){return this._parent.insertBefore(e,this._next)},insertBefore:function insertBefore(e,t){return this._parent.insertBefore(e,t)},querySelector:function querySelector(e){return this._parent.querySelector(e)},querySelectorAll:function querySelectorAll(e){return this._parent.querySelectorAll(e)}};var Rn="$";function bindIndex(e,t,n,r,i,a){for(var o,s=0,c=t.length,l=a.length;s<l;++s)(o=t[s])?(o.__data__=a[s],r[s]=o):n[s]=new EnterNode(e,a[s]);for(;s<c;++s)(o=t[s])&&(i[s]=o)}function bindKey(e,t,n,r,i,a,o){var s,c,l,u={},f=t.length,h=a.length,d=new Array(f);for(s=0;s<f;++s)(c=t[s])&&(d[s]=l=Rn+o.call(c,c.__data__,s,t),l in u?i[s]=c:u[l]=c);for(s=0;s<h;++s)(c=u[l=Rn+o.call(e,a[s],s,a)])?(r[s]=c,c.__data__=a[s],u[l]=null):n[s]=new EnterNode(e,a[s]);for(s=0;s<f;++s)(c=t[s])&&u[d[s]]===c&&(i[s]=c)}function sort_ascending(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}var Fn=function(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView};function styleValue(e,t){return e.style.getPropertyValue(t)||Fn(e).getComputedStyle(e,null).getPropertyValue(t)}function classArray(e){return e.trim().split(/^|\s+/)}function classList(e){return e.classList||new ClassList(e)}function ClassList(e){this._node=e,this._names=classArray(e.getAttribute("class")||"")}function classedAdd(e,t){for(var n=classList(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function classedRemove(e,t){for(var n=classList(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}ClassList.prototype={add:function add(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function remove(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function contains(e){return this._names.indexOf(e)>=0}};function textRemove(){this.textContent=""}function htmlRemove(){this.innerHTML=""}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function constantNull(){return null}function remove_remove(){var e=this.parentNode;e&&e.removeChild(this)}function selection_cloneShallow(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function selection_cloneDeep(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}var Dn={},Ln=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(Dn={mouseenter:"mouseover",mouseleave:"mouseout"}));function filterContextListener(e,t,n){return e=contextListener(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function contextListener(e,t,n){return function(r){var i=Ln;Ln=r;try{e.call(this,this.__data__,t,n)}finally{Ln=i}}}function onRemove(e){return function(){var t=this.__on;if(t){for(var n,r=0,i=-1,a=t.length;r<a;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?t.length=i:delete this.__on}}}function onAdd(e,t,n){var r=Dn.hasOwnProperty(e.type)?filterContextListener:contextListener;return function(i,a,o){var s,c=this.__on,l=r(t,a,o);if(c)for(var u=0,f=c.length;u<f;++u)if((s=c[u]).type===e.type&&s.name===e.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=t);this.addEventListener(e.type,l,n),s={type:e.type,name:e.name,value:t,listener:l,capture:n},c?c.push(s):this.__on=[s]}}function customEvent(e,t,n,r){var i=Ln;e.sourceEvent=Ln,Ln=e;try{return t.apply(n,r)}finally{Ln=i}}function dispatchEvent(e,t,n){var r=Fn(e),i=r.CustomEvent;"function"==typeof i?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}var In=[null];function Selection(e,t){this._groups=e,this._parents=t}function selection_selection(){return new Selection([[document.documentElement]],In)}Selection.prototype=selection_selection.prototype={constructor:Selection,select:function(e){"function"!=typeof e&&(e=Mn(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=t[i],c=s.length,l=r[i]=new Array(c),u=0;u<c;++u)(a=s[u])&&(o=e.call(a,a.__data__,u,s))&&("__data__"in a&&(o.__data__=a.__data__),l[u]=o);return new Selection(r,this._parents)},selectAll:function(e){"function"!=typeof e&&(e=Pn(e));for(var t=this._groups,n=t.length,r=[],i=[],a=0;a<n;++a)for(var o,s=t[a],c=s.length,l=0;l<c;++l)(o=s[l])&&(r.push(e.call(o,o.__data__,l,s)),i.push(o));return new Selection(r,i)},filter:function(e){"function"!=typeof e&&(e=On(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,c=r[i]=[],l=0;l<s;++l)(a=o[l])&&e.call(a,a.__data__,l,o)&&c.push(a);return new Selection(r,this._parents)},data:function(e,t){if(!e)return d=new Array(this.size()),l=-1,this.each(function(e){d[++l]=e}),d;var n=t?bindKey:bindIndex,r=this._parents,i=this._groups;"function"!=typeof e&&(e=function(e){return function(){return e}}(e));for(var a=i.length,o=new Array(a),s=new Array(a),c=new Array(a),l=0;l<a;++l){var u=r[l],f=i[l],h=f.length,d=e.call(u,u&&u.__data__,l,r),_=d.length,p=s[l]=new Array(_),y=o[l]=new Array(_);n(u,f,p,y,c[l]=new Array(h),d,t);for(var g,m,v=0,b=0;v<_;++v)if(g=p[v]){for(v>=b&&(b=v+1);!(m=y[b])&&++b<_;);g._next=m||null}}return(o=new Selection(o,r))._enter=s,o._exit=c,o},enter:function(){return new Selection(this._enter||this._groups.map(Nn),this._parents)},exit:function(){return new Selection(this._exit||this._groups.map(Nn),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,l=t[s],u=n[s],f=l.length,h=o[s]=new Array(f),d=0;d<f;++d)(c=l[d]||u[d])&&(h[d]=c);for(;s<r;++s)o[s]=t[s];return new Selection(o,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,i=e[t],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function compareNode(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=sort_ascending);for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i){for(var a,o=t[i],s=o.length,c=r[i]=new Array(s),l=0;l<s;++l)(a=o[l])&&(c[l]=a);c.sort(compareNode)}return new Selection(r,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each(function(){e[++t]=this}),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var e=0;return this.each(function(){++e}),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i,a=t[n],o=0,s=a.length;o<s;++o)(i=a[o])&&e.call(i,i.__data__,o,a);return this},attr:function(e,t){var n=kn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?function attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function attrRemove(e){return function(){this.removeAttribute(e)}}:"function"==typeof t?n.local?function attrFunctionNS(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}:function attrFunction(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}:n.local?function attrConstantNS(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}:function attrConstant(e,t){return function(){this.setAttribute(e,t)}})(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?function styleRemove(e){return function(){this.style.removeProperty(e)}}:"function"==typeof t?function styleFunction(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}:function styleConstant(e,t,n){return function(){this.style.setProperty(e,t,n)}})(e,t,null==n?"":n)):styleValue(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?function propertyRemove(e){return function(){delete this[e]}}:"function"==typeof t?function propertyFunction(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}:function propertyConstant(e,t){return function(){this[e]=t}})(e,t)):this.node()[e]},classed:function(e,t){var n=classArray(e+"");if(arguments.length<2){for(var r=classList(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?function classedFunction(e,t){return function(){(t.apply(this,arguments)?classedAdd:classedRemove)(this,e)}}:t?function classedTrue(e){return function(){classedAdd(this,e)}}:function classedFalse(e){return function(){classedRemove(this,e)}})(n,t))},text:function(e){return arguments.length?this.each(null==e?textRemove:("function"==typeof e?function textFunction(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}:function textConstant(e){return function(){this.textContent=e}})(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?htmlRemove:("function"==typeof e?function htmlFunction(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}:function htmlConstant(e){return function(){this.innerHTML=e}})(e)):this.node().innerHTML},raise:function(){return this.each(raise)},lower:function(){return this.each(lower)},append:function(e){var t="function"==typeof e?e:Sn(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:Sn(e),r=null==t?constantNull:"function"==typeof t?t:Mn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(remove_remove)},clone:function(e){return this.select(e?selection_cloneDeep:selection_cloneShallow)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,i,a=function parseTypenames(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}(e+""),o=a.length;if(!(arguments.length<2)){for(s=t?onAdd:onRemove,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],t,n));return this}var s=this.node().__on;if(s)for(var c,l=0,u=s.length;l<u;++l)for(r=0,c=s[l];r<o;++r)if((i=a[r]).type===c.type&&i.name===c.name)return c.value},dispatch:function(e,t){return this.each(("function"==typeof t?function dispatchFunction(e,t){return function(){return dispatchEvent(this,e,t.apply(this,arguments))}}:function dispatchConstant(e,t){return function(){return dispatchEvent(this,e,t)}})(e,t))}};var jn=selection_selection,zn=function(e){return"string"==typeof e?new Selection([[document.querySelector(e)]],[document.documentElement]):new Selection([[e]],In)},Bn=0;function Local(){this._="@"+(++Bn).toString(36)}Local.prototype=function local(){return new Local}.prototype={constructor:Local,get:function get(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function set(e,t){return e[this._]=t},remove:function remove(e){return this._ in e&&delete e[this._]},toString:function toString(){return this._}};var Hn=function(){for(var e,t=Ln;e=t.sourceEvent;)t=e;return t},Un=function(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]},Vn=function(e){var t=Hn();return t.changedTouches&&(t=t.changedTouches[0]),Un(e,t)},qn=function(e,t,n){arguments.length<3&&(n=t,t=Hn().changedTouches);for(var r,i=0,a=t?t.length:0;i<a;++i)if((r=t[i]).identifier===n)return Un(e,r);return null},Wn={value:function value(){}};function dispatch_dispatch(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r)throw new Error("illegal type: "+e);r[e]=[]}return new Dispatch(r)}function Dispatch(e){this._=e}function dispatch_get(e,t){for(var n,r=0,i=e.length;r<i;++r)if((n=e[r]).name===t)return n.value}function dispatch_set(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Wn,e=e.slice(0,r).concat(e.slice(r+1));break}return null!=n&&e.push({name:t,value:n}),e}Dispatch.prototype=dispatch_dispatch.prototype={constructor:Dispatch,on:function on(e,t){var n,r=this._,i=function dispatch_parseTypenames(e,t){return e.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}(e+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++a<o;)if(n=(e=i[a]).type)r[n]=dispatch_set(r[n],e.name,t);else if(null==t)for(n in r)r[n]=dispatch_set(r[n],e.name,null);return this}for(;++a<o;)if((n=(e=i[a]).type)&&(n=dispatch_get(r[n],e.name)))return n},copy:function copy(){var copy={},e=this._;for(var t in e)copy[t]=e[t].slice();return new Dispatch(copy)},call:function call(e,t){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=0,n=(r=this._[e]).length;a<n;++a)r[a].value.apply(t,i)},apply:function apply(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,a=r.length;i<a;++i)r[i].value.apply(t,n)}};var Gn=dispatch_dispatch;function nopropagation(){Ln.stopImmediatePropagation()}var Yn=function(){Ln.preventDefault(),Ln.stopImmediatePropagation()},Xn=function(e){var t=e.document.documentElement,n=zn(e).on("dragstart.drag",Yn,!0);"onselectstart"in t?n.on("selectstart.drag",Yn,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")};function yesdrag(e,t){var n=e.document.documentElement,r=zn(e).on("dragstart.drag",null);t&&(r.on("click.drag",Yn,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var $n=function(e){return function(){return e}};function DragEvent(e,t,n,r,i,a,o,s,c,l){this.target=e,this.type=t,this.subject=n,this.identifier=r,this.active=i,this.x=a,this.y=o,this.dx=s,this.dy=c,this._=l}function defaultFilter(){return!Ln.button}function defaultContainer(){return this.parentNode}function defaultSubject(e){return null==e?{x:Ln.x,y:Ln.y}:e}function defaultTouchable(){return"ontouchstart"in this}DragEvent.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};var Zn,Kn,Jn=function(){var e,t,n,r,i=defaultFilter,a=defaultContainer,o=defaultSubject,s=defaultTouchable,c={},l=Gn("start","drag","end"),u=0,f=0;function drag(e){e.on("mousedown.drag",mousedowned).filter(s).on("touchstart.drag",touchstarted).on("touchmove.drag",touchmoved).on("touchend.drag touchcancel.drag",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function mousedowned(){if(!r&&i.apply(this,arguments)){var o=beforestart("mouse",a.apply(this,arguments),Vn,this,arguments);o&&(zn(Ln.view).on("mousemove.drag",mousemoved,!0).on("mouseup.drag",mouseupped,!0),Xn(Ln.view),nopropagation(),n=!1,e=Ln.clientX,t=Ln.clientY,o("start"))}}function mousemoved(){if(Yn(),!n){var r=Ln.clientX-e,i=Ln.clientY-t;n=r*r+i*i>f}c.mouse("drag")}function mouseupped(){zn(Ln.view).on("mousemove.drag mouseup.drag",null),yesdrag(Ln.view,n),Yn(),c.mouse("end")}function touchstarted(){if(i.apply(this,arguments)){var e,t,n=Ln.changedTouches,r=a.apply(this,arguments),o=n.length;for(e=0;e<o;++e)(t=beforestart(n[e].identifier,r,qn,this,arguments))&&(nopropagation(),t("start"))}}function touchmoved(){var e,t,n=Ln.changedTouches,r=n.length;for(e=0;e<r;++e)(t=c[n[e].identifier])&&(Yn(),t("drag"))}function touchended(){var e,t,n=Ln.changedTouches,i=n.length;for(r&&clearTimeout(r),r=setTimeout(function(){r=null},500),e=0;e<i;++e)(t=c[n[e].identifier])&&(nopropagation(),t("end"))}function beforestart(e,t,n,r,i){var a,s,f,h=n(t,e),d=l.copy();if(customEvent(new DragEvent(drag,"beforestart",a,e,u,h[0],h[1],0,0,d),function(){return null!=(Ln.subject=a=o.apply(r,i))&&(s=a.x-h[0]||0,f=a.y-h[1]||0,!0)}))return function gesture(o){var l,_=h;switch(o){case"start":c[e]=gesture,l=u++;break;case"end":delete c[e],--u;case"drag":h=n(t,e),l=u}customEvent(new DragEvent(drag,o,a,e,l,h[0]+s,h[1]+f,h[0]-_[0],h[1]-_[1],d),d.apply,d,[o,r,i])}}return drag.filter=function(e){return arguments.length?(i="function"==typeof e?e:$n(!!e),drag):i},drag.container=function(e){return arguments.length?(a="function"==typeof e?e:$n(e),drag):a},drag.subject=function(e){return arguments.length?(o="function"==typeof e?e:$n(e),drag):o},drag.touchable=function(e){return arguments.length?(s="function"==typeof e?e:$n(!!e),drag):s},drag.on=function(){var e=l.on.apply(l,arguments);return e===l?drag:e},drag.clickDistance=function(e){return arguments.length?(f=(e=+e)*e,drag):Math.sqrt(f)},drag},Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},er=0,tr=0,nr=0,rr=1e3,ir=0,ar=0,or=0,sr="object"===("undefined"==typeof performance?"undefined":Qn(performance))&&performance.now?performance:Date,cr="object"===("undefined"==typeof window?"undefined":Qn(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function now(){return ar||(cr(clearNow),ar=sr.now()+or)}function clearNow(){ar=0}function Timer(){this._call=this._time=this._next=null}function timer(e,t,n){var r=new Timer;return r.restart(e,t,n),r}function wake(){ar=(ir=sr.now())+or,er=tr=0;try{!function timerFlush(){now(),++er;for(var e,t=Zn;t;)(e=ar-t._time)>=0&&t._call.call(null,e),t=t._next;--er}()}finally{er=0,function nap(){var e,t,n=Zn,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:Zn=t);Kn=e,sleep(r)}(),ar=0}}function poke(){var e=sr.now(),t=e-ir;t>rr&&(or-=t,ir=e)}function sleep(e){er||(tr&&(tr=clearTimeout(tr)),e-ar>24?(e<1/0&&(tr=setTimeout(wake,e-sr.now()-or)),nr&&(nr=clearInterval(nr))):(nr||(ir=sr.now(),nr=setInterval(poke,rr)),er=1,cr(wake)))}Timer.prototype=timer.prototype={constructor:Timer,restart:function restart(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?now():+n)+(null==t?0:+t),this._next||Kn===this||(Kn?Kn._next=this:Zn=this,Kn=this),this._call=e,this._time=n,sleep()},stop:function stop(){this._call&&(this._call=null,this._time=1/0,sleep())}};var lr=function(e,t,n){var r=new Timer;return t=null==t?0:+t,r.restart(function(n){r.stop(),e(n+t)},t,n),r},ur=Gn("start","end","interrupt"),fr=[],hr=0,dr=1,_r=2,pr=3,yr=4,gr=5,mr=6,vr=function(e,t,n,r,i,a){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function schedule_create(e,t,n){var r,i=e.__transition;function start(a){var o,s,c,l;if(n.state!==dr)return stop();for(o in i)if((l=i[o]).name===n.name){if(l.state===pr)return lr(start);l.state===yr?(l.state=mr,l.timer.stop(),l.on.call("interrupt",e,e.__data__,l.index,l.group),delete i[o]):+o<t&&(l.state=mr,l.timer.stop(),delete i[o])}if(lr(function(){n.state===pr&&(n.state=yr,n.timer.restart(tick,n.delay,n.time),tick(a))}),n.state=_r,n.on.call("start",e,e.__data__,n.index,n.group),n.state===_r){for(n.state=pr,r=new Array(c=n.tween.length),o=0,s=-1;o<c;++o)(l=n.tween[o].value.call(e,e.__data__,n.index,n.group))&&(r[++s]=l);r.length=s+1}}function tick(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(stop),n.state=gr,1),a=-1,o=r.length;++a<o;)r[a].call(null,i);n.state===gr&&(n.on.call("end",e,e.__data__,n.index,n.group),stop())}function stop(){for(var r in n.state=mr,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=timer(function schedule(e){n.state=dr,n.timer.restart(start,n.delay,n.time),n.delay<=e&&start(e-n.delay)},0,n.time)}(e,n,{name:t,index:r,group:i,on:ur,tween:fr,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:hr})};function init(e,t){var n=schedule_get(e,t);if(n.state>hr)throw new Error("too late; already scheduled");return n}function schedule_set(e,t){var n=schedule_get(e,t);if(n.state>_r)throw new Error("too late; already started");return n}function schedule_get(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}var br=function(e,t){var n,r,i,a=e.__transition,o=!0;if(a){for(i in t=null==t?null:t+"",a)(n=a[i]).name===t?(r=n.state>_r&&n.state<gr,n.state=mr,n.timer.stop(),r&&n.on.call("interrupt",e,e.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete e.__transition}};function tweenValue(e,t,n){var r=e._id;return e.each(function(){var e=schedule_set(this,r);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return schedule_get(e,r).value[t]}}var xr=function(e,t){var n;return("number"==typeof t?Me:t instanceof color_color?Se:(n=color_color(t))?(t=n,Se):Fe)(e,t)};var wr=jn.prototype.constructor;var Cr=0;function Transition(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function newId(){return++Cr}var kr=jn.prototype;Transition.prototype=function src_transition_transition(e){return jn().transition(e)}.prototype={constructor:Transition,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Mn(e));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,c,l=r[o],u=l.length,f=a[o]=new Array(u),h=0;h<u;++h)(s=l[h])&&(c=e.call(s,s.__data__,h,l))&&("__data__"in s&&(c.__data__=s.__data__),f[h]=c,vr(f[h],t,n,h,f,schedule_get(s,n)));return new Transition(a,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=Pn(e));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var c,l=r[s],u=l.length,f=0;f<u;++f)if(c=l[f]){for(var h,d=e.call(c,c.__data__,f,l),_=schedule_get(c,n),p=0,y=d.length;p<y;++p)(h=d[p])&&vr(h,t,n,p,d,_);a.push(d),o.push(c)}return new Transition(a,o,t,n)},filter:function(e){"function"!=typeof e&&(e=On(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var a,o=t[i],s=o.length,c=r[i]=[],l=0;l<s;++l)(a=o[l])&&e.call(a,a.__data__,l,o)&&c.push(a);return new Transition(r,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var c,l=t[s],u=n[s],f=l.length,h=o[s]=new Array(f),d=0;d<f;++d)(c=l[d]||u[d])&&(h[d]=c);for(;s<r;++s)o[s]=t[s];return new Transition(o,this._parents,this._name,this._id)},selection:function(){return new wr(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=newId(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],c=s.length,l=0;l<c;++l)if(o=s[l]){var u=schedule_get(o,t);vr(o,e,n,l,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Transition(r,this._parents,e,n)},call:kr.call,nodes:kr.nodes,node:kr.node,size:kr.size,empty:kr.empty,each:kr.each,on:function(e,t){var n=this._id;return arguments.length<2?schedule_get(this.node(),n).on.on(e):this.each(function onFunction(e,t,n){var r,i,a=function on_start(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?init:schedule_set;return function(){var o=a(this,e),s=o.on;s!==r&&(i=(r=s).copy()).on(t,n),o.on=i}}(n,e,t))},attr:function(e,t){var n=kn(e),r="transform"===n?He:xr;return this.attrTween(e,"function"==typeof t?(n.local?function attr_attrFunctionNS(e,t,n){var r,i,a;return function(){var o,s=n(this);if(null!=s)return(o=this.getAttributeNS(e.space,e.local))===s?null:o===r&&s===i?a:a=t(r=o,i=s);this.removeAttributeNS(e.space,e.local)}}:function attr_attrFunction(e,t,n){var r,i,a;return function(){var o,s=n(this);if(null!=s)return(o=this.getAttribute(e))===s?null:o===r&&s===i?a:a=t(r=o,i=s);this.removeAttribute(e)}})(n,r,tweenValue(this,"attr."+e,t)):null==t?(n.local?function attr_attrRemoveNS(e){return function(){this.removeAttributeNS(e.space,e.local)}}:function attr_attrRemove(e){return function(){this.removeAttribute(e)}})(n):(n.local?function attr_attrConstantNS(e,t,n){var r,i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===n?null:a===r?i:i=t(r=a,n)}}:function attr_attrConstant(e,t,n){var r,i;return function(){var a=this.getAttribute(e);return a===n?null:a===r?i:i=t(r=a,n)}})(n,r,t+""))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var r=kn(e);return this.tween(n,(r.local?function attrTweenNS(e,t){function tween(){var n=this,r=t.apply(n,arguments);return r&&function(t){n.setAttributeNS(e.space,e.local,r(t))}}return tween._value=t,tween}:function attrTween(e,t){function tween(){var n=this,r=t.apply(n,arguments);return r&&function(t){n.setAttribute(e,r(t))}}return tween._value=t,tween})(r,t))},style:function(e,t,n){var r="transform"==(e+="")?Be:xr;return null==t?this.styleTween(e,function style_styleRemove(e,t){var n,r,i;return function(){var a=styleValue(this,e),o=(this.style.removeProperty(e),styleValue(this,e));return a===o?null:a===n&&o===r?i:i=t(n=a,r=o)}}(e,r)).on("end.style."+e,function styleRemoveEnd(e){return function(){this.style.removeProperty(e)}}(e)):this.styleTween(e,"function"==typeof t?function style_styleFunction(e,t,n){var r,i,a;return function(){var o=styleValue(this,e),s=n(this);return null==s&&(this.style.removeProperty(e),s=styleValue(this,e)),o===s?null:o===r&&s===i?a:a=t(r=o,i=s)}}(e,r,tweenValue(this,"style."+e,t)):function style_styleConstant(e,t,n){var r,i;return function(){var a=styleValue(this,e);return a===n?null:a===r?i:i=t(r=a,n)}}(e,r,t+""),n)},styleTween:function(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==t)return this.tween(r,null);if("function"!=typeof t)throw new Error;return this.tween(r,function styleTween(e,t,n){function tween(){var r=this,i=t.apply(r,arguments);return i&&function(t){r.style.setProperty(e,i(t),n)}}return tween._value=t,tween}(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function text_textFunction(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(tweenValue(this,"text",e)):function text_textConstant(e){return function(){this.textContent=e}}(null==e?"":e+""))},remove:function(){return this.on("end.remove",function removeFunction(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r,i=schedule_get(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===e)return r.value;return null}return this.each((null==t?function tweenRemove(e,t){var n,r;return function(){var i=schedule_set(this,e),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===t){(r=r.slice()).splice(o,1);break}i.tween=r}}:function tweenFunction(e,t,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=schedule_set(this,e),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=s;break}c===l&&i.push(s)}a.tween=i}})(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function delayFunction(e,t){return function(){init(this,e).delay=+t.apply(this,arguments)}}:function delayConstant(e,t){return t=+t,function(){init(this,e).delay=t}})(t,e)):schedule_get(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?function durationFunction(e,t){return function(){schedule_set(this,e).duration=+t.apply(this,arguments)}}:function durationConstant(e,t){return t=+t,function(){schedule_set(this,e).duration=t}})(t,e)):schedule_get(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(function easeConstant(e,t){if("function"!=typeof t)throw new Error;return function(){schedule_set(this,e).ease=t}}(t,e)):schedule_get(this.node(),t).ease}};var Sr={time:null,delay:0,duration:250,ease:cubicInOut};function transition_inherit(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))return Sr.time=now(),Sr;return n}jn.prototype.interrupt=function(e){return this.each(function(){br(this,e)})},jn.prototype.transition=function(e){var t,n;e instanceof Transition?(t=e._id,e=e._name):(t=newId(),(n=Sr).time=now(),e=null==e?null:e+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],c=s.length,l=0;l<c;++l)(o=s[l])&&vr(o,e,t,l,s,n||transition_inherit(o,t));return new Transition(r,this._parents,e,t)};["e","w"].map(brush_type),["n","s"].map(brush_type),["n","e","s","w","nw","ne","se","sw"].map(brush_type);function brush_type(e){return{type:e}}var Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pr=function selectElement(e){return zn(e)},Er=function makeElement(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments[5];(e instanceof HTMLElement||e instanceof SVGElement)&&(e=Pr(e));var o=r?r[0]:null,s=null,c=null,l=null,u=null,f=null,h=void 0;o?"#"===o?(s="id",c=r):(s="class",c="."===r[0]?r:"."+r):(c=t,h=!0),l=e.selectAll(c),h&&(l=l.filter(function(){return this.parentNode===e.node()})),u=(l=l.data(n,a)).enter().append(t||"div"),i.enter&&u.each(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.enter.apply(i,[Pr(this)].concat(t))}),f=u.merge(l),i.update&&f.each(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.update.apply(i,[Pr(this)].concat(t))}),"class"===s?f.classed("."===o?r.substring(1,r.length):r,!0):"id"===s&&f.attr("id",r.substring(1,r.length));var d=l.exit();return i.exit?d.each(function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.exit.apply(i,[Pr(this)].concat(t))}):d.remove(),f},Tr=function applyStyle(e,t){return Object.entries(t).forEach(function(t){e.style(t[0],t[1])},void 0),e},Ar=function setElementAttrs(e,t){for(var n in t)({}).hasOwnProperty.call(t,n)&&e.attr(n,t[n])},Or=function setAttrs(e,t,n){return e instanceof jn||(e=Pr(e)),void 0!==n?e.selectAll("."+n).each(function(){Ar(zn(this),t)}):Ar(e,t),e},Nr=function setStyles(e,t){for(var n in e instanceof jn||(e=Pr(e)),t)({}).hasOwnProperty.call(t,n)&&e.style(n,t[n]);return e},Rr=function createElements(e){var t=zn(e.container),n=void 0,r=void 0;"number"==typeof(n=e.data)&&(n=Array(n).fill().map(function(e,t){return t})),r=t.selectAll(e.selector).data(n),(r=t.selectAll(e.selector).filter(function(){return this.parentNode===t.node()}).data(e.data)).enter().append(e.append).merge(r).each(function(t,n){e.each(t,zn(this),n)}).attr("class",e.className||""),r.exit().remove()},Fr=function getClientPoint(){var e=Un.apply(void 0,arguments);return{x:e[0],y:e[1]}},Dr=function getEvent(){return Ln},Lr=function getD3Drag(){return Jn},Ir=function getSmartComputedStyle(e,t){var n,r,i={"fill-opacity":0},a="string"==typeof t?t:t instanceof Array?t.join(" "):void 0,o=void 0;return o=e.node()instanceof HTMLElement?e.append("div").html("W"):e.append("text").text("W"),a?o.attr("class",a):"object"===(void 0===t?"undefined":Mr(t))&&(delete t["fill-opacity"],extend2(i,t)),o.style(i),r={fontSize:(n=window.getComputedStyle(o.node())).fontSize,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontStyle:n.fontStyle},o.remove(),r},jr=function hasTouch(){return"ontouchstart"in document.documentElement},zr=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Br=function(){function Selection(){!function selection_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Selection),this._data=[],this._idMap={},this._mode="",this._enterdata=[],this._exitdata=[]}return zr(Selection,[{key:"getObjects",value:function getObjects(){var e=this;return Object.keys(this._idMap).map(function(t){return e._idMap[t]})}},{key:"data",value:function data(e,t){var n=this;if(t){this._data=[],this._idGetter=t;var r={};e.forEach(function(){var e=t.apply(void 0,arguments);r[e]=arguments.length<=0?void 0:arguments[0]});var i=[];return Object.keys(this._idMap).forEach(function(e){r[e]||i.push(e)}),Object.keys(r).forEach(function(e){n._idMap[e]?(n._idMap[e]=r[e],n._data.push(r[e])):n._enterdata.push(r[e])}),i.forEach(function(e){var t=n._idMap[e];n._exitdata.push(t),delete n._idMap[e]}),this}if(e.length>this._data.length)for(var a=this._data.length;a<e.length;a+=1)this._enterdata.push(e[a]);else{for(var o=e.length,s=o;s<this._data.length;s+=1){var c=this._data[s];delete this._idMap[c.id],this._exitdata.push(c)}this._data=this._data.slice(o,this._data.length)}return this}},{key:"append",value:function append(e){var t=this;return this["_"+this._mode+"data"].forEach(function(){var n=arguments.length<=0?void 0:arguments[0],r=t._idGetter?t._idGetter.apply(t,arguments):n.id||(arguments.length<=1?void 0:arguments[1]);t._idMap[r]=e.apply(void 0,arguments)}),this._mode="",this}},{key:"enter",value:function enter(){return this._mode="enter",this}},{key:"attr",value:function attr(e,t){return this._data.forEach(function(n){return n.attr(e,t)}),this}},{key:"merge",value:function merge(e){var t=this;return e._data.forEach(function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=t._idGetter?t._idGetter.apply(t,n):n[0].id||n[1];t._idMap[i]=n[0],t._data.push(n[0])}),this._enterdata=[],this}},{key:"exit",value:function exit(){return this._mode="exit",this}},{key:"each",value:function each(e){var t=this;return Object.keys(this._idMap).forEach(function(n){e(t._idMap[n])}),this}},{key:"map",value:function map(e){var t=this;return Object.keys(this._idMap).forEach(function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];t._idMap[r[0]]=e.apply(void 0,[t._idMap[r[0]]].concat(r))}),this}},{key:"remove",value:function remove(){this["_"+this._mode+"data"].forEach(function(e){return e.remove()}),""===this._mode&&this.each(function(e){return e.remove()}),this["_"+this._mode+"data"]=[],this._mode=""}}]),Selection}();var Hr=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();!function(){function DataObject(){!function data_object_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DataObject),this._id=Ht()}Hr(DataObject,[{key:"attr",value:function attr(e,t){this[e]=t}},{key:"remove",value:function remove(){}},{key:"id",get:function get(){return this._id}}])}();var Ur=["initialized","beforeupdate","updated","beforedraw","drawn","beforeremove","removed"],Vr=[];["canvas","unit","layer","axis","facet-headers","legend","caption"].forEach(function(e){Ur.forEach(function(t){Vr.push(e+"."+t)})});var qr=Vr,Wr=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Gr=function resolver(e){return function(t){return e(t)}},Yr=function hasOwn(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Xr=function(){function LifeCycleManager(){!function lifecycle_manager_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LifeCycleManager),this._eventList=qr,this._promises=new Map,this._notifiers={},this._lifeCycles={},this._unreleasedLifeCycles={},this._boot()}return Wr(LifeCycleManager,[{key:"_boot",value:function _boot(){this._notifiers=this._eventList.reduce(function(e,t){return e[t]=Gr,e},{}),this._preparePromises()}},{key:"retrieve",value:function retrieve(e){return this._promises.get(e)}},{key:"_makeNotifierPromise",value:function _makeNotifierPromise(e){var t=this;return new Promise(function(n){t._notifiers[e]=t._notifiers[e](n)})}},{key:"_preparePromises",value:function _preparePromises(){var e=this;this._eventList.forEach(function(t){e._promises.set(t,e._makeNotifierPromise(t))})}},{key:"_resolvePromise",value:function _resolvePromise(e,t){this._notifiers[e](t)}},{key:"notify",value:function notify(e){var t=e.formalName||e.client.constructor.formalName();e.formalName=t,this._releasePromisesFromCache(),this._notify(t,e)}},{key:"_notify",value:function _notify(e,t){var n=t.action,r=e+"."+n;this._resolvePromise(r,t);var i=this.retrieve(r);this._lifeCycles[e]&&this._lifeCycles[e][n]?this._callLifeCycleCallback(e,n,i):this._cachePromise(e,n,i)}},{key:"_callLifeCycleCallback",value:function _callLifeCycleCallback(e,t,n){var r=e+"."+t;this._lifeCycles[e][t](n),this._resetTargetPromise(r)}},{key:"_releasePromisesFromCache",value:function _releasePromisesFromCache(){var e=this;Object.keys(this._unreleasedLifeCycles).forEach(function(t){Object.keys(e._unreleasedLifeCycles[t]).forEach(function(n){if(e._lifeCycles[t]&&e._lifeCycles[t][n]){var r=e._unreleasedLifeCycles[t][n];e._callLifeCycleCallback(t,n,r),delete e._unreleasedLifeCycles[t][n]}})})}},{key:"_cachePromise",value:function _cachePromise(e,t,n){Yr(this._unreleasedLifeCycles,e)||(this._unreleasedLifeCycles[e]={}),Yr(this._unreleasedLifeCycles[e],t)||(this._unreleasedLifeCycles[e][t]={}),this._unreleasedLifeCycles[e][t]=n}},{key:"register",value:function register(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._lifeCycles=e,this._releasePromisesFromCache()}},{key:"_resetTargetPromise",value:function _resetTargetPromise(e){var t=this;setTimeout(function(){t._notifiers[e]=Gr,t._promises.set(e,t._makeNotifierPromise(e))},0)}}]),LifeCycleManager}(),$r=0,Zr=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Kr=function(){function SelectionSet(e,t){!function selection_set_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SelectionSet),this.completeSet=e,this._set=e.reduce(function(e,t){return e[t]=$r,e},{}),this._volatile=t,this._completeSetCount=e.length,this._lockedSelection={},this._resetted=!0}return Zr(SelectionSet,[{key:"add",value:function add(e){this._resetted=!1;var t=this._set;for(var n in e.forEach(function(e){t[e]=1}),t)1!==t[n]&&2!==t[n]&&(t[n]=t[n]<0?-2:-1);return this}},{key:"update",value:function update(e){var t=this._set;return e.forEach(function(e){t[e]=2}),this}},{key:"updateEntry",value:function updateEntry(){var e=this._set;for(var t in e)e[t]=1===e[t]?2:e[t];return this}},{key:"updateExit",value:function updateExit(){var e=this._set;for(var t in e)e[t]=-1===e[t]?-2:e[t];return this}},{key:"remove",value:function remove(e){this._resetted=!1;var t=this._set;for(var n in e.forEach(function(e){t[e]=-1}),t)-1!==t[n]&&-2!==t[n]&&(t[n]=0===t[n]?1:2);return this}},{key:"getSets",value:function getSets(){var e=this._set,t={entrySet:[[],[]],exitSet:[[],[]],completeSet:[]};for(var n in e)e[n]>0?(2===e[n]&&t.entrySet[0].push(n),1===e[n]&&t.entrySet[1].push(n)):e[n]<0&&(-2===e[n]&&t.exitSet[0].push(n),-1===e[n]&&t.exitSet[1].push(n)),t.completeSet.push(n);return["entrySet","exitSet"].forEach(function(e){t[e]=t[e].map(function(e){return e.map(Number)})}),t.completeSet=t.completeSet.map(Number),t}},{key:"reset",value:function reset(e){var t=this._set;if(e)e.forEach(function(e){t[e]=$r});else{var n=this._lockedSelection;for(var r in t)r in n||(t[r]=$r)}return this._resetted=!0,this}},{key:"getEntrySet",value:function getEntrySet(){var e=this._set,t=[];for(var n in e)1===e[n]&&t.push(n);return t}},{key:"getOldEntry",value:function getOldEntry(){var e=this._set,t=[];for(var n in e)2===e[n]&&t.push(n);return t}},{key:"getOldExit",value:function getOldExit(){var e=this._set,t=[];for(var n in e)-2===e[n]&&t.push(n);return t}},{key:"getExitSet",value:function getExitSet(){var e=this._set,t=[];for(var n in e)-1===e[n]&&t.push(n);return t}},{key:"getCompleteSet",value:function getCompleteSet(){var e=this._set,t=[];for(var n in e)t.push(n);return t}},{key:"getCompleteSetCount",value:function getCompleteSetCount(){return this._completeSetCount}},{key:"resetted",value:function resetted(){return this._resetted}}]),SelectionSet}();function helper_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Jr=function changeSideEffectAvailability(e,t,n){for(var r in e)if({}.hasOwnProperty.call(e,r)){var i=!0;t&&!1===t(e[r],r)&&(i=!1),i&&(n?e[r].enable():e[r].disable())}},Qr=function getMergedSet(e){return[].concat(helper_toConsumableArray(new Set([].concat(helper_toConsumableArray(e[0]),helper_toConsumableArray(e[1])))))},ei={newEntry:[1],oldEntry:[2],mergedEnter:[1,2],newExit:[-1],oldExit:[-2],mergedExit:[-1,-2],complete:[]},ti=function getSetInfo(e,t,n){var r=null,i=n.filteredDataModel,a=n.selectionSet;return n.propagationData?i&&(r="mergedEnter"===e?i[0]:i[1]):r=a.resetted()?null:function getModelFromSet(e,t,n){return t?t.select(function(t,r){return ei[e].some(function(e){return n[r]===e})},{saveChild:!1}):null}(e,n.dataModel,n.selectionSet._set),{uids:t,length:t.length,model:r}},ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ri=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function firebolt_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var ii=function(){function Firebolt(e,t,n,r){!function firebolt_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Firebolt),this.context=e,this._sideEffectDefinitions={},this._sideEffects={},this._actions={behavioural:{},physical:{}},this._sourceSideEffects={tooltip:!0,selectionBox:!0},this._actionBehaviourMap={},this._config={},this._behaviourEffectMap={},this.mapSideEffects(r),this.registerBehaviouralActions(t.behavioural),this.registerSideEffects(n),this.registerPhysicalBehaviouralMap(t.physicalBehaviouralMap),this.registerPhysicalActions(t.physical)}return ri(Firebolt,[{key:"config",value:function config(){if(arguments.length){var e=this._config=hn(this._config,arguments.length<=0?void 0:arguments[0]),t=this.sideEffects();for(var n in t)if({}.hasOwnProperty.call(t,n)){var r=e[n];r&&t[n].config(r)}return this}return this._config}},{key:"mapSideEffects",value:function mapSideEffects(e){var t=this._behaviourEffectMap;for(var n in e)if({}.hasOwnProperty.call(e,n)){var r=e[n]||[];!t[n]&&(t[n]=[]),this._behaviourEffectMap[n]=[].concat(firebolt_toConsumableArray(new Set([].concat(firebolt_toConsumableArray(t[n]),firebolt_toConsumableArray(r)))))}return this}},{key:"registerBehaviouralActions",value:function registerBehaviouralActions(e){var t=function initializeBehaviouralActions(e,t){var n={};return(t=t instanceof Array?t:Object.values(t)).forEach(function(t){n[t.formalName()]=new t(e)}),n}(this,e);return Object.assign(this._actions.behavioural,t),this}},{key:"registerSideEffects",value:function registerSideEffects(e){for(var t in e)this._sideEffectDefinitions[e[t].formalName()]=e[t];return this}},{key:"applySideEffects",value:function applySideEffects(e,t,n){var r=this.sideEffects();return e.forEach(function(e){var i=void 0,a=void 0;"object"===(void 0===e?"undefined":ni(e))?(a=e.name,i=e.strategy):a=e,r[a].enabled&&r[a].apply(t,n,i)}),this}},{key:"dispatchBehaviour",value:function dispatchBehaviour(e,t){var n=this._actions.behavioural[e],r=this._behaviourEffectMap[e];if(n){var i=n(t);this.applySideEffects(r,i,t)}}},{key:"sideEffects",value:function sideEffects(){return arguments.length?(this._sideEffects=arguments.length<=0?void 0:arguments[0],this):this._sideEffects}},{key:"enable",value:function enable(e){return Jr(this.sideEffects(),e,!0),this}},{key:"disable",value:function disable(e){return Jr(this.sideEffects(),e,!1),this}},{key:"attachPropagationListener",value:function attachPropagationListener(e){return e.unsubscribe("propagation"),e.on("propagation",this.onDataModelPropagation()),this}},{key:"onDataModelPropagation",value:function onDataModelPropagation(){var e=this;return function(t){var n=t.payload,r=n.action;e.dispatchBehaviour(r,n,{propagate:!1})}}},{key:"createSelectionSet",value:function createSelectionSet(e){var t=this._actions.behavioural,n={},r={};for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=new Kr(e),r[i]=new Kr(e,!0));return this._volatileSelectionSet=r,this.selectionSet(n),this}},{key:"selectionSet",value:function selectionSet(){return arguments.length?(this._selectionSet=arguments.length<=0?void 0:arguments[0],this):this._selectionSet}},{key:"initializeSideEffects",value:function initializeSideEffects(){var e=this._sideEffectDefinitions;return this.sideEffects(function initializeSideEffects(e,t){var n=e._sideEffects;return(t=t instanceof Array?t:Object.values(t)).forEach(function(t){var r=n[t.formalName()];n[t.formalName()]=r||new t(e)}),n}(this,e)),this}},{key:"registerPhysicalActions",value:function registerPhysicalActions(e){var t=function initializePhysicalActions(e,t){var n={};for(var r in t)({}).hasOwnProperty.call(r,t)||(n[r]=t[r](e));return n}(this,e);return Object.assign(this._actions.physical,t),this}},{key:"mapActionsAndBehaviour",value:function mapActionsAndBehaviour(){var e=this._actions.physical,t=this._actionBehaviourMap;for(var n in t)if(!{}.hasOwnProperty.call(n,t)){var r=void 0,i=t[n];r=i.target;var a=i.touch;r||(r=this.context.getDefaultTargetContainer()),(jr()?!0===a||void 0===a:!a)&&this.bindActionWithBehaviour(e[n],r,i.behaviours)}return this}},{key:"registerPhysicalBehaviouralMap",value:function registerPhysicalBehaviouralMap(e){return Object.assign(this._actionBehaviourMap,e),this}},{key:"bindActionWithBehaviour",value:function bindActionWithBehaviour(e,t,n){var r=this;return"string"==typeof t&&(t=[t]),t.forEach(function(t){var i=function getElementsByClassName(e,t){return zn(e).selectAll(t).nodes()}(r.context.mount(),"."+t);i&&i.forEach(function(t){e(t,n)})}),this}},{key:"select",value:function select(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(){return function(){var a=r.context.id(),o=i.sourceId,s=[];o!==a&&(s=[r._volatileSelectionSet[t]]),o&&s.push(r.selectionSet()[t]);var c=n.persist,l=r.getAddSetFromCriteria(e,i),u=l.model,f=l.uids,h=r.getFullData();return s.map(function(t){!function setSelectionSets(e,t,n){if(null===e)t.reset();else if(e.length){var r=e.filter(function(e){return 1===t._set[e]||2===t._set[e]});if(n){r.length?(t.updateExit(),t.remove(r)):(t.updateEntry(),t.add(e));var i=t.getSets().exitSet,a=Qr(i),o=t.getCompleteSet().length;i[1].length!==o&&a.length===o&&t.reset()}else{t.updateExit();var s=t.getSets().entrySet;t.reset(Qr(s)),t.add(e),t.update(r)}}else t.remove(t.getCompleteSet())}(f,t,c);var n=t.getSets(),r=n.entrySet,a=n.exitSet,o=n.completeSet,s={isSourceFieldPresent:i.isSourceFieldPresent,dataModel:h,filteredDataModel:u,propagationData:i.data,selectionSet:t};return{entrySet:[ti("oldEntry",r[0],s),ti("newEntry",r[1],s)],exitSet:[ti("oldEntry",a[0],s),ti("newExit",a[1],s)],mergedEnter:ti("mergedEnter",Qr(r),s),mergedExit:ti("mergedExit",Qr(a),s),completeSet:ti("complete",o,s),isSourceFieldPresent:i.isSourceFieldPresent,fields:function getSourceFields(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.sourceIdentifiers;return n?n.getSchema().map(function(e){return e.name}):t instanceof Array?t[0]:Object.keys(t||{})}(i,e),sourceSelectionSet:!0===t._volatile}})}}}},{key:"getAddSetFromCriteria",value:function getAddSetFromCriteria(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.context,r=t.data?t.data:n.getDataModelFromIdentifiers(e,"all"),i=n.fields().x||[],a=n.fields().y||[],o=i.every(function(e){return e.type()===b.MEASURE}),s=a.every(function(e){return e.type()===b.MEASURE});return{model:r,uids:null===e?null:t.data?function filterPropagationModel(e,t,n){var r=t.getData(),i=r.data,a=r.schema,o=void 0;if(a.length)if(a[0].name===w.ROW_ID){var s={};i.forEach(function(e){s[e[0]]=!0}),o=e.select(function(e,t){return s[t]},{saveChild:!1})}else{var c=e.getFieldsConfig();o=e.select(function(e){return i.some(function(t){return a.every(function(r,i){return!(n||r.name in c&&c[r.name].def.type!==b.MEASURE)||t[i]===e[r.name].valueOf()})})},{saveChild:!1})}else o=t;return o}(this.getFullData(),t.data[0],o&&s).getData().uids:r[0].getData().uids}}},{key:"getFullData",value:function getFullData(){return this.context.data()}},{key:"resetted",value:function resetted(){return this._resetted}}]),Firebolt}(),ai=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var oi=function(){function GenericBehaviour(e){!function generic_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GenericBehaviour),this.firebolt=e}return ai(GenericBehaviour,[{key:"dispatch",value:function dispatch(){return this}}],[{key:"mutates",value:function mutates(){return!1}}]),GenericBehaviour}(),si=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var ci=function(e){function VolatileBehaviour(){return function volatile_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VolatileBehaviour),function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(VolatileBehaviour.__proto__||Object.getPrototypeOf(VolatileBehaviour)).apply(this,arguments))}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(VolatileBehaviour,oi),si(VolatileBehaviour,[{key:"getSelectionSet",value:function getSelectionSet(e,t){var n=e.criteria,r=this.firebolt,i=this.constructor.formalName();return r.select(n,i,{},t)()}},{key:"dispatch",value:function dispatch(e,t){return this.getSelectionSet(e,t)}}]),VolatileBehaviour}(),li="brush",ui="highlight",fi="tooltip",hi="filter",di="select",_i=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var pi=function(e){function HighlightBehaviour(){return function highlight_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,HighlightBehaviour),function highlight_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(HighlightBehaviour.__proto__||Object.getPrototypeOf(HighlightBehaviour)).apply(this,arguments))}return function highlight_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(HighlightBehaviour,ci),_i(HighlightBehaviour,null,[{key:"formalName",value:function formalName(){return ui}}]),HighlightBehaviour}(),yi=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var gi=function(e){function BrushBehaviour(){return function brush_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BrushBehaviour),function brush_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(BrushBehaviour.__proto__||Object.getPrototypeOf(BrushBehaviour)).apply(this,arguments))}return function brush_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(BrushBehaviour,ci),yi(BrushBehaviour,null,[{key:"formalName",value:function formalName(){return li}}]),BrushBehaviour}(),mi=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var vi=function(e){function FilterBehaviour(){return function filter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FilterBehaviour),function filter_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(FilterBehaviour.__proto__||Object.getPrototypeOf(FilterBehaviour)).apply(this,arguments))}return function filter_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(FilterBehaviour,ci),mi(FilterBehaviour,null,[{key:"formalName",value:function formalName(){return hi}},{key:"mutates",value:function mutates(){return!0}}]),FilterBehaviour}(),bi=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var xi=function(e){function PersistentBehaviour(){return function persistent_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PersistentBehaviour),function persistent_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(PersistentBehaviour.__proto__||Object.getPrototypeOf(PersistentBehaviour)).apply(this,arguments))}return function persistent_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(PersistentBehaviour,oi),bi(PersistentBehaviour,[{key:"getSelectionSet",value:function getSelectionSet(e,t){var n=e.criteria,r=this.firebolt,i=this.constructor.formalName();return r.select(n,i,{persist:void 0===t.persistent||t.persistent},t)()}},{key:"dispatch",value:function dispatch(e,t){return this.getSelectionSet(e,t)}}]),PersistentBehaviour}(),wi=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Ci,ki=function(e){function SelectBehaviour(){return function select_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SelectBehaviour),function select_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SelectBehaviour.__proto__||Object.getPrototypeOf(SelectBehaviour)).apply(this,arguments))}return function select_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SelectBehaviour,xi),wi(SelectBehaviour,null,[{key:"formalName",value:function formalName(){return di}}]),SelectBehaviour}(),Si=function getDragActionConfig(e,t,n){if(!e.axes.x&&!e.axes.y)return{criteria:null};var r=e.axes,i=r.x[0],a=r.y[0],o=e.fields,s=o.x[0].getMembers()[0],c=o.y[0].getMembers()[0],l=n[s].def.subtype?n[s].def.subtype:n[s].def.type,u=n[c].def.subtype?n[c].def.subtype:n[c].def.type,f={},h=t.startPos,d=t.endPos;if(h.x===d.x&&h.y===d.y)return{criteria:null,interpolated:!0};var _=l===b.MEASURE?u===b.MEASURE?["x","y"]:["y"]:["x"],p={},y=l===v.CATEGORICAL,g=u===v.CATEGORICAL,m="band"===i.constructor.type()?i.scale().invertExtent(h.x,d.x):i.invert(h.x,d.x),x="band"===a.constructor.type()?a.scale().invertExtent(h.y,d.y):a.invert(h.y,d.y),w={x:h.x===d.x?[]:y?m:m.sort(function(e,t){return e-t}),y:h.y===d.y?[]:g?x:x.sort(function(e,t){return e-t})},C={};if(2===_.length){if(C[s]=w.x,C[c]=w.y,s===c){var k=w.x,S=w.y,M=k[0]>S[0]?S:k,P=M===S?k:S;M[1]<P[0]?C[s]=[]:C[s]=[P[0],M[1]<P[1]?M[1]:P[1]],f.x=[h.x,d.x],f.y=[h.y,d.y]}}else p[_[0]]=w[_[0]]||[],"x"===_[0]?(C[s]=p.x,l===v.CATEGORICAL&&(f.x=t.snap&&h.x!==d.x?i.getNearestRange(h.x,d.x):[h.x,d.x])):(C[c]=p.y,u===v.CATEGORICAL&&(f.y=t.snap&&h.y!==d.y?a.getNearestRange(h.y,d.y):[h.y,d.y]));return{criteria:C,dimensions:f,interpolated:!0}},Mi=function attachDragEvent(e,t,n,r){var i={},a={},o=Lr(),s=e.getBoundingClientRect(),c=void 0;Pr(e).call(o().on("start",function(){var e=Dr();i={x:e.x,y:e.y},c=(new Date).getTime()}).on("drag",function(){var e=Dr();if(a={x:e.x,y:e.y},!(r&&Math.abs(i.x-a.x)<=5)){a.x=Math.max(0,Math.min(a.x,s.width)),a.y=Math.max(0,Math.min(a.y,s.height));var o=Si(n.context.getSourceInfo(),{startPos:i,endPos:a},n.context.data().getFieldsConfig());t.forEach(function(e){return n.dispatchBehaviour(e,o)})}}).on("end",function(){var e=Dr();a={x:e.x,y:e.y};var o=(new Date).getTime()-c;if(!(r&&o>100&&Math.abs(i.x-a.x)<=5)){a.x=Math.max(0,Math.min(a.x,s.width)),a.y=Math.max(0,Math.min(a.y,s.height));var l=Si(n.context.getSourceInfo(),{startPos:i,endPos:a,snap:!0},n.context.data().getFieldsConfig());l.dragEnd=!0,t.forEach(function(e){return n.dispatchBehaviour(e,l)})}}))},Pi=function hover(e){return function(t,n){var r=function dispatchBehaviour(t){var r=Dr(),i=e.context,a=i.config().interaction.tooltip.mode,o=Fr(i.getDrawingContext().svgContainer,r),s=i.getNearestPoint(o.x,o.y,{getAllPoints:"consolidated"===a||"fragmented"===a,data:t}),c={criteria:s?s.id:null,showInPosition:s.showInPosition,target:s.target,position:o,mode:a};n.forEach(function(t){return e.dispatchBehaviour(t,c)}),r.stopPropagation()};Pr(t).on("mouseover",r).on("mousemove",r).on("mouseout",function(){n.forEach(function(t){return e.dispatchBehaviour(t,{criteria:null})})})}},Ei=function generatePayloadFromEvent(e,t,n){var r=n.context,i=Fr(r.getDrawingContext().svgContainer,t.touches?t.touches[0]:t),a=r.getNearestPoint(i.x,i.y,{data:e});return{criteria:a?a.id:null,showInPosition:a.showInPosition,target:a.target,position:i}},Ti="drag",Ai="hover",Oi="selectiondrag",Ni="click",Ri="longtouch",Fi="touchdrag",Di=function click(e){return function(t,n){Pr(t).on("click",function dispatchBehaviour(t){var r=Dr(),i=Ei(t,r,e);n.forEach(function(t){return e.dispatchBehaviour(t,i)}),r.stopPropagation()})}};function physical_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Li=(physical_defineProperty(Ci={},Ti,function drag(e){return function(t,n){Mi(t,n,e)}}),physical_defineProperty(Ci,Ai,Pi),physical_defineProperty(Ci,Ni,Di),physical_defineProperty(Ci,Ri,function longtouch(e){return function(t,n){var r=void 0,i=void 0;i=!1,r=Dr(),Pr(t).on("touchstart",function(t){r=Dr(),i=!1,setTimeout(function(){i?n.forEach(function(t){return e.dispatchBehaviour(t,{criteria:null})}):function dispatchBehaviour(t){var i=Ei(t,r,e);n.forEach(function(t){return e.dispatchBehaviour(t,i)}),r.stopPropagation()}(t)},100)}).on("touchend",function(){i=!0})}}),physical_defineProperty(Ci,Fi,function touchdrag(e){return function(t,n){Mi(t,n,e,!0)}}),Ci),Ii=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var ji=function(){function GenericSideEffect(e){!function side_effects_generic_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GenericSideEffect),this.firebolt=e,this.enabled=!0,this._strategy="default",this._config={},this._id=Ht(),this.config(this.constructor.defaultConfig())}return Ii(GenericSideEffect,[{key:"config",value:function config(){return arguments.length?(this._config=hn(this._config,arguments.length<=0?void 0:arguments[0]),this):this._config}},{key:"disable",value:function disable(){return this.enabled=!1,this}},{key:"enable",value:function enable(){return this.enabled=!0,this}},{key:"apply",value:function apply(){return this}},{key:"detach",value:function detach(){return this}},{key:"sourceInf",value:function sourceInf(){return arguments.length?(this._sourceInf=arguments.length<=0?void 0:arguments[0],this):this._sourceInf}},{key:"marksFromIdentifiers",value:function marksFromIdentifiers(){return arguments.length?(this._marksFromIdentifiers=arguments.length<=0?void 0:arguments[0],this):this._marksFromIdentifiers}}],[{key:"defaultConfig",value:function defaultConfig(){return{}}},{key:"target",value:function target(){return"all"}},{key:"mutates",value:function mutates(){return!1}}]),GenericSideEffect}(),zi=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Bi=function(e){function SurrogateSideEffect(){return function surrogate_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SurrogateSideEffect),function surrogate_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SurrogateSideEffect.__proto__||Object.getPrototypeOf(SurrogateSideEffect)).apply(this,arguments))}return function surrogate_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SurrogateSideEffect,ji),zi(SurrogateSideEffect,[{key:"fadeOutSelection",value:function fadeOutSelection(e){this.firebolt.context.fadeOutSelection(e)}},{key:"unfadeSelection",value:function unfadeSelection(e){this.firebolt.context.unfadeSelection(e)}},{key:"highlightPoint",value:function highlightPoint(e){this.firebolt.context.highlightPoint(e)}},{key:"dehighlightPoint",value:function dehighlightPoint(e){this.firebolt.context.dehighlightPoint(e)}},{key:"focusSelection",value:function focusSelection(e){this.firebolt.context.focusSelection(e)}},{key:"focusOutSelection",value:function focusOutSelection(e){this.firebolt.context.focusOutSelection(e)}},{key:"resetPoint",value:function resetPoint(e){this.firebolt.context.resetPoint(e)}}]),SurrogateSideEffect}(),Hi=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Ui=function(e){function SpawnableSideEffect(){return function spawnable_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SpawnableSideEffect),function spawnable_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SpawnableSideEffect.__proto__||Object.getPrototypeOf(SpawnableSideEffect)).apply(this,arguments))}return function spawnable_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SpawnableSideEffect,ji),Hi(SpawnableSideEffect,[{key:"createElement",value:function createElement(e,t,n,r){return Er(e,t,n,r)}},{key:"drawingContext",value:function drawingContext(){return arguments.length?(this._drawingContext=arguments.length<=0?void 0:arguments[0],this):this._drawingContext}},{key:"show",value:function show(){return this}},{key:"hide",value:function hide(){return this}}]),SpawnableSideEffect}(),Vi=(n(7),function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),qi=function changeVisibility(e,t,n){var r=e.config(),i=r.defClassName,a=r.classPrefix;Pr(t).selectAll("."+a+"-"+i).style("display",n?"block":"none")},Wi=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Gi=function(e){function SelectionBox(){return function selection_box_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SelectionBox),function selection_box_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SelectionBox.__proto__||Object.getPrototypeOf(SelectionBox)).apply(this,arguments))}return function selection_box_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SelectionBox,Ui),Wi(SelectionBox,[{key:"apply",value:function apply(e,t){var n=void 0,r=void 0,i=void 0,a=void 0,o=this._config,s=o.box,c=this.firebolt,l=this.drawingContext()(),u=l.sideEffectGroup,f=l.width,h=l.height,d=o.classPrefix,_=l.xOffset,p=l.yOffset,y=o.defClassName;if(null===t.criteria)return this.hide(l),this;var g=function getBoxDimensionsFromPayload(e,t){var n=void 0,r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,c=void 0,l=e.criteria,u=(e.dragEnd,t.axes),f=t.fields,h=e.dimensions||{},d=h.x,_=h.y;if(null===l)return null;var p=u.x[0],y=u.y[0],g="linear"===p.constructor.type(),m="linear"===y.constructor.type(),v=""+f.x[0],b=""+f.y[0],x=l[v],w=l[b];if(x&&x[0]instanceof Array?(o=x[0],s=x[1]):(o=x||[],s=w||[]),c=x&&w?"both":x?"vertical":"horizontal",o&&o.length)if("band"===y.constructor.type()&&g)n=r=void 0,c="horizontal";else{var C=p.domain(),k="band"===p.constructor.type(),S=void 0,M=void 0;if(k){var P=C.indexOf(o[0]),E=C.indexOf(o[o.length-1]),T=[P,E].sort(function(e,t){return e-t}),A=Vi(T,2);P=A[0],E=A[1],S=C[P],M=C[E]}else S=o[0],M=o[o.length-1];n=p.getScaleValue(S),r=p.getScaleValue(M),r+=k?p.getUnitWidth():0}else n=r=void 0;if(s&&s.length)if("band"===p.constructor.type()&&m)i=a=void 0,c="vertical";else{var O=y.domain(),N=void 0,R=void 0;if("band"===y.constructor.type()){var F=O.indexOf(s[0]),D=O.indexOf(s[s.length-1]),L=[F,D].sort(function(e,t){return t-e}),I=Vi(L,2);F=I[0],D=I[1],N=O[F],R=O[D]}else N=s[0],R=s[s.length-1];i=y.getScaleValue(N),a=y.getScaleValue(R),a+="band"===y.constructor.type()?y.getUnitWidth():0}else i=a=void 0;if(m&&g||!e.dragEnd){if(d){var j=Vi(d,2);n=j[0],r=j[1]}if(_){var z=Vi(_,2);i=z[0],a=z[1]}}return{dimension:{x1:n,x2:r,y1:i,y2:a},direction:c}}(t,this.sourceInf()()),m=g.dimension,v=g.direction,b=t.dragEnd&&o.transition;"both"===v||"vertical"===v?(n=Math.min(m.x1,m.x2),i=Math.abs(m.x2-m.x1)):(n=0,i=f),"both"===v||"horizontal"===v?(r=Math.min(m.y1,m.y2),a=Math.abs(m.y2-m.y1)):(a=h,r=0),this._direction=v,"vertical"===v?n+=_:"horizontal"===v?r+=p:(n+=_,r+=p),this._direction=v,this.show(l);var x=[{x:n,y:r,width:i,height:a,sourceUnit:t.sourceUnit}],w=this,C=Er(Pr(u),"g",[1],"."+d+"-"+y).selectAll("rect").data(x),k=C.enter().append("rect").each(function(){!function selectionBoxDrag(e){return function(t,n,r){var i=void 0,a=function onDrag(r){r.sourceUnit=t.data()[0].sourceUnit,n.forEach(function(t){return e.dispatchBehaviour(t,r)})},o=r.drawingContext()(),s=r._direction,c=o.xOffset,l=o.yOffset,u=Lr();t.call(u().on("start",function(){var e=Dr();i=e.subject,"horizontal"===s?i.y-=l:"vertical"===s?i.x-=c:(i.y-=l,i.x-=c)}).on("drag",function(){var t=void 0,n=void 0,c=o.width,l=o.height,u=Dr();i.x+=u.dx,i.y+=u.dy,t=Math.min(c-i.width,Math.max(i.x,0)),n=Math.min(l-i.height,Math.max(i.y,0)),"horizontal"===s?(n=Math.min(o.boundHeight-i.height,Math.max(i.y,0)),l=o.height):"vertical"===s?(t=Math.min(o.boundWidth-i.width,Math.max(i.x,0)),c=o.width):(n=Math.min(o.boundHeight-i.height,Math.max(i.y,0)),l=o.boundHeight,t=Math.min(o.boundWidth-i.width,Math.max(i.x,0)),c=o.boundWidth);var f=n+i.height,h=t+i.width;if(t>=0&&h<=c&&n>=0&&f<=l){var d=Si(r.sourceInf()(),{startPos:{x:t,y:n},endPos:{x:h,y:f}},e.context.data().getFieldsConfig());a(d)}}).on("end",function(){var t=o.width,n=o.height,s=Math.min(t-i.width,Math.max(i.x,0)),c=Math.min(n-i.height,Math.max(i.y,0)),l=c+i.height,u=s+i.width;if(s>=0&&u<=t&&c>=0&&l<=n){var f=Si(r.sourceInf()(),{startPos:{x:s,y:c},endPos:{x:u,y:l},snap:!0},e.context.data().getFieldsConfig());f.dragEnd=!0,a(f)}}))}}(c)(Pr(this),["brush"],w)}).merge(C).each(function(e){var t=Pr(this);for(var n in b&&(t=t.transition().duration(b.duration)),e)({}).hasOwnProperty.call(e,n)&&!isNaN(e[n])&&t.attr(n,e[n])}),S=Jt(s.defClassName,this._id,d);return k.classed(S.join(" "),!0),k.classed(s.className,!0),this}},{key:"hide",value:function hide(e){qi(this,e.sideEffectGroup,!1)}},{key:"show",value:function show(e){qi(this,e.sideEffectGroup,!0)}}],[{key:"defaultConfig",value:function defaultConfig(){return{defClassName:"selection-box-group",className:"",classPrefix:"muze",box:{defClassName:"selection-box",className:""},transition:{duration:200}}}},{key:"formalName",value:function formalName(){return"selectionBox"}}]),SelectionBox}(),Yi={position:"absolute",width:0,height:0},Xi={classPrefix:"muze",defClassName:"tooltip-box",connectorClassName:"tooltip-connectors",className:"",row:{margin:0},content:{spacing:5,iconContainerSize:10,iconSize:30,iconShape:"circle",iconColor:"#ff0000",rowMargin:"0px",margin:10,separator:":"},arrow:{size:10,disabled:!1,defClassName:"tooltip-arrow",className:"",color:"rgba(195,195,195,0.85)"}},$i=function getArrowPos(e,t,n,r){var i=void 0,a=n.x,o=n.y,s=n.boxHeight,c=n.boxWidth,l=r.arrow.disabled?0:r.arrow.size;if("left"===e||"right"===e){var u=0,f=s/2,h=t.y+t.height,d=o+s;t.y>o?(u=t.y-o,f=(h>=d?d-t.y:t.height)/2):d>h&&(f=Math.abs(o-(t.y+t.height))/2),i=u+f-l/2}else{var _=0,p=c/2,y=t.x+t.width,g=a+c;t.x>a?(_=t.x-a,p=(y>=g?g-t.x:t.width)/2):g>y&&(p=Math.abs(a-(t.x+t.width))/2),i=_+p-l/2}return i},Zi=function placeArrow(e,t,n){var r=e._tooltipArrow,i=e._tooltipBackground,a=e._config,o=a.classPrefix,s=a.arrow,c=Jt(s.defClassName,e._id,a.classPrefix);r.style("display","block"),r.attr("class",""+c.join(" ")),"left"===t||"right"===t?(r.style("top",n+"px"),r.style("left",""),i.style("top",n+"px"),i.style("left","")):(r.style("top",""),r.style("left",n+"px"),i.style("top",""),i.style("left",n+"px")),r.classed(o+"-tooltip-arrow",!0),r.classed(o+"-tooltip-arrow-"+e._arrowOrientation,!1),r.classed(o+"-tooltip-arrow-"+t,!0),i.classed(o+"-tooltip-background-arrow",!0),i.classed(o+"-tooltip-background-arrow-"+e._arrowOrientation,!1),i.classed(o+"-tooltip-background-arrow-"+t,!0)},Ki=(n(9),Math.PI),Ji=2*Ki,Qi=Ji-1e-6;function path_Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function src_path_path(){return new path_Path}path_Path.prototype=src_path_path.prototype={constructor:path_Path,moveTo:function moveTo(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function lineTo(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function quadraticCurveTo(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function arcTo(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,c=r-t,l=a-e,u=o-t,f=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>1e-6)if(Math.abs(u*s-c*l)>1e-6&&i){var h=n-a,d=r-o,_=s*s+c*c,p=h*h+d*d,y=Math.sqrt(_),g=Math.sqrt(f),m=i*Math.tan((Ki-Math.acos((_+f-p)/(2*y*g)))/2),v=m/g,b=m/y;Math.abs(v-1)>1e-6&&(this._+="L"+(e+v*l)+","+(t+v*u)),this._+="A"+i+","+i+",0,0,"+ +(u*h>l*d)+","+(this._x1=e+b*s)+","+(this._y1=t+b*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function arc(e,t,n,r,i,a){e=+e,t=+t;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=e+o,l=t+s,u=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+c+","+l),n&&(f<0&&(f=f%Ji+Ji),f>Qi?this._+="A"+n+","+n+",0,1,"+u+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=Ki)+","+u+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function rect(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function toString(){return this._}};var ea=src_path_path,ta=function(e){return function constant(){return e}},na=(Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt,1e-12),ra=Math.PI,ia=2*ra;function linear_Linear(e){this._context=e}linear_Linear.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var aa=function(e){return new linear_Linear(e)};radial_curveRadial(aa);function radial_Radial(e){this._curve=e}function radial_curveRadial(e){function radial(t){return new radial_Radial(e(t))}return radial._curve=e,radial}radial_Radial.prototype={areaStart:function areaStart(){this._curve.areaStart()},areaEnd:function areaEnd(){this._curve.areaEnd()},lineStart:function lineStart(){this._curve.lineStart()},lineEnd:function lineEnd(){this._curve.lineEnd()},point:function point(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};Array.prototype.slice;var oa={draw:function draw(e,t){var n=Math.sqrt(t/ra);e.moveTo(n,0),e.arc(0,0,n,0,ia)}},sa=(Math.sqrt(1/3),Math.sin(ra/10)/Math.sin(7*ra/10)),ca=(Math.sin(ia/10),Math.cos(ia/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function basis_point(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function basis_Basis(e){this._context=e}basis_Basis.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 3:basis_point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function basisClosed_BasisClosed(e){this._context=e}basisClosed_BasisClosed.prototype={areaStart:ca,areaEnd:ca,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function basisOpen_BasisOpen(e){this._context=e}basisOpen_BasisOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function bundle_Bundle(e,t){this._basis=new basis_Basis(e),this._beta=t}bundle_Bundle.prototype={lineStart:function lineStart(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],a=t[0],o=e[n]-i,s=t[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+r*o),this._beta*t[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};(function custom(e){function bundle(t){return 1===e?new basis_Basis(t):new bundle_Bundle(t,e)}return bundle.beta=function(e){return custom(+e)},bundle})(.85);function curve_cardinal_point(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function cardinal_Cardinal(e,t){this._context=e,this._k=(1-t)/6}cardinal_Cardinal.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:curve_cardinal_point(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new cardinal_Cardinal(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function cardinalClosed_CardinalClosed(e,t){this._context=e,this._k=(1-t)/6}cardinalClosed_CardinalClosed.prototype={areaStart:ca,areaEnd:ca,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new cardinalClosed_CardinalClosed(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function cardinalOpen_CardinalOpen(e,t){this._context=e,this._k=(1-t)/6}cardinalOpen_CardinalOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new cardinalOpen_CardinalOpen(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function curve_catmullRom_point(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>na){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>na){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function catmullRom_CatmullRom(e,t){this._context=e,this._alpha=t}catmullRom_CatmullRom.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new catmullRom_CatmullRom(t,e):new cardinal_Cardinal(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function catmullRomClosed_CatmullRomClosed(e,t){this._context=e,this._alpha=t}catmullRomClosed_CatmullRomClosed.prototype={areaStart:ca,areaEnd:ca,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new catmullRomClosed_CatmullRomClosed(t,e):new cardinalClosed_CardinalClosed(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function catmullRomOpen_CatmullRomOpen(e,t){this._context=e,this._alpha=t}catmullRomOpen_CatmullRomOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new catmullRomOpen_CatmullRomOpen(t,e):new cardinalOpen_CardinalOpen(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function linearClosed_LinearClosed(e){this._context=e}linearClosed_LinearClosed.prototype={areaStart:ca,areaEnd:ca,lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){this._point&&this._context.closePath()},point:function point(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function curve_monotone_sign(e){return e<0?-1:1}function monotone_slope3(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(curve_monotone_sign(a)+curve_monotone_sign(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function monotone_slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function curve_monotone_point(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function monotone_MonotoneX(e){this._context=e}function monotone_MonotoneY(e){this._context=new monotone_ReflectContext(e)}function monotone_ReflectContext(e){this._context=e}function natural_Natural(e){this._context=e}function natural_controlPoints(e){var t,n,r=e.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}monotone_MonotoneX.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:curve_monotone_point(this,this._t0,monotone_slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,curve_monotone_point(this,monotone_slope2(this,n=monotone_slope3(this,e,t)),n);break;default:curve_monotone_point(this,this._t0,n=monotone_slope3(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(monotone_MonotoneY.prototype=Object.create(monotone_MonotoneX.prototype)).point=function(e,t){monotone_MonotoneX.prototype.point.call(this,t,e)},monotone_ReflectContext.prototype={moveTo:function moveTo(e,t){this._context.moveTo(t,e)},closePath:function closePath(){this._context.closePath()},lineTo:function lineTo(e,t){this._context.lineTo(t,e)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},natural_Natural.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=[],this._y=[]},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=natural_controlPoints(e),i=natural_controlPoints(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};function step_Step(e,t){this._context=e,this._t=t}step_Step.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=this._y=NaN,this._point=0},lineEnd:function lineEnd(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};function strategy_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function strategy_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var la={millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",month:"%B %Y",year:"%Y"},ua=[["millisecond","second","minute","hour","day","month","year"],[1,1e3,6e4,36e5,864e5,2592e6,31536e6]],fa=function defaultTooltipFormatters(e,t){var n;return(strategy_defineProperty(n={},v.TEMPORAL,function(e,t){var n=function getNearestInterval(e){var t=Xt(ua[1],e);return ua[0][t]}(t);return DateTimeFormatter.formatAs(e,la[n])}),strategy_defineProperty(n,b.MEASURE,function(e){return t(e?e.toFixed(2):e)}),strategy_defineProperty(n,b.DIMENSION,function(e){return e}),n)[e]},ha={keyValue:function keyValue(e,t,n){return function buildTooltipData(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],r=[],i=e.getData(),a=i.data,o=i.schema,s=t.formatters,c=t.separator,l=e.getFieldsConfig(),u=e.getFieldspace(),f=u.fieldsObj(),h=n.dimensionMeasureMap,d=n.axes,_=o.filter(function(e){return e.type===b.DIMENSION}),p=o.filter(function(e){return e.type===b.MEASURE}),y=a.length,g=function getRowContent(e,n){var r=void 0,i=void 0,o=void 0,_=[],p=l[e].index,g=l[e].def.subtype===v.TEMPORAL?f[e].getMinDiff():0,m=s&&s[e]||fa(n,function(e){return e});if(null!==r){var x=n===b.MEASURE?a.map(function(e){return e[p]}):[].concat(strategy_toConsumableArray(new Set(a.map(function(e){return e[p]}))));x=x.filter(function(e){return""!==e});var w=d.color[0],C=d.shape[0],k=d.size[0],S=(w||C||k)&&y>1&&n!==b.MEASURE;x.forEach(function(n,s){var f=void 0,d=h[e];if(d&&d.length&&y>1){f=n;var p={value:""};S&&(p={type:"icon",color:w.getColor(n),shape:C.getShape(n),size:k.getSize(n)*t.iconSize}),d.length>1?(_.push([p,""+$t(f)]),d.forEach(function(e){o=l[e].index,r=a[s][o],i=fa("measure",u.fields[o]._ref.numberFormat())(r,g),_.push([{value:""+$t(e)+c,style:{"margin-left":t.margin+"px}"},className:t.classPrefix+"-tooltip-key"},{value:""+i,className:t.classPrefix+"-tooltip-value"}])})):(o=l[d[0]].index,r=a[s][o],i=fa("measure",u.fields[o]._ref.numberFormat())(r,g),_.push([p,{value:""+$t(f)+c,className:t.classPrefix+"-tooltip-key"},{value:""+i,className:t.classPrefix+"-tooltip-value"}]))}else f=e,i=m(r=n,g),_.push([{value:""+$t(f)+c,className:t.classPrefix+"-tooltip-key"},{value:""+i,className:t.classPrefix+"-tooltip-value"}])})}return _};_.forEach(function(e){var t=e.subtype?e.subtype:e.type;r=[].concat(strategy_toConsumableArray(r),strategy_toConsumableArray(g(e.name,t)))});var m=[].concat(strategy_toConsumableArray(new(Function.prototype.bind.apply(Set,[null].concat(strategy_toConsumableArray(Object.values(h)))))));return(y>1?p.filter(function(e){return-1===m.indexOf(e.name)}):p).forEach(function(e){var t=e.subtype?e.subtype:e.type;r=[].concat(strategy_toConsumableArray(r),strategy_toConsumableArray(g(e.name,t)))}),r}(e,t,n)}},da="keyValue",_a=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var pa=function(){function Content(){!function content_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Content),this._model=null,this._strategy=da,this._formatter=null,this._config=this.constructor.defaultConfig()}return _a(Content,[{key:"config",value:function config(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length>0?(this._config=hn(this._config,t),this):this._config}},{key:"update",value:function update(e){return this._model=e.model,this._strategy=void 0!==e.strategy?e.strategy:da,this._formatter=e.formatter,this}},{key:"context",value:function context(e){return this._context=e,this}},{key:"render",value:function render(e){var t=void 0,n=this._config,r=n.iconContainerSize,i=this._formatter,a=n.rowMargin,o=this._model;if(this._mount=e,(t=o instanceof Array?o:i instanceof Function?i(this._model,this._context):ha[this._strategy](this._model,this.config(),this._context))instanceof Function)e.html(t());else{var s=Er(e,"p",t,n.classPrefix+"-tooltip-row"),c=Er(s,"span",function(e){return e},n.classPrefix+"-tooltip-content");c.attr("class",n.classPrefix+"-tooltip-content"),Nr(s,{margin:a}),Nr(c,{display:"inline-block","margin-right":n.spacing+"px"}),c.each(function(e){var t=Pr(this);if(t.html(""),e instanceof Object)if("icon"===e.type){var n=Er(t,"svg",[1]),i=Er(n,"path",[1]),a=e.shape instanceof Function?e.shape:function(){var e=ta(oa),t=ta(64),n=null;function symbol(){var r;if(n||(n=r=ea()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return symbol.type=function(t){return arguments.length?(e="function"==typeof t?t:ta(t),symbol):e},symbol.size=function(e){return arguments.length?(t="function"==typeof e?e:ta(+e),symbol):t},symbol.context=function(e){return arguments.length?(n=null==e?null:e,symbol):n},symbol}().type(Gt[e.shape]);Or(n,{x:0,y:0,width:r,height:r}),Or(i,{d:a.size(e.size)(),transform:"translate("+r/2+", "+r/2+")"}),Nr(i,{fill:e.color})}else t.html(e.value),e.className&&t.classed(e.className,!0),Nr(t,e.style);else t.html(e)})}return this}},{key:"clear",value:function clear(){return this._model=null,this._mount.remove(),this}}],[{key:"defaultConfig",value:function defaultConfig(){var e=Xi.content;return e.classPrefix=Xi.classPrefix,e}}]),Content}(),ya=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var ga=function(){function Tooltip(e,t){!function tooltip_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Tooltip);var n=t;this._id=Ht(),this._config={},this._container=Pr(e),this._tooltipContainer=this._container.append("div").style("position","absolute"),this._contentContainer=this._tooltipContainer.append("div"),this._tooltipBackground=this._tooltipContainer.append("div"),this._tooltipArrow=this._tooltipContainer.append("div"),t||(n=e.append("svg").style("pointer-events","none")),this.content=new pa,this.config({});var r=this._config;this._tooltipConnectorContainer=Pr(n).append("g").attr("class",r.classPrefix+"-"+r.connectorClassName);var i=this._id,a=r.defClassName,o=Jt(a,i,r.classPrefix);Nr(this._tooltipArrow,Yi),Nr(this._tooltipBackground,Yi),this.addClass(o.join(" ")),this.addClass(r.className),this.hide()}return ya(Tooltip,[{key:"config",value:function config(){if(arguments.length>0){var e=hn({},this.constructor.defaultConfig());this._config=hn(e,arguments.length<=0?void 0:arguments[0]);var t=this._config.content;return t.classPrefix=this._config.classPrefix,this.content.config(t),this}return this._config}},{key:"addClass",value:function addClass(e){return this._tooltipContainer.classed(e,!0),this}},{key:"context",value:function context(){return arguments.length?(this._context=arguments.length<=0?void 0:arguments[0],this.content.context(arguments.length<=0?void 0:arguments[0]),this):this._context}},{key:"data",value:function data(e){if(null===e)return this.hide(),this;var t=this._config.formatter;return this.content.update({model:e,formatter:t}),this.content.render(this._contentContainer),this}},{key:"position",value:function position(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this._data&&0===this._data.length)return this.hide(),this;this.show();var r=this._target,i=n.repositionArrow;if(r&&i){var a=this._tooltipContainer.node(),o=this._config,s=o.arrow.disabled?0:o.arrow.size,c=this._arrowOrientation;if("left"===c||"right"===c?t+a.offsetHeight-s<r.y||t>r.y+r.height:e+a.offsetWidth-s<r.x||e>r.x+r.width){var l=void 0;this._tooltipArrow.style("display","none"),this._tooltipBackground.style("display","none"),this._tooltipConnectorContainer.style("display","block");var u=this._tooltipConnectorContainer.selectAll("path").data([1]),f=u.enter().append("path");"left"===c?l="M "+e+" "+(t+a.offsetHeight/2)+" L "+(r.x+r.width)+(r.y+r.height/2):"right"===c?l="M "+(e+a.offsetWidth)+" "+(t+a.offsetHeight/2)+"L "+r.x+" "+(r.y+r.height/2):"bottom"===c&&(l="M "+(e+a.offsetWidth/2)+" "+(t+a.offsetHeight)+"L "+(r.x+r.width/2)+" "+r.y),f.merge(u).attr("d",l).style("display","block")}else{var h=$i(c,r,{x:e,y:t,boxHeight:a.offsetHeight,boxWidth:a.offsetWidth},this._config);Zi(this,this._arrowOrientation,h),this._tooltipConnectorContainer.style("display","none")}}var d=this._offset||{x:0,y:0};return this._tooltipContainer.style("left",d.x+e+"px").style("top",d.y+t+"px"),this}},{key:"positionRelativeTo",value:function positionRelativeTo(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=void 0,i=n.orientation;this.show();var a=this._extent,o=this._tooltipContainer.node(),s=o.offsetWidth,c=o.offsetHeight,l=this._config,u=l.arrow.disabled,f=l.arrow.size,h=void 0===n.draw||n.draw,d=e.y;this._target=e,i||(i=d>c+f?"vertical":"horizontal"),"horizontal"===i?r=function positionHorizontal(){var n=void 0,r=e.x+e.width,i=e.y,o=a.width-r,l=e.x-a.x;return o>=s?(n="left",r+=f):l>=s?(r=e.x-s,n="right",r-=f):(n="left",r+=f),e.height<c&&(i=Math.max(0,e.y+e.height/2-c/2)),{position:n,arrowPos:$i(n,e,{x:r,y:i,boxHeight:c,boxWidth:s},t._config),x:r,y:i}}():"vertical"===i&&(r=function positionVertical(){var n=void 0,r=e.x-s/2+e.width/2,i=e.y-c-f;a.width-e.x<s?r=a.width-s:r<a.x&&(r=a.x);var o=$i(n,e,{x:r,y:i,boxHeight:c,boxWidth:s},t._config);return{position:n="bottom",arrowPos:o,x:r,y:i}}()),this._position={x:r.x,y:r.y},this._arrowPos=r.arrowPos,u||Zi(this,r.position,r.arrowPos),this._arrowOrientation=r.position,h&&this.position(r.x,r.y)}},{key:"hide",value:function hide(){return this._tooltipContainer.style("display","none"),this._tooltipConnectorContainer.style("display","none"),this}},{key:"show",value:function show(){return this._tooltipContainer.style("display","block"),this}},{key:"extent",value:function extent(e){return this._extent=e,this}},{key:"offset",value:function offset(e){return this._offset=e,this}},{key:"remove",value:function remove(){return this._tooltipContainer.remove(),this._tooltipBackground.remove(),this._tooltipConnectorContainer.remove(),this}}],[{key:"defaultConfig",value:function defaultConfig(){return Xi}}]),Tooltip}(),ma=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var va=function(e){function Tooltip(){var e;!function side_effects_tooltip_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Tooltip);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function tooltip_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=Tooltip.__proto__||Object.getPrototypeOf(Tooltip)).call.apply(e,[this].concat(n)));return i._tooltips={},i}return function tooltip_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Tooltip,Ui),ma(Tooltip,[{key:"apply",value:function apply(e,t){var n=0,r=0,i=e.mergedEnter.model,a=this.drawingContext()();if(t.criteria&&i&&i.isEmpty())return this;if(null===t.criteria||!i)return this.hide(a),this;var o=this._tooltips,s=this.config(),c={width:a.width,height:a.height},l=t.showInPosition,u=s.padding,f=[],h=this.marksFromIdentifiers()(t.criteria),d=this.sourceInf()(),_=""+d.fields.x[0],p=i.getFieldsConfig(),y=!!(p[_]&&p[_].def.type===b.DIMENSION),g=t.position,m=[],v="fragmented"===s.mode,x={};if(v){var w=i.getData().uids;f.push.apply(f,function tooltip_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(w.map(function(e){return i.select(function(t,n){return n===e},{saveChild:!1})})))}else f.push(i);for(var C=0;C<f.length;C++){var k=f[C];x[C]=!0;var S=o[C]=o[C]||new ga(a.htmlContainer,a.svgContainer);S.context(d);var M=h[C];if(S.data(k).config(this.config()).extent({x:0,y:0,width:a.width,height:a.height}),l)S.position(g.x+u,g.y+u);else{if(!M){S.hide();break}S.positionRelativeTo({x:M.x+a.xOffset,y:M.y+a.yOffset,width:M.width||0,height:M.height||0},{orientation:v?y?"horizontal":"vertical":void 0})}if(v){var P=S._position,E=S._tooltipContainer.node().getBoundingClientRect();if(n+=E.height+u,r+=E.width+u,y?n>a.height:r>a.width)break;m.push({x:P.x,y:P.y,width:E.width,height:E.height,tooltip:S})}}for(var T in o)T in x||(o[T].remove(),delete o[T]);return v&&(!function spaceOutBoxes(e,t,n){var r=void 0,i=void 0,a=void 0,o=void 0,s=void 0,c=e.length,l=function spaceOutIfOverlap(e,t,s){a=e.x,o=e.width,r=e.y,i=e.height;var c=r+i,l=a+o;n?(s?r<t.y+t.height:c>t.y)&&(t.y=s?e.y-t.height-5:c+5):(s?a<t.x+t.width:l>t.x)&&(t.x=s?e.x-t.width-5:l+5)};for(e.sort(function(e,t){return n?e.y-t.y:e.x-t.x}),s=0,s=0;s<c-1;s++)l(e[s],e[s+1]);if(e[s].y+e[s].height>t.height||e[s].x+e[s].width>t.width)for(n?e[s].y-=e[s].height+e[s].y-t.height:e[s].x-=e[s].width+e[s].x-t.width,s=c-1;s>0;s--)l(e[s],e[s-1],!0)}(m,c,y),m.forEach(function(e){return e.tooltip.position(e.x,e.y,{repositionArrow:!0})})),this}},{key:"hide",value:function hide(){var e=this._tooltips;for(var t in e)({}).hasOwnProperty.call(e,t)&&e[t].hide()}}],[{key:"defaultConfig",value:function defaultConfig(){return{padding:5}}},{key:"formalName",value:function formalName(){return"tooltip"}}]),Tooltip}(),ba=(n(11),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());function crossline_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var xa=function(e){function Crossline(){return function crossline_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Crossline),function crossline_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Crossline.__proto__||Object.getPrototypeOf(Crossline)).apply(this,arguments))}return function crossline_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Crossline,Ui),ba(Crossline,[{key:"apply",value:function apply(e,t){var n=this,r=void 0,i=void 0,a=void 0,o=void 0,s=this.config(),c=s.className,l=s.bandClass,u=s.lineClass,f=e.mergedEnter.model,h=this.drawingContext()();if(t.criteria&&f&&f.isEmpty())return this;if(null===t.criteria||!f)return this.hide(),this;var d=f.getData(),_=this.sourceInf()(),p=_.axes,y=_.fields,g=e.fields,m=d.data,v=f.getFieldsConfig(),x=h.sideEffectGroup,w=[];if(g.forEach(function(e){var t=v[e]&&v[e].index,s=m.map(function(e){return e[t]}),c=[["x",0],["x",1],["y",0],["y",1]].find(function(t){var n=y[t[0]][t[1]];return n&&n.type()===b.DIMENSION&&-1!==n.getMembers().indexOf(e)});if(void 0!==c&&m.length){var f=c[0],d=p[f][c[1]],_=s[0];i=d.getUnitWidth()||0,a=d.getScaleValue(_)+i/2+h.xOffset;var g=Math.max.apply(Math,crossline_toConsumableArray(n.firebolt.context.layers().map(function(e){return e.getPlotSpan()[f]}))),x=Math.max.apply(Math,crossline_toConsumableArray(n.firebolt.context.layers().map(function(e){return e.getPlotPadding()[f]})));r=h.height,o=h.width;var C=a-g/2-x/2,k=a+g/2+x/2,S={};S.d="y"===f?"M 0 "+C+" L 0 "+k+" L "+o+" "+k+" L "+o+" "+C+" Z":"M "+C+" 0 L "+k+" 0 L "+k+" "+r+" L "+C+" "+r+" Z",S.className=g?l:u,w.push(S)}}),w.length){var C=this.createElement(x,"g",[1],c);this.createElement(C,"path",w).attr("d",function(e){return e.d}).style("pointer-events","none").attr("class",function(e){return e.className})}return this}},{key:"hide",value:function hide(){var e=this.config().className,t=this.drawingContext()();Pr(t.sideEffectGroup).selectAll("."+e).remove()}}],[{key:"defaultConfig",value:function defaultConfig(){return{className:"muze-crossline-group",bandClass:"muze-crossband",lineClass:"muze-crossline"}}},{key:"formalName",value:function formalName(){return"crossline"}}]),Crossline}(),wa={fade:function fade(e,t){var n=e.mergedEnter,r=e.mergedExit,i=e.exitSet,a=e.completeSet;n.length||r.length?(t.fadeOutSelection(i[1]),t.unfadeSelection(n)):t.unfadeSelection(a)},focus:function focus(e,t){var n=e.mergedEnter,r=e.mergedExit,i=e.completeSet;n.length||r.length?(t.focusOutSelection(r),t.focusSelection(n)):t.focusSelection(i)},highlight:function highlight(e,t){var n=e.mergedEnter,r=e.mergedExit,i=e.entrySet,a=e.exitSet,o=e.completeSet;n.length||r.length?(t.highlightPoint(i[1]),t.dehighlightPoint(a[1])):t.dehighlightPoint(o)}},Ca=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var ka=function(e){function PlotHighlighter(){var e;!function plot_highlighter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PlotHighlighter);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function plot_highlighter_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=PlotHighlighter.__proto__||Object.getPrototypeOf(PlotHighlighter)).call.apply(e,[this].concat(n)));return i._strategy="highlight",i}return function plot_highlighter_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(PlotHighlighter,Bi),Ca(PlotHighlighter,[{key:"setStrategy",value:function setStrategy(e){return this._strategy=e,this}},{key:"apply",value:function apply(e,t,n){var r=wa[n||this._strategy];return!1!==e.isSourceFieldPresent&&r(e,this),this}}],[{key:"formalName",value:function formalName(){return"highlighter"}},{key:"target",value:function target(){return"visual-unit"}}]),PlotHighlighter}(),Sa=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Ma=function(e){function FilterEffect(){return function side_effects_filter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FilterEffect),function side_effects_filter_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(FilterEffect.__proto__||Object.getPrototypeOf(FilterEffect)).apply(this,arguments))}return function side_effects_filter_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(FilterEffect,Bi),Sa(FilterEffect,[{key:"apply",value:function apply(e,t){var n=this.firebolt.context,r=e.mergedEnter.model;return null===t.criteria?n.clearCaching().resetData():n.enableCaching().data(r),this}}],[{key:"formalName",value:function formalName(){return"filter"}},{key:"target",value:function target(){return"visual-unit"}},{key:"mutates",value:function mutates(){return!0}}]),FilterEffect}(),Pa=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function anchors_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Ea=function(e){function AnchorEffect(){var e;!function anchors_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AnchorEffect);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function anchors_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=AnchorEffect.__proto__||Object.getPrototypeOf(AnchorEffect)).call.apply(e,[this].concat(n))),a=i.firebolt.context;return i._layers=i.addAnchorLayers(a),i}return function anchors_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(AnchorEffect,Ui),Pa(AnchorEffect,[{key:"addAnchorLayers",value:function addAnchorLayers(e){var t=this,n=[];return this.firebolt.context.layers().forEach(function(r,i){if(r.shouldDrawAnchors()){var a=r.encodingFieldsInf(),o=r.config();n=[].concat(anchors_toConsumableArray(n),anchors_toConsumableArray(e.addLayer({name:r.alias()+"-this.constructor.formalName()-"+i,mark:"point",encoding:{x:a.xField,y:a.yField,color:a.colorField,size:{value:t.defaultSizeValue()}},transform:o.transform,transition:t.getTransitionConfig(),calculateDomain:!1,dataSource:function dataSource(e){return e.select(function(){return!1})},interactive:!1})))}}),n}},{key:"getTransitionConfig",value:function getTransitionConfig(){return{disabled:!0}}},{key:"defaultSizeValue",value:function defaultSizeValue(){return 100}},{key:"apply",value:function apply(e){var t=e.mergedEnter.model,n=this.drawingContext()().sideEffectGroup,r=this.config().className,i=this.createElement(n,"g",this._layers.map(function(e){return e.id()}),r),a=this._layers;return i.each(function(e,n){a[n].data(t).mount(this)}),this}}],[{key:"target",value:function target(){return"visual-unit"}},{key:"defaultConfig",value:function defaultConfig(){return{className:"muze-anchors-group"}}},{key:"formalName",value:function formalName(){return"anchors"}}]),AnchorEffect}(),Ta=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Aa,Oa=function(e){function PersistentAnchors(){return function persistent_anchors_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PersistentAnchors),function persistent_anchors_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(PersistentAnchors.__proto__||Object.getPrototypeOf(PersistentAnchors)).apply(this,arguments))}return function persistent_anchors_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(PersistentAnchors,Ea),Ta(PersistentAnchors,[{key:"getTransitionConfig",value:function getTransitionConfig(){return{disabled:!0}}}],[{key:"formalName",value:function formalName(){return"persistent-anchors"}},{key:"defaultConfig",value:function defaultConfig(){return{className:"muze-persistent-anchors"}}}]),PersistentAnchors}();function behaviour_effect_map_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Na=(behaviour_effect_map_defineProperty(Aa={},li,["selectionBox",{name:"highlighter",strategy:"fade"}]),behaviour_effect_map_defineProperty(Aa,ui,[{name:"highlighter",strategy:"highlight"},"crossline","tooltip","anchors"]),behaviour_effect_map_defineProperty(Aa,hi,["filter"]),behaviour_effect_map_defineProperty(Aa,di,[{name:"highlighter",strategy:"focus"},"persistent-anchors"]),Aa),Ra="stack",Fa="angle",Da="radius",La="size",Ia="color",ja="shape",za={X:"x",Y:"y",X0:"x0",Y0:"y0"},Ba={classPrefix:"muze",defClassName:"layer-area",className:"",interpolate:"linear",transform:{type:Ra},nearestPointThreshold:10,encoding:{color:{},x:{},y:{},y0:{},strokeOpacity:{value:1}},transition:{effect:"cubic",duration:1e3},connectNullData:!1,states:{highlight:{className:"layer-area-highlight"},fadeout:{className:"layer-area-fadeout"},selected:{className:"layer-area-selected"}}},Ha=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Ua=function(){function SimpleLayer(){!function simple_layer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SimpleLayer)}return Ha(SimpleLayer,[{key:"formalName",value:function formalName(){throw new Error(ln.INTERFACE_IMPL)}},{key:"dependencies",value:function dependencies(){throw new Error(ln.INTERFACE_IMPL)}},{key:"config",value:function config(){throw new Error(ln.INTERFACE_IMPL)}},{key:"data",value:function data(){throw new Error(ln.INTERFACE_IMPL)}},{key:"serialize",value:function serialize(){throw new Error(ln.INTERFACE_IMPL)}},{key:"id",value:function id(){throw new Error(ln.INTERFACE_IMPL)}},{key:"normalizeTransformedData",value:function normalizeTransformedData(){throw new Error(ln.INTERFACE_IMPL)}},{key:"getTransformedData",value:function getTransformedData(){throw new Error(ln.INTERFACE_IMPL)}},{key:"_calculateDomainFromData",value:function _calculateDomainFromData(){throw new Error(ln.INTERFACE_IMPL)}},{key:"getDomain",value:function getDomain(){throw new Error(ln.INTERFACE_IMPL)}},{key:"getNearestPoint",value:function getNearestPoint(){throw new Error(ln.INTERFACE_IMPL)}},{key:"highlightPoint",value:function highlightPoint(){throw new Error(ln.INTERFACE_IMPL)}},{key:"dehighlightPoint",value:function dehighlightPoint(){return this}},{key:"linkLayerStore",value:function linkLayerStore(){throw new Error(ln.INTERFACE_IMPL)}},{key:"mount",value:function mount(){throw new Error(ln.INTERFACE_IMPL)}},{key:"render",value:function render(){throw new Error(ln.INTERFACE_IMPL)}}]),SimpleLayer}(),Va=Math.PI,qa=2*Va,Wa=qa-1e-6;function src_path_Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function d3_path_src_path_path(){return new src_path_Path}src_path_Path.prototype=d3_path_src_path_path.prototype={constructor:src_path_Path,moveTo:function moveTo(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function lineTo(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function quadraticCurveTo(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function arcTo(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,c=r-t,l=a-e,u=o-t,f=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>1e-6)if(Math.abs(u*s-c*l)>1e-6&&i){var h=n-a,d=r-o,_=s*s+c*c,p=h*h+d*d,y=Math.sqrt(_),g=Math.sqrt(f),m=i*Math.tan((Va-Math.acos((_+f-p)/(2*y*g)))/2),v=m/g,b=m/y;Math.abs(v-1)>1e-6&&(this._+="L"+(e+v*l)+","+(t+v*u)),this._+="A"+i+","+i+",0,0,"+ +(u*h>l*d)+","+(this._x1=e+b*s)+","+(this._y1=t+b*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function arc(e,t,n,r,i,a){e=+e,t=+t;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=e+o,l=t+s,u=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+c+","+l),n&&(f<0&&(f=f%qa+qa),f>Wa?this._+="A"+n+","+n+",0,1,"+u+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=Va)+","+u+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function rect(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function toString(){return this._}};var Ga=function(e){return function constant(){return e}},Ya=(Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt,1e-12),Xa=Math.PI,$a=2*Xa;function curve_linear_Linear(e){this._context=e}curve_linear_Linear.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var Za=function(e){return new curve_linear_Linear(e)};curve_radial_curveRadial(Za);function curve_radial_Radial(e){this._curve=e}function curve_radial_curveRadial(e){function radial(t){return new curve_radial_Radial(e(t))}return radial._curve=e,radial}curve_radial_Radial.prototype={areaStart:function areaStart(){this._curve.areaStart()},areaEnd:function areaEnd(){this._curve.areaEnd()},lineStart:function lineStart(){this._curve.lineStart()},lineEnd:function lineEnd(){this._curve.lineEnd()},point:function point(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};var Ka=Array.prototype.slice;Math.sqrt(1/3);var Ja=Math.sin(Xa/10)/Math.sin(7*Xa/10),Qa=(Math.sin($a/10),Math.cos($a/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function curve_basis_point(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function curve_basis_Basis(e){this._context=e}curve_basis_Basis.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 3:curve_basis_point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function curve_basisClosed_BasisClosed(e){this._context=e}curve_basisClosed_BasisClosed.prototype={areaStart:Qa,areaEnd:Qa,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function curve_basisOpen_BasisOpen(e){this._context=e}curve_basisOpen_BasisOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function curve_bundle_Bundle(e,t){this._basis=new curve_basis_Basis(e),this._beta=t}curve_bundle_Bundle.prototype={lineStart:function lineStart(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],a=t[0],o=e[n]-i,s=t[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+r*o),this._beta*t[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};(function custom(e){function bundle(t){return 1===e?new curve_basis_Basis(t):new curve_bundle_Bundle(t,e)}return bundle.beta=function(e){return custom(+e)},bundle})(.85);function src_curve_cardinal_point(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function curve_cardinal_Cardinal(e,t){this._context=e,this._k=(1-t)/6}curve_cardinal_Cardinal.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:src_curve_cardinal_point(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new curve_cardinal_Cardinal(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function curve_cardinalClosed_CardinalClosed(e,t){this._context=e,this._k=(1-t)/6}curve_cardinalClosed_CardinalClosed.prototype={areaStart:Qa,areaEnd:Qa,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new curve_cardinalClosed_CardinalClosed(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function curve_cardinalOpen_CardinalOpen(e,t){this._context=e,this._k=(1-t)/6}curve_cardinalOpen_CardinalOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new curve_cardinalOpen_CardinalOpen(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function src_curve_catmullRom_point(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>Ya){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>Ya){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function curve_catmullRom_CatmullRom(e,t){this._context=e,this._alpha=t}curve_catmullRom_CatmullRom.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new curve_catmullRom_CatmullRom(t,e):new curve_cardinal_Cardinal(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function curve_catmullRomClosed_CatmullRomClosed(e,t){this._context=e,this._alpha=t}curve_catmullRomClosed_CatmullRomClosed.prototype={areaStart:Qa,areaEnd:Qa,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new curve_catmullRomClosed_CatmullRomClosed(t,e):new curve_cardinalClosed_CardinalClosed(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function curve_catmullRomOpen_CatmullRomOpen(e,t){this._context=e,this._alpha=t}curve_catmullRomOpen_CatmullRomOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new curve_catmullRomOpen_CatmullRomOpen(t,e):new curve_cardinalOpen_CardinalOpen(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function curve_linearClosed_LinearClosed(e){this._context=e}curve_linearClosed_LinearClosed.prototype={areaStart:Qa,areaEnd:Qa,lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){this._point&&this._context.closePath()},point:function point(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function src_curve_monotone_sign(e){return e<0?-1:1}function curve_monotone_slope3(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(src_curve_monotone_sign(a)+src_curve_monotone_sign(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function curve_monotone_slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function src_curve_monotone_point(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function curve_monotone_MonotoneX(e){this._context=e}function curve_monotone_MonotoneY(e){this._context=new curve_monotone_ReflectContext(e)}function curve_monotone_ReflectContext(e){this._context=e}function curve_natural_Natural(e){this._context=e}function curve_natural_controlPoints(e){var t,n,r=e.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}curve_monotone_MonotoneX.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:src_curve_monotone_point(this,this._t0,curve_monotone_slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,src_curve_monotone_point(this,curve_monotone_slope2(this,n=curve_monotone_slope3(this,e,t)),n);break;default:src_curve_monotone_point(this,this._t0,n=curve_monotone_slope3(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(curve_monotone_MonotoneY.prototype=Object.create(curve_monotone_MonotoneX.prototype)).point=function(e,t){curve_monotone_MonotoneX.prototype.point.call(this,t,e)},curve_monotone_ReflectContext.prototype={moveTo:function moveTo(e,t){this._context.moveTo(t,e)},closePath:function closePath(){this._context.closePath()},lineTo:function lineTo(e,t){this._context.lineTo(t,e)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},curve_natural_Natural.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=[],this._y=[]},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=curve_natural_controlPoints(e),i=curve_natural_controlPoints(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};function curve_step_Step(e,t){this._context=e,this._t=t}curve_step_Step.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=this._y=NaN,this._point=0},lineEnd:function lineEnd(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var eo=function(e,t){if((i=e.length)>1)for(var n,r,i,a=1,o=e[t[0]],s=o.length;a<i;++a)for(r=o,o=e[t[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},to=function(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n};function src_stack_stackValue(e,t){return e[t]}var no=function(e){var t=e.map(src_order_ascending_sum);return to(e).sort(function(e,n){return t[e]-t[n]})};function src_order_ascending_sum(e){for(var t,n=0,r=-1,i=e.length;++r<i;)(t=+e[r][1])&&(n+=t);return n}function map_Map(){}function map_map(e,t){var n=new map_Map;if(e instanceof map_Map)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var r,i=-1,a=e.length;if(null==t)for(;++i<a;)n.set(i,e[i]);else for(;++i<a;)n.set(t(r=e[i],i,e),r)}else if(e)for(var o in e)n.set(o,e[o]);return n}map_Map.prototype=map_map.prototype={constructor:map_Map,has:function has(e){return"$"+e in this},get:function get(e){return this["$"+e]},set:function set(e,t){return this["$"+e]=t,this},remove:function remove(e){var t="$"+e;return t in this&&delete this[t]},clear:function clear(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function keys(){var keys=[];for(var e in this)"$"===e[0]&&keys.push(e.slice(1));return keys},values:function values(){var values=[];for(var e in this)"$"===e[0]&&values.push(this[e]);return values},entries:function entries(){var entries=[];for(var e in this)"$"===e[0]&&entries.push({key:e.slice(1),value:this[e]});return entries},size:function size(){var size=0;for(var e in this)"$"===e[0]&&++size;return size},empty:function empty(){for(var e in this)if("$"===e[0])return!1;return!0},each:function each(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var ro=map_map,io=function(){var e,t,n,r=[],i=[];function apply(n,i,a,o){if(i>=r.length)return null!=e&&n.sort(e),null!=t?t(n):n;for(var s,c,l,u=-1,f=n.length,h=r[i++],d=ro(),_=a();++u<f;)(l=d.get(s=h(c=n[u])+""))?l.push(c):d.set(s,[c]);return d.each(function(e,t){o(_,t,apply(e,i,a,o))}),_}return n={object:function object(e){return apply(e,0,createObject,setObject)},map:function map(e){return apply(e,0,createMap,setMap)},entries:function entries(e){return function _entries(e,n){if(++n>r.length)return e;var a,o=i[n-1];return null!=t&&n>=r.length?a=e.entries():(a=[],e.each(function(e,t){a.push({key:t,values:_entries(e,n)})})),null!=o?a.sort(function(e,t){return o(e.key,t.key)}):a}(apply(e,0,createMap,setMap),0)},key:function key(e){return r.push(e),n},sortKeys:function sortKeys(e){return i[r.length-1]=e,n},sortValues:function sortValues(t){return e=t,n},rollup:function rollup(e){return t=e,n}}};function createObject(){return{}}function setObject(e,t,n){e[t]=n}function createMap(){return ro()}function setMap(e,t,n){e.set(t,n)}function set_Set(){}var ao=ro.prototype;function set_set(e,t){var n=new set_Set;if(e instanceof set_Set)e.each(function(e){n.add(e)});else if(e){var r=-1,i=e.length;if(null==t)for(;++r<i;)n.add(e[r]);else for(;++r<i;)n.add(t(e[r],r,e))}return n}set_Set.prototype=set_set.prototype={constructor:set_Set,has:ao.has,add:function add(e){return this["$"+(e+="")]=e,this},remove:ao.remove,clear:ao.clear,values:ao.keys,size:ao.size,empty:ao.empty,each:ao.each};var oo,so;function utils_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var co=(utils_defineProperty(oo={},"none",to),utils_defineProperty(oo,"ascending",no),utils_defineProperty(oo,"descending",function(e){return no(e).reverse()}),oo),lo=(utils_defineProperty(so={},"diverging",function(e,t){if((s=e.length)>1)for(var n,r,i,a,o,s,c=0,l=e[t[0]].length;c<l;++c)for(a=o=0,n=0;n<s;++n)(i=(r=e[t[n]][c])[1]-r[0])>=0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):r[0]=a}),utils_defineProperty(so,"diverging",eo),utils_defineProperty(so,"expand",function(e,t){if((r=e.length)>0){for(var n,r,i,a=0,o=e[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=e[n][a][1]||0;if(i)for(n=0;n<r;++n)e[n][a][1]/=i}eo(e,t)}}),utils_defineProperty(so,"wiggle",function(e,t){if((i=e.length)>0&&(r=(n=e[t[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,c=0,l=0;s<i;++s){for(var u=e[t[s]],f=u[o][1]||0,h=(f-(u[o-1][1]||0))/2,d=0;d<s;++d){var _=e[t[d]];h+=(_[o][1]||0)-(_[o-1][1]||0)}c+=f,l+=h*f}n[o-1][1]+=n[o-1][0]=a,c&&(a-=l/c)}n[o-1][1]+=n[o-1][0]=a,eo(e,t)}}),so),uo=function stack(e){return function(){var e=Ga([]),t=to,n=eo,r=src_stack_stackValue;function stack(i){var a,o,s=e.apply(this,arguments),c=i.length,l=s.length,u=new Array(l);for(a=0;a<l;++a){for(var f,h=s[a],d=u[a]=new Array(c),_=0;_<c;++_)d[_]=f=[0,+r(i[_],h,_,i)],f.data=i[_];d.key=h}for(a=0,o=t(u);a<l;++a)u[o[a]].index=a;return n(u,o),u}return stack.keys=function(t){return arguments.length?(e="function"==typeof t?t:Ga(Ka.call(t)),stack):e},stack.value=function(e){return arguments.length?(r="function"==typeof e?e:Ga(+e),stack):r},stack.order=function(e){return arguments.length?(t=null==e?to:"function"==typeof e?e:Ga(Ka.call(e)),stack):t},stack.offset=function(e){return arguments.length?(n=null==e?eo:e,stack):n},stack}().keys(e.keys).offset(lo[e.offset]).order(co[e.order])(e.data)},fo=function(e,t,n){var r=n.groupBy instanceof Array?n.groupBy:[n.groupBy],i=r.map(function(t){return e.findIndex(function(e){return e.name===t})});if(void 0!==i.find(function(e){return-1===e}))throw new Error("Groupby field "+r+" not found in schema");return function nestCollection(e){var t=io();return e.keys.forEach(function(e){return t.key(function(t){return t[e]})}),t.entries(e.data)}({keys:i,data:t})};var ho;function transform_factory_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _o=(transform_factory_defineProperty(ho={},"identity",function identityTransform(e,t,n){return t}),transform_factory_defineProperty(ho,"fracture",function(e,t,n){var r=n.keys,i=n.breaks,a=function maskAndReduce(e){return function(t){return t.map(function(t){return e[t]})}},o=e.map(function(e){return-1!==r.indexOf(e.name)}).reduce(function(e,t,n){return t?e.concat(n):e},[]),s=e.map(function(e){return-1!==i.indexOf(e.name)}).reduce(function(e,t,n){return t?e.concat(n):e},[]).map(function(e){return o.slice(0).concat(e).sort()}),c=s.map(a(t));return[s.map(a(e)),c]}),transform_factory_defineProperty(ho,"group",fo),transform_factory_defineProperty(ho,"stack",function(e,t,n){var r=n.uniqueField,i=n.value,a=n.groupBy,o=n.sort||"descending",s=function normalizeData(e,t,n,r,i){var a=fo(t,e,{groupBy:r}),o=t.findIndex(function(e){return e.name===r}),s=t.findIndex(function(e){return e.name===n}),c=t.findIndex(function(e){return e.name===i}),l=e.map(function(e){return e[c]}).filter(function(e,t,n){return n.indexOf(e)===t}).sort(),u=t.reduce(function(e,t,n){return e[n]=t.name,e},{});return{data:a.map(function(e){var t={},n=e.values.reduce(function(e,n){return e=n.reduce(function(e,r,i){return i===c?(e[r]=n[s],t[r]=n):i!==s&&(e[u[i]]=r),e},e)},{});return n._tuple=t,l.forEach(function(t){if(void 0===n[t]){n[t]=0;var r=new Array(e.values[0].length);r[o]=e.key,r[c]=t,n._tuple[t]=r}}),n}),keys:l}}(t,e,i,r,a),c=uo({keys:s.keys,offset:n.offset||"diverging",order:o,data:s.data});return c.forEach(function(e){e.forEach(function(t){t.data=t.data._tuple[e.key]})}),c}),ho);var po=function transformFactory(e){var t=_o[e];if("function"!=typeof t)throw new Error("Invalid transform type supplied.");return t},yo=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();var go,mo=function getLayerColor(e,t){var n=e.datum,r=e.index,i=t.colorEncoding,a=t.colorAxis,o=t.colorFieldIndex,s="",c="";return i&&i.value instanceof Function?(c=i.value(n,r),s=i.value(n,r)):(s=a.getRawColor(n._data[o]),c=a.getHslString(s)),{color:c,rawColor:s}},vo=function transfromColor(e,t,n,r){t.meta.stateColor[n]=t.meta.stateColor[n]||t.meta.originalColor;var i=e.transformColor(t.meta.stateColor[n],r);return t.meta.stateColor[n]=i.hsla,i},bo=function applyInteractionStyle(e,t,n,r){var i=e.getPlotElementsFromSet(t),a=e.axes().color,o=r.apply;r.interaction[n].forEach(function(e){var t=e.type;i.style(t,function(r){var i=r.meta,s=i.colorTransform,c=i.stateColor,l=i.originalColor;if(s[n]=s[n]||{},o&&!s[n][t])return s[n][t]=e.intensity,vo(a,r,t,e.intensity).color;if(!o&&s[n][t])return s[n][t]=null,vo(a,r,t,e.intensity.map(function(e){return-e})).color;var u=c[t]?c[t]:l,f=yo(u,4);return"hsla("+360*f[0]+","+100*f[1]+"%,"+100*f[2]+"%, "+(f[3]||1)+")"})})},xo=function fadeUnfadeSelection(e,t,n,r){bo(e,t,"fade",{interaction:r,apply:n})},wo=function focusUnfocusSelection(e,t,n,r){bo(e,t,"focus",{interaction:r,apply:n})},Co=function getAxesScales(e){var t=[za.X,za.Y].map(function(t){return e[t]}),n=yo(t,2),r=n[0],i=n[1],a=[r,i].map(function(e){return e&&e.scale()}),o=yo(a,2);return{xAxis:r,yAxis:i,xScale:o[0],yScale:o[1]}},ko=function attachDataToVoronoi(e,t){var n;e.data((n=[]).concat.apply(n,function helpers_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t)).filter(function(e){return void 0!==e._id}).map(function(e){var t=e.update;return{x:t.x,y:t.y,data:e}}))},So=function updateStyle(e,t,n){for(var r in t)({}).hasOwnProperty.call(t,r)&&e.style(r,n?null:t[r])},Mo=function positionPoints(e,t){var n=e.config().positioner;return n?n(t,e.linkLayerStore(),{smartLabel:e._dependencies.smartLabel}):t},Po=function listenerMap(e){return[{props:["transformedData"],listener:function listener(t){return t("data","config",function(t,n){var r=t.value,i=n.value,a=i&&i.encoding;if(r&&a){var o=r.getFieldsConfig(),s=function getEncodingFieldInf(e,t){var n=[za.X,za.Y,za.X0,za.Y0,Ia,ja,La].map(function(t){return e[t]&&e[t].field}),r=yo(n,7),i=r[0],a=r[1],o=r[2],s=r[3],c=r[4],l=r[5],u=r[6],f=[i,a,o,s].map(function(e){return t[e]&&t[e].def.type}),h=yo(f,2),d=h[0],_=h[1],p=[i,a].map(function(e){return t[e]&&(t[e].def.subtype||t[e].def.type)}),y=yo(p,2),g=y[0],m=y[1],v=[i,a,o,s].map(function(e){return t[e]&&t[e].index}),b=yo(v,4);return{xField:i,yField:a,colorField:c,shapeField:l,sizeField:u,x0Field:o,y0Field:s,xFieldType:d,yFieldType:_,xFieldSubType:g,yFieldSubType:m,xFieldIndex:b[0],yFieldIndex:b[1],x0FieldIndex:b[2],y0FieldIndex:b[3]}}(a,o);return e.encodingFieldsInf(s),e.transformType(function getValidTransform(e,t,n){var r=void 0,i=e.transform,a=n.xField,o=n.yField,s=n.xFieldType,c=n.yFieldType,l=i.groupBy,u=t[l]&&t[l].def.type===b.MEASURE;return r=i.type,a&&o&&!u&&l&&(s!==b.DIMENSION||c!==b.DIMENSION)||(r="identity"),r}(i,o,s)),e.getTransformedData(r,i,e.transformType(),s)}return null})},type:"computed"},{props:["normalizedData"],listener:function listener(t){return t("transformedData",function(t){var n=t.value;if(n){var r=e.data().getFieldsConfig();return e.getNormalizedData(n,r)}return null})},type:"computed"},{props:["domain"],listener:function listener(t){return t("normalizedData",function(t){var n=t.value;return n?e.calculateDomainFromData(n,e.encodingFieldsInf(),e.data().getFieldsConfig()):null})},type:"computed"},{props:["mount","data","axes","config"],listener:function listener(t,n,r,i){t[1]&&n[1]&&i[1]&&r[1]&&(e.render(t[1]),e.dependencies().throwback.commit("onlayerdraw",!0))},type:"registerChangeListener"}]};function default_options_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Eo=(default_options_defineProperty(go={},"config",{value:null,meta:{sanitization:function sanitization(e,t,n){var r=n.constructor,i=hn({},r.defaultConfig());return r.defaultPolicy(i,e)}}}),default_options_defineProperty(go,"data",{value:null,meta:{preset:function preset(e,t){t._cacheEnabled?t._cachedData.push(e):t._cachedData=[e]}}}),default_options_defineProperty(go,"mount",{value:null}),default_options_defineProperty(go,"axes",{value:null}),default_options_defineProperty(go,"measurement",{value:null}),go),To=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Ao=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Oo=function(e){function BaseLayer(e,t,n,r){!function base_layer_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BaseLayer);var i=function base_layer_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(BaseLayer.__proto__||Object.getPrototypeOf(BaseLayer)).call(this));return i.store(new nn({DATA:null})),an(i,Eo,i.store().model),i.data(e),i.axes(t),i.config(n),i.dependencies(r),i._points=[],i._cachedData=[],i._id=Ht(),i._measurement={},vn(i,Po),i}return function base_layer_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(BaseLayer,Ua),Ao(BaseLayer,[{key:"store",value:function store(){return arguments.length?(this._store=arguments.length<=0?void 0:arguments[0],this):this._store}},{key:"encodingFieldsInf",value:function encodingFieldsInf(){return arguments.length?(this._encodingFieldsInf=arguments.length<=0?void 0:arguments[0],this):this._encodingFieldsInf}},{key:"alias",value:function alias(){return arguments.length?(this._alias=arguments.length<=0?void 0:arguments[0],this):this._alias||this.constructor.formalName()}},{key:"dependencies",value:function dependencies(){return arguments.length?(this._dependencies=arguments.length<=0?void 0:arguments[0],this):this._dependencies}},{key:"enableCaching",value:function enableCaching(){return this._cacheEnabled=!0,this}},{key:"clearCaching",value:function clearCaching(){return this._cacheEnabled=!1,this.data(this._cachedData[0])}},{key:"serialize",value:function serialize(){return this.config()}},{key:"id",value:function id(){return this._id}},{key:"getTransformedData",value:function getTransformedData(e,t,n,r){return function transformData(e,t,n,r){var i=e.getData({withUid:!0}),a=i.schema,o=t.transform,s=r.xField,c=r.yField,l=r.xFieldType,u=r.yFieldType,f=l===b.MEASURE?c:s;return po(n)(a,i.data,{groupBy:o.groupBy,uniqueField:f,sort:o.sort,offset:o.offset,value:u===b.MEASURE?c:s},i.uids)}(e,t,n,r)}},{key:"calculateDomainFromData",value:function calculateDomainFromData(e){var t={};return this.data().isEmpty()||(t=function calculateDomainFromData(e,t,n){var r=t.xFieldSubType,i=t.yFieldSubType,a=t.xField,o=t.yField,s=t.x0Field,c=t.y0Field,l={},u=za.Y,f=za.X;return a&&(l.x=Wt(e,s||n===Ra?[f,za.X0]:[f,f],r)),o&&(l.y=Wt(e,c||n===Ra?[za.Y0,za.Y]:[u,u],i)),l}(e,this.encodingFieldsInf(),this.transformType())),t}},{key:"shouldDrawAnchors",value:function shouldDrawAnchors(){return!1}},{key:"getDataDomain",value:function getDataDomain(e){var t=this.store().get("domain");return void 0!==e?t[e]||[]:t}},{key:"getNormalizedData",value:function getNormalizedData(e,t){return function getNormalizedData(e,t,n,r){var i="identity"===r?[e]:e,a=n.xFieldType,o=n.xFieldIndex,s=n.yFieldIndex,c=n.x0FieldIndex,l=n.y0FieldIndex,u=Object.keys(t).length;return i.map(function(e){return("group"===r?e.values:e).map(function(e){var t={},n=void 0;if(r===Ra){n=e.data||[];var i=void 0,f=void 0,h=void 0,d=void 0;e[1]>=e[0]?(i=d=e[1],h=f=e[0]):(i=d=e[0],h=f=e[1]),(t=a===b.MEASURE?{x:h,x0:d,y:n[s],y0:n[s]}:{x:n[o],x0:n[o],y:i,y0:f})._data=n,t._id=n[u]}else(t={x:e[o],y:e[s],x0:e[c],y0:e[l]})._data=e,t._id=e[u];return t})})}(e,t,this.encodingFieldsInf(),this.transformType())}},{key:"getNearestPoint",value:function getNearestPoint(){return null}},{key:"highlightPoint",value:function highlightPoint(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPlotElementsFromSet(e),r=this.axes().color;return(t.interaction?t.interaction.highlight:this.config().interaction.highlight).forEach(function(e){var t=e.type;n.style(t,function(n){var i=n.meta,a=i.colorTransform,o=i.stateColor,s=i.originalColor;a.highlight=a.highlight||{},o[t]=o[t]||s;var c=r.transformColor(o[t],e.intensity);return a.highlight[t]=e.intensity,o[t]=c.hsla,c.color})}),this}},{key:"dehighlightPoint",value:function dehighlightPoint(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getPlotElementsFromSet(e),r=this.axes().color;return(t.interaction?t.interaction.highlight:this.config().interaction.highlight).forEach(function(e){var t=e.type;n.style(t,function(n){var i=n.meta,a=i.colorTransform,o=i.stateColor,s=i.originalColor;if(a.highlight=a.highlight||{},a.highlight&&a.highlight[t]){o[t]=o[t]||s;var c=r.transformColor(o[t],e.intensity.map(function(e){return-e}));return o[t]=c.hsla,a.highlight[t]=null,c.color}a.highlight=null;var l=o[t]?o[t]:s,u=To(l,3);return"hsl("+360*u[0]+","+100*u[1]+"%,"+100*u[2]+"%)"})}),this}},{key:"focusOutSelection",value:function focusOutSelection(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).interaction||this.config().interaction;return wo(this,e,!0,t),this}},{key:"focusSelection",value:function focusSelection(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).interaction||this.config().interaction;return wo(this,e,!1,t),this}},{key:"fadeOutSelection",value:function fadeOutSelection(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).interaction||this.config().interaction;return xo(this,e,!0,t),this}},{key:"unfadeSelection",value:function unfadeSelection(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).interaction||this.config().interaction;return xo(this,e,!1,t),this}},{key:"linkLayerStore",value:function linkLayerStore(){return arguments.length?(this._linkedLayerStore=arguments.length<=0?void 0:arguments[0],this):this._linkedLayerStore}},{key:"transformType",value:function transformType(){return arguments.length?(this._transformType=arguments.length<=0?void 0:arguments[0],this):this._transformType}},{key:"render",value:function render(){return this}},{key:"elemType",value:function elemType(){return"g"}},{key:"remove",value:function remove(){return this.store().unsubscribeAll(),Pr(this.mount()).remove(),this}},{key:"cachePoint",value:function cachePoint(e,t){if(null===e)return this;var n=this._pointMap;return!n[e]&&(n[e]=[]),n[e].push(t),this}},{key:"dataProps",value:function dataProps(){return arguments.length?(this._dataProps=arguments.length<=0?void 0:arguments[0],this):this._dataProps}},{key:"getIdentifiersFromData",value:function getIdentifiersFromData(e){var t=this.data().getData().schema,n=this.data().getFieldsConfig(),r=[[],[]],i=this.encodingFieldsInf(),a=i.xFieldType,o=i.yFieldType,s=i.xField,c=i.yField,l=[a,o].map(function(e){return e===b.MEASURE}),u=To(l,2),f=u[0],h=u[1];if(t.forEach(function(t,i){var a=t.name;n[a].def.type===b.DIMENSION&&(r[0].push(a),r[1].push(e[i]))}),f&&h){var d,_,p=n[s].index,y=n[c].index;(d=r[0]).push.apply(d,[s,c]),(_=r[1]).push.apply(_,[e[p],e[y]])}return r}},{key:"getPlotSpan",value:function getPlotSpan(){return{x:0,y:0}}},{key:"getPlotPadding",value:function getPlotPadding(){return{x:0,y:0}}},{key:"getPointsFromIdentifiers",value:function getPointsFromIdentifiers(e,t){var n;if(!this.data())return[];var r=e[0],i=e.slice(1,e.length),a=this._points,o=this.data().getFieldsConfig(),s=(n=[]).concat.apply(n,function base_layer_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a)).filter(function(e){var t=e._data,n=e._id;return r.every(function(e,r){return e in o?-1!==i.findIndex(function(n){return n[r]===t[o[e].index]}):e===w.ROW_ID&&-1!==i.findIndex(function(e){return e[r]===n})})});return t?s:s.map(function(e){return e.update||e}).sort(function(e,t){return e.y-t.y})}},{key:"getPlotElementsFromSet",value:function getPlotElementsFromSet(e){return Pr(this.mount()).selectAll(this.elemType()).filter(function(t){return-1!==e.indexOf(t._id)})}}],[{key:"create",value:function create(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new(Function.prototype.bind.apply(this,[null].concat(t)))}},{key:"defaultConfig",value:function defaultConfig(){return{transform:{type:"identity"}}}},{key:"defaultPolicy",value:function defaultPolicy(e,t){return hn(e,t)}},{key:"formalName",value:function formalName(){return"base"}}]),BaseLayer}(),No=Math.PI,Ro=2*No,Fo=Ro-1e-6;function d3_path_src_path_Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function node_modules_d3_path_src_path_path(){return new d3_path_src_path_Path}d3_path_src_path_Path.prototype=node_modules_d3_path_src_path_path.prototype={constructor:d3_path_src_path_Path,moveTo:function moveTo(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function lineTo(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function quadraticCurveTo(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function arcTo(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,c=r-t,l=a-e,u=o-t,f=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>1e-6)if(Math.abs(u*s-c*l)>1e-6&&i){var h=n-a,d=r-o,_=s*s+c*c,p=h*h+d*d,y=Math.sqrt(_),g=Math.sqrt(f),m=i*Math.tan((No-Math.acos((_+f-p)/(2*y*g)))/2),v=m/g,b=m/y;Math.abs(v-1)>1e-6&&(this._+="L"+(e+v*l)+","+(t+v*u)),this._+="A"+i+","+i+",0,0,"+ +(u*h>l*d)+","+(this._x1=e+b*s)+","+(this._y1=t+b*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function arc(e,t,n,r,i,a){e=+e,t=+t;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=e+o,l=t+s,u=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+c+","+l),n&&(f<0&&(f=f%Ro+Ro),f>Fo?this._+="A"+n+","+n+",0,1,"+u+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=No)+","+u+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function rect(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function toString(){return this._}};var Do=node_modules_d3_path_src_path_path,Lo=function(e){return function constant(){return e}},Io=Math.abs,jo=Math.atan2,zo=Math.cos,Bo=Math.max,Ho=Math.min,Uo=Math.sin,Vo=Math.sqrt,qo=1e-12,Wo=Math.PI,Go=Wo/2,Yo=2*Wo;function d3_shape_src_math_asin(e){return e>=1?Go:e<=-1?-Go:Math.asin(e)}function d3_shape_src_arc_arcInnerRadius(e){return e.innerRadius}function d3_shape_src_arc_arcOuterRadius(e){return e.outerRadius}function d3_shape_src_arc_arcStartAngle(e){return e.startAngle}function d3_shape_src_arc_arcEndAngle(e){return e.endAngle}function d3_shape_src_arc_arcPadAngle(e){return e&&e.padAngle}function d3_shape_src_arc_cornerTangents(e,t,n,r,i,a,o){var s=e-n,c=t-r,l=(o?a:-a)/Vo(s*s+c*c),u=l*c,f=-l*s,h=e+u,d=t+f,_=n+u,p=r+f,y=(h+_)/2,g=(d+p)/2,m=_-h,v=p-d,b=m*m+v*v,x=i-a,w=h*p-_*d,C=(v<0?-1:1)*Vo(Bo(0,x*x*b-w*w)),k=(w*v-m*C)/b,S=(-w*m-v*C)/b,M=(w*v+m*C)/b,P=(-w*m+v*C)/b,E=k-y,T=S-g,A=M-y,O=P-g;return E*E+T*T>A*A+O*O&&(k=M,S=P),{cx:k,cy:S,x01:-u,y01:-f,x11:k*(i/x-1),y11:S*(i/x-1)}}var Xo=function(){var e=d3_shape_src_arc_arcInnerRadius,t=d3_shape_src_arc_arcOuterRadius,n=Lo(0),r=null,i=d3_shape_src_arc_arcStartAngle,a=d3_shape_src_arc_arcEndAngle,o=d3_shape_src_arc_arcPadAngle,s=null;function arc(){var c,l,u=+e.apply(this,arguments),f=+t.apply(this,arguments),h=i.apply(this,arguments)-Go,d=a.apply(this,arguments)-Go,_=Io(d-h),p=d>h;if(s||(s=c=Do()),f<u&&(l=f,f=u,u=l),f>qo)if(_>Yo-qo)s.moveTo(f*zo(h),f*Uo(h)),s.arc(0,0,f,h,d,!p),u>qo&&(s.moveTo(u*zo(d),u*Uo(d)),s.arc(0,0,u,d,h,p));else{var y,g,m=h,v=d,b=h,x=d,w=_,C=_,k=o.apply(this,arguments)/2,S=k>qo&&(r?+r.apply(this,arguments):Vo(u*u+f*f)),M=Ho(Io(f-u)/2,+n.apply(this,arguments)),P=M,E=M;if(S>qo){var T=d3_shape_src_math_asin(S/u*Uo(k)),A=d3_shape_src_math_asin(S/f*Uo(k));(w-=2*T)>qo?(b+=T*=p?1:-1,x-=T):(w=0,b=x=(h+d)/2),(C-=2*A)>qo?(m+=A*=p?1:-1,v-=A):(C=0,m=v=(h+d)/2)}var O=f*zo(m),N=f*Uo(m),R=u*zo(x),F=u*Uo(x);if(M>qo){var D=f*zo(v),L=f*Uo(v),I=u*zo(b),j=u*Uo(b);if(_<Wo){var z=w>qo?function d3_shape_src_arc_intersect(e,t,n,r,i,a,o,s){var c=n-e,l=r-t,u=o-i,f=s-a,h=(u*(t-a)-f*(e-i))/(f*c-u*l);return[e+h*c,t+h*l]}(O,N,I,j,D,L,R,F):[R,F],B=O-z[0],H=N-z[1],U=D-z[0],V=L-z[1],q=1/Uo(function d3_shape_src_math_acos(e){return e>1?0:e<-1?Wo:Math.acos(e)}((B*U+H*V)/(Vo(B*B+H*H)*Vo(U*U+V*V)))/2),W=Vo(z[0]*z[0]+z[1]*z[1]);P=Ho(M,(u-W)/(q-1)),E=Ho(M,(f-W)/(q+1))}}C>qo?E>qo?(y=d3_shape_src_arc_cornerTangents(I,j,O,N,f,E,p),g=d3_shape_src_arc_cornerTangents(D,L,R,F,f,E,p),s.moveTo(y.cx+y.x01,y.cy+y.y01),E<M?s.arc(y.cx,y.cy,E,jo(y.y01,y.x01),jo(g.y01,g.x01),!p):(s.arc(y.cx,y.cy,E,jo(y.y01,y.x01),jo(y.y11,y.x11),!p),s.arc(0,0,f,jo(y.cy+y.y11,y.cx+y.x11),jo(g.cy+g.y11,g.cx+g.x11),!p),s.arc(g.cx,g.cy,E,jo(g.y11,g.x11),jo(g.y01,g.x01),!p))):(s.moveTo(O,N),s.arc(0,0,f,m,v,!p)):s.moveTo(O,N),u>qo&&w>qo?P>qo?(y=d3_shape_src_arc_cornerTangents(R,F,D,L,u,-P,p),g=d3_shape_src_arc_cornerTangents(O,N,I,j,u,-P,p),s.lineTo(y.cx+y.x01,y.cy+y.y01),P<M?s.arc(y.cx,y.cy,P,jo(y.y01,y.x01),jo(g.y01,g.x01),!p):(s.arc(y.cx,y.cy,P,jo(y.y01,y.x01),jo(y.y11,y.x11),!p),s.arc(0,0,u,jo(y.cy+y.y11,y.cx+y.x11),jo(g.cy+g.y11,g.cx+g.x11),p),s.arc(g.cx,g.cy,P,jo(g.y11,g.x11),jo(g.y01,g.x01),!p))):s.arc(0,0,u,x,b,p):s.lineTo(R,F)}else s.moveTo(0,0);if(s.closePath(),c)return s=null,c+""||null}return arc.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-Wo/2;return[zo(r)*n,Uo(r)*n]},arc.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:Lo(+t),arc):e},arc.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:Lo(+e),arc):t},arc.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:Lo(+e),arc):n},arc.padRadius=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Lo(+e),arc):r},arc.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:Lo(+e),arc):i},arc.endAngle=function(e){return arguments.length?(a="function"==typeof e?e:Lo(+e),arc):a},arc.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:Lo(+e),arc):o},arc.context=function(e){return arguments.length?(s=null==e?null:e,arc):s},arc};function src_curve_linear_Linear(e){this._context=e}src_curve_linear_Linear.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var $o=function(e){return new src_curve_linear_Linear(e)};function visual_layer_node_modules_d3_shape_src_point_x(e){return e[0]}function visual_layer_node_modules_d3_shape_src_point_y(e){return e[1]}var Zo=function(){var e=visual_layer_node_modules_d3_shape_src_point_x,t=visual_layer_node_modules_d3_shape_src_point_y,n=Lo(!0),r=null,i=$o,a=null;function line(o){var s,c,l,u=o.length,f=!1;for(null==r&&(a=i(l=Do())),s=0;s<=u;++s)!(s<u&&n(c=o[s],s,o))===f&&((f=!f)?a.lineStart():a.lineEnd()),f&&a.point(+e(c,s,o),+t(c,s,o));if(l)return a=null,l+""||null}return line.x=function(t){return arguments.length?(e="function"==typeof t?t:Lo(+t),line):e},line.y=function(e){return arguments.length?(t="function"==typeof e?e:Lo(+e),line):t},line.defined=function(e){return arguments.length?(n="function"==typeof e?e:Lo(!!e),line):n},line.curve=function(e){return arguments.length?(i=e,null!=r&&(a=i(r)),line):i},line.context=function(e){return arguments.length?(null==e?r=a=null:a=i(r=e),line):r},line},Ko=function(){var e=visual_layer_node_modules_d3_shape_src_point_x,t=null,n=Lo(0),r=visual_layer_node_modules_d3_shape_src_point_y,i=Lo(!0),a=null,o=$o,s=null;function area(c){var l,u,f,h,d,_=c.length,p=!1,y=new Array(_),g=new Array(_);for(null==a&&(s=o(d=Do())),l=0;l<=_;++l){if(!(l<_&&i(h=c[l],l,c))===p)if(p=!p)u=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),f=l-1;f>=u;--f)s.point(y[f],g[f]);s.lineEnd(),s.areaEnd()}p&&(y[l]=+e(h,l,c),g[l]=+n(h,l,c),s.point(t?+t(h,l,c):y[l],r?+r(h,l,c):g[l]))}if(d)return s=null,d+""||null}function arealine(){return Zo().defined(i).curve(o).context(a)}return area.x=function(n){return arguments.length?(e="function"==typeof n?n:Lo(+n),t=null,area):e},area.x0=function(t){return arguments.length?(e="function"==typeof t?t:Lo(+t),area):e},area.x1=function(e){return arguments.length?(t=null==e?null:"function"==typeof e?e:Lo(+e),area):t},area.y=function(e){return arguments.length?(n="function"==typeof e?e:Lo(+e),r=null,area):n},area.y0=function(e){return arguments.length?(n="function"==typeof e?e:Lo(+e),area):n},area.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:Lo(+e),area):r},area.lineX0=area.lineY0=function(){return arealine().x(e).y(n)},area.lineY1=function(){return arealine().x(e).y(r)},area.lineX1=function(){return arealine().x(t).y(n)},area.defined=function(e){return arguments.length?(i="function"==typeof e?e:Lo(!!e),area):i},area.curve=function(e){return arguments.length?(o=e,null!=a&&(s=o(a)),area):o},area.context=function(e){return arguments.length?(null==e?a=s=null:s=o(a=e),area):a},area},Jo=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},Qo=function(e){return e};src_curve_radial_curveRadial($o);function src_curve_radial_Radial(e){this._curve=e}function src_curve_radial_curveRadial(e){function radial(t){return new src_curve_radial_Radial(e(t))}return radial._curve=e,radial}src_curve_radial_Radial.prototype={areaStart:function areaStart(){this._curve.areaStart()},areaEnd:function areaEnd(){this._curve.areaEnd()},lineStart:function lineStart(){this._curve.lineStart()},lineEnd:function lineEnd(){this._curve.lineEnd()},point:function point(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};Array.prototype.slice;var es={draw:function draw(e,t){var n=Math.sqrt(t/Wo);e.moveTo(n,0),e.arc(0,0,n,0,Yo)}},ts=(Math.sqrt(1/3),Math.sin(Wo/10)/Math.sin(7*Wo/10)),ns=(Math.sin(Yo/10),Math.cos(Yo/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function src_curve_basis_point(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function src_curve_basis_Basis(e){this._context=e}src_curve_basis_Basis.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 3:src_curve_basis_point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function src_curve_basisClosed_BasisClosed(e){this._context=e}src_curve_basisClosed_BasisClosed.prototype={areaStart:ns,areaEnd:ns,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function src_curve_basisOpen_BasisOpen(e){this._context=e}src_curve_basisOpen_BasisOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function src_curve_bundle_Bundle(e,t){this._basis=new src_curve_basis_Basis(e),this._beta=t}src_curve_bundle_Bundle.prototype={lineStart:function lineStart(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],a=t[0],o=e[n]-i,s=t[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+r*o),this._beta*t[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};(function custom(e){function bundle(t){return 1===e?new src_curve_basis_Basis(t):new src_curve_bundle_Bundle(t,e)}return bundle.beta=function(e){return custom(+e)},bundle})(.85);function d3_shape_src_curve_cardinal_point(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function src_curve_cardinal_Cardinal(e,t){this._context=e,this._k=(1-t)/6}src_curve_cardinal_Cardinal.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:d3_shape_src_curve_cardinal_point(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new src_curve_cardinal_Cardinal(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function src_curve_cardinalClosed_CardinalClosed(e,t){this._context=e,this._k=(1-t)/6}src_curve_cardinalClosed_CardinalClosed.prototype={areaStart:ns,areaEnd:ns,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new src_curve_cardinalClosed_CardinalClosed(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function src_curve_cardinalOpen_CardinalOpen(e,t){this._context=e,this._k=(1-t)/6}src_curve_cardinalOpen_CardinalOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new src_curve_cardinalOpen_CardinalOpen(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function d3_shape_src_curve_catmullRom_point(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>qo){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>qo){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function src_curve_catmullRom_CatmullRom(e,t){this._context=e,this._alpha=t}src_curve_catmullRom_CatmullRom.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var rs=function custom(e){function catmullRom(t){return e?new src_curve_catmullRom_CatmullRom(t,e):new src_curve_cardinal_Cardinal(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom}(.5);function src_curve_catmullRomClosed_CatmullRomClosed(e,t){this._context=e,this._alpha=t}src_curve_catmullRomClosed_CatmullRomClosed.prototype={areaStart:ns,areaEnd:ns,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new src_curve_catmullRomClosed_CatmullRomClosed(t,e):new src_curve_cardinalClosed_CardinalClosed(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function src_curve_catmullRomOpen_CatmullRomOpen(e,t){this._context=e,this._alpha=t}src_curve_catmullRomOpen_CatmullRomOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new src_curve_catmullRomOpen_CatmullRomOpen(t,e):new src_curve_cardinalOpen_CardinalOpen(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function src_curve_linearClosed_LinearClosed(e){this._context=e}src_curve_linearClosed_LinearClosed.prototype={areaStart:ns,areaEnd:ns,lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){this._point&&this._context.closePath()},point:function point(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function d3_shape_src_curve_monotone_sign(e){return e<0?-1:1}function src_curve_monotone_slope3(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(d3_shape_src_curve_monotone_sign(a)+d3_shape_src_curve_monotone_sign(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function src_curve_monotone_slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function d3_shape_src_curve_monotone_point(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function src_curve_monotone_MonotoneX(e){this._context=e}function src_curve_monotone_MonotoneY(e){this._context=new src_curve_monotone_ReflectContext(e)}function src_curve_monotone_ReflectContext(e){this._context=e}function src_curve_natural_Natural(e){this._context=e}function src_curve_natural_controlPoints(e){var t,n,r=e.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}src_curve_monotone_MonotoneX.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:d3_shape_src_curve_monotone_point(this,this._t0,src_curve_monotone_slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,d3_shape_src_curve_monotone_point(this,src_curve_monotone_slope2(this,n=src_curve_monotone_slope3(this,e,t)),n);break;default:d3_shape_src_curve_monotone_point(this,this._t0,n=src_curve_monotone_slope3(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(src_curve_monotone_MonotoneY.prototype=Object.create(src_curve_monotone_MonotoneX.prototype)).point=function(e,t){src_curve_monotone_MonotoneX.prototype.point.call(this,t,e)},src_curve_monotone_ReflectContext.prototype={moveTo:function moveTo(e,t){this._context.moveTo(t,e)},closePath:function closePath(){this._context.closePath()},lineTo:function lineTo(e,t){this._context.lineTo(t,e)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},src_curve_natural_Natural.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=[],this._y=[]},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=src_curve_natural_controlPoints(e),i=src_curve_natural_controlPoints(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};function src_curve_step_Step(e,t){this._context=e,this._t=t}src_curve_step_Step.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=this._y=NaN,this._point=0},lineEnd:function lineEnd(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var is={linear:$o,stepAfter:function src_curve_step_stepAfter(e){return new src_curve_step_Step(e,1)},catmullRom:rs,step:function(e){return new src_curve_step_Step(e,.5)},stepBefore:function src_curve_step_stepBefore(e){return new src_curve_step_Step(e,0)}},as=function drawLine(e){var t=void 0,n=e.container,r=e.points,i=e.interpolate,a=e.connectNullData,o=e.className,s=e.style,c=Pr(n).attr("class",o),l=is[i],u=Zo().curve(l).x(function(e){return e.update.x}).y(function(e){return e.update.y}).defined(function(e){return null!==e.update.y});return t=r,a&&(t=r.filter(function(e){return null!==e.update.y})),So(c,s),Er(c,"path",[1]).transition().duration(1e3).attr("d",u(t)).style("fill-opacity",0)},os={classPrefix:"muze",defClassName:"layer-line",className:"",interpolate:"linear",transform:{type:"group"},interaction:{highlight:[{type:"stroke",intensity:[0,-10,-10,0]}],fade:[{type:"stroke",intensity:[0,-30,30,0]}],focus:[{type:"stroke",intensity:[0,-30,30,0]}]},nearestPointThreshold:10,encoding:{color:{},x:{},y:{},strokeOpacity:{value:1}},transition:{effect:"cubic",duration:1e3},connectNullData:!1},ss=(n(13),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var cs=function(e){function LineLayer(){var e;!function line_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LineLayer);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function line_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=LineLayer.__proto__||Object.getPrototypeOf(LineLayer)).call.apply(e,[this].concat(n)));return i._voronoi=new tn,i}return function line_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(LineLayer,Oo),ss(LineLayer,[{key:"elemType",value:function elemType(){return"path"}},{key:"getDrawFn",value:function getDrawFn(){return as}},{key:"highlightPoint",value:function highlightPoint(){return this}},{key:"dehighlightPoint",value:function dehighlightPoint(){return this}},{key:"focusSelection",value:function focusSelection(){return this}},{key:"focusOutSelection",value:function focusOutSelection(){return this}},{key:"fadeOutSelection",value:function fadeOutSelection(){return this}},{key:"unfadeSelection",value:function unfadeSelection(){return this}},{key:"shouldDrawAnchors",value:function shouldDrawAnchors(){return!0}},{key:"translatePoints",value:function translatePoints(e,t,n){var r=this,i=[],a=n.x,o=n.y,s=n.color,c=this.config().encoding,l=t.xFieldType,u=t.yFieldType,f=l===b.DIMENSION,h=u===b.DIMENSION,d=f?za.X:h?za.Y:null,_=c.color,p=_.field,y=this.data().getFieldsConfig(),g=p&&y[p].index,m={},v={};return i=e.map(function(e,t){var n,i=a.getScaleValue(e.x)+a.getUnitWidth()/2,c=o.getScaleValue(e.y),l=mo({datum:e,index:t},{colorEncoding:_,colorAxis:s,colorFieldIndex:g}),u=l.color,f=l.rawColor;return m.stroke=u,m["fill-opacity"]=0,v.stateColor={},v.originalColor=f,v.colorTransform={},n={enter:{},update:{x:i,y:null===e.y?null:c},style:m,_data:e._data,_id:e._id,meta:v},r.cachePoint(e[d],n),n}),i=Mo(this,i)}},{key:"render",value:function render(e){var t=this,n=void 0,r=void 0,i=void 0,a=this.config(),o=a.encoding,s=a.interpolate,c=a.className,l=a.defClassName,u=a.transition,f=this._store,h=f.get("normalizedData"),d=f.get("transformedData"),_=this.data().getFieldsConfig(),p=this.axes(),y=d.map(function(e){return e.key}),g=Jt(l,this.id(),a.classPrefix),m=Pr(e),v=o.color.field,x=_[v]&&_[v].def.type===b.MEASURE;return this._points=[],this._pointMap={},m.classed(g.join(" "),!0),m.classed(c,!0),Er(e,"g",h,null,{enter:function enter(e){!function animateGroup(e,t){var n=void 0,r=void 0,i=t.transition,a=t.groupAnimateStyle,o=i.duration,s=i.effect,c=i.disabled;a&&(Nr(e.node(),a.enter),r=a.update,n=c?e:e.transition().ease(Yt[s]).duration(o).on("end",function(){So(Pr(this),r,!0)}),So(n,r))}(e,{transition:u,groupAnimateStyle:{enter:{"stroke-opacity":0},update:{"stroke-opacity":o.strokeOpacity.value}}})},update:function update(e,o,c){n=t.translatePoints(o,t.encodingFieldsInf(),p,c),t._points.push(n),r=(g[0]+"-"+(y[c]||c)).toLowerCase(),x||(i=n[c].style),t.getDrawFn()({container:e.node(),interpolate:s,points:n,className:r,transition:u,style:i||{},connectNullData:a.connectNullData})}}),ko(this._voronoi,this._points),this}},{key:"getPathStyle",value:function getPathStyle(e){return{stroke:e,"fill-opacity":"0"}}},{key:"getNearestPoint",value:function getNearestPoint(e,t,n){var r=n.searchRadius,i=this.data();if(!i||i&&i.isEmpty())return null;r=void 0!==r?r:this.config().nearestPointThreshold;var a=this._voronoi.find(e,t,r),o=bn(a,"data","data","update");if(a){var s=a.data.data,c=s._data,l=s._id;return{id:this.getIdentifiersFromData(c,l),dimensions:[{x:o.x,y:o.y,width:2,height:2}],layerId:this.id()}}return null}}],[{key:"formalName",value:function formalName(){return"line"}},{key:"defaultConfig",value:function defaultConfig(){return os}},{key:"defaultPolicy",value:function defaultPolicy(e,t){var n=Oo.defaultPolicy(e,t),r=n.encoding,i=n.transform,a=r.color&&r.color.field;return a&&(i.groupBy=a),n}}]),LineLayer}(),ls=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),us={linear:$o,catmullRom:rs},fs=function drawArea(e){var t,n=void 0,r=e.container,i=e.points,a=e.style,o=e.transition,s=e.className,c=e.connectNullData,l=e.interpolate,u=o.effect,f=o.duration,h=Pr(r),d=us[l],_=h.selectAll("path").data([1]),p=["enter","update"].map(function(e){return Ko().curve(d).x(function(t){return t[e].x}).y1(function(t){return t[e].y}).y0(function(t){return t[e].y0}).defined(function(t){return null!==t[e].y})}),y=ls(p,2),g=y[0],m=y[1];n=i,h.attr("class",s),c&&(n=i.filter(function(e){return null!==e.update.y})),t=_.enter().append("path").attr("d",g(n)),_.merge(t).transition().ease(Yt[u]).duration(f).attr("d",m(n)).each(function(){var e=Pr(this);Object.keys(a).forEach(function(t){return e.style(t,a[t])})})},hs=(n(15),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var ds=function(e){function AreaLayer(){return function area_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AreaLayer),function area_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(AreaLayer.__proto__||Object.getPrototypeOf(AreaLayer)).apply(this,arguments))}return function area_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(AreaLayer,cs),hs(AreaLayer,[{key:"calculateDomainFromData",value:function calculateDomainFromData(e,t,n){var r=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(AreaLayer.prototype.__proto__||Object.getPrototypeOf(AreaLayer.prototype),"calculateDomainFromData",this).call(this,e,n);return[za.X,za.Y].forEach(function(e){t[e+"FieldType"]===b.MEASURE&&(r[e][0]=Math.min(r[e][0],0))}),r}},{key:"getDrawFn",value:function getDrawFn(){return fs}},{key:"translatePoints",value:function translatePoints(e,t,n){var r=this,i=[],a=this.transformType(),o=n.color,s=this.config().encoding.color,c=s.field,l=this.data().getFieldsConfig(),u=c&&l[c].index,f=t.xField,h=t.yField,d=t.y0Field,_=Co(n),p=_.xAxis,y=_.yAxis,g=l[f]&&l[f].def.type===b.DIMENSION,m=l[h]&&l[h].def.type===b.DIMENSION,v=g?"x":m?"y":null;return i=e.map(function(e,t){var n=p.getScaleValue(e.x)+p.getUnitWidth()/2,i=y.getScaleValue(e.y),c=d||a===Ra?y.getScaleValue(e.y0):y.getScaleValue(0),l=mo({datum:e,index:t},{colorEncoding:s,colorAxis:o,colorFieldIndex:u}),f=l.color,h=l.rawColor,_={},g={};_.fill=f,g.stateColor={},g.originalColor=h,g.colorTransform={};var m={enter:{x:n,y:null===e.y?e.y:y.getScaleValue(0),y0:null===e.y0?e.y0:y.getScaleValue(0)},update:{x:n,y:null===e.y?e.y:i,y0:null===e.y0?e.y0:c},_id:e._id,_data:e._data,style:_,meta:g};return r.cachePoint(e[v],m),m}),i=Mo(this,i)}},{key:"getPathStyle",value:function getPathStyle(e){return{fill:e}}}],[{key:"defaultConfig",value:function defaultConfig(){return Ba}},{key:"formalName",value:function formalName(){return"area"}}]),AreaLayer}(),_s={classPrefix:"muze",defClassName:"layer-arc",padding:{top:1,bottom:1,left:1,right:1},className:"",minOuterRadius:10,interaction:{highlight:[{type:"fill",intensity:[0,0,-20,0]}],fade:[{type:"fill",intensity:[0,0,20,0]}],focus:[{type:"fill",intensity:[0,0,20,0]}]},height:100,width:100,sort:"",cornerRadius:0,padAngle:0,padRadius:0,startAngle:0,endAngle:360,colors:["#F44336","blue","green","yellow","orange","purple"],transform:{type:"identity"},encoding:{"stroke-width":{value:"2px"},"stroke-linejoin":{value:"round"},angle:{value:"1"},radius:{value:"1"},opacity:{value:"1"},color:{value:"1"},shape:{value:"1"},size:{value:"1"}},innerRadiusFixer:10,transition:{effect:"cubic",duration:1e3},states:{highlight:{className:"muze-layer-arc-highlight"},fadeout:{className:"muze-layer-arc-fadeout"},selected:{className:"muze-layer-arc-selected"}}},ps=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),ys=function tweenPie(e,t,n){var r=t[0].datum,i=r.uid,a=bn(n,i,0)||function getIndexedPoint(e,t){if(!e[t]){var n=e[t-1],r=e[t+1];if(n&&r)return{startAngle:n[0].endAngle,endAngle:r[0].startAngle};if(!r)return{startAngle:2*Math.PI,endAngle:2*Math.PI}}return{startAngle:0,endAngle:0}}(n,i),o={startAngle:a.startAngle,endAngle:a.endAngle};return function(t){return e(function interpolator(){return Le}()(o,r)(t))}},gs=(n(17),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var ms=function(e){function ArcLayer(e,t,n,r){!function arc_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ArcLayer);var i=function arc_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(ArcLayer.__proto__||Object.getPrototypeOf(ArcLayer)).call(this,e,t,n,r));return i._prevPieData={},i}return function arc_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(ArcLayer,Oo),gs(ArcLayer,[{key:"elemType",value:function elemType(){return"path"}},{key:"getTransformedData",value:function getTransformedData(e,t){var n=this,r=[],i=t.startAngle,a=t.endAngle,o=t.encoding,s=t.sort,c=t.minOuterRadius,l=this._store.get("transformedData")||[],u=function getFieldIndices(e,t){var n=[Fa,Da,Ia,La].map(function(t){return e[t].field}),r=ps(n,4),i=r[0],a=r[1],o=r[2],s=[i,r[3],a].map(function(e){var n=t[e];return n&&n.def.type===b.MEASURE?n.index:null}),c=ps(s,3);return{angleIndex:c[0],sizeIndex:c[1],radiusIndex:c[2],colorIndex:bn(t,o,"index")}}(o,this.data().getFieldsConfig()),f=u.angleIndex,h=u.sizeIndex,d=u.radiusIndex,_=u.colorIndex,p=e.getData(),y=p.data,g=p.uids;this._prevPieData={},l.forEach(function(e,t){n._prevPieData[e.uid]=[e,t]}),r=function(){var e=Qo,t=Jo,n=null,r=Lo(0),i=Lo(Yo),a=Lo(0);function pie(o){var s,c,l,u,f,h=o.length,d=0,_=new Array(h),p=new Array(h),y=+r.apply(this,arguments),g=Math.min(Yo,Math.max(-Yo,i.apply(this,arguments)-y)),m=Math.min(Math.abs(g)/h,a.apply(this,arguments)),v=m*(g<0?-1:1);for(s=0;s<h;++s)(f=p[_[s]=s]=+e(o[s],s,o))>0&&(d+=f);for(null!=t?_.sort(function(e,n){return t(p[e],p[n])}):null!=n&&_.sort(function(e,t){return n(o[e],o[t])}),s=0,l=d?(g-h*v)/d:0;s<h;++s,y=u)c=_[s],u=y+((f=p[c])>0?f*l:0)+v,p[c]={data:o[c],index:s,value:f,startAngle:y,endAngle:u,padAngle:m};return p}return pie.value=function(t){return arguments.length?(e="function"==typeof t?t:Lo(+t),pie):e},pie.sortValues=function(e){return arguments.length?(t=e,n=null,pie):t},pie.sort=function(e){return arguments.length?(n=e,t=null,pie):n},pie.startAngle=function(e){return arguments.length?(r="function"==typeof e?e:Lo(+e),pie):r},pie.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:Lo(+e),pie):i},pie.padAngle=function(e){return arguments.length?(a="function"==typeof e?e:Lo(+e),pie):a},pie}().startAngle(i/180*Math.PI).endAngle(Math.PI*a/180).value(function(e){return e[f]||1}),s.length&&r.sort(function(e,t){return"asc"===s?e[d]-t[d]:t[d]-e[d]});var m=y.reduce(function(e,t){return e+(t[h]||0)},1);return r=r(y).map(function(e,t){return e.outerRadiusValue=y[t][d]||c,e.colorVal=y[t][_],e.angleVal=y[t][f],e.sizeVal=m,e.uid=g[t],e})}},{key:"getNormalizedData",value:function getNormalizedData(e){return e}},{key:"calculateDomainFromData",value:function calculateDomainFromData(e){return{radius:Wt([e],["outerRadiusValue","outerRadiusValue"])}}},{key:"getNearestPoint",value:function getNearestPoint(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).data;if(un(n)){var r=n.datum,i=r.data,a=r.uid;return{id:this.getIdentifiersFromData(i,a),layerId:this.id(),showInPosition:!0}}return null}},{key:"getPlotElementsFromSet",value:function getPlotElementsFromSet(e){return Pr(this.mount()).selectAll(this.elemType()).filter(function(t){return-1!==e.indexOf(t.datum.uid)})}},{key:"render",value:function render(e){var t=this,n=this.measurement(),r=n.height,i=n.width,a=this.config(),o=a.classPrefix,s=a.defClassName,c=a.minOuterRadius,l=a.innerRadius,u=a.outerRadius,f=a.cornerRadius,h=a.padAngle,d=a.padRadius,_=a.padding,p=a.transition,y=a.innerRadiusFixer,g=this.axes().size,m=this._store,v=r-_.top-_.bottom,b=i-_.left-_.right,x=Jt(s,this.id(),o),w=function getRadiusRange(e,t,n){var r=n.minOuterRadius,i=n.innerRadius,a=n.outerRadius,o=n.innerRadiusFixer;return[Math.max(i+o||0,r),a||Math.min(t,e)/2]}(b,v,{minOuterRadius:c,innerRadius:l,outerRadius:u,innerRadiusFixer:y}),C=this.axes().color,k=u||Math.min(v,b)/2,S=m.get("domain").radius,M=Xo().outerRadius(function(e){return function getRangeValue(e,t,n,r,i){var a=1,o=e.outerRadiusValue,s=e.sizeVal,c=i.domain(),l=i.getSize(s)/(c?i.range()[1]:i.config().value);return a*=(t[1]-t[0])/(n[1]-n[0]),(t[0]+(o-n[0])*a||r)*l}(e,w,S,k,g)}).innerRadius(l?Math.min(v/2,b/2,l):0).cornerRadius(f).padAngle(h).padRadius(d),P=Er(Pr(e),"g",[1],x[0]+"-group").classed(x[1]+"-group",!0).attr("transform","translate("+b/2+","+v/2+")"),E=function tween(e){Er(e,"path",function(e,t){return[{datum:e,index:t,meta:{originalColor:C.getRawColor(e.colorVal),stateColor:{},colorTransform:{}}}]},x[0]+"-path").attr("fill",function(e){return C.getColor(e.datum.colorVal)}).transition().duration(p.duration).attrTween("d",function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return ys(M,n,t._prevPieData)}).attr("class",function(e){return x[0]+"-path "+x[1]+"-path-"+e.index})};return Er(P,"g",m.get("transformedData"),""+x[0],{update:E},function(e){return e.uid}).attr("class",function(e,t){return x[0]+" "+x[1]+"-"+t}).call(E),this}}],[{key:"defaultConfig",value:function defaultConfig(){return _s}},{key:"formalName",value:function formalName(){return"arc"}}]),ArcLayer}(),vs=function drawText(e,t,n,r){var i=n.backgroundPadding,a=Pr(e).selectAll("g").data(t),o=a.enter().append("g").each(function(e){Or(this,e.enter)}).merge(a),s=Ir(Pr(e),n.className),c=parseInt(s.fontSize,10);return r.setStyle(s),o.each(function(e){var t=Pr(this),a=e.update,o=e.background,s=e.text,l=e.color,u=e.textanchor;if(n.backgroundEnabled){var f=void 0,h=r.getOriSize(e.text),d=h.width,_=h.height,p=Er(t,"rect",[1]);f="end"===u?d:"start"===u?0:d/2,Or(p.node(),{x:a.x-f-i/2,y:a.y-c-i/2,width:d+i,height:_+i}),o&&Nr(p,{background:o})}var y=Er(t,"text",function(e){return[e]}).text(s),g=y.node();l&&Nr(g,{fill:l}),Or(g,a),y.attr("text-anchor",u)}),a.exit().remove(),a},bs={defClassName:"layer-text",classPrefix:"muze",className:"",transform:{type:"identity"},interaction:{highlight:[{type:"fill",intensity:[0,-10,-10,0]}],fade:[{type:"fill",intensity:[0,-30,30,0]}],focus:[{type:"fill",intensity:[0,-30,30,0]}]},transition:{effect:"cubic",duration:1e3},encoding:{color:{},text:{value:""},background:{padding:10,enabled:!1}},states:{highlight:{className:"muze-layer-text-highlight"},fadeout:{className:"muze-layer-text-fadeout"},selected:{className:"muze-layer-text-selected"}}},xs=(n(19),function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),ws=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Cs=function(e){function TextLayer(){return function text_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TextLayer),function text_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(TextLayer.__proto__||Object.getPrototypeOf(TextLayer)).apply(this,arguments))}return function text_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(TextLayer,Oo),ws(TextLayer,[{key:"elemType",value:function elemType(){return"text"}},{key:"translatePoints",value:function translatePoints(e,t,n){var r=void 0,i=n.color,a=t.text,o=a.field,s=a.value,c=a.formatter,l=t.color,u=l&&l.field,f=this.data().getFieldsConfig(),h=t.background.field,d=h?f[h].index:-1,_=u?f[u].index:-1,p=o?f[o]&&f[o].index:-1,y=za.X,g=za.Y;return r=e.map(function(e,t){var r=e._data,a=o?r[p]:s,u=[y,g].map(function(t){return n[t]?n[t].getScaleValue(e[t])+n[t].getUnitWidth()/2:0}),f=xs(u,2),h=f[0],m=f[1],v=mo({datum:e,index:t},{colorEncoding:l,colorAxis:i,colorFieldIndex:_}),b=v.color,x=v.rawColor;return{enter:{},update:{x:h,y:m},text:c?c(a):a,color:b,background:i.getColor(e._data[d]),meta:{stateColor:{},originalColor:x,colorTransform:{}},_data:r,_id:e._id}}),r=Mo(this,r)}},{key:"render",value:function render(e){var t=this,n=void 0,r=this.config(),i=r.encoding,a=this._store.get("normalizedData"),o=r.className,s=i.background.padding,c=i.background.enabled||i.background.field,l=Jt(r.defClassName,this.id(),r.classPrefix),u=this.axes();return Pr(e).classed(l.join(" ")+" "+o,!0),Rr({data:a,append:"g",selector:"g",container:e,each:function each(e,r,a){var o=r.node();n=t.translatePoints(e,i,u,a),Nr(o,{"text-anchor":"middle"}),vs(o,n,{className:l[0],backgroundPadding:s,backgroundEnabled:c},t._dependencies.smartLabel)}}),this}}],[{key:"defaultConfig",value:function defaultConfig(){return bs}},{key:"formalName",value:function formalName(){return"text"}}]),TextLayer}(),ks=function createShape(e,t){var n=Pr(t),r=e.shape,i=e.size,a=e.update;if(r instanceof Promise)r.then(function(n){e.shape=n,createShape(e,t)});else if(r instanceof Element){var o=r.cloneNode(!0);if("img"===o.nodeName.toLowerCase()){var s=o.src||o.href;(o=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("href",s)}var c=Pr(o);"path"===o.nodeName||"image"===o.nodeName?c.attr("transform","scale("+i/100+")"):(c.attr("height",i),c.attr("width",i)),c.attr("x",-i/2),c.attr("y",-i/2),Pr(n.node().appendChild(o))}else if("string"==typeof r){var l=void 0;l=function checkPath(e){return!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4)}(r)?r:function(){var e=Lo(es),t=Lo(64),n=null;function symbol(){var r;if(n||(n=r=Do()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return symbol.type=function(t){return arguments.length?(e="function"==typeof t?t:Lo(t),symbol):e},symbol.size=function(e){return arguments.length?(t="function"==typeof e?e:Lo(+e),symbol):t},symbol.context=function(e){return arguments.length?(n=null==e?null:e,symbol):n},symbol}().type(Gt[r]).size(i)(a),Er(n,"path",[1]).attr("d",l)}else e.shape="circle",createShape(e,t)},Ss=function drawSymbols(e){var t=void 0,n=e.container,r=e.points,i=e.transition,a=e.className,o=i.duration,s=i.effect,c=i.disabled,l=Pr(n);l.attr("class",a);var u=l.selectAll("g").data(r,e.keyFn),f=u.enter().append("g").attr("transform",function(e){return"translate("+e.enter.x+","+e.enter.y+")"});t=u.merge(f).each(function(e){ks(e,this)}),(t=c?t:t.transition().duration(c?0:i.duration)).attr("transform",function(e){return"translate("+e.update.x+","+e.update.y+")"}).each(function(e){var t=e.style,n=Pr(this);en(t,function(e){return n.style(e,t[e])}),n.attr("class",""+a),n.classed(e.className,!0)});var h=u.exit();c?h.remove():h.transition().ease(Yt[s]).duration(o).on("end",function(){Pr(this).remove()}).style("fill-opacity",0).style("stroke-opacity",0)},Ms={defClassName:"layer-point",className:"",classPrefix:"muze",defColorStyle:"stroke",interaction:{highlight:[{type:"fill",intensity:[0,0,-20,0]}],fade:[{type:"fill",intensity:[-20,-80,20,0]}],focus:[{type:"fill",intensity:[0,0,50,0]}]},transform:{type:"identity"},transition:{effect:"cubic",duration:1e3},encoding:{size:{value:30},color:{},shape:{value:"circle"},x:{},y:{},strokeOpacity:{value:.5},fillOpacity:{value:.5}},scaleFactor:100,shapes:["circle","cross","diamond","square","star","wye","triangle"],sizes:[20,30,40,50,60,70]},Ps=(n(21),function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),Es=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Ts=function(e){function PointLayer(){var e;!function point_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PointLayer);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function point_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=PointLayer.__proto__||Object.getPrototypeOf(PointLayer)).call.apply(e,[this].concat(n)));return i._voronoi=new tn,i}return function point_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(PointLayer,Oo),Es(PointLayer,[{key:"elemType",value:function elemType(){return"g"}},{key:"translatePoints",value:function translatePoints(e,t,n){for(var r=this,i=[],a=t.size,o=t.shape,s=t.color,c=t.x,l=t.y,u=a.field,f=o.field,h=c.field,d=l.field,_=n.size,p=n.shape,y=this.data().getFieldsConfig(),g=y[h]&&y[h].def.type===b.DIMENSION,m=y[d]&&y[d].def.type===b.DIMENSION,v=g?za.X:m?za.Y:null,x=s&&s.field,w=y[x]&&y[x].index,C=this._store.get("measurement"),k=y[f]&&y[f].index,S=y[u]&&y[u].index,M=n.color,P=function _loop(a,o){var c=e[a],l=c._data,u=_.getSize(l[S]),f=p.getShape(l[k]),h=[za.X,za.Y].map(function(e){var r=n[e].getUnitWidth()/2,i=null===c[e]?void 0:c[e],a=e===za.X?C.width:C.height;return t[e].field?n[e].getScaleValue(i)+r:a/2}),d=Ps(h,2),y=d[0],g=d[1],m=mo({datum:c,index:a},{colorEncoding:s,colorAxis:M,colorFieldIndex:w}),b=m.color,x=m.rawColor,P={fill:b,stroke:b};if(!isNaN(y)&&!isNaN(g)){var E={enter:{x:y,y:g},update:{x:y,y:g},shape:f,size:Math.abs(u),meta:{stateColor:{},originalColor:x,colorTransform:{}},style:P,_data:l,_id:c._id};i.push(E),r.cachePoint(c[v],E)}},E=0,T=e.length;E<T;E++)P(E);return i=Mo(this,i)}},{key:"render",value:function render(e){var t=this,n=void 0,r=0,i=void 0,a=this.config(),o=a.transition,s=a.encoding,c=a.className,l=a.defClassName,u=a.classPrefix,f=this.axes(),h=this._store.get("normalizedData"),d=Pr(e),_=Jt(l,this.id(),u);return this._points=[],this._pointMap={},d.classed(_.join(" "),!0).classed(c,!0),Er(e,"g",h,null,{update:function update(e,a,c){n=t.translatePoints(a,s,f,c),t._points.push(n),r=Math.max.apply(Math,[r].concat(function point_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n.map(function(e){return e.size})))),i=""+_[0],t.constructor.drawFn()({container:e.node(),points:n,className:i,transition:o,keyFn:function keyFn(e){return e._id}})}}),this._maxSize=2*Math.sqrt(r/Math.PI),ko(this._voronoi,this._points),this}},{key:"getNearestPoint",value:function getNearestPoint(e,t){var n,r,i,a=this._maxSize;if(!this.data())return null;if(r=(n=this._voronoi.find(e,t,a))&&n.data.data.update,i=n?Math.sqrt(n.data.data.size/Math.PI):0,n){var o=n.data.data,s=o._data,c=o._id;return{id:this.getIdentifiersFromData(s,c),dimensions:[{x:r.x,y:r.y,width:i,height:i}],layerId:this.id()}}return null}}],[{key:"defaultConfig",value:function defaultConfig(){return Ms}},{key:"formalName",value:function formalName(){return"point"}},{key:"drawFn",value:function drawFn(){return Ss}}]),PointLayer}(),As=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},Os=function(e){return 1===e.length&&(e=function ascendingComparator(e){return function(t,n){return As(e(t),n)}}(e)),{left:function left(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)<0?r=a+1:i=a}return r},right:function right(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)>0?i=a:r=a+1}return r}}};var Ns=Os(As);Ns.right,Ns.left;var Rs=Array.prototype,Fs=(Rs.slice,Rs.map,function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(i);++r<i;)a[r]=e+r*n;return a});Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);function src_map_Map(){}function src_map_map(e,t){var n=new src_map_Map;if(e instanceof src_map_Map)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var r,i=-1,a=e.length;if(null==t)for(;++i<a;)n.set(i,e[i]);else for(;++i<a;)n.set(t(r=e[i],i,e),r)}else if(e)for(var o in e)n.set(o,e[o]);return n}src_map_Map.prototype=src_map_map.prototype={constructor:src_map_Map,has:function has(e){return"$"+e in this},get:function get(e){return this["$"+e]},set:function set(e,t){return this["$"+e]=t,this},remove:function remove(e){var t="$"+e;return t in this&&delete this[t]},clear:function clear(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function keys(){var keys=[];for(var e in this)"$"===e[0]&&keys.push(e.slice(1));return keys},values:function values(){var values=[];for(var e in this)"$"===e[0]&&values.push(this[e]);return values},entries:function entries(){var entries=[];for(var e in this)"$"===e[0]&&entries.push({key:e.slice(1),value:this[e]});return entries},size:function size(){var size=0;for(var e in this)"$"===e[0]&&++size;return size},empty:function empty(){for(var e in this)if("$"===e[0])return!1;return!0},each:function each(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var Ds=src_map_map;function src_set_Set(){}var Ls=Ds.prototype;function src_set_set(e,t){var n=new src_set_Set;if(e instanceof src_set_Set)e.each(function(e){n.add(e)});else if(e){var r=-1,i=e.length;if(null==t)for(;++r<i;)n.add(e[r]);else for(;++r<i;)n.add(t(e[r],r,e))}return n}src_set_Set.prototype=src_set_set.prototype={constructor:src_set_Set,has:Ls.has,add:function add(e){return this["$"+(e+="")]=e,this},remove:Ls.remove,clear:Ls.clear,values:Ls.keys,size:Ls.size,empty:Ls.empty,each:Ls.each};var Is=Array.prototype,js=(Is.map,Is.slice),zs={name:"implicit"};function band(){var e,t,n=function ordinal(e){var t=Ds(),n=[],r=zs;function scale(i){var a=i+"",o=t.get(a);if(!o){if(r!==zs)return r;t.set(a,o=n.push(i))}return e[(o-1)%e.length]}return e=null==e?[]:js.call(e),scale.domain=function(e){if(!arguments.length)return n.slice();n=[],t=Ds();for(var r,i,a=-1,o=e.length;++a<o;)t.has(i=(r=e[a])+"")||t.set(i,n.push(r));return scale},scale.range=function(t){return arguments.length?(e=js.call(t),scale):e.slice()},scale.unknown=function(e){return arguments.length?(r=e,scale):r},scale.copy=function(){return ordinal().domain(n).range(e).unknown(r)},scale}().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,c=0,l=.5;function rescale(){var n=r().length,u=a[1]<a[0],f=a[u-0],h=a[1-u];e=(h-f)/Math.max(1,n-s+2*c),o&&(e=Math.floor(e)),f+=(h-f-e*(n-s))*l,t=e*(1-s),o&&(f=Math.round(f),t=Math.round(t));var d=Fs(n).map(function(t){return f+e*t});return i(u?d.reverse():d)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),rescale()):r()},n.range=function(e){return arguments.length?(a=[+e[0],+e[1]],rescale()):a.slice()},n.rangeRound=function(e){return a=[+e[0],+e[1]],o=!0,rescale()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,rescale()):o},n.padding=function(e){return arguments.length?(s=c=Math.max(0,Math.min(1,e)),rescale()):s},n.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),rescale()):s},n.paddingOuter=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),rescale()):c},n.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),rescale()):l},n.copy=function(){return band().domain(r()).range(a).round(o).paddingInner(s).paddingOuter(c).align(l)},n.invertExtent=function(e,t){var n,o,s,c,l=+e,u=arguments.length>1?+t:l,f=a[1]<a[0],h=f?i().reverse():i(),d=h.length-1;if(h.push(h[d]+this.step()),u<l&&(s=l,l=u,u=s),!(u<h[0]||l>a[1-f]))return n=Math.max(0,band_getClosestIndexOf(h,l)),c=band_getClosestIndexOf(h,u),o=l===u?n:Math.max(n,c-1),f&&(s=n,n=d-o,o=d-s),n>o?void 0:r().slice(n,o+1)},n.invert=function(e,t){var n,o,s=+e,c=arguments.length>1?+t:s,l=a[1]<a[0],u=l?i().reverse():i(),f=u.length-1;if(c<s&&(o=s,s=c,c=o),!(c<u[0]||s>a[1-l]))return n=Math.max(0,band_getClosestIndexOf(u,s,"left")),r()[l?f-n:n]},rescale()}function band_getClosestIndexOf(e,t,n){for(var r,i,a,o=0,s=e.length-1;o<s;)i=Math.floor((o+s)/2),a=Math.abs(e[i]-t),Math.abs(e[i+1]-t)<=a?o=i+1:s=i;return n?(r=e[s])===t?s:r>t?0===s?s:"left"===n?s-1:s:s===e.length-1?s:"left"===n?s:s+1:s}var Bs=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function define_extend(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function color_Color(){}var Hs="\\s*([+-]?\\d+)\\s*",Us="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Vs="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qs=/^#([0-9a-f]{3})$/,Ws=/^#([0-9a-f]{6})$/,Gs=new RegExp("^rgb\\("+[Hs,Hs,Hs]+"\\)$"),Ys=new RegExp("^rgb\\("+[Vs,Vs,Vs]+"\\)$"),Xs=new RegExp("^rgba\\("+[Hs,Hs,Hs,Us]+"\\)$"),$s=new RegExp("^rgba\\("+[Vs,Vs,Vs,Us]+"\\)$"),Zs=new RegExp("^hsl\\("+[Us,Vs,Vs]+"\\)$"),Ks=new RegExp("^hsla\\("+[Us,Vs,Vs,Us]+"\\)$"),Js={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function src_color_color(e){var t;return e=(e+"").trim().toLowerCase(),(t=qs.exec(e))?new color_Rgb((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=Ws.exec(e))?color_rgbn(parseInt(t[1],16)):(t=Gs.exec(e))?new color_Rgb(t[1],t[2],t[3],1):(t=Ys.exec(e))?new color_Rgb(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Xs.exec(e))?color_rgba(t[1],t[2],t[3],t[4]):(t=$s.exec(e))?color_rgba(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Zs.exec(e))?color_hsla(t[1],t[2]/100,t[3]/100,1):(t=Ks.exec(e))?color_hsla(t[1],t[2]/100,t[3]/100,t[4]):Js.hasOwnProperty(e)?color_rgbn(Js[e]):"transparent"===e?new color_Rgb(NaN,NaN,NaN,0):null}function color_rgbn(e){return new color_Rgb(e>>16&255,e>>8&255,255&e,1)}function color_rgba(e,t,n,r){return r<=0&&(e=t=n=NaN),new color_Rgb(e,t,n,r)}function color_rgbConvert(e){return e instanceof color_Color||(e=src_color_color(e)),e?new color_Rgb((e=e.rgb()).r,e.g,e.b,e.opacity):new color_Rgb}function src_color_rgb(e,t,n,r){return 1===arguments.length?color_rgbConvert(e):new color_Rgb(e,t,n,null==r?1:r)}function color_Rgb(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function color_hex(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function color_hsla(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new color_Hsl(e,t,n,r)}function color_hsl(e,t,n,r){return 1===arguments.length?function color_hslConvert(e){if(e instanceof color_Hsl)return new color_Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof color_Color||(e=src_color_color(e)),!e)return new color_Hsl;if(e instanceof color_Hsl)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new color_Hsl(o,s,c,e.opacity)}(e):new color_Hsl(e,t,n,null==r?1:r)}function color_Hsl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function color_hsl2rgb(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}Bs(color_Color,src_color_color,{displayable:function displayable(){return this.rgb().displayable()},hex:function hex(){return this.rgb().hex()},toString:function toString(){return this.rgb()+""}}),Bs(color_Rgb,src_color_rgb,define_extend(color_Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new color_Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new color_Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function rgb(){return this},displayable:function displayable(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function hex(){return"#"+color_hex(this.r)+color_hex(this.g)+color_hex(this.b)},toString:function toString(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),Bs(color_Hsl,color_hsl,define_extend(color_Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new color_Hsl(this.h,this.s,this.l*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new color_Hsl(this.h,this.s,this.l*e,this.opacity)},rgb:function rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new color_Rgb(color_hsl2rgb(e>=240?e-240:e+120,i,r),color_hsl2rgb(e,i,r),color_hsl2rgb(e<120?e+240:e-120,i,r),this.opacity)},displayable:function displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Qs=Math.PI/180,ec=180/Math.PI,tc=.96422,nc=1,rc=.82521,ic=4/29,ac=6/29,oc=3*ac*ac,sc=ac*ac*ac;function lab_labConvert(e){if(e instanceof lab_Lab)return new lab_Lab(e.l,e.a,e.b,e.opacity);if(e instanceof lab_Hcl){if(isNaN(e.h))return new lab_Lab(e.l,0,0,e.opacity);var t=e.h*Qs;return new lab_Lab(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof color_Rgb||(e=color_rgbConvert(e));var n,r,i=lab_rgb2lrgb(e.r),a=lab_rgb2lrgb(e.g),o=lab_rgb2lrgb(e.b),s=lab_xyz2lab((.2225045*i+.7168786*a+.0606169*o)/nc);return i===a&&a===o?n=r=s:(n=lab_xyz2lab((.4360747*i+.3850649*a+.1430804*o)/tc),r=lab_xyz2lab((.0139322*i+.0971045*a+.7141733*o)/rc)),new lab_Lab(116*s-16,500*(n-s),200*(s-r),e.opacity)}function src_lab_lab(e,t,n,r){return 1===arguments.length?lab_labConvert(e):new lab_Lab(e,t,n,null==r?1:r)}function lab_Lab(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function lab_xyz2lab(e){return e>sc?Math.pow(e,1/3):e/oc+ic}function lab_lab2xyz(e){return e>ac?e*e*e:oc*(e-ic)}function lab_lrgb2rgb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function lab_rgb2lrgb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function lab_hclConvert(e){if(e instanceof lab_Hcl)return new lab_Hcl(e.h,e.c,e.l,e.opacity);if(e instanceof lab_Lab||(e=lab_labConvert(e)),0===e.a&&0===e.b)return new lab_Hcl(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*ec;return new lab_Hcl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function lab_hcl(e,t,n,r){return 1===arguments.length?lab_hclConvert(e):new lab_Hcl(e,t,n,null==r?1:r)}function lab_Hcl(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}Bs(lab_Lab,src_lab_lab,define_extend(color_Color,{brighter:function brighter(e){return new lab_Lab(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function darker(e){return new lab_Lab(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new color_Rgb(lab_lrgb2rgb(3.1338561*(t=tc*lab_lab2xyz(t))-1.6168667*(e=nc*lab_lab2xyz(e))-.4906146*(n=rc*lab_lab2xyz(n))),lab_lrgb2rgb(-.9787684*t+1.9161415*e+.033454*n),lab_lrgb2rgb(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),Bs(lab_Hcl,lab_hcl,define_extend(color_Color,{brighter:function brighter(e){return new lab_Hcl(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function darker(e){return new lab_Hcl(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function rgb(){return lab_labConvert(this).rgb()}}));var cc=-.29227,lc=-.90649,uc=1.97294,fc=uc*lc,hc=1.78277*uc,dc=1.78277*cc- -.14861*lc;function d3_color_src_cubehelix_cubehelix(e,t,n,r){return 1===arguments.length?function cubehelix_cubehelixConvert(e){if(e instanceof cubehelix_Cubehelix)return new cubehelix_Cubehelix(e.h,e.s,e.l,e.opacity);e instanceof color_Rgb||(e=color_rgbConvert(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(dc*r+fc*t-hc*n)/(dc+fc-hc),a=r-i,o=(uc*(n-i)-cc*a)/lc,s=Math.sqrt(o*o+a*a)/(uc*i*(1-i)),c=s?Math.atan2(o,a)*ec-120:NaN;return new cubehelix_Cubehelix(c<0?c+360:c,s,i,e.opacity)}(e):new cubehelix_Cubehelix(e,t,n,null==r?1:r)}function cubehelix_Cubehelix(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function src_basis_basis(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}Bs(cubehelix_Cubehelix,d3_color_src_cubehelix_cubehelix,define_extend(color_Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new cubehelix_Cubehelix(this.h,this.s,this.l*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new cubehelix_Cubehelix(this.h,this.s,this.l*e,this.opacity)},rgb:function rgb(){var e=isNaN(this.h)?0:(this.h+120)*Qs,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new color_Rgb(255*(t+n*(-.14861*r+1.78277*i)),255*(t+n*(cc*r+lc*i)),255*(t+n*(uc*r)),this.opacity)}}));var _c=function(e){return function(){return e}};function src_color_linear(e,t){return function(n){return e+n*t}}function src_color_hue(e,t){var n=t-e;return n?src_color_linear(e,n>180||n<-180?n-360*Math.round(n/360):n):_c(isNaN(e)?t:e)}function color_gamma(e){return 1==(e=+e)?color_nogamma:function(t,n){return n-t?function color_exponential(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):_c(isNaN(t)?n:t)}}function color_nogamma(e,t){var n=t-e;return n?src_color_linear(e,n):_c(isNaN(e)?t:e)}(function rgbGamma(e){var t=color_gamma(e);function rgb(e,n){var r=t((e=src_color_rgb(e)).r,(n=src_color_rgb(n)).r),i=t(e.g,n.g),a=t(e.b,n.b),o=color_nogamma(e.opacity,n.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return rgb.gamma=rgbGamma,rgb})(1);function rgb_rgbSpline(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=src_color_rgb(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}rgb_rgbSpline(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return src_basis_basis((n-r/t)*t,o,i,a,s)}}),rgb_rgbSpline(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return src_basis_basis((n-r/t)*t,i,a,o,s)}});var pc=function(e,t){return t-=e=+e,function(n){return e+t*n}},yc=("function"==typeof Symbol&&Symbol.iterator,/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g);new RegExp(yc.source,"g");"function"==typeof Symbol&&Symbol.iterator;var gc,mc,vc,bc,xc=180/Math.PI,wc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Cc=function(e,t,n,r,i,a){var o,s,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*xc,skewX:Math.atan(c)*xc,scaleX:o,scaleY:s}};function transform_interpolateTransform(e,t,n,r){function pop(e){return e.length?e.pop()+" ":""}return function(i,a){var o=[],s=[];return i=e(i),a=e(a),function translate(e,r,i,a,o,s){if(e!==i||r!==a){var c=o.push("translate(",null,t,null,n);s.push({i:c-4,x:pc(e,i)},{i:c-2,x:pc(r,a)})}else(i||a)&&o.push("translate("+i+t+a+n)}(i.translateX,i.translateY,a.translateX,a.translateY,o,s),function rotate(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(pop(n)+"rotate(",null,r)-2,x:pc(e,t)})):t&&n.push(pop(n)+"rotate("+t+r)}(i.rotate,a.rotate,o,s),function skewX(e,t,n,i){e!==t?i.push({i:n.push(pop(n)+"skewX(",null,r)-2,x:pc(e,t)}):t&&n.push(pop(n)+"skewX("+t+r)}(i.skewX,a.skewX,o,s),function scale(e,t,n,r,i,a){if(e!==n||t!==r){var o=i.push(pop(i)+"scale(",null,",",null,")");a.push({i:o-4,x:pc(e,n)},{i:o-2,x:pc(t,r)})}else 1===n&&1===r||i.push(pop(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,o,s),i=a=null,function(e){for(var t,n=-1,r=s.length;++n<r;)o[(t=s[n]).i]=t.x(e);return o.join("")}}}transform_interpolateTransform(function parse_parseCss(e){return"none"===e?wc:(gc||(gc=document.createElement("DIV"),mc=document.documentElement,vc=document.defaultView),gc.style.transform=e,e=vc.getComputedStyle(mc.appendChild(gc),null).getPropertyValue("transform"),mc.removeChild(gc),e=e.slice(7,-1).split(","),Cc(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),transform_interpolateTransform(function parse_parseSvg(e){return null==e?wc:(bc||(bc=document.createElementNS("http://www.w3.org/2000/svg","g")),bc.setAttribute("transform",e),(e=bc.transform.baseVal.consolidate())?(e=e.matrix,Cc(e.a,e.b,e.c,e.d,e.e,e.f)):wc)},", ",")",")"),Math.SQRT2;function src_hsl_hsl(e){return function(t,n){var r=e((t=color_hsl(t)).h,(n=color_hsl(n)).h),i=color_nogamma(t.s,n.s),a=color_nogamma(t.l,n.l),o=color_nogamma(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=a(e),t.opacity=o(e),t+""}}}src_hsl_hsl(src_color_hue),src_hsl_hsl(color_nogamma);function src_hcl_hcl(e){return function(t,n){var r=e((t=lab_hcl(t)).h,(n=lab_hcl(n)).h),i=color_nogamma(t.c,n.c),a=color_nogamma(t.l,n.l),o=color_nogamma(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=a(e),t.opacity=o(e),t+""}}}src_hcl_hcl(src_color_hue),src_hcl_hcl(color_nogamma);function d3_interpolate_src_cubehelix_cubehelix(e){return function cubehelixGamma(t){function cubehelix(n,r){var i=e((n=d3_color_src_cubehelix_cubehelix(n)).h,(r=d3_color_src_cubehelix_cubehelix(r)).h),a=color_nogamma(n.s,r.s),o=color_nogamma(n.l,r.l),s=color_nogamma(n.opacity,r.opacity);return function(e){return n.h=i(e),n.s=a(e),n.l=o(Math.pow(e,t)),n.opacity=s(e),n+""}}return t=+t,cubehelix.gamma=cubehelixGamma,cubehelix}(1)}d3_interpolate_src_cubehelix_cubehelix(src_color_hue);var kc=d3_interpolate_src_cubehelix_cubehelix(color_nogamma);var Sc=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},Mc=function(e){return(e=Sc(Math.abs(e)))?e[1]:NaN},Pc=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(e){return new FormatSpecifier(e)}function FormatSpecifier(e){if(!(t=Pc.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Ec,Tc,Ac=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(i>0){if(!+e[r])break e;i=0}}return i>0?e.slice(0,i)+e.slice(t+1):e},Oc=function(e,t){var n=Sc(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},Nc={"%":function _(e,t){return(100*e).toFixed(t)},b:function b(e){return Math.round(e).toString(2)},c:function c(e){return e+""},d:function d(e){return Math.round(e).toString(10)},e:function e(t,n){return t.toExponential(n)},f:function f(e,t){return e.toFixed(t)},g:function g(e,t){return e.toPrecision(t)},o:function o(e){return Math.round(e).toString(8)},p:function p(e,t){return Oc(100*e,t)},r:Oc,s:function(e,t){var n=Sc(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(Ec=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Sc(e,Math.max(0,t+a-1))[0]},X:function X(e){return Math.round(e).toString(16).toUpperCase()},x:function x(e){return Math.round(e).toString(16)}},Rc=function(e){return e},Fc=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],Dc=function(e){var t=e.grouping&&e.thousands?function(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}(e.grouping,e.thousands):Rc,n=e.currency,r=e.decimal,i=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(e.numerals):Rc,a=e.percent||"%";function newFormat(e){var o=(e=formatSpecifier(e)).fill,s=e.align,c=e.sign,l=e.symbol,u=e.zero,f=e.width,h=e.comma,d=e.precision,_=e.trim,p=e.type;"n"===p?(h=!0,p="g"):Nc[p]||(null==d&&(d=12),_=!0,p="g"),(u||"0"===o&&"="===s)&&(u=!0,o="0",s="=");var y="$"===l?n[0]:"#"===l&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",g="$"===l?n[1]:/[%p]/.test(p)?a:"",m=Nc[p],v=/[defgprs%]/.test(p);function format(e){var n,a,l,b=y,x=g;if("c"===p)x=m(e)+x,e="";else{var w=(e=+e)<0;if(e=m(Math.abs(e),d),_&&(e=Ac(e)),w&&0==+e&&(w=!1),b=(w?"("===c?c:"-":"-"===c||"("===c?"":c)+b,x=("s"===p?Fc[8+Ec/3]:"")+x+(w&&"("===c?")":""),v)for(n=-1,a=e.length;++n<a;)if(48>(l=e.charCodeAt(n))||l>57){x=(46===l?r+e.slice(n+1):e.slice(n))+x,e=e.slice(0,n);break}}h&&!u&&(e=t(e,1/0));var C=b.length+e.length+x.length,k=C<f?new Array(f-C+1).join(o):"";switch(h&&u&&(e=t(k+e,k.length?f-x.length:1/0),k=""),s){case"<":e=b+e+x+k;break;case"=":e=b+k+e+x;break;case"^":e=k.slice(0,C=k.length>>1)+b+e+x+k.slice(C);break;default:e=k+b+e+x}return i(e)}return d=null==d?6:/[gprs]/.test(p)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),format.toString=function(){return e+""},format}return{format:newFormat,formatPrefix:function formatPrefix(e,t){var n=newFormat(((e=formatSpecifier(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(Mc(t)/3))),i=Math.pow(10,-r),a=Fc[8+r/3];return function(e){return n(i*e)+a}}}};!function defaultLocale(e){return Tc=Dc(e),Tc.format,Tc.formatPrefix,Tc}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Lc=new Date,Ic=new Date;function newInterval(e,t,n,r){function interval(t){return e(t=new Date(+t)),t}return interval.floor=interval,interval.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},interval.round=function(e){var t=interval(e),n=interval.ceil(e);return e-t<n-e?t:n},interval.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},interval.range=function(n,r,i){var a,o=[];if(n=interval.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return o;do{o.push(a=new Date(+n)),t(n,i),e(n)}while(a<n&&n<r);return o},interval.filter=function(n){return newInterval(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(interval.count=function(t,r){return Lc.setTime(+t),Ic.setTime(+r),e(Lc),e(Ic),Math.floor(n(Lc,Ic))},interval.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?interval.filter(r?function(t){return r(t)%e==0}:function(t){return interval.count(0,t)%e==0}):interval:null}),interval}var jc=newInterval(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});jc.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?newInterval(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):jc:null};jc.range;var zc=6e4,Bc=6048e5,Hc=newInterval(function(e){e.setTime(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),Uc=(Hc.range,newInterval(function(e){e.setTime(Math.floor(e/zc)*zc)},function(e,t){e.setTime(+e+t*zc)},function(e,t){return(t-e)/zc},function(e){return e.getMinutes()})),Vc=(Uc.range,newInterval(function(e){var t=e.getTimezoneOffset()*zc%36e5;t<0&&(t+=36e5),e.setTime(36e5*Math.floor((+e-t)/36e5)+t)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()})),qc=(Vc.range,newInterval(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*zc)/864e5},function(e){return e.getDate()-1})),Wc=qc;qc.range;function weekday(e){return newInterval(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*zc)/Bc})}var Gc=weekday(0),Yc=weekday(1),Xc=weekday(2),$c=weekday(3),Zc=weekday(4),Kc=weekday(5),Jc=weekday(6),Qc=(Gc.range,Yc.range,Xc.range,$c.range,Zc.range,Kc.range,Jc.range,newInterval(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()})),el=(Qc.range,newInterval(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));el.every=function(e){return isFinite(e=Math.floor(e))&&e>0?newInterval(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var tl=el,nl=(el.range,newInterval(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*zc)},function(e,t){return(t-e)/zc},function(e){return e.getUTCMinutes()})),rl=(nl.range,newInterval(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()})),il=(rl.range,newInterval(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1})),al=il;il.range;function utcWeekday(e){return newInterval(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/Bc})}var ol=utcWeekday(0),sl=utcWeekday(1),cl=utcWeekday(2),ll=utcWeekday(3),ul=utcWeekday(4),fl=utcWeekday(5),hl=utcWeekday(6),dl=(ol.range,sl.range,cl.range,ll.range,ul.range,fl.range,hl.range,newInterval(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()})),_l=(dl.range,newInterval(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}));_l.every=function(e){return isFinite(e=Math.floor(e))&&e>0?newInterval(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var pl=_l;_l.range;function localDate(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function utcDate(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function newYear(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}var yl,gl,ml,vl={"-":"",_:" ",0:"0"},bl=/^\s*\d+/,xl=/^%/,wl=/[\\^$*+?|[\]().{}]/g;function locale_pad(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function requote(e){return e.replace(wl,"\\$&")}function formatRe(e){return new RegExp("^(?:"+e.map(requote).join("|")+")","i")}function formatLookup(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function parseWeekdayNumberSunday(e,t,n){var r=bl.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function parseWeekdayNumberMonday(e,t,n){var r=bl.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function parseWeekNumberSunday(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function parseWeekNumberISO(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function parseWeekNumberMonday(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function parseFullYear(e,t,n){var r=bl.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function parseYear(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function parseZone(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function parseMonthNumber(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function parseDayOfMonth(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function parseDayOfYear(e,t,n){var r=bl.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function parseHour24(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function parseMinutes(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function parseSeconds(e,t,n){var r=bl.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function parseMilliseconds(e,t,n){var r=bl.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function parseMicroseconds(e,t,n){var r=bl.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function parseLiteralPercent(e,t,n){var r=xl.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function parseUnixTimestamp(e,t,n){var r=bl.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function parseUnixTimestampSeconds(e,t,n){var r=bl.exec(t.slice(n));return r?(e.Q=1e3*+r[0],n+r[0].length):-1}function formatDayOfMonth(e,t){return locale_pad(e.getDate(),t,2)}function formatHour24(e,t){return locale_pad(e.getHours(),t,2)}function formatHour12(e,t){return locale_pad(e.getHours()%12||12,t,2)}function formatDayOfYear(e,t){return locale_pad(1+Wc.count(tl(e),e),t,3)}function formatMilliseconds(e,t){return locale_pad(e.getMilliseconds(),t,3)}function formatMicroseconds(e,t){return formatMilliseconds(e,t)+"000"}function formatMonthNumber(e,t){return locale_pad(e.getMonth()+1,t,2)}function formatMinutes(e,t){return locale_pad(e.getMinutes(),t,2)}function formatSeconds(e,t){return locale_pad(e.getSeconds(),t,2)}function formatWeekdayNumberMonday(e){var t=e.getDay();return 0===t?7:t}function formatWeekNumberSunday(e,t){return locale_pad(Gc.count(tl(e),e),t,2)}function formatWeekNumberISO(e,t){var n=e.getDay();return e=n>=4||0===n?Zc(e):Zc.ceil(e),locale_pad(Zc.count(tl(e),e)+(4===tl(e).getDay()),t,2)}function formatWeekdayNumberSunday(e){return e.getDay()}function formatWeekNumberMonday(e,t){return locale_pad(Yc.count(tl(e),e),t,2)}function locale_formatYear(e,t){return locale_pad(e.getFullYear()%100,t,2)}function formatFullYear(e,t){return locale_pad(e.getFullYear()%1e4,t,4)}function formatZone(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+locale_pad(t/60|0,"0",2)+locale_pad(t%60,"0",2)}function formatUTCDayOfMonth(e,t){return locale_pad(e.getUTCDate(),t,2)}function formatUTCHour24(e,t){return locale_pad(e.getUTCHours(),t,2)}function formatUTCHour12(e,t){return locale_pad(e.getUTCHours()%12||12,t,2)}function formatUTCDayOfYear(e,t){return locale_pad(1+al.count(pl(e),e),t,3)}function formatUTCMilliseconds(e,t){return locale_pad(e.getUTCMilliseconds(),t,3)}function formatUTCMicroseconds(e,t){return formatUTCMilliseconds(e,t)+"000"}function formatUTCMonthNumber(e,t){return locale_pad(e.getUTCMonth()+1,t,2)}function formatUTCMinutes(e,t){return locale_pad(e.getUTCMinutes(),t,2)}function formatUTCSeconds(e,t){return locale_pad(e.getUTCSeconds(),t,2)}function formatUTCWeekdayNumberMonday(e){var t=e.getUTCDay();return 0===t?7:t}function formatUTCWeekNumberSunday(e,t){return locale_pad(ol.count(pl(e),e),t,2)}function formatUTCWeekNumberISO(e,t){var n=e.getUTCDay();return e=n>=4||0===n?ul(e):ul.ceil(e),locale_pad(ul.count(pl(e),e)+(4===pl(e).getUTCDay()),t,2)}function formatUTCWeekdayNumberSunday(e){return e.getUTCDay()}function formatUTCWeekNumberMonday(e,t){return locale_pad(sl.count(pl(e),e),t,2)}function formatUTCYear(e,t){return locale_pad(e.getUTCFullYear()%100,t,2)}function formatUTCFullYear(e,t){return locale_pad(e.getUTCFullYear()%1e4,t,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(e){return+e}function formatUnixTimestampSeconds(e){return Math.floor(+e/1e3)}!function defaultLocale_defaultLocale(e){return yl=function formatLocale(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,c=e.shortMonths,l=formatRe(i),u=formatLookup(i),f=formatRe(a),h=formatLookup(a),d=formatRe(o),_=formatLookup(o),p=formatRe(s),y=formatLookup(s),g=formatRe(c),m=formatLookup(c),v={a:function formatShortWeekday(e){return o[e.getDay()]},A:function formatWeekday(e){return a[e.getDay()]},b:function formatShortMonth(e){return c[e.getMonth()]},B:function formatMonth(e){return s[e.getMonth()]},c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:function formatPeriod(e){return i[+(e.getHours()>=12)]},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:locale_formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},b={a:function formatUTCShortWeekday(e){return o[e.getUTCDay()]},A:function formatUTCWeekday(e){return a[e.getUTCDay()]},b:function formatUTCShortMonth(e){return c[e.getUTCMonth()]},B:function formatUTCMonth(e){return s[e.getUTCMonth()]},c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:function formatUTCPeriod(e){return i[+(e.getUTCHours()>=12)]},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},x={a:function parseShortWeekday(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=_[r[0].toLowerCase()],n+r[0].length):-1},A:function parseWeekday(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function parseShortMonth(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m[r[0].toLowerCase()],n+r[0].length):-1},B:function parseMonth(e,t,n){var r=p.exec(t.slice(n));return r?(e.m=y[r[0].toLowerCase()],n+r[0].length):-1},c:function parseLocaleDateTime(e,n,r){return parseSpecifier(e,t,n,r)},d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:function parsePeriod(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=u[r[0].toLowerCase()],n+r[0].length):-1},Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:function parseLocaleDate(e,t,r){return parseSpecifier(e,n,t,r)},X:function parseLocaleTime(e,t,n){return parseSpecifier(e,r,t,n)},y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};function newFormat(e,t){return function(n){var r,i,a,o=[],s=-1,c=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(o.push(e.slice(c,s)),null!=(i=vl[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(a=t[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(e.slice(c,s)),o.join("")}}function newParse(e,t){return function(n){var r,i,a=newYear(1900);if(parseSpecifier(a,e,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("p"in a&&(a.H=a.H%12+12*a.p),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(r=(i=(r=utcDate(newYear(a.y))).getUTCDay())>4||0===i?sl.ceil(r):sl(r),r=al.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(r=(i=(r=t(newYear(a.y))).getDay())>4||0===i?Yc.ceil(r):Yc(r),r=Wc.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?utcDate(newYear(a.y)).getUTCDay():t(newYear(a.y)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,utcDate(a)):t(a)}}function parseSpecifier(e,t,n,r){for(var i,a,o=0,s=t.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(a=x[i in vl?t.charAt(o++):i])||(r=a(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=newFormat(n,v),v.X=newFormat(r,v),v.c=newFormat(t,v),b.x=newFormat(n,b),b.X=newFormat(r,b),b.c=newFormat(t,b),{format:function format(e){var t=newFormat(e+="",v);return t.toString=function(){return e},t},parse:function parse(e){var t=newParse(e+="",localDate);return t.toString=function(){return e},t},utcFormat:function utcFormat(e){var t=newFormat(e+="",b);return t.toString=function(){return e},t},utcParse:function utcParse(e){var t=newParse(e,utcDate);return t.toString=function(){return e},t}}}(e),yl.format,yl.parse,gl=yl.utcFormat,ml=yl.utcParse,yl}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||gl("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||ml("%Y-%m-%dT%H:%M:%S.%LZ");var Cl=function(e){return e.match(/.{6}/g).map(function(e){return"#"+e})};Cl("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Cl("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Cl("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Cl("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),kc(d3_color_src_cubehelix_cubehelix(300,.5,0),d3_color_src_cubehelix_cubehelix(-240,.5,1)),kc(d3_color_src_cubehelix_cubehelix(-100,.75,.35),d3_color_src_cubehelix_cubehelix(80,1.5,.8)),kc(d3_color_src_cubehelix_cubehelix(260,.75,.35),d3_color_src_cubehelix_cubehelix(80,1.5,.8)),d3_color_src_cubehelix_cubehelix();function ramp(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}ramp(Cl("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),ramp(Cl("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),ramp(Cl("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),ramp(Cl("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function cubic_cubicInOut(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}(function custom(e){function polyIn(t){return Math.pow(t,e)}return e=+e,polyIn.exponent=custom,polyIn})(3),function custom(e){function polyOut(t){return 1-Math.pow(1-t,e)}return e=+e,polyOut.exponent=custom,polyOut}(3),function custom(e){function polyInOut(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,polyInOut.exponent=custom,polyInOut}(3),Math.PI;(function custom(e){function backIn(t){return t*t*((e+1)*t-e)}return e=+e,backIn.overshoot=custom,backIn})(1.70158),function custom(e){function backOut(t){return--t*t*((e+1)*t+e)+1}return e=+e,backOut.overshoot=custom,backOut}(1.70158),function custom(e){function backInOut(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,backInOut.overshoot=custom,backInOut}(1.70158);var kl,Sl=2*Math.PI,Ml=(function custom(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=Sl);function elasticIn(r){return e*Math.pow(2,10*--r)*Math.sin((n-r)/t)}return elasticIn.amplitude=function(e){return custom(e,t*Sl)},elasticIn.period=function(t){return custom(e,t)},elasticIn}(1,.3),function custom(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=Sl);function elasticOut(r){return 1-e*Math.pow(2,-10*(r=+r))*Math.sin((r+n)/t)}return elasticOut.amplitude=function(e){return custom(e,t*Sl)},elasticOut.period=function(t){return custom(e,t)},elasticOut}(1,.3),function custom(e,t){var n=Math.asin(1/(e=Math.max(1,e)))*(t/=Sl);function elasticInOut(r){return((r=2*r-1)<0?e*Math.pow(2,10*r)*Math.sin((n-r)/t):2-e*Math.pow(2,-10*r)*Math.sin((n+r)/t))/2}return elasticInOut.amplitude=function(e){return custom(e,t*Sl)},elasticInOut.period=function(t){return custom(e,t)},elasticInOut}(1,.3),function drawRects(e){var t=e.points,n=e.container,r=e.keyFn;return Er(n,"rect",t,null,{enter:function enter(e,t){!function barEnterFn(e,t){var n=e,r=t.enter||{};Object.entries(r).forEach(function(e){return!isNaN(e[1])&&n.attr(e[0],e[1])})}(e,t)},update:function update(t,n,r){!function transitionBars(e,t,n,r){var i=r.transition,a=r.classnameFn,o=i.duration,s=e,c=i.disabled?s:s.transition().duration(o).ease(cubic_cubicInOut),l=t.update||t,u=t.style||{};a&&s.classed(a(t,n),!0),Object.entries(l).forEach(function(e){return!isNaN(e[1])&&c.attr(e[0],e[1])}),Object.entries(u).forEach(function(e){return s.style(e[0],e[1])})}(t,n,r,e)}},r)}),Pl={classPrefix:"muze",defClassName:"layer-bar",className:"",interaction:{highlight:[{type:"fill",intensity:[0,0,-20,0]}],fade:[{type:"fill",intensity:[0,0,20,0]}],focus:[{type:"fill",intensity:[0,0,20,0]}]},transform:{type:"stack"},transition:{effect:"cubic",duration:1e3},innerPadding:.1,encoding:{color:{},x:{},y:{},x0:{},y0:{}},states:{highlight:{className:"muze-layer-bar-highlight"},fadeout:{className:"muze-layer-bar-fadeout"},selected:{className:"muze-layer-bar-selected"}}},El=(n(23),Array.prototype.slice),Tl=function(e){return e},Al=1,Ol=2,Nl=3,Rl=4,Fl=1e-6;function translateX(e){return"translate("+(e+.5)+",0)"}function translateY(e){return"translate(0,"+(e+.5)+")"}function entering(){return!this.__axis}function axis_axis(e,t){var n=[],r=null,i=null,a=null,o=6,s=6,c=3,l=e===Al||e===Rl?-1:1,u=e===Rl||e===Ol?"x":"y",f=e===Al||e===Nl?translateX:translateY;function axis(h){var d=null==r?t.ticks?t.ticks.apply(t,n):t.domain():r,_=null==i?t.tickFormat?t.tickFormat.apply(t,n):Tl:i,p=Math.max(o,0)+c,y=t.range(),g=+y[0]+.5,m=+y[y.length-1]+.5,v=(t.bandwidth?function axis_center(e){var t=Math.max(0,e.bandwidth()-1)/2;return e.round()&&(t=Math.round(t)),function(n){return+e(n)+t}}:function axis_number(e){return function(t){return+e(t)}})(t.copy()),b=h.selection?h.selection():h,x=b.selectAll(".domain").data([null]),w=b.selectAll(".tick").data(d,t).order(),C=w.exit(),k=w.enter().append("g").attr("class","tick"),S=w.select("line"),M=w.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),w=w.merge(k),S=S.merge(k.append("line").attr("stroke","#000").attr(u+"2",l*o)),M=M.merge(k.append("text").attr("fill","#000").attr(u,l*p).attr("dy",e===Al?"0em":e===Nl?"0.71em":"0.32em")).style("transform",a),h!==b&&(x=x.transition(h),w=w.transition(h),S=S.transition(h),M=M.transition(h),C=C.transition(h).attr("opacity",Fl).attr("transform",function(e){return isFinite(e=v(e))?f(e):this.getAttribute("transform")}),k.attr("opacity",Fl).attr("transform",function(e){var t=this.parentNode.__axis;return f(t&&isFinite(t=t(e))?t:v(e))})),C.remove(),x.attr("d",e===Rl||e==Ol?"M"+l*s+","+g+"H0.5V"+m+"H"+l*s:"M"+g+","+l*s+"V0.5H"+m+"V"+l*s),w.attr("opacity",1).attr("transform",function(e){return f(v(e))}),S.attr(u+"2",l*o),M.attr(u,l*p).text(_),b.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===Ol?"start":e===Rl?"end":"middle"),b.each(function(){this.__axis=v})}return axis.scale=function(e){return arguments.length?(t=e,axis):t},axis.tickTransform=function(e){return arguments.length?(a=e,axis):a},axis.ticks=function(){return n=El.call(arguments),axis},axis.tickArguments=function(e){return arguments.length?(n=null==e?[]:El.call(e),axis):n.slice()},axis.tickValues=function(e){return arguments.length?(r=null==e?null:El.call(e),axis):r&&r.slice()},axis.tickFormat=function(e){return arguments.length?(i=e,axis):i},axis.tickSize=function(e){return arguments.length?(o=s=+e,axis):o},axis.tickSizeInner=function(e){return arguments.length?(o=+e,axis):o},axis.tickSizeOuter=function(e){return arguments.length?(s=+e,axis):s},axis.tickPadding=function(e){return arguments.length?(c=+e,axis):c},axis}function axis_orientation_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dl="bottom",Ll="top",Il="left",jl="right",zl=(axis_orientation_defineProperty(kl={},Il,function axisLeft(e){return axis_axis(Rl,e)}),axis_orientation_defineProperty(kl,Dl,function axisBottom(e){return axis_axis(Nl,e)}),axis_orientation_defineProperty(kl,jl,function axisRight(e){return axis_axis(Ol,e)}),axis_orientation_defineProperty(kl,Ll,function axisTop(e){return axis_axis(Al,e)}),kl),Bl="linear",Hl="band",Ul="temporal",Vl="color",ql="ordinal",Wl="quantize",Gl="quantile",Yl="log",Xl="pow",$l="identity",Zl="sequential",Kl="threshold",Jl=(n(25),function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}),Ql=function(e){return 1===e.length&&(e=function bisector_ascendingComparator(e){return function(t,n){return Jl(e(t),n)}}(e)),{left:function left(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)<0?r=a+1:i=a}return r},right:function right(t,n,r,i){for(null==r&&(r=0),null==i&&(i=t.length);r<i;){var a=r+i>>>1;e(t[a],n)>0?i=a:r=a+1}return r}}};var eu=Ql(Jl),tu=eu.right,nu=(eu.left,tu);var ru=function(e){return null===e?NaN:+e},iu=Array.prototype,au=(iu.slice,iu.map,function(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),a=new Array(i);++r<i;)a[r]=e+r*n;return a}),ou=Math.sqrt(50),su=Math.sqrt(10),cu=Math.sqrt(2),lu=function(e,t,n){var r,i,a,o,s=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),0===(o=ticks_tickIncrement(e,t,n))||!isFinite(o))return[];if(o>0)for(e=Math.ceil(e/o),t=Math.floor(t/o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(e+s)*o;else for(e=Math.floor(e*o),t=Math.ceil(t*o),a=new Array(i=Math.ceil(e-t+1));++s<i;)a[s]=(e-s)/o;return r&&a.reverse(),a};function ticks_tickIncrement(e,t,n){var r=(t-e)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=ou?10:a>=su?5:a>=cu?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=ou?10:a>=su?5:a>=cu?2:1)}function ticks_tickStep(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=ou?i*=10:a>=su?i*=5:a>=cu&&(i*=2),t<e?-i:i}var uu=function(e,t,n){if(null==n&&(n=ru),r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,a=Math.floor(i),o=+n(e[a],a,e);return o+(+n(e[a+1],a+1,e)-o)*(i-a)}};function d3_collection_src_map_Map(){}function d3_collection_src_map_map(e,t){var n=new d3_collection_src_map_Map;if(e instanceof d3_collection_src_map_Map)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var r,i=-1,a=e.length;if(null==t)for(;++i<a;)n.set(i,e[i]);else for(;++i<a;)n.set(t(r=e[i],i,e),r)}else if(e)for(var o in e)n.set(o,e[o]);return n}d3_collection_src_map_Map.prototype=d3_collection_src_map_map.prototype={constructor:d3_collection_src_map_Map,has:function has(e){return"$"+e in this},get:function get(e){return this["$"+e]},set:function set(e,t){return this["$"+e]=t,this},remove:function remove(e){var t="$"+e;return t in this&&delete this[t]},clear:function clear(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function keys(){var keys=[];for(var e in this)"$"===e[0]&&keys.push(e.slice(1));return keys},values:function values(){var values=[];for(var e in this)"$"===e[0]&&values.push(this[e]);return values},entries:function entries(){var entries=[];for(var e in this)"$"===e[0]&&entries.push({key:e.slice(1),value:this[e]});return entries},size:function size(){var size=0;for(var e in this)"$"===e[0]&&++size;return size},empty:function empty(){for(var e in this)if("$"===e[0])return!1;return!0},each:function each(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var fu=d3_collection_src_map_map;function d3_collection_src_set_Set(){}var hu=fu.prototype;function d3_collection_src_set_set(e,t){var n=new d3_collection_src_set_Set;if(e instanceof d3_collection_src_set_Set)e.each(function(e){n.add(e)});else if(e){var r=-1,i=e.length;if(null==t)for(;++r<i;)n.add(e[r]);else for(;++r<i;)n.add(t(e[r],r,e))}return n}d3_collection_src_set_Set.prototype=d3_collection_src_set_set.prototype={constructor:d3_collection_src_set_Set,has:hu.has,add:function add(e){return this["$"+(e+="")]=e,this},remove:hu.remove,clear:hu.clear,values:hu.keys,size:hu.size,empty:hu.empty,each:hu.each};var du=Array.prototype,_u=du.map,pu=du.slice,yu={name:"implicit"};function ordinal_ordinal(e){var t=fu(),n=[],r=yu;function scale(i){var a=i+"",o=t.get(a);if(!o){if(r!==yu)return r;t.set(a,o=n.push(i))}return e[(o-1)%e.length]}return e=null==e?[]:pu.call(e),scale.domain=function(e){if(!arguments.length)return n.slice();n=[],t=fu();for(var r,i,a=-1,o=e.length;++a<o;)t.has(i=(r=e[a])+"")||t.set(i,n.push(r));return scale},scale.range=function(t){return arguments.length?(e=pu.call(t),scale):e.slice()},scale.unknown=function(e){return arguments.length?(r=e,scale):r},scale.copy=function(){return ordinal_ordinal().domain(n).range(e).unknown(r)},scale}function band_band(){var e,t,n=ordinal_ordinal().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,c=0,l=.5;function rescale(){var n=r().length,u=a[1]<a[0],f=a[u-0],h=a[1-u];e=(h-f)/Math.max(1,n-s+2*c),o&&(e=Math.floor(e)),f+=(h-f-e*(n-s))*l,t=e*(1-s),o&&(f=Math.round(f),t=Math.round(t));var d=au(n).map(function(t){return f+e*t});return i(u?d.reverse():d)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),rescale()):r()},n.range=function(e){return arguments.length?(a=[+e[0],+e[1]],rescale()):a.slice()},n.rangeRound=function(e){return a=[+e[0],+e[1]],o=!0,rescale()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(o=!!e,rescale()):o},n.padding=function(e){return arguments.length?(s=c=Math.max(0,Math.min(1,e)),rescale()):s},n.paddingInner=function(e){return arguments.length?(s=Math.max(0,Math.min(1,e)),rescale()):s},n.paddingOuter=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),rescale()):c},n.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),rescale()):l},n.copy=function(){return band_band().domain(r()).range(a).round(o).paddingInner(s).paddingOuter(c).align(l)},n.invertExtent=function(e,t){var n,o,s,c,l=+e,u=arguments.length>1?+t:l,f=a[1]<a[0],h=f?i().reverse():i(),d=h.length-1;if(h.push(h[d]+this.step()),u<l&&(s=l,l=u,u=s),!(u<h[0]||l>a[1-f]))return n=Math.max(0,src_band_getClosestIndexOf(h,l)),c=src_band_getClosestIndexOf(h,u),o=l===u?n:Math.max(n,c-1),f&&(s=n,n=d-o,o=d-s),n>o?void 0:r().slice(n,o+1)},n.invert=function(e,t){var n,o,s=+e,c=arguments.length>1?+t:s,l=a[1]<a[0],u=l?i().reverse():i(),f=u.length-1;if(c<s&&(o=s,s=c,c=o),!(c<u[0]||s>a[1-l]))return n=Math.max(0,src_band_getClosestIndexOf(u,s,"left")),r()[l?f-n:n]},rescale()}function src_band_getClosestIndexOf(e,t,n){for(var r,i,a,o=0,s=e.length-1;o<s;)i=Math.floor((o+s)/2),a=Math.abs(e[i]-t),Math.abs(e[i+1]-t)<=a?o=i+1:s=i;return n?(r=e[s])===t?s:r>t?0===s?s:"left"===n?s-1:s:s===e.length-1?s:"left"===n?s:s+1:s}var gu=function(e,t,n){e.prototype=t.prototype=n,n.constructor=e};function src_define_extend(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function src_color_Color(){}var mu="\\s*([+-]?\\d+)\\s*",vu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",bu="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xu=/^#([0-9a-f]{3})$/,wu=/^#([0-9a-f]{6})$/,Cu=new RegExp("^rgb\\("+[mu,mu,mu]+"\\)$"),ku=new RegExp("^rgb\\("+[bu,bu,bu]+"\\)$"),Su=new RegExp("^rgba\\("+[mu,mu,mu,vu]+"\\)$"),Mu=new RegExp("^rgba\\("+[bu,bu,bu,vu]+"\\)$"),Pu=new RegExp("^hsl\\("+[vu,bu,bu]+"\\)$"),Eu=new RegExp("^hsla\\("+[vu,bu,bu,vu]+"\\)$"),Tu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function d3_color_src_color_color(e){var t;return e=(e+"").trim().toLowerCase(),(t=xu.exec(e))?new src_color_Rgb((t=parseInt(t[1],16))>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):(t=wu.exec(e))?src_color_rgbn(parseInt(t[1],16)):(t=Cu.exec(e))?new src_color_Rgb(t[1],t[2],t[3],1):(t=ku.exec(e))?new src_color_Rgb(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Su.exec(e))?src_color_rgba(t[1],t[2],t[3],t[4]):(t=Mu.exec(e))?src_color_rgba(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=Pu.exec(e))?src_color_hsla(t[1],t[2]/100,t[3]/100,1):(t=Eu.exec(e))?src_color_hsla(t[1],t[2]/100,t[3]/100,t[4]):Tu.hasOwnProperty(e)?src_color_rgbn(Tu[e]):"transparent"===e?new src_color_Rgb(NaN,NaN,NaN,0):null}function src_color_rgbn(e){return new src_color_Rgb(e>>16&255,e>>8&255,255&e,1)}function src_color_rgba(e,t,n,r){return r<=0&&(e=t=n=NaN),new src_color_Rgb(e,t,n,r)}function src_color_rgbConvert(e){return e instanceof src_color_Color||(e=d3_color_src_color_color(e)),e?new src_color_Rgb((e=e.rgb()).r,e.g,e.b,e.opacity):new src_color_Rgb}function d3_color_src_color_rgb(e,t,n,r){return 1===arguments.length?src_color_rgbConvert(e):new src_color_Rgb(e,t,n,null==r?1:r)}function src_color_Rgb(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function src_color_hex(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function src_color_hsla(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new src_color_Hsl(e,t,n,r)}function src_color_hsl(e,t,n,r){return 1===arguments.length?function src_color_hslConvert(e){if(e instanceof src_color_Hsl)return new src_color_Hsl(e.h,e.s,e.l,e.opacity);if(e instanceof src_color_Color||(e=d3_color_src_color_color(e)),!e)return new src_color_Hsl;if(e instanceof src_color_Hsl)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),a=Math.max(t,n,r),o=NaN,s=a-i,c=(a+i)/2;return s?(o=t===a?(n-r)/s+6*(n<r):n===a?(r-t)/s+2:(t-n)/s+4,s/=c<.5?a+i:2-a-i,o*=60):s=c>0&&c<1?0:o,new src_color_Hsl(o,s,c,e.opacity)}(e):new src_color_Hsl(e,t,n,null==r?1:r)}function src_color_Hsl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function src_color_hsl2rgb(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}gu(src_color_Color,d3_color_src_color_color,{displayable:function displayable(){return this.rgb().displayable()},hex:function hex(){return this.rgb().hex()},toString:function toString(){return this.rgb()+""}}),gu(src_color_Rgb,d3_color_src_color_rgb,src_define_extend(src_color_Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new src_color_Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new src_color_Rgb(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function rgb(){return this},displayable:function displayable(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function hex(){return"#"+src_color_hex(this.r)+src_color_hex(this.g)+src_color_hex(this.b)},toString:function toString(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}})),gu(src_color_Hsl,src_color_hsl,src_define_extend(src_color_Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new src_color_Hsl(this.h,this.s,this.l*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new src_color_Hsl(this.h,this.s,this.l*e,this.opacity)},rgb:function rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new src_color_Rgb(src_color_hsl2rgb(e>=240?e-240:e+120,i,r),src_color_hsl2rgb(e,i,r),src_color_hsl2rgb(e<120?e+240:e-120,i,r),this.opacity)},displayable:function displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Au=Math.PI/180,Ou=180/Math.PI,Nu=.96422,Ru=1,Fu=.82521,Du=4/29,Lu=6/29,Iu=3*Lu*Lu,ju=Lu*Lu*Lu;function src_lab_labConvert(e){if(e instanceof src_lab_Lab)return new src_lab_Lab(e.l,e.a,e.b,e.opacity);if(e instanceof src_lab_Hcl){if(isNaN(e.h))return new src_lab_Lab(e.l,0,0,e.opacity);var t=e.h*Au;return new src_lab_Lab(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}e instanceof src_color_Rgb||(e=src_color_rgbConvert(e));var n,r,i=src_lab_rgb2lrgb(e.r),a=src_lab_rgb2lrgb(e.g),o=src_lab_rgb2lrgb(e.b),s=src_lab_xyz2lab((.2225045*i+.7168786*a+.0606169*o)/Ru);return i===a&&a===o?n=r=s:(n=src_lab_xyz2lab((.4360747*i+.3850649*a+.1430804*o)/Nu),r=src_lab_xyz2lab((.0139322*i+.0971045*a+.7141733*o)/Fu)),new src_lab_Lab(116*s-16,500*(n-s),200*(s-r),e.opacity)}function d3_color_src_lab_lab(e,t,n,r){return 1===arguments.length?src_lab_labConvert(e):new src_lab_Lab(e,t,n,null==r?1:r)}function src_lab_Lab(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function src_lab_xyz2lab(e){return e>ju?Math.pow(e,1/3):e/Iu+Du}function src_lab_lab2xyz(e){return e>Lu?e*e*e:Iu*(e-Du)}function src_lab_lrgb2rgb(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function src_lab_rgb2lrgb(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function src_lab_hclConvert(e){if(e instanceof src_lab_Hcl)return new src_lab_Hcl(e.h,e.c,e.l,e.opacity);if(e instanceof src_lab_Lab||(e=src_lab_labConvert(e)),0===e.a&&0===e.b)return new src_lab_Hcl(NaN,0,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Ou;return new src_lab_Hcl(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function src_lab_hcl(e,t,n,r){return 1===arguments.length?src_lab_hclConvert(e):new src_lab_Hcl(e,t,n,null==r?1:r)}function src_lab_Hcl(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}gu(src_lab_Lab,d3_color_src_lab_lab,src_define_extend(src_color_Color,{brighter:function brighter(e){return new src_lab_Lab(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function darker(e){return new src_lab_Lab(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new src_color_Rgb(src_lab_lrgb2rgb(3.1338561*(t=Nu*src_lab_lab2xyz(t))-1.6168667*(e=Ru*src_lab_lab2xyz(e))-.4906146*(n=Fu*src_lab_lab2xyz(n))),src_lab_lrgb2rgb(-.9787684*t+1.9161415*e+.033454*n),src_lab_lrgb2rgb(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),gu(src_lab_Hcl,src_lab_hcl,src_define_extend(src_color_Color,{brighter:function brighter(e){return new src_lab_Hcl(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function darker(e){return new src_lab_Hcl(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function rgb(){return src_lab_labConvert(this).rgb()}}));var zu=-.29227,Bu=-.90649,Hu=1.97294,Uu=Hu*Bu,Vu=1.78277*Hu,qu=1.78277*zu- -.14861*Bu;function node_modules_d3_color_src_cubehelix_cubehelix(e,t,n,r){return 1===arguments.length?function src_cubehelix_cubehelixConvert(e){if(e instanceof src_cubehelix_Cubehelix)return new src_cubehelix_Cubehelix(e.h,e.s,e.l,e.opacity);e instanceof src_color_Rgb||(e=src_color_rgbConvert(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(qu*r+Uu*t-Vu*n)/(qu+Uu-Vu),a=r-i,o=(Hu*(n-i)-zu*a)/Bu,s=Math.sqrt(o*o+a*a)/(Hu*i*(1-i)),c=s?Math.atan2(o,a)*Ou-120:NaN;return new src_cubehelix_Cubehelix(c<0?c+360:c,s,i,e.opacity)}(e):new src_cubehelix_Cubehelix(e,t,n,null==r?1:r)}function src_cubehelix_Cubehelix(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function d3_interpolate_src_basis_basis(e,t,n,r,i){var a=e*e,o=a*e;return((1-3*e+3*a-o)*t+(4-6*a+3*o)*n+(1+3*e+3*a-3*o)*r+o*i)/6}gu(src_cubehelix_Cubehelix,node_modules_d3_color_src_cubehelix_cubehelix,src_define_extend(src_color_Color,{brighter:function brighter(e){return e=null==e?1/.7:Math.pow(1/.7,e),new src_cubehelix_Cubehelix(this.h,this.s,this.l*e,this.opacity)},darker:function darker(e){return e=null==e?.7:Math.pow(.7,e),new src_cubehelix_Cubehelix(this.h,this.s,this.l*e,this.opacity)},rgb:function rgb(){var e=isNaN(this.h)?0:(this.h+120)*Au,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new src_color_Rgb(255*(t+n*(-.14861*r+1.78277*i)),255*(t+n*(zu*r+Bu*i)),255*(t+n*(Hu*r)),this.opacity)}}));var Wu=function(e){return function(){return e}};function d3_interpolate_src_color_linear(e,t){return function(n){return e+n*t}}function d3_interpolate_src_color_hue(e,t){var n=t-e;return n?d3_interpolate_src_color_linear(e,n>180||n<-180?n-360*Math.round(n/360):n):Wu(isNaN(e)?t:e)}function src_color_gamma(e){return 1==(e=+e)?src_color_nogamma:function(t,n){return n-t?function src_color_exponential(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):Wu(isNaN(t)?n:t)}}function src_color_nogamma(e,t){var n=t-e;return n?d3_interpolate_src_color_linear(e,n):Wu(isNaN(e)?t:e)}var Gu=function rgbGamma(e){var t=src_color_gamma(e);function rgb(e,n){var r=t((e=d3_color_src_color_rgb(e)).r,(n=d3_color_src_color_rgb(n)).r),i=t(e.g,n.g),a=t(e.b,n.b),o=src_color_nogamma(e.opacity,n.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=a(t),e.opacity=o(t),e+""}}return rgb.gamma=rgbGamma,rgb}(1);function src_rgb_rgbSpline(e){return function(t){var n,r,i=t.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=d3_color_src_color_rgb(t[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=e(a),o=e(o),s=e(s),r.opacity=1,function(e){return r.r=a(e),r.g=o(e),r.b=s(e),r+""}}}var Yu=src_rgb_rgbSpline(function(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],a=e[r+1],o=r>0?e[r-1]:2*i-a,s=r<t-1?e[r+2]:2*a-i;return d3_interpolate_src_basis_basis((n-r/t)*t,o,i,a,s)}}),Xu=(src_rgb_rgbSpline(function(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],a=e[r%t],o=e[(r+1)%t],s=e[(r+2)%t];return d3_interpolate_src_basis_basis((n-r/t)*t,i,a,o,s)}}),function(e,t){return t-=e=+e,function(n){return e+t*n}}),$u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Zu=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ku=new RegExp(Zu.source,"g");var Ju,Qu,ef,tf,nf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rf=function(e,t){var n,r=void 0===t?"undefined":nf(t);return null==t||"boolean"===r?Wu(t):("number"===r?Xu:"string"===r?(n=d3_color_src_color_color(t))?(t=n,Gu):function(e,t){var n,r,i,a=Zu.lastIndex=Ku.lastIndex=0,o=-1,s=[],c=[];for(e+="",t+="";(n=Zu.exec(e))&&(r=Ku.exec(t));)(i=r.index)>a&&(i=t.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,c.push({i:o,x:Xu(n,r)})),a=Ku.lastIndex;return a<t.length&&(i=t.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function src_string_one(e){return function(t){return e(t)+""}}(c[0].x):function d3_interpolate_src_string_zero(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,r=0;r<t;++r)s[(n=c[r]).i]=n.x(e);return s.join("")})}:t instanceof d3_color_src_color_color?Gu:t instanceof Date?function(e,t){var n=new Date;return t-=e=+e,function(r){return n.setTime(e+t*r),n}}:Array.isArray(t)?function(e,t){var n,r=t?t.length:0,i=e?Math.min(r,e.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=rf(e[n],t[n]);for(;n<r;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=a[n](e);return o}}:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?function(e,t){var n,r={},i={};for(n in null!==e&&"object"===(void 0===e?"undefined":$u(e))||(e={}),null!==t&&"object"===(void 0===t?"undefined":$u(t))||(t={}),t)n in e?r[n]=rf(e[n],t[n]):i[n]=t[n];return function(e){for(n in r)i[n]=r[n](e);return i}}:Xu)(e,t)},af=function(e,t){return t-=e=+e,function(n){return Math.round(e+t*n)}},of=180/Math.PI,sf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},cf=function(e,t,n,r,i,a){var o,s,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,c/=s),e*r<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(t,e)*of,skewX:Math.atan(c)*of,scaleX:o,scaleY:s}};function src_transform_interpolateTransform(e,t,n,r){function pop(e){return e.length?e.pop()+" ":""}return function(i,a){var o=[],s=[];return i=e(i),a=e(a),function translate(e,r,i,a,o,s){if(e!==i||r!==a){var c=o.push("translate(",null,t,null,n);s.push({i:c-4,x:Xu(e,i)},{i:c-2,x:Xu(r,a)})}else(i||a)&&o.push("translate("+i+t+a+n)}(i.translateX,i.translateY,a.translateX,a.translateY,o,s),function rotate(e,t,n,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:n.push(pop(n)+"rotate(",null,r)-2,x:Xu(e,t)})):t&&n.push(pop(n)+"rotate("+t+r)}(i.rotate,a.rotate,o,s),function skewX(e,t,n,i){e!==t?i.push({i:n.push(pop(n)+"skewX(",null,r)-2,x:Xu(e,t)}):t&&n.push(pop(n)+"skewX("+t+r)}(i.skewX,a.skewX,o,s),function scale(e,t,n,r,i,a){if(e!==n||t!==r){var o=i.push(pop(i)+"scale(",null,",",null,")");a.push({i:o-4,x:Xu(e,n)},{i:o-2,x:Xu(t,r)})}else 1===n&&1===r||i.push(pop(i)+"scale("+n+","+r+")")}(i.scaleX,i.scaleY,a.scaleX,a.scaleY,o,s),i=a=null,function(e){for(var t,n=-1,r=s.length;++n<r;)o[(t=s[n]).i]=t.x(e);return o.join("")}}}src_transform_interpolateTransform(function transform_parse_parseCss(e){return"none"===e?sf:(Ju||(Ju=document.createElement("DIV"),Qu=document.documentElement,ef=document.defaultView),Ju.style.transform=e,e=ef.getComputedStyle(Qu.appendChild(Ju),null).getPropertyValue("transform"),Qu.removeChild(Ju),e=e.slice(7,-1).split(","),cf(+e[0],+e[1],+e[2],+e[3],+e[4],+e[5]))},"px, ","px)","deg)"),src_transform_interpolateTransform(function transform_parse_parseSvg(e){return null==e?sf:(tf||(tf=document.createElementNS("http://www.w3.org/2000/svg","g")),tf.setAttribute("transform",e),(e=tf.transform.baseVal.consolidate())?(e=e.matrix,cf(e.a,e.b,e.c,e.d,e.e,e.f)):sf)},", ",")",")"),Math.SQRT2;function d3_interpolate_src_hsl_hsl(e){return function(t,n){var r=e((t=src_color_hsl(t)).h,(n=src_color_hsl(n)).h),i=src_color_nogamma(t.s,n.s),a=src_color_nogamma(t.l,n.l),o=src_color_nogamma(t.opacity,n.opacity);return function(e){return t.h=r(e),t.s=i(e),t.l=a(e),t.opacity=o(e),t+""}}}d3_interpolate_src_hsl_hsl(d3_interpolate_src_color_hue),d3_interpolate_src_hsl_hsl(src_color_nogamma);function d3_interpolate_src_hcl_hcl(e){return function(t,n){var r=e((t=src_lab_hcl(t)).h,(n=src_lab_hcl(n)).h),i=src_color_nogamma(t.c,n.c),a=src_color_nogamma(t.l,n.l),o=src_color_nogamma(t.opacity,n.opacity);return function(e){return t.h=r(e),t.c=i(e),t.l=a(e),t.opacity=o(e),t+""}}}d3_interpolate_src_hcl_hcl(d3_interpolate_src_color_hue),d3_interpolate_src_hcl_hcl(src_color_nogamma);function node_modules_d3_interpolate_src_cubehelix_cubehelix(e){return function cubehelixGamma(t){function cubehelix(n,r){var i=e((n=node_modules_d3_color_src_cubehelix_cubehelix(n)).h,(r=node_modules_d3_color_src_cubehelix_cubehelix(r)).h),a=src_color_nogamma(n.s,r.s),o=src_color_nogamma(n.l,r.l),s=src_color_nogamma(n.opacity,r.opacity);return function(e){return n.h=i(e),n.s=a(e),n.l=o(Math.pow(e,t)),n.opacity=s(e),n+""}}return t=+t,cubehelix.gamma=cubehelixGamma,cubehelix}(1)}node_modules_d3_interpolate_src_cubehelix_cubehelix(d3_interpolate_src_color_hue);var lf=node_modules_d3_interpolate_src_cubehelix_cubehelix(src_color_nogamma);var uf=function(e){return function(){return e}},ff=function(e){return+e},hf=[0,1];function continuous_deinterpolateLinear(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:uf(t)}function continuous_bimap(e,t,n,r){var i=e[0],a=e[1],o=t[0],s=t[1];return a<i?(i=n(a,i),o=r(s,o)):(i=n(i,a),o=r(o,s)),function(e){return o(i(e))}}function continuous_polymap(e,t,n,r){var i=Math.min(e.length,t.length)-1,a=new Array(i),o=new Array(i),s=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<i;)a[s]=n(e[s],e[s+1]),o[s]=r(t[s],t[s+1]);return function(t){var n=nu(e,t,1,i)-1;return o[n](a[n](t))}}function continuous_copy(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function continuous_continuous(e,t){var n,r,i,a=hf,o=hf,s=rf,c=!1;function rescale(){return n=Math.min(a.length,o.length)>2?continuous_polymap:continuous_bimap,r=i=null,scale}function scale(t){return(r||(r=n(a,o,c?function continuous_deinterpolateClamp(e){return function(t,n){var r=e(t=+t,n=+n);return function(e){return e<=t?0:e>=n?1:r(e)}}}(e):e,s)))(+t)}return scale.invert=function(e){return(i||(i=n(o,a,continuous_deinterpolateLinear,c?function continuous_reinterpolateClamp(e){return function(t,n){var r=e(t=+t,n=+n);return function(e){return e<=0?t:e>=1?n:r(e)}}}(t):t)))(+e)},scale.domain=function(e){return arguments.length?(a=_u.call(e,ff),rescale()):a.slice()},scale.range=function(e){return arguments.length?(o=pu.call(e),rescale()):o.slice()},scale.rangeRound=function(e){return o=pu.call(e),s=af,rescale()},scale.clamp=function(e){return arguments.length?(c=!!e,rescale()):c},scale.interpolate=function(e){return arguments.length?(s=e,rescale()):s},rescale()}var df=function(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]},_f=function(e){return(e=df(Math.abs(e)))?e[1]:NaN},pf=/^(?:(.)?([<>=^]))?([+\-\( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier_formatSpecifier(e){return new formatSpecifier_FormatSpecifier(e)}function formatSpecifier_FormatSpecifier(e){if(!(t=pf.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}formatSpecifier_formatSpecifier.prototype=formatSpecifier_FormatSpecifier.prototype,formatSpecifier_FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var yf,gf,mf,vf,bf=function(e){e:for(var t,n=e.length,r=1,i=-1;r<n;++r)switch(e[r]){case".":i=t=r;break;case"0":0===i&&(i=r),t=r;break;default:if(i>0){if(!+e[r])break e;i=0}}return i>0?e.slice(0,i)+e.slice(t+1):e},xf=function(e,t){var n=df(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},wf={"%":function _(e,t){return(100*e).toFixed(t)},b:function b(e){return Math.round(e).toString(2)},c:function c(e){return e+""},d:function d(e){return Math.round(e).toString(10)},e:function e(t,n){return t.toExponential(n)},f:function f(e,t){return e.toFixed(t)},g:function g(e,t){return e.toPrecision(t)},o:function o(e){return Math.round(e).toString(8)},p:function p(e,t){return xf(100*e,t)},r:xf,s:function(e,t){var n=df(e,t);if(!n)return e+"";var r=n[0],i=n[1],a=i-(yf=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+df(e,Math.max(0,t+a-1))[0]},X:function X(e){return Math.round(e).toString(16).toUpperCase()},x:function x(e){return Math.round(e).toString(16)}},Cf=function(e){return e},kf=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],Sf=function(e){var t=e.grouping&&e.thousands?function(e,t){return function(n,r){for(var i=n.length,a=[],o=0,s=e[0],c=0;i>0&&s>0&&(c+s+1>r&&(s=Math.max(1,r-c)),a.push(n.substring(i-=s,i+s)),!((c+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(t)}}(e.grouping,e.thousands):Cf,n=e.currency,r=e.decimal,i=e.numerals?function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(e.numerals):Cf,a=e.percent||"%";function newFormat(e){var o=(e=formatSpecifier_formatSpecifier(e)).fill,s=e.align,c=e.sign,l=e.symbol,u=e.zero,f=e.width,h=e.comma,d=e.precision,_=e.trim,p=e.type;"n"===p?(h=!0,p="g"):wf[p]||(null==d&&(d=12),_=!0,p="g"),(u||"0"===o&&"="===s)&&(u=!0,o="0",s="=");var y="$"===l?n[0]:"#"===l&&/[boxX]/.test(p)?"0"+p.toLowerCase():"",g="$"===l?n[1]:/[%p]/.test(p)?a:"",m=wf[p],v=/[defgprs%]/.test(p);function format(e){var n,a,l,b=y,x=g;if("c"===p)x=m(e)+x,e="";else{var w=(e=+e)<0;if(e=m(Math.abs(e),d),_&&(e=bf(e)),w&&0==+e&&(w=!1),b=(w?"("===c?c:"-":"-"===c||"("===c?"":c)+b,x=("s"===p?kf[8+yf/3]:"")+x+(w&&"("===c?")":""),v)for(n=-1,a=e.length;++n<a;)if(48>(l=e.charCodeAt(n))||l>57){x=(46===l?r+e.slice(n+1):e.slice(n))+x,e=e.slice(0,n);break}}h&&!u&&(e=t(e,1/0));var C=b.length+e.length+x.length,k=C<f?new Array(f-C+1).join(o):"";switch(h&&u&&(e=t(k+e,k.length?f-x.length:1/0),k=""),s){case"<":e=b+e+x+k;break;case"=":e=b+k+e+x;break;case"^":e=k.slice(0,C=k.length>>1)+b+e+x+k.slice(C);break;default:e=k+b+e+x}return i(e)}return d=null==d?6:/[gprs]/.test(p)?Math.max(1,Math.min(21,d)):Math.max(0,Math.min(20,d)),format.toString=function(){return e+""},format}return{format:newFormat,formatPrefix:function formatPrefix(e,t){var n=newFormat(((e=formatSpecifier_formatSpecifier(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(_f(t)/3))),i=Math.pow(10,-r),a=kf[8+r/3];return function(e){return n(i*e)+a}}}};!function src_defaultLocale_defaultLocale(e){return gf=Sf(e),mf=gf.format,vf=gf.formatPrefix,gf}({decimal:".",thousands:",",grouping:[3],currency:["$",""]});var Mf=function(e,t,n){var r,i=e[0],a=e[e.length-1],o=ticks_tickStep(i,a,null==t?10:t);switch((n=formatSpecifier_formatSpecifier(null==n?",f":n)).type){case"s":var s=Math.max(Math.abs(i),Math.abs(a));return null!=n.precision||isNaN(r=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(_f(t)/3)))-_f(Math.abs(e)))}(o,s))||(n.precision=r),vf(n,s);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,_f(t)-_f(e))+1}(o,Math.max(Math.abs(i),Math.abs(a))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=function(e){return Math.max(0,-_f(Math.abs(e)))}(o))||(n.precision=r-2*("%"===n.type))}return mf(n)};function linear_linearish(e){var t=e.domain;return e.ticks=function(e){var n=t();return lu(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){return Mf(t(),e,n)},e.nice=function(n){null==n&&(n=10);var r,i=t(),a=0,o=i.length-1,s=i[a],c=i[o];return c<s&&(r=s,s=c,c=r,r=a,a=o,o=r),(r=ticks_tickIncrement(s,c,n))>0?r=ticks_tickIncrement(s=Math.floor(s/r)*r,c=Math.ceil(c/r)*r,n):r<0&&(r=ticks_tickIncrement(s=Math.ceil(s*r)/r,c=Math.floor(c*r)/r,n)),r>0?(i[a]=Math.floor(s/r)*r,i[o]=Math.ceil(c/r)*r,t(i)):r<0&&(i[a]=Math.ceil(s*r)/r,i[o]=Math.floor(c*r)/r,t(i)),e},e}function d3_scale_src_linear_linear(){var e=continuous_continuous(continuous_deinterpolateLinear,Xu);return e.copy=function(){return continuous_copy(e,d3_scale_src_linear_linear())},linear_linearish(e)}var Pf=function(e,t){var n,r=0,i=(e=e.slice()).length-1,a=e[r],o=e[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),e[r]=t.floor(a),e[i]=t.ceil(o),e};function src_log_deinterpolate(e,t){return(t=Math.log(t/e))?function(n){return Math.log(n/e)/t}:uf(t)}function src_log_reinterpolate(e,t){return e<0?function(n){return-Math.pow(-t,n)*Math.pow(-e,1-n)}:function(n){return Math.pow(t,n)*Math.pow(e,1-n)}}function log_pow10(e){return isFinite(e)?+("1e"+e):e<0?0:e}function log_powp(e){return 10===e?log_pow10:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function log_logp(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function log_reflect(e){return function(t){return-e(-t)}}function src_pow_raise(e,t){return e<0?-Math.pow(-e,t):Math.pow(e,t)}function pow_pow(){var e=1,t=continuous_continuous(function deinterpolate(t,n){return(n=src_pow_raise(n,e)-(t=src_pow_raise(t,e)))?function(r){return(src_pow_raise(r,e)-t)/n}:uf(n)},function reinterpolate(t,n){return n=src_pow_raise(n,e)-(t=src_pow_raise(t,e)),function(r){return src_pow_raise(t+n*r,1/e)}}),n=t.domain;return t.exponent=function(t){return arguments.length?(e=+t,n(n())):e},t.copy=function(){return continuous_copy(t,pow_pow().exponent(e))},linear_linearish(t)}function src_quantile_quantile(){var e=[],t=[],n=[];function rescale(){var r=0,i=Math.max(1,t.length);for(n=new Array(i-1);++r<i;)n[r-1]=uu(e,r/i);return scale}function scale(e){if(!isNaN(e=+e))return t[nu(n,e)]}return scale.invertExtent=function(r){var i=t.indexOf(r);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]},scale.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,r=0,i=t.length;r<i;++r)null==(n=t[r])||isNaN(n=+n)||e.push(n);return e.sort(Jl),rescale()},scale.range=function(e){return arguments.length?(t=pu.call(e),rescale()):t.slice()},scale.quantiles=function(){return n.slice()},scale.copy=function(){return src_quantile_quantile().domain(e).range(t)},scale}function src_quantize_quantize(){var e=0,t=1,n=1,r=[.5],i=[0,1];function scale(e){if(e<=e)return i[nu(r,e,0,n)]}function rescale(){var i=-1;for(r=new Array(n);++i<n;)r[i]=((i+1)*t-(i-n)*e)/(n+1);return scale}return scale.domain=function(n){return arguments.length?(e=+n[0],t=+n[1],rescale()):[e,t]},scale.range=function(e){return arguments.length?(n=(i=pu.call(e)).length-1,rescale()):i.slice()},scale.invertExtent=function(a){var o=i.indexOf(a);return o<0?[NaN,NaN]:o<1?[e,r[0]]:o>=n?[r[n-1],t]:[r[o-1],r[o]]},scale.copy=function(){return src_quantize_quantize().domain([e,t]).range(i)},linear_linearish(scale)}var Ef=new Date,Tf=new Date;function interval_newInterval(e,t,n,r){function interval(t){return e(t=new Date(+t)),t}return interval.floor=interval,interval.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},interval.round=function(e){var t=interval(e),n=interval.ceil(e);return e-t<n-e?t:n},interval.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},interval.range=function(n,r,i){var a,o=[];if(n=interval.ceil(n),i=null==i?1:Math.floor(i),!(n<r&&i>0))return o;do{o.push(a=new Date(+n)),t(n,i),e(n)}while(a<n&&n<r);return o},interval.filter=function(n){return interval_newInterval(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););})},n&&(interval.count=function(t,r){return Ef.setTime(+t),Tf.setTime(+r),e(Ef),e(Tf),Math.floor(n(Ef,Tf))},interval.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?interval.filter(r?function(t){return r(t)%e==0}:function(t){return interval.count(0,t)%e==0}):interval:null}),interval}var Af=interval_newInterval(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Af.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?interval_newInterval(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):Af:null};var Of=Af,Nf=(Af.range,6e4),Rf=6048e5,Ff=interval_newInterval(function(e){e.setTime(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),Df=Ff,Lf=(Ff.range,interval_newInterval(function(e){e.setTime(Math.floor(e/Nf)*Nf)},function(e,t){e.setTime(+e+t*Nf)},function(e,t){return(t-e)/Nf},function(e){return e.getMinutes()})),If=Lf,jf=(Lf.range,interval_newInterval(function(e){var t=e.getTimezoneOffset()*Nf%36e5;t<0&&(t+=36e5),e.setTime(36e5*Math.floor((+e-t)/36e5)+t)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()})),zf=jf,Bf=(jf.range,interval_newInterval(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Nf)/864e5},function(e){return e.getDate()-1})),Hf=Bf;Bf.range;function week_weekday(e){return interval_newInterval(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Nf)/Rf})}var Uf=week_weekday(0),Vf=week_weekday(1),qf=week_weekday(2),Wf=week_weekday(3),Gf=week_weekday(4),Yf=week_weekday(5),Xf=week_weekday(6),$f=(Uf.range,Vf.range,qf.range,Wf.range,Gf.range,Yf.range,Xf.range,interval_newInterval(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()})),Zf=$f,Kf=($f.range,interval_newInterval(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}));Kf.every=function(e){return isFinite(e=Math.floor(e))&&e>0?interval_newInterval(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};var Jf=Kf,Qf=(Kf.range,interval_newInterval(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Nf)},function(e,t){return(t-e)/Nf},function(e){return e.getUTCMinutes()})),eh=(Qf.range,interval_newInterval(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()})),th=(eh.range,interval_newInterval(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1})),nh=th;th.range;function utcWeek_utcWeekday(e){return interval_newInterval(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/Rf})}var rh=utcWeek_utcWeekday(0),ih=utcWeek_utcWeekday(1),ah=utcWeek_utcWeekday(2),oh=utcWeek_utcWeekday(3),sh=utcWeek_utcWeekday(4),ch=utcWeek_utcWeekday(5),lh=utcWeek_utcWeekday(6),uh=(rh.range,ih.range,ah.range,oh.range,sh.range,ch.range,lh.range,interval_newInterval(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()})),fh=(uh.range,interval_newInterval(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}));fh.every=function(e){return isFinite(e=Math.floor(e))&&e>0?interval_newInterval(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};var hh=fh;fh.range;function locale_localDate(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function locale_utcDate(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function locale_newYear(e){return{y:e,m:0,d:1,H:0,M:0,S:0,L:0}}var dh,_h,ph,yh,gh={"-":"",_:" ",0:"0"},mh=/^\s*\d+/,vh=/^%/,bh=/[\\^$*+?|[\]().{}]/g;function src_locale_pad(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(t)+i:i)}function locale_requote(e){return e.replace(bh,"\\$&")}function locale_formatRe(e){return new RegExp("^(?:"+e.map(locale_requote).join("|")+")","i")}function locale_formatLookup(e){for(var t={},n=-1,r=e.length;++n<r;)t[e[n].toLowerCase()]=n;return t}function locale_parseWeekdayNumberSunday(e,t,n){var r=mh.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function locale_parseWeekdayNumberMonday(e,t,n){var r=mh.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function locale_parseWeekNumberSunday(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function locale_parseWeekNumberISO(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function locale_parseWeekNumberMonday(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function locale_parseFullYear(e,t,n){var r=mh.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function locale_parseYear(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function locale_parseZone(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function locale_parseMonthNumber(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function locale_parseDayOfMonth(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function locale_parseDayOfYear(e,t,n){var r=mh.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function locale_parseHour24(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function locale_parseMinutes(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function locale_parseSeconds(e,t,n){var r=mh.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function locale_parseMilliseconds(e,t,n){var r=mh.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function locale_parseMicroseconds(e,t,n){var r=mh.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function locale_parseLiteralPercent(e,t,n){var r=vh.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function locale_parseUnixTimestamp(e,t,n){var r=mh.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function locale_parseUnixTimestampSeconds(e,t,n){var r=mh.exec(t.slice(n));return r?(e.Q=1e3*+r[0],n+r[0].length):-1}function locale_formatDayOfMonth(e,t){return src_locale_pad(e.getDate(),t,2)}function locale_formatHour24(e,t){return src_locale_pad(e.getHours(),t,2)}function locale_formatHour12(e,t){return src_locale_pad(e.getHours()%12||12,t,2)}function locale_formatDayOfYear(e,t){return src_locale_pad(1+Hf.count(Jf(e),e),t,3)}function locale_formatMilliseconds(e,t){return src_locale_pad(e.getMilliseconds(),t,3)}function locale_formatMicroseconds(e,t){return locale_formatMilliseconds(e,t)+"000"}function locale_formatMonthNumber(e,t){return src_locale_pad(e.getMonth()+1,t,2)}function locale_formatMinutes(e,t){return src_locale_pad(e.getMinutes(),t,2)}function locale_formatSeconds(e,t){return src_locale_pad(e.getSeconds(),t,2)}function locale_formatWeekdayNumberMonday(e){var t=e.getDay();return 0===t?7:t}function locale_formatWeekNumberSunday(e,t){return src_locale_pad(Uf.count(Jf(e),e),t,2)}function locale_formatWeekNumberISO(e,t){var n=e.getDay();return e=n>=4||0===n?Gf(e):Gf.ceil(e),src_locale_pad(Gf.count(Jf(e),e)+(4===Jf(e).getDay()),t,2)}function locale_formatWeekdayNumberSunday(e){return e.getDay()}function locale_formatWeekNumberMonday(e,t){return src_locale_pad(Vf.count(Jf(e),e),t,2)}function src_locale_formatYear(e,t){return src_locale_pad(e.getFullYear()%100,t,2)}function locale_formatFullYear(e,t){return src_locale_pad(e.getFullYear()%1e4,t,4)}function locale_formatZone(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+src_locale_pad(t/60|0,"0",2)+src_locale_pad(t%60,"0",2)}function locale_formatUTCDayOfMonth(e,t){return src_locale_pad(e.getUTCDate(),t,2)}function locale_formatUTCHour24(e,t){return src_locale_pad(e.getUTCHours(),t,2)}function locale_formatUTCHour12(e,t){return src_locale_pad(e.getUTCHours()%12||12,t,2)}function locale_formatUTCDayOfYear(e,t){return src_locale_pad(1+nh.count(hh(e),e),t,3)}function locale_formatUTCMilliseconds(e,t){return src_locale_pad(e.getUTCMilliseconds(),t,3)}function locale_formatUTCMicroseconds(e,t){return locale_formatUTCMilliseconds(e,t)+"000"}function locale_formatUTCMonthNumber(e,t){return src_locale_pad(e.getUTCMonth()+1,t,2)}function locale_formatUTCMinutes(e,t){return src_locale_pad(e.getUTCMinutes(),t,2)}function locale_formatUTCSeconds(e,t){return src_locale_pad(e.getUTCSeconds(),t,2)}function locale_formatUTCWeekdayNumberMonday(e){var t=e.getUTCDay();return 0===t?7:t}function locale_formatUTCWeekNumberSunday(e,t){return src_locale_pad(rh.count(hh(e),e),t,2)}function locale_formatUTCWeekNumberISO(e,t){var n=e.getUTCDay();return e=n>=4||0===n?sh(e):sh.ceil(e),src_locale_pad(sh.count(hh(e),e)+(4===hh(e).getUTCDay()),t,2)}function locale_formatUTCWeekdayNumberSunday(e){return e.getUTCDay()}function locale_formatUTCWeekNumberMonday(e,t){return src_locale_pad(ih.count(hh(e),e),t,2)}function locale_formatUTCYear(e,t){return src_locale_pad(e.getUTCFullYear()%100,t,2)}function locale_formatUTCFullYear(e,t){return src_locale_pad(e.getUTCFullYear()%1e4,t,4)}function locale_formatUTCZone(){return"+0000"}function locale_formatLiteralPercent(){return"%"}function locale_formatUnixTimestamp(e){return+e}function locale_formatUnixTimestampSeconds(e){return Math.floor(+e/1e3)}!function d3_time_format_src_defaultLocale_defaultLocale(e){return dh=function locale_formatLocale(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,a=e.days,o=e.shortDays,s=e.months,c=e.shortMonths,l=locale_formatRe(i),u=locale_formatLookup(i),f=locale_formatRe(a),h=locale_formatLookup(a),d=locale_formatRe(o),_=locale_formatLookup(o),p=locale_formatRe(s),y=locale_formatLookup(s),g=locale_formatRe(c),m=locale_formatLookup(c),v={a:function formatShortWeekday(e){return o[e.getDay()]},A:function formatWeekday(e){return a[e.getDay()]},b:function formatShortMonth(e){return c[e.getMonth()]},B:function formatMonth(e){return s[e.getMonth()]},c:null,d:locale_formatDayOfMonth,e:locale_formatDayOfMonth,f:locale_formatMicroseconds,H:locale_formatHour24,I:locale_formatHour12,j:locale_formatDayOfYear,L:locale_formatMilliseconds,m:locale_formatMonthNumber,M:locale_formatMinutes,p:function formatPeriod(e){return i[+(e.getHours()>=12)]},Q:locale_formatUnixTimestamp,s:locale_formatUnixTimestampSeconds,S:locale_formatSeconds,u:locale_formatWeekdayNumberMonday,U:locale_formatWeekNumberSunday,V:locale_formatWeekNumberISO,w:locale_formatWeekdayNumberSunday,W:locale_formatWeekNumberMonday,x:null,X:null,y:src_locale_formatYear,Y:locale_formatFullYear,Z:locale_formatZone,"%":locale_formatLiteralPercent},b={a:function formatUTCShortWeekday(e){return o[e.getUTCDay()]},A:function formatUTCWeekday(e){return a[e.getUTCDay()]},b:function formatUTCShortMonth(e){return c[e.getUTCMonth()]},B:function formatUTCMonth(e){return s[e.getUTCMonth()]},c:null,d:locale_formatUTCDayOfMonth,e:locale_formatUTCDayOfMonth,f:locale_formatUTCMicroseconds,H:locale_formatUTCHour24,I:locale_formatUTCHour12,j:locale_formatUTCDayOfYear,L:locale_formatUTCMilliseconds,m:locale_formatUTCMonthNumber,M:locale_formatUTCMinutes,p:function formatUTCPeriod(e){return i[+(e.getUTCHours()>=12)]},Q:locale_formatUnixTimestamp,s:locale_formatUnixTimestampSeconds,S:locale_formatUTCSeconds,u:locale_formatUTCWeekdayNumberMonday,U:locale_formatUTCWeekNumberSunday,V:locale_formatUTCWeekNumberISO,w:locale_formatUTCWeekdayNumberSunday,W:locale_formatUTCWeekNumberMonday,x:null,X:null,y:locale_formatUTCYear,Y:locale_formatUTCFullYear,Z:locale_formatUTCZone,"%":locale_formatLiteralPercent},x={a:function parseShortWeekday(e,t,n){var r=d.exec(t.slice(n));return r?(e.w=_[r[0].toLowerCase()],n+r[0].length):-1},A:function parseWeekday(e,t,n){var r=f.exec(t.slice(n));return r?(e.w=h[r[0].toLowerCase()],n+r[0].length):-1},b:function parseShortMonth(e,t,n){var r=g.exec(t.slice(n));return r?(e.m=m[r[0].toLowerCase()],n+r[0].length):-1},B:function parseMonth(e,t,n){var r=p.exec(t.slice(n));return r?(e.m=y[r[0].toLowerCase()],n+r[0].length):-1},c:function parseLocaleDateTime(e,n,r){return parseSpecifier(e,t,n,r)},d:locale_parseDayOfMonth,e:locale_parseDayOfMonth,f:locale_parseMicroseconds,H:locale_parseHour24,I:locale_parseHour24,j:locale_parseDayOfYear,L:locale_parseMilliseconds,m:locale_parseMonthNumber,M:locale_parseMinutes,p:function parsePeriod(e,t,n){var r=l.exec(t.slice(n));return r?(e.p=u[r[0].toLowerCase()],n+r[0].length):-1},Q:locale_parseUnixTimestamp,s:locale_parseUnixTimestampSeconds,S:locale_parseSeconds,u:locale_parseWeekdayNumberMonday,U:locale_parseWeekNumberSunday,V:locale_parseWeekNumberISO,w:locale_parseWeekdayNumberSunday,W:locale_parseWeekNumberMonday,x:function parseLocaleDate(e,t,r){return parseSpecifier(e,n,t,r)},X:function parseLocaleTime(e,t,n){return parseSpecifier(e,r,t,n)},y:locale_parseYear,Y:locale_parseFullYear,Z:locale_parseZone,"%":locale_parseLiteralPercent};function newFormat(e,t){return function(n){var r,i,a,o=[],s=-1,c=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===e.charCodeAt(s)&&(o.push(e.slice(c,s)),null!=(i=gh[r=e.charAt(++s)])?r=e.charAt(++s):i="e"===r?" ":"0",(a=t[r])&&(r=a(n,i)),o.push(r),c=s+1);return o.push(e.slice(c,s)),o.join("")}}function newParse(e,t){return function(n){var r,i,a=locale_newYear(1900);if(parseSpecifier(a,e,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("p"in a&&(a.H=a.H%12+12*a.p),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(r=(i=(r=locale_utcDate(locale_newYear(a.y))).getUTCDay())>4||0===i?ih.ceil(r):ih(r),r=nh.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(r=(i=(r=t(locale_newYear(a.y))).getDay())>4||0===i?Vf.ceil(r):Vf(r),r=Hf.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?locale_utcDate(locale_newYear(a.y)).getUTCDay():t(locale_newYear(a.y)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,locale_utcDate(a)):t(a)}}function parseSpecifier(e,t,n,r){for(var i,a,o=0,s=t.length,c=n.length;o<s;){if(r>=c)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(a=x[i in gh?t.charAt(o++):i])||(r=a(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=newFormat(n,v),v.X=newFormat(r,v),v.c=newFormat(t,v),b.x=newFormat(n,b),b.X=newFormat(r,b),b.c=newFormat(t,b),{format:function format(e){var t=newFormat(e+="",v);return t.toString=function(){return e},t},parse:function parse(e){var t=newParse(e+="",locale_localDate);return t.toString=function(){return e},t},utcFormat:function utcFormat(e){var t=newFormat(e+="",b);return t.toString=function(){return e},t},utcParse:function utcParse(e){var t=newParse(e,locale_utcDate);return t.toString=function(){return e},t}}}(e),_h=dh.format,dh.parse,ph=dh.utcFormat,yh=dh.utcParse,dh}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Date.prototype.toISOString||ph("%Y-%m-%dT%H:%M:%S.%LZ");+new Date("2000-01-01T00:00:00.000Z")||yh("%Y-%m-%dT%H:%M:%S.%LZ");var xh=1e3,wh=60*xh,Ch=60*wh,kh=24*Ch,Sh=7*kh,Mh=30*kh,Ph=365*kh;function src_time_date(e){return new Date(e)}function src_time_number(e){return e instanceof Date?+e:+new Date(+e)}function time_calendar(e,t,n,r,i,a,o,s,c){var l=continuous_continuous(continuous_deinterpolateLinear,Xu),u=l.invert,f=l.domain,h=c(".%L"),d=c(":%S"),_=c("%I:%M"),p=c("%I %p"),y=c("%a %d"),g=c("%b %d"),m=c("%B"),v=c("%Y"),b=[[o,1,xh],[o,5,5*xh],[o,15,15*xh],[o,30,30*xh],[a,1,wh],[a,5,5*wh],[a,15,15*wh],[a,30,30*wh],[i,1,Ch],[i,3,3*Ch],[i,6,6*Ch],[i,12,12*Ch],[r,1,kh],[r,2,2*kh],[n,1,Sh],[t,1,Mh],[t,3,3*Mh],[e,1,Ph]];function tickFormat(s){return(o(s)<s?h:a(s)<s?d:i(s)<s?_:r(s)<s?p:t(s)<s?n(s)<s?y:g:e(s)<s?m:v)(s)}function tickInterval(t,n,r,i){if(null==t&&(t=10),"number"==typeof t){var a=Math.abs(r-n)/t,o=Ql(function(e){return e[2]}).right(b,a);o===b.length?(i=ticks_tickStep(n/Ph,r/Ph,t),t=e):o?(i=(o=b[a/b[o-1][2]<b[o][2]/a?o-1:o])[1],t=o[0]):(i=Math.max(ticks_tickStep(n,r,t),1),t=s)}return null==i?t:t.every(i)}return l.invert=function(e){return new Date(u(e))},l.domain=function(e){return arguments.length?f(_u.call(e,src_time_number)):f().map(src_time_date)},l.ticks=function(e,t){var n,r=f(),i=r[0],a=r[r.length-1],o=a<i;return o&&(n=i,i=a,a=n),n=(n=tickInterval(e,i,a,t))?n.range(i,a+1):[],o?n.reverse():n},l.tickFormat=function(e,t){return null==t?tickFormat:c(t)},l.nice=function(e,t){var n=f();return(e=tickInterval(e,n[0],n[n.length-1],t))?f(Pf(n,e)):l},l.copy=function(){return continuous_copy(l,time_calendar(e,t,n,r,i,a,o,s,c))},l}var Eh=function(){return time_calendar(Jf,Zf,Uf,Hf,zf,If,Df,Of,_h).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},Th=function(e){return e.match(/.{6}/g).map(function(e){return"#"+e})};Th("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Th("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),Th("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),Th("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),lf(node_modules_d3_color_src_cubehelix_cubehelix(300,.5,0),node_modules_d3_color_src_cubehelix_cubehelix(-240,.5,1)),lf(node_modules_d3_color_src_cubehelix_cubehelix(-100,.75,.35),node_modules_d3_color_src_cubehelix_cubehelix(80,1.5,.8)),lf(node_modules_d3_color_src_cubehelix_cubehelix(260,.75,.35),node_modules_d3_color_src_cubehelix_cubehelix(80,1.5,.8)),node_modules_d3_color_src_cubehelix_cubehelix();function viridis_ramp(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}viridis_ramp(Th("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),viridis_ramp(Th("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),viridis_ramp(Th("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),viridis_ramp(Th("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function sequential_sequential(e){var t=0,n=1,r=!1;function scale(i){var a=(i-t)/(n-t);return e(r?Math.max(0,Math.min(1,a)):a)}return scale.domain=function(e){return arguments.length?(t=+e[0],n=+e[1],scale):[t,n]},scale.clamp=function(e){return arguments.length?(r=!!e,scale):r},scale.interpolator=function(t){return arguments.length?(e=t,scale):e},scale.copy=function(){return sequential_sequential(e).domain([t,n]).clamp(r)},linear_linearish(scale)}var Ah=function(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n},Oh=(Ah("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Ah("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666")),Nh=Ah("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Rh=Ah("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Fh=Ah("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Dh=Ah("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Lh=Ah("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Ih=Ah("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),jh=Ah("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),zh=function(e){return Yu(e[e.length-1])},Bh=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Ah),Hh=zh(Bh),Uh=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Ah),Vh=zh(Uh),qh=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Ah),Wh=zh(qh),Gh=zh(new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Ah)),Yh=zh(new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Ah)),Xh=zh(new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Ah)),$h=zh(new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Ah)),Zh=zh(new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Ah)),Kh=zh(new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Ah)),Jh=zh(new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Ah)),Qh=zh(new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Ah)),ed=zh(new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Ah)),td=zh(new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Ah)),nd=zh(new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Ah)),rd=zh(new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Ah)),ad=zh(new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Ah)),od=zh(new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Ah)),sd=zh(new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Ah)),cd=zh(new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Ah)),ld=zh(new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Ah)),ud=zh(new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Ah)),fd=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Ah),hd=zh(fd),dd=zh(new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Ah)),_d=zh(new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Ah)),pd=zh(new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Ah)),yd=zh(new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Ah)),gd=zh(new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Ah)),md=lf(node_modules_d3_color_src_cubehelix_cubehelix(300,.5,0),node_modules_d3_color_src_cubehelix_cubehelix(-240,.5,1)),vd=lf(node_modules_d3_color_src_cubehelix_cubehelix(-100,.75,.35),node_modules_d3_color_src_cubehelix_cubehelix(80,1.5,.8)),bd=lf(node_modules_d3_color_src_cubehelix_cubehelix(260,.75,.35),node_modules_d3_color_src_cubehelix_cubehelix(80,1.5,.8)),xd=node_modules_d3_color_src_cubehelix_cubehelix();d3_color_src_color_rgb(),Math.PI,Math.PI;function sequential_multi_viridis_ramp(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}var wd,Cd,kd=sequential_multi_viridis_ramp(Ah("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Sd=sequential_multi_viridis_ramp(Ah("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Md=sequential_multi_viridis_ramp(Ah("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Pd=sequential_multi_viridis_ramp(Ah("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),Ed="continous",Td="discrete",Ad="sequential",Od="ordinal",Nd="linear",Rd="quantize",Fd="hidden";function scale_creator_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Dd=(scale_creator_defineProperty(wd={},Bl,d3_scale_src_linear_linear),scale_creator_defineProperty(wd,Hl,band_band),scale_creator_defineProperty(wd,Wl,src_quantize_quantize),scale_creator_defineProperty(wd,Gl,src_quantile_quantile),scale_creator_defineProperty(wd,Kl,function src_threshold_threshold(){var e=[.5],t=[0,1],n=1;function scale(r){if(r<=r)return t[nu(e,r,0,n)]}return scale.domain=function(r){return arguments.length?(e=pu.call(r),n=Math.min(e.length,t.length-1),scale):e.slice()},scale.range=function(r){return arguments.length?(t=pu.call(r),n=Math.min(e.length,t.length-1),scale):t.slice()},scale.invertExtent=function(n){var r=t.indexOf(n);return[e[r-1],e[r]]},scale.copy=function(){return src_threshold_threshold().domain(e).range(t)},scale}),scale_creator_defineProperty(wd,Zl,sequential_sequential),scale_creator_defineProperty(wd,Yl,function log_log(){var e=continuous_continuous(src_log_deinterpolate,src_log_reinterpolate).domain([1,10]),t=e.domain,n=10,r=log_logp(10),i=log_powp(10);function rescale(){return r=log_logp(n),i=log_powp(n),t()[0]<0&&(r=log_reflect(r),i=log_reflect(i)),e}return e.base=function(e){return arguments.length?(n=+e,rescale()):n},e.domain=function(e){return arguments.length?(t(e),rescale()):t()},e.ticks=function(e){var a,o=t(),s=o[0],c=o[o.length-1];(a=c<s)&&(h=s,s=c,c=h);var l,u,f,h=r(s),d=r(c),_=null==e?10:+e,p=[];if(!(n%1)&&d-h<_){if(h=Math.round(h)-1,d=Math.round(d)+1,s>0){for(;h<d;++h)for(u=1,l=i(h);u<n;++u)if(!((f=l*u)<s)){if(f>c)break;p.push(f)}}else for(;h<d;++h)for(u=n-1,l=i(h);u>=1;--u)if(!((f=l*u)<s)){if(f>c)break;p.push(f)}}else p=lu(h,d,Math.min(d-h,_)).map(i);return a?p.reverse():p},e.tickFormat=function(t,a){if(null==a&&(a=10===n?".0e":","),"function"!=typeof a&&(a=mf(a)),t===1/0)return a;null==t&&(t=10);var o=Math.max(1,n*t/e.ticks().length);return function(e){var t=e/i(Math.round(r(e)));return t*n<n-.5&&(t*=n),t<=o?a(e):""}},e.nice=function(){return t(Pf(t(),{floor:function floor(e){return i(Math.floor(r(e)))},ceil:function ceil(e){return i(Math.ceil(r(e)))}}))},e.copy=function(){return continuous_copy(e,log_log().base(n))},e}),scale_creator_defineProperty(wd,Xl,pow_pow),scale_creator_defineProperty(wd,$l,function src_identity_identity(){var e=[0,1];function scale(e){return+e}return scale.invert=scale,scale.domain=scale.range=function(t){return arguments.length?(e=_u.call(t,ff),scale):e.slice()},scale.copy=function(){return src_identity_identity().domain(e)},linear_linearish(scale)}),scale_creator_defineProperty(wd,Ul,Eh),scale_creator_defineProperty(wd,Vl,d3_scale_src_linear_linear),scale_creator_defineProperty(wd,ql,ordinal_ordinal),scale_creator_defineProperty(wd,"scaleSequential",sequential_sequential),wd),Ld=(scale_creator_defineProperty(Cd={schemeAccent:Oh,schemeBlues:fd,schemeDark2:Nh,schemePaired:Rh,schemePastel1:Fh,schemePastel2:Dh,schemeSet1:Lh,schemeSet2:Ih,schemeSet3:jh,schemeBrBG:Bh,schemePRGn:Uh,schemePiYG:qh,interpolateBrBG:Hh,interpolatePRGn:Vh,interpolatePiYG:Wh,interpolatePuOr:Gh,interpolateRdBu:Yh,interpolateRdGy:Xh,interpolateRdYlBu:$h,interpolateRdYlGn:Zh,interpolateSpectral:Kh,interpolateBlues:hd,interpolateGreens:dd,interpolateGreys:_d,interpolateOranges:gd,interpolatePurples:pd,interpolateReds:yd,interpolateViridis:kd,interpolateInferno:Md,interpolateMagma:Sd,interpolatePlasma:Pd,interpolateWarm:vd,interpolateCool:bd,interpolateCubehelixDefault:md,interpolateBuGn:Jh,interpolateBuPu:Qh,interpolateGnBu:ed,interpolateOrRd:td,interpolatePuBuGn:nd,interpolatePuBu:rd,interpolatePuRd:ad,interpolateRdPu:od,interpolateYlGnBu:sd,interpolateYlGn:cd,interpolateYlOrBr:ld,interpolateYlOrRd:ud,interpolateRainbow:function(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return xd.h=360*e-100,xd.s=1.5-1.5*t,xd.l=.8-.9*t,xd+""}},Hl,band_band),scale_creator_defineProperty(Cd,Wl,src_quantize_quantize),scale_creator_defineProperty(Cd,Gl,src_quantile_quantile),scale_creator_defineProperty(Cd,Ul,Eh),scale_creator_defineProperty(Cd,Vl,d3_scale_src_linear_linear),scale_creator_defineProperty(Cd,ql,ordinal_ordinal),Cd);function scale_creator_createScale(e){if(!e.type||!Dd[e.type])throw new Error(e.type+" is not a valid scale type");if(!Array.isArray(e.range))throw new Error("range parameter must be an array");var t=null,n=e.range;if(e.type===Nd&&e.interpolator){if(t=Dd[e.interpolator],e.interpolator===Xl)return t().range(n).exponent(e.exponent);if(e.interpolator===Yl)return t().range(n).base([e.base])}else t=Dd[e.type];return e.type===Rd&&t().nice(),t().range(n)}var Id={id:Ht(),axisName:{defClassName:"axis-name"},axisNamePadding:12,base:10,classPrefix:"muze",className:"muze-axis",exponent:1,interpolator:"linear",fixedBaseline:!0,labels:{rotation:0,smartTicks:!1},orientation:"left",maxHeight:50,maxWidth:40,numberFormat:function numberFormat(e){return e},padding:.3,nice:!0,numberOfTicks:10,rotate:!1,show:!0,showAxisName:!1,showInnerTicks:null,showOuterTicks:null,style:{},type:"linear",tickFormat:null,tickValues:null,xOffset:void 0,yOffset:void 0},jd=function rotateAxis(e,t,n,r){var i=e.axis(),a=r.orientation,o=r.labels,s=r.fixedBaseline,c=r.type,l=o.rotation,u=e.getTickSize();return t.each(function(e,t){var r=void 0,o=void 0;e=(i.tickFormat?i.tickFormat()(e):e).toString();var f=n.getOriSize(e),h=.5*f.width,d=.5*f.height;l<0&&(l=360+l);var _=4-Math.floor(l/90),p=(_%2==0?l:180*Math.ceil(l/180)-l)%180;r=Math.sqrt(Math.pow(d,2)+Math.pow(h,2))*Math.sin(function angleToRadian(e){return e*Math.PI/180}(p)),3!==_&&2!==_||p>67.5&&p<=90||(r+=2*d),o=h,o=90===l?d:270===l?-d:0,a===Ll?(o=0===t&&s&&c===Nd?o+o/4:o,Pr(this).attr("transform","translate("+2*-o+" "+(-r-u)+") rotate("+l+")")):(o=0===t&&s&&c===Nd?o-o/4:o,Pr(this).attr("transform","translate("+2*o+" "+(r+u)+") rotate("+l+")"))}),t},zd=function changeTickOrientation(e,t,n){var r=t._smartTicks,i=t.config(),a=t.dependencies().labelManager,o=i.labels,s=i.orientation,c=o.rotation,l=o.smartTicks,u=e.selectAll(".tick text");if(u.selectAll("tspan").remove(),0===c||!1!==l||void 0!==s&&"bottom"!==s)if(0===c&&!1===l)u.attr("transform","");else{u.attr("y",0).attr("x",0).text(""),Er(u,"tspan",function(e,t){return r[t].lines},"smart-text").attr("dy","0").style("opacity","0").transition().duration(1e3).attr("dy",function(e,t){return"bottom"===s||0!==t?r[t].oriTextHeight:-r[t].oriTextHeight*(r[t].lines.length-1)-n}).style("opacity",1).attr("x",0).text(function(e){return e})}else jd(t,u,a,i);return u},Bd=function setFixedBaseline(e){e.config().fixedBaseline&&e.setFixedBaseline()},Hd=function setAxisNamePos(e,t,n){var r=n.axisNameHeight,i=n.yOffset,a=n.xOffset,o=n.labelOffset,s=n.availableSpace,c=n.axisNameWidth;switch(t){case Il:e.attr("transform","translate("+-(s.width-r)+","+(i+o)+")rotate(-90)");break;case jl:e.attr("transform","translate("+(s.width-r)+","+(i+o)+")rotate(90)");break;case Ll:e.attr("transform","translate("+(o+a+c/2)+","+(-s.height+r)+")");break;case Dl:e.attr("transform","translate("+s.width/2+","+(s.height-r/2)+")")}return e};var Ud=function getTickLabelInfo(e){var t="",n=void 0,r={},i=void 0,a=e.scale(),o=[],s=e.config(),c=s.tickFormat,l=s.tickValues,u=s.numberFormat,f=a.ticks||a.quantile||a.domain,h=e.dependencies().labelManager;return h.setStyle(e._tickLabelStyle),i=(i=l||f()).map(function(i,s){var l=u(i),f=c?c(l):a.tickFormat?u(a.tickFormat()(i)):l,d=f.toString();return o.push(h.getOriSize(d)),d.length>t.length&&(t=d,r=e.smartTicks()?e.smartTicks()[s]:{},n=o[s]),f}),n=h.getOriSize(t),{largestLabel:t,largestLabelDim:n,axisTickLabels:i,allLabelLengths:o,smartTick:r}},Vd=function setOffset(e){var t=0,n=0,r=e.logicalSpace(),i=e.config(),a=i.orientation,o=i.xOffset,s=i.yOffset;a===Il&&(t=void 0===o?r.width:o),a===Ll&&(n=void 0===s?r.height:s),e.config({xOffset:t,yOffset:n})},qd=function adjustRange(e,t,n,r){var i=function getAxisOffset(e,t,n){var r=Math.abs(t[1]-t[0])/(n[1]-n[0])*e,i=t[1]-t[0],a=i/r;return(i-i/(a+1)*a)/2}(e,t,n);return r===Ll||r===Dl?(t[0]+=i,t[1]-=i):(t[0]-=i,t[1]+=i),t},Wd=function registerChangeListeners(e){return e.store().model.next(["domain","range","mount","config"],function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];e.render(),e._domainLock=!1,e._eventList.forEach(function(e){e.action instanceof Function&&e.action.apply(e,n)})},!0),e},Gd=function getHorizontalAxisSpace(e,t,n,r){var i=void 0,a=void 0,o=t.tickSize,s=t.tickLabelDim,c=t.axisLabelDim,l=n.axisNamePadding,u=n.showAxisName,f=n.tickValues,h=c.height,d=s.height,_=s.width;return i=r&&r.length?r[1]-r[0]:0,a=0,f&&(i=f.reduce(function(t){return t+=_+e._minTickDistance.width},0)),a=i&&0!==i?d:Math.max(_,d),{width:i,height:a+=(u?h+l:0)+o}},Yd=function getVerticalAxisSpace(e,t,n){var r=void 0,i=void 0,a=t.tickSize,o=t.tickLabelDim,s=t.axisLabelDim,c=n.axisNamePadding,l=n.showAxisName,u=n.tickValues,f=s.height,h=o.height;return r=0,i=o.width,u&&(r=u.reduce(function(e){return e+=1.1*h},0)),{height:r,width:i+=(l?f:0)+a+c}},Xd={availableSpace:{},axisDimensions:{},config:{sanitization:function sanitization(e,t){return t.labels&&t.labels.rotation&&(e._rotationLock=!0),(t=hn(e._config||{},t)).axisNamePadding=Math.max(t.axisNamePadding,0),e.axis(e.createAxis(t)),e.store().commit("config",t),t}},logicalSpace:{},mount:{sanitization:function sanitization(e,t){return e.store().commit("mount",t),t}},range:{sanitization:function sanitization(e,t){return e.scale().range(t),e.logicalSpace(null),e.store().commit("range",t),t}},smartTicks:{},store:{},tickSize:{}},$d=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Zd=function(){function SimpleAxis(e,t){!function simple_axis_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SimpleAxis),this._id=Ht(),this._dependencies=t,this._mount=null,this._range=[],this._domain=[],this._domainLock=!1,this._rotationLock=!1,this._axisDimensions={},this._eventList=[];var n=hn({},this.constructor.defaultConfig()),r=hn(n,e),i=Pr("body"),a=r.classPrefix;this._tickLabelStyle=Ir(i,a+"-ticks"),this._axisNameStyle=Ir(i,a+"-axis-name"),t.labelManager.setStyle(this._tickLabelStyle),this._minTickDistance=t.labelManager.getOriSize("ww"),sn(this,Xd),this.store(new nn({domain:this.domain(),range:this.range(),config:r,mount:this.mount()})),this.config(r),this._scale=this.createScale(this._config),this._axis=this.createAxis(this._config),Wd(this)}return $d(SimpleAxis,[{key:"setFixedBaseline",value:function setFixedBaseline(){return this}},{key:"scale",value:function scale(){return arguments.length?(this._scale=arguments.length<=0?void 0:arguments[0],this):this._scale}},{key:"axis",value:function axis(){return arguments.length?(this._axis=arguments.length<=0?void 0:arguments[0],this):this._axis}},{key:"domain",value:function domain(){return arguments.length?(this.scale().domain(arguments.length<=0?void 0:arguments[0]),this._domain=this.scale().domain(),this.smartTicks(this.setTickConfig()),this.store().commit("domain",this._domain),this.logicalSpace(null),this):this._domain}},{key:"dependencies",value:function dependencies(){return this._dependencies}},{key:"createScale",value:function createScale(e){var t=e.base;return scale_creator_createScale({padding:e.padding,interpolator:e.interpolator,exponent:e.exponent,base:t,range:this.range(),type:this.constructor.type()})}},{key:"createAxis",value:function createAxis(e){var t=e.tickFormat,n=e.numberFormat,r=e.orientation,i=zl[r];if(i){var a=i(this.scale()),o={};return o=t?function formatter(e){for(var r=arguments.length,i=Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return t.apply(void 0,[n(e)].concat(i))}:function formatter(e){return n(e)},a=a.tickFormat(o)}return null}},{key:"setTickConfig",value:function setTickConfig(){return this}},{key:"setRotationConfig",value:function setRotationConfig(e,t){var n=this.config().orientation;if(n===Ll||n===Dl){var r=this.range(),i=Math.abs(r[0]-r[1]);this.config({labels:{rotation:0}}),i>0&&e.length*(t+this._minTickDistance.width)>i&&this.config({labels:{rotation:-90}})}return this}},{key:"adjustRange",value:function adjustRange(){return this}},{key:"getScaleValue",value:function getScaleValue(e){if(null!==e&&void 0!==e)return this.scale()(e)}},{key:"getTickSize",value:function getTickSize(){return this.axis().tickSize()}},{key:"getAxisDimensions",value:function getAxisDimensions(){return this.axisDimensions(function computeAxisDimensions(e){var t={},n=e.config(),r=n.name,i=n.labels,a=n.tickValues,o=(i.smartTicks?0:i.rotation)*Math.PI/180,s=e.dependencies().labelManager,c=Ud(e),l=c.largestLabelDim,u=c.axisTickLabels,f=c.smartTick,h=l.height,d=l.width;return 0===e.domain().length?null:(!1===e._rotationLock&&(e.setRotationConfig(a||u,l.width),e._rotationLock=!1),t=i.smartTicks?f:{width:Math.abs(h*Math.sin(o))+Math.abs(d*Math.cos(o)),height:Math.abs(d*Math.sin(o))+Math.abs(h*Math.cos(o))},s.setStyle(e._axisNameStyle),{tickSize:e.getTickSize(),tickLabelDim:t,axisLabelDim:s.getOriSize(r),largestLabelDim:l,axisTickLabels:u})}(this)),this.axisDimensions()}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||(this.logicalSpace(function calculateContinousSpace(e){var t=e.range(),n=e.config(),r=e.getAxisDimensions(),i=n.orientation,a=n.show,o=r.axisLabelDim;if(!1===a)return{width:0,height:0};var s=o.width;if(i===Ll||i===Dl){var c=Gd(e,r,n,t),l=c.width,u=c.height;return{width:Math.max(l,s),height:u}}var f=Yd(0,r,n),h=f.width,d=f.height;return{width:h,height:Math.max(d,s)}}(this)),Vd(this),this.logicalSpace()),this.logicalSpace()}},{key:"invert",value:function invert(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=n.map(function(t){return e.scale().invert(t)})||[];return 1===n.length?i[0]:i}},{key:"getNearestRange",value:function getNearestRange(e,t){var n=void 0,r=this.config().type,i=this.scale(),a=i.range(),o=a[0]>a[1];return"band"===r?(n=i.invertExtent(e,t),[i(o?n[n.length-1]:n[0]),i(o?n[0]:n[n.length-1])+i.bandwidth()]):[e,t]}},{key:"updateDomainBounds",value:function updateDomainBounds(e){var t=this.domain();return 0===t.length&&(t=e),e.length&&(t=[Math.min(t[0],e[0]),Math.max(t[1],e[1])]),this.domain(t)}},{key:"updateDomainCache",value:function updateDomainCache(e){return!1===this._domainLock&&(this.domain([]),this._domainLock=!0),this.updateDomainBounds(e||[])}},{key:"setTickValues",value:function setTickValues(){var e=this.config().tickValues;return e?(e instanceof Array&&this.axis().tickValues(e),this):this}},{key:"getUnitWidth",value:function getUnitWidth(){return 0}},{key:"serialize",value:function serialize(){return{name:this.name,type:this.type,range:this.range(),config:this.config()}}},{key:"registerEvent",value:function registerEvent(e,t){this._eventList.push({name:e,action:t})}},{key:"on",value:function on(e,t){e=e||"update",this.registerEvent(e,t)}},{key:"render",value:function render(){return this.mount()&&function renderAxis(e){var t=e.config(),n=e.dependencies().labelManager,r=e.mount(),i=e.range(),a=e.axis(),o=e._axisNameStyle,s=e._tickLabelStyle,c=t.orientation,l=t.name,u=t.labels,f=t.xOffset,h=t.yOffset,d=t.axisNamePadding,_=t.className,p=t.showAxisName,y=t.show,g=t.id,m=t.interpolator,v=t.classPrefix;if(y){var b=e.getTickSize(),x=Er(Pr(r),"g",[1],""+_);n.setStyle(s),"linear"===m&&e.setTickValues();var w=Math.abs(i[0]-i[1]),C=e.axisDimensions().tickLabelDim;x.attr("transform","translate("+f+","+h+")"),Bd(e),!1===u.smartTicks?x.transition().duration(1e3).call(a):x.call(a),x.selectAll(".tick").classed(v+"-ticks",!0),x.selectAll(".tick line").classed(v+"-tick-lines",!0),x.selectAll(".tick text").classed(v+"-ticks",!0).classed(v+"-ticks-"+g,!0),zd(x,e,b);var k=Er(x,"text",[l],v+"-axis-name").attr("text-anchor","middle").classed(v+"-axis-name-"+g,!0).text(function(e){return e});k.classed(Fd,!p);var S=w/2;n.setStyle(o);var M=n.getOriSize(l),P={labelProps:C,tickSize:b,axisNamePadding:d,axisNameHeight:M.height,axisNameWidth:M.width,yOffset:h,xOffset:f,labelOffset:S,availableSpace:e.availableSpace()};Hd(k,c,P)}}(this),this}},{key:"remove",value:function remove(){return this.store().unsubscribeAll(),Pr(this.mount()).remove(),this}},{key:"unsubscribe",value:function unsubscribe(){return this.store().unsubscribeAll(),this}},{key:"isReverse",value:function isReverse(){var e=this.range();return e[0]>e[1]}},{key:"getPixelToValueRatio",value:function getPixelToValueRatio(){var e=this.scale(),t=e.range(),n=e.domain();return Math.abs(t[1]-t[0])/(n[1]-n[0])}},{key:"id",get:function get(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return Id}}]),SimpleAxis}(),Kd=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Jd=function(e){function LinearAxis(){return function linear_axis_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LinearAxis),function linear_axis_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(LinearAxis.__proto__||Object.getPrototypeOf(LinearAxis)).apply(this,arguments))}return function linear_axis_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(LinearAxis,Zd),Kd(LinearAxis,[{key:"createScale",value:function createScale(e){var t=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(LinearAxis.prototype.__proto__||Object.getPrototypeOf(LinearAxis.prototype),"createScale",this).call(this,e);return t=t.nice()}},{key:"updateDomainBounds",value:function updateDomainBounds(e){var t=this.domain();return 0===t.length&&(t=e),e.length&&(t=[Math.min(t[0],e[0]),Math.max(t[1],e[1])]),t=function sanitizeDomain(e,t){return t.config().interpolator===Yl&&e[0]>=0?[Math.max(1,e[0]),Math.max(1,e[1])]:e}(t,this),this.domain(t)}},{key:"getScaleValue",value:function getScaleValue(e){if(null!==e&&void 0!==e)return this.config().interpolator===Yl&&e<=0?1:this.scale()(e)+.5}},{key:"getTickSize",value:function getTickSize(){var e=this.config(),t=e.showInnerTicks,n=e.showOuterTicks,r=this.axis();return r.tickSizeInner(!1===t?0:6),r.tickSizeOuter(!1===n?0:6),r.tickSize()}},{key:"domain",value:function domain(e){if(e&&e.length){var t=this.config().nice;return e.length&&e[0]===e[1]&&(e=[0,2*+e[0]]),this.scale().domain(e),t&&this.scale().nice(),this._domain=this.scale().domain(),this.store().commit("domain",this._domain),this.logicalSpace(null),this}return this._domain}},{key:"setAvailableSpace",value:function setAvailableSpace(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments[1],n=arguments[2],r=arguments[3],i=n.left,a=n.right,o=n.top,s=n.bottom,c=this.config(),l=c.orientation,u=c.fixedBaseline,f=this.getAxisDimensions().tickLabelDim;if(this.availableSpace({width:e,height:t}),l===Ll||l===Dl){var h=f.width;this.range([(u?0:h/2)+i,e-a-h/2]);var d=this.getLogicalSpace().height;r&&this.config({yOffset:Math.max(d,t)})}else{var _=f.height;this.range([t-s-(u?0:_/2),_/2+o]);var p=this.getLogicalSpace().width;r&&this.config({xOffset:Math.max(p,e)})}return this}},{key:"setTickValues",value:function setTickValues(){var e=this.config().tickValues,t=this.axis();return e?(e instanceof Array&&this.axis().tickValues(e),this):(t.tickValues(this.getTickValues()),this)}},{key:"getTickValues",value:function getTickValues(){var e=this.config(),t=e.orientation,n=e.tickValues,r=this.range(),i=this.axis(),a=Math.abs(r[0]-r[1]),o=Ud(this).largestLabelDim;return n?i.scale().ticks(n):function getNumberOfTicks(e,t,n,r){var i=n.scale().ticks().length,a=i;return i*(1.5*t)>e&&(a=Math.floor(e/(1.5*t))),a<1&&(a=1),n.scale().ticks(a)}(a,o[t===Dl||t===Ll?"width":"height"],i)}},{key:"setFixedBaseline",value:function setFixedBaseline(e){var t=this.config(),n=t.orientation,r=t.labels.rotation,i=this.axis(),a=this.dependencies().labelManager;return a.setStyle(this._tickLabelStyle),i.tickTransform(function(e,t){var o=(i.tickFormat?i.tickFormat()(e):e).toString(),s=a.getOriSize(o),c=s.width,l=s.height;return 0!==t||n!==Il&&n!==jl?0!==t||n!==Ll&&n!==Dl||0!==r?"":"translate("+c/2+"px,  0px) rotate("+r+"deg)":"translate(0, -"+l/3+"px)"}),e}}],[{key:"type",value:function type(){return Bl}}]),LinearAxis}(),Qd=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var e_=function(e){function BandAxis(){return function band_axis_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BandAxis),function band_axis_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(BandAxis.__proto__||Object.getPrototypeOf(BandAxis)).apply(this,arguments))}return function band_axis_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(BandAxis,Zd),Qd(BandAxis,[{key:"createScale",value:function createScale(e){var t=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(BandAxis.prototype.__proto__||Object.getPrototypeOf(BandAxis.prototype),"createScale",this).call(this,e),n=this.config().padding;return"number"==typeof n&&t.padding(n),t}},{key:"setAvailableSpace",value:function setAvailableSpace(e,t,n,r){var i=n.left,a=n.right,o=n.top,s=n.bottom,c=this.config(),l=c.orientation,u=c.showAxisName,f=c.axisNamePadding,h=this.getAxisDimensions().axisLabelDim.height;if(this.availableSpace({width:e,height:t}),l===Ll||l===Dl){this.range([0,e-i-a]);var d=this.getLogicalSpace().height-(!1===u?h+f:0);r&&this.config({yOffset:Math.max(d,t)})}else{this.range([t-s,o]);var _=this.getLogicalSpace().width-(!1===u?h:0);r&&this.config({xOffset:Math.max(_,e)})}return this}},{key:"getUnitWidth",value:function getUnitWidth(){return this.scale().bandwidth()}},{key:"setTickConfig",value:function setTickConfig(){var e="",t=void 0,n=this.config(),r=n.maxWidth,i=n.maxHeight,a=this._dependencies.labelManager,o=this.axis().scale().domain(),s=this.axis();e=o;var c=s.tickFormat();return o&&o.length&&(e=o.map(function(e){return a.useEllipsesOnOverflow(!0),t=a.getSmartText(c(e),r,i),a.constructor.textToLines(t)})),e}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||(this.logicalSpace(function calculateBandSpace(e){var t=e.range(),n=e.config(),r=n.orientation,i=n.show,a=e.getAxisDimensions(),o=a.largestLabelDim,s=a.axisTickLabels,c=o.height,l=o.width;if(r===Ll||r===Dl){var u=Gd(e,a,n,t),f=u.width,h=u.height;return f&&0!==f||(f=s.length*Math.min(l+e._minTickDistance.width,c+e._minTickDistance.width)),!1===i&&(h=0),{width:f,height:h}}var d=Yd(0,a,n),_=d.width,p=d.height;return p&&0!==p||(p=s.length*(c+c/2)+c),!1===i&&(_=0),{width:_,height:p}}(this)),Vd(this),this.logicalSpace()),this.logicalSpace()}},{key:"setRotationConfig",value:function setRotationConfig(e,t){var n=this,r=this.config().orientation,i=this.range(),a=Math.abs(i[0]-i[1]);if(this.config({labels:{rotation:0,smartTicks:!1}}),r===Ll||r===Dl){var o=this.smartTicks().reduce(function(e,t){return e+t.width+n._minTickDistance.width},0);a>0&&e.length*(t+this._minTickDistance.width)>a&&(a&&o<a?this.config({labels:{smartTicks:!0}}):this.config({labels:{rotation:-90}}))}return this}},{key:"getTickValues",value:function getTickValues(){return this.axis().scale().domain()}},{key:"getTickSize",value:function getTickSize(){var e=this.config(),t=e.showInnerTicks,n=e.showOuterTicks,r=this.axis();return r.tickSizeInner(t?6:0),r.tickSizeOuter(n?6:0),r.tickSize()}},{key:"updateDomainBounds",value:function updateDomainBounds(e){var t=this.domain();return 0===t.length&&(t=e),t=(t=t.concat(e)).sort(),this.domain(t),this}}],[{key:"type",value:function type(){return Hl}}]),BandAxis}(),t_=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),n_=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0};var r_=function(e){function TimeAxis(){var e;!function time_axis_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TimeAxis);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function time_axis_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=TimeAxis.__proto__||Object.getPrototypeOf(TimeAxis)).call.apply(e,[this].concat(n)));return i._minDiff=1/0,i}return function time_axis_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(TimeAxis,Zd),t_(TimeAxis,[{key:"createScale",value:function createScale(e){var t=n_(TimeAxis.prototype.__proto__||Object.getPrototypeOf(TimeAxis.prototype),"createScale",this).call(this,e);return t=t.nice()}},{key:"setTickConfig",value:function setTickConfig(){var e=void 0,t=void 0,n=this.config(),r=n.maxWidth,i=n.maxHeight,a=n.tickFormat,o=this._dependencies.labelManager,s=this.getTickValues(),c=this.scale();e=s;var l=a||c.tickFormat();return s&&s.length&&(e=s.map(function(e){return t=o.getSmartText(l(e),r,i),o.constructor.textToLines(t)})),e}},{key:"createAxis",value:function createAxis(e){var t=e.tickFormat,n=e.orientation,r=zl[n];if(r){var i=r(this.scale());return t&&(i=i.tickFormat(t)),i}return null}},{key:"getTickSize",value:function getTickSize(){var e=this.config(),t=e.showInnerTicks,n=e.showOuterTicks,r=this.axis();return r.tickSizeInner(!1===t?0:6),r.tickSizeOuter(!1===n?0:6),n_(TimeAxis.prototype.__proto__||Object.getPrototypeOf(TimeAxis.prototype),"getTickSize",this).call(this)}},{key:"getTickValues",value:function getTickValues(){return this.scale().ticks()}},{key:"minDiff",value:function minDiff(e){return this._minDiff=Math.min(this._minDiff,e),this}},{key:"setRotationConfig",value:function setRotationConfig(e,t){var n=this.config().orientation,r=this.range(),i=Math.abs(r[0]-r[1]);if(this.config({labels:{rotation:0,smartTicks:!1}}),n===Ll||n===Dl){var a=this.smartTicks().reduce(function(e,t){return e+t.width},0);i>0&&e.length*t>i&&(i&&1.25*a<i&&this.config({labels:{smartTicks:!0}}),this.config({labels:{rotation:-90}}))}return this}},{key:"domain",value:function domain(e){if(e){var t=this.config().nice;return e.length&&e[0]===e[1]&&(e=[0,2*+e[0]]),this.scale().domain(e),t&&this.scale().nice(),this._domain=this.scale().domain(),this.smartTicks(this.setTickConfig()),this.store().commit("domain",this._domain),this.logicalSpace(null),this}return this._domain}},{key:"setAvailableSpace",value:function setAvailableSpace(e,t,n,r){var i=n.left,a=n.right,o=n.top,s=n.bottom,c=this.config(),l=c.orientation,u=c.showAxisName,f=c.axisNamePadding,h=this.domain(),d=this.getAxisDimensions(),_=d.axisLabelDim,p=d.tickLabelDim,y=_.height,g=p.height,m=p.width;if(this.availableSpace({width:e,height:t}),l===Ll||l===Dl){var v=m;this.range(qd(this._minDiff,[v/2,e-i-a-v/2],h,l));var b=this.getLogicalSpace().height-(!1===u?y+f:0);r&&this.config({yOffset:Math.max(b,t)})}else{var x=g;this.range(qd(this._minDiff,[t-o-s-x/2,x/2],h,l));var w=this.getLogicalSpace().width-(!1===u?y:0);this.isOffset&&this.config({xOffset:Math.max(w,e)})}return this}}],[{key:"type",value:function type(){return Ul}}]),TimeAxis}();function color_strategy_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function color_strategy_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var i_=function indexedDomain(e){var t=e;return{domain:e.map(function(t,n){return n/(e.length-1)}),uniqueVals:t,scaleDomain:[0,1]}},a_=function indexedDomainMeasure(e){return{domain:e,uniqueVals:e,scaleDomain:[0,1]}},o_=function normalDomain(e){return{uniqueVals:e,domain:e,nice:!0}},s_=function steppedDomain(e,t){var n=[];if(t instanceof Array)n=t.slice().sort();else for(var r=dn().apply(void 0,color_strategy_toConsumableArray(e)),i=0;i<=t;i++)n[i]=r(i/t);var a=e;return n[0]<e[0]&&n.shift(),{uniqueVals:a,domain:n,nice:!0}},c_=function pieceWiseRange(e,t,n,r){var i=n[r.indexOf(e)];return _n()(function colorInterpolator(){return Se}(),[].concat(color_strategy_toConsumableArray(t.range())))(i)},l_=function uniqueRange(e,t,n,r){return t(n[r.indexOf(e)])},u_=function indexedRange(e,t,n){return t((e-n[0])/(n[n.length-1]-n[0]))},f_=function normalRange(e,t){return t(e)},h_=function strategyGetter(e,t,n,r){return function strategies(){var e;return color_strategy_defineProperty(e={},Ed+"-"+Ed+"-"+Zl,{scale:Zl,domain:function domain(){return a_},range:function range(){return u_}}),color_strategy_defineProperty(e,Td+"-"+Ed+"-"+Zl,{scale:Zl,domain:function domain(){return i_},range:function range(){return l_}}),color_strategy_defineProperty(e,Ed+"-"+Td+"-"+Zl,{scale:Zl,domain:function domain(){return a_},range:function range(){return u_}}),color_strategy_defineProperty(e,Td+"-"+Td+"-"+Zl,{scale:Zl,domain:function domain(){return i_},range:function range(){return l_}}),color_strategy_defineProperty(e,Td+"-"+Ed+"-"+ql,{scale:Bl,domain:function domain(){return i_},range:function range(e){return e.length?c_:u_}}),color_strategy_defineProperty(e,Td+"-"+Td+"-"+ql,{scale:ql,domain:function domain(){return o_},range:function range(){return f_}}),color_strategy_defineProperty(e,Ed+"-"+Ed+"-"+ql,{scale:Bl,domain:function domain(){return o_},range:function range(){return f_}}),color_strategy_defineProperty(e,Ed+"-"+Td+"-"+ql,{scale:Kl,domain:function domain(){return s_},range:function range(){return f_}}),e}()[e+"-"+t+"-"+(n||"")]},d_=["#086bb6","#f37d45","#f5ce02","#67bda0","#c54e4e","#ae70af"],__={scheme:d_,steps:5,interpolate:!1,type:Nd},p_={Pink:{hex:"ffc0cb",rgb:"255,192,203"},LightPink:{hex:"ffb6c1",rgb:"255,182,193"},HotPink:{hex:"ff69b4",rgb:"255,105,180"},DeepPink:{hex:"ff1493",rgb:"255,20,147"},PaleVioletRed:{hex:"db7093",rgb:"219,112,147"},MediumVioletRed:{hex:"c71585",rgb:"199,21,133"},LightSalmon:{hex:"ffa07a",rgb:"255,160,122"},Salmon:{hex:"fa8072",rgb:"250,128,114"},DarkSalmon:{hex:"e9967a",rgb:"233,150,122"},LightCoral:{hex:"f08080",rgb:"240,128,128"},IndianRed:{hex:"cd5c5c",rgb:"205,92,92"},Crimson:{hex:"dc143c",rgb:"220,20,60"},FireBrick:{hex:"b22222",rgb:"178,34,34"},DarkRed:{hex:"8b0000",rgb:"139,0,0"},Red:{hex:"ff0000",rgb:"255,0,0"},OrangeRed:{hex:"ff4500",rgb:"255,69,0"},Tomato:{hex:"ff6347",rgb:"255,99,71"},Coral:{hex:"ff7f50",rgb:"255,127,80"},DarkOrange:{hex:"ff8c00",rgb:"255,140,0"},Orange:{hex:"ffa500",rgb:"255,165,0"},Gold:{hex:"ffd700",rgb:"255,215,0"},Yellow:{hex:"ffff00",rgb:"255,255,0"},LightYellow:{hex:"ffffe0",rgb:"255,255,224"},LemonChiffon:{hex:"fffacd",rgb:"255,250,205"},LightGoldenrodYellow:{hex:"fafad2",rgb:"250,250,210"},PapayaWhip:{hex:"ffefd5",rgb:"255,239,213"},Moccasin:{hex:"ffe4b5",rgb:"255,228,181"},PeachPuff:{hex:"ffdab9",rgb:"255,218,185"},PaleGoldenrod:{hex:"eee8aa",rgb:"238,232,170"},Khaki:{hex:"f0e68c",rgb:"240,230,140"},DarkKhaki:{hex:"bdb76b",rgb:"189,183,107"},Cornsilk:{hex:"fff8dc",rgb:"255,248,220"},BlanchedAlmond:{hex:"ffebcd",rgb:"255,235,205"},Bisque:{hex:"ffe4c4",rgb:"255,228,196"},NavajoWhite:{hex:"ffdead",rgb:"255,222,173"},Wheat:{hex:"f5deb3",rgb:"245,222,179"},BurlyWood:{hex:"deb887",rgb:"222,184,135"},Tan:{hex:"d2b48c",rgb:"210,180,140"},RosyBrown:{hex:"bc8f8f",rgb:"188,143,143"},SandyBrown:{hex:"f4a460",rgb:"244,164,96"},Goldenrod:{hex:"daa520",rgb:"218,165,32"},DarkGoldenrod:{hex:"b8860b",rgb:"184,134,11"},Peru:{hex:"cd853f",rgb:"205,133,63"},Chocolate:{hex:"d2691e",rgb:"210,105,30"},SaddleBrown:{hex:"8b4513",rgb:"139,69,19"},Sienna:{hex:"a0522d",rgb:"160,82,45"},Brown:{hex:"a52a2a",rgb:"165,42,42"},Maroon:{hex:"800000",rgb:"128,0,0"},DarkOliveGreen:{hex:"556b2f",rgb:"85,107,47"},Olive:{hex:"808000",rgb:"128,128,0"},OliveDrab:{hex:"6b8e23",rgb:"107,142,35"},YellowGreen:{hex:"9acd32",rgb:"154,205,50"},LimeGreen:{hex:"32cd32",rgb:"50,205,50"},Lime:{hex:"00ff00",rgb:"0,255,0"},LawnGreen:{hex:"7cfc00",rgb:"124,252,0"},Chartreuse:{hex:"7fff00",rgb:"127,255,0"},GreenYellow:{hex:"adff2f",rgb:"173,255,47"},SpringGreen:{hex:"00ff7f",rgb:"0,255,127"},MediumSpringGreen:{hex:"00fa9a",rgb:"0,250,154"},LightGreen:{hex:"90ee90",rgb:"144,238,144"},PaleGreen:{hex:"98fb98",rgb:"152,251,152"},DarkSeaGreen:{hex:"8fbc8f",rgb:"143,188,143"},MediumSeaGreen:{hex:"3cb371",rgb:"60,179,113"},SeaGreen:{hex:"2e8b57",rgb:"46,139,87"},ForestGreen:{hex:"228b22",rgb:"34,139,34"},Green:{hex:"008000",rgb:"0,128,0"},DarkGreen:{hex:"006400",rgb:"0,100,0"},MediumAquamarine:{hex:"66cdaa",rgb:"102,205,170"},Aqua:{hex:"00ffff",rgb:"0,255,255"},Cyan:{hex:"00ffff",rgb:"0,255,255"},LightCyan:{hex:"e0ffff",rgb:"224,255,255"},PaleTurquoise:{hex:"afeeee",rgb:"175,238,238"},Aquamarine:{hex:"7fffd4",rgb:"127,255,212"},Turquoise:{hex:"40e0d0",rgb:"64,224,208"},MediumTurquoise:{hex:"48d1cc",rgb:"72,209,204"},DarkTurquoise:{hex:"00ced1",rgb:"0,206,209"},LightSeaGreen:{hex:"20b2aa",rgb:"32,178,170"},CadetBlue:{hex:"5f9ea0",rgb:"95,158,160"},DarkCyan:{hex:"008b8b",rgb:"0,139,139"},Teal:{hex:"008080",rgb:"0,128,128"},LightSteelBlue:{hex:"b0c4de",rgb:"176,196,222"},PowderBlue:{hex:"b0e0e6",rgb:"176,224,230"},LightBlue:{hex:"add8e6",rgb:"173,216,230"},SkyBlue:{hex:"87ceeb",rgb:"135,206,235"},LightSkyBlue:{hex:"87cefa",rgb:"135,206,250"},DeepSkyBlue:{hex:"00bfff",rgb:"0,191,255"},DodgerBlue:{hex:"1e90ff",rgb:"30,144,255"},CornflowerBlue:{hex:"6495ed",rgb:"100,149,237"},SteelBlue:{hex:"4682b4",rgb:"70,130,180"},RoyalBlue:{hex:"4169e1",rgb:"65,105,225"},Blue:{hex:"0000ff",rgb:"0,0,255"},MediumBlue:{hex:"0000cd",rgb:"0,0,205"},DarkBlue:{hex:"00008b",rgb:"0,0,139"},Navy:{hex:"000080",rgb:"0,0,128"},MidnightBlue:{hex:"191970",rgb:"25,25,112"},Lavender:{hex:"e6e6fa",rgb:"230,230,250"},Thistle:{hex:"d8bfd8",rgb:"216,191,216"},Plum:{hex:"dda0dd",rgb:"221,160,221"},Violet:{hex:"ee82ee",rgb:"238,130,238"},Orchid:{hex:"da70d6",rgb:"218,112,214"},Fuchsia:{hex:"ff00ff",rgb:"255,0,255"},Magenta:{hex:"ff00ff",rgb:"255,0,255"},MediumOrchid:{hex:"ba55d3",rgb:"186,85,211"},MediumPurple:{hex:"9370db",rgb:"147,112,219"},BlueViolet:{hex:"8a2be2",rgb:"138,43,226"},DarkViolet:{hex:"9400d3",rgb:"148,0,211"},DarkOrchid:{hex:"9932cc",rgb:"153,50,204"},DarkMagenta:{hex:"8b008b",rgb:"139,0,139"},Purple:{hex:"800080",rgb:"128,0,128"},Indigo:{hex:"4b0082",rgb:"75,0,130"},DarkSlateBlue:{hex:"483d8b",rgb:"72,61,139"},SlateBlue:{hex:"6a5acd",rgb:"106,90,205"},MediumSlateBlue:{hex:"7b68ee",rgb:"123,104,238"},White:{hex:"ffffff",rgb:"255,255,255"},Snow:{hex:"fffafa",rgb:"255,250,250"},Honeydew:{hex:"f0fff0",rgb:"240,255,240"},MintCream:{hex:"f5fffa",rgb:"245,255,250"},Azure:{hex:"f0ffff",rgb:"240,255,255"},AliceBlue:{hex:"f0f8ff",rgb:"240,248,255"},GhostWhite:{hex:"f8f8ff",rgb:"248,248,255"},WhiteSmoke:{hex:"f5f5f5",rgb:"245,245,245"},Seashell:{hex:"fff5ee",rgb:"255,245,238"},Beige:{hex:"f5f5dc",rgb:"245,245,220"},OldLace:{hex:"fdf5e6",rgb:"253,245,230"},FloralWhite:{hex:"fffaf0",rgb:"255,250,240"},Ivory:{hex:"fffff0",rgb:"255,255,240"},AntiqueWhite:{hex:"faebd7",rgb:"250,235,215"},Linen:{hex:"faf0e6",rgb:"250,240,230"},LavenderBlush:{hex:"fff0f5",rgb:"255,240,245"},MistyRose:{hex:"ffe4e1",rgb:"255,228,225"},Gainsboro:{hex:"dcdcdc",rgb:"220,220,220"},LightGray:{hex:"d3d3d3",rgb:"211,211,211"},Silver:{hex:"c0c0c0",rgb:"192,192,192"},DarkGrey:{hex:"a9a9a9",rgb:"169,169,169"},Grey:{hex:"808080",rgb:"128,128,128"},DimGrey:{hex:"696969",rgb:"105,105,105"},LightSlateGrey:{hex:"778899",rgb:"119,136,153"},SlateGrey:{hex:"708090",rgb:"112,128,144"},DarkSlateGrey:{hex:"2f4f4f",rgb:"47,79,79"},Black:{hex:"000000",rgb:"0,0,0"}};function props_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var y_=function convertToXllString(e){return(e.split(" ")||[]).reduce(function(e,t){return""+e+t.charAt(0).toUpperCase()+t.slice(1)},"")},g_={config:{sanitization:function sanitization(e,t){var n=hn({},e.constructor.defaultConfig());"linear"===t.type&&"boolean"!=typeof t.interpolate&&(t.interpolate=!0);var r=hn(n,t);return r.scheme instanceof Array&&(r.scheme=r.scheme.map(function(e,t){var n="";if("string"==typeof e&&(e=e.replace(/ /g,"")),"hsl"===yn(e))n=[(n=e.match(/(\d+(\.\d+)?)/g))[0]/360,n[1]/100,n[2]/100,n[3]||1];else if("hex"===yn(e))n=function hexToHsv(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e),n=parseInt(t[1],16),r=parseInt(t[2],16),i=parseInt(t[3],16),a=t[4]?parseInt(t[4],16):1;return pn(n,r,i,a)}(e);else if("rgb"===yn(e)){var r=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/);n=pn.apply(void 0,props_toConsumableArray(r))}else n=p_[y_(e)]?pn.apply(void 0,props_toConsumableArray(p_[y_(e)].rgb.split(","))):"string"==typeof e||e instanceof Array?e:pn(d_[t]);return n})),r}},domain:{},scale:{},uniqueValues:{}},m_=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function color_axis_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var v_=function(){function ColorAxis(e){!function color_axis_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ColorAxis),sn(this,g_),this.config(e),this._domainType="linear"===this._config.type?Ed:Td,this._rangeType=this._config.interpolate?Ed:Td,this._schemeType=function getSchemeType(e){return e&&"string"==typeof e&&"i"===e[0]?Ad:Od}(this._config.scheme||this._config.value||this._config.range),this._colorStrategy=this.setColorStrategy(this._domainType,this._rangeType,this._schemeType),this._scale=this.createScale(this._colorStrategy),this._id=Ht()}return m_(ColorAxis,[{key:"createScale",value:function createScale(e){var t=this.config().scheme;return t&&"string"==typeof t?function getScheme(e){return"i"===e[0]?sequential_sequential(Ld[e]):ordinal_ordinal(Ld[e])}(t):scale_creator_createScale({type:e.scale,range:t})}},{key:"setColorStrategy",value:function setColorStrategy(e,t,n){this.config().steps;return h_(e,t,n)}},{key:"getHslString",value:function getHslString(e){return function getHslString(e){return"hsla("+360*e[0]+","+100*e[1]+"%,"+100*e[2]+"%, \n    "+(e[3]||1)+")"}(e)}},{key:"getColor",value:function getColor(e){return this.getHslString(this.getRawColor(e))}},{key:"getRawColor",value:function getRawColor(e){var t=this.scale(),n=t.range?t.range():null,r=this._colorStrategy.range(n)(e,t,this.domain(),this.uniqueValues());if("string"==typeof r){var i=r.substring(4,r.length-1).replace(/ /g,"").split(",");return pn.apply(void 0,color_axis_toConsumableArray(i))}return[].concat(color_axis_toConsumableArray(r))}},{key:"updateDomain",value:function updateDomain(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this._colorStrategy.domain()(e,this.config().steps);return this.domain(t.domain),this.uniqueValues(t.uniqueVals),this.scale().domain(t.scaleDomain||this.domain()),this}},{key:"serialize",value:function serialize(){return{type:this.constructor.type(),scale:this.scale(),domain:this.domain(),range:this.range(),config:this.config(),scheme:this.scheme()}}},{key:"transformColor",value:function transformColor(e,t){var n=360*e[0],r=100*e[1],i=100*e[2],a=e[3]||1,o=n+t[0],s=r+t[1],c=i+t[2],l=a+t[3]||0;return{color:"hsl("+(n=o>360?o-360:o<0?o+360:o)+","+(r=s>100?s-100:s<0?s+100:s)+"%,"+(i=c>100?c-100:c<0?c+100:c)+"%,"+(a=l>1?l-1:l<0?l+1:l)+")",hsla:[n/360,r/100,i/100,a]}}},{key:"id",value:function id(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return __}},{key:"type",value:function type(){return"color"}}]),ColorAxis}(),b_={interpolate:!1,value:64,type:"ordinal",range:[50,360],scaleFactor:1,intervals:5};function size_strategy_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function size_strategy_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var x_=function indexedDomain(e){var t=e;return{domain:e.map(function(t,n){return n/(e.length-1)}),uniqueVals:t,scaleDomain:[0,1]}},w_=function normalDomain(e){return{uniqueVals:e,domain:e}},C_=function steppedDomain(e,t){var n=[];if(t instanceof Array)n=t.slice().sort();else for(var r=dn().apply(void 0,size_strategy_toConsumableArray(e)),i=0;i<t;i++)n[i]=r(i/(t-1));return n[0]<e[0]&&n.shift(),{uniqueVals:n,domain:n,nice:!0}},k_=function discreteRange(e,t,n){var r=(e-n[0])/(n[n.length-1]-n[0]);return dn().apply(void 0,size_strategy_toConsumableArray(t.range()))(r)},S_=function pieceWiseRange(e,t,n,r){var i=n[r.indexOf(e)];return _n()(dn(),[].concat(size_strategy_toConsumableArray(t.range())))(i)},M_=function normalRange(e,t){return t(e)},P_=function strategyGetter(e,t,n){return function strategies(){var e;return size_strategy_defineProperty(e={},Td+"-"+Ed,{scale:Bl,domain:x_,range:S_}),size_strategy_defineProperty(e,Ed+"-"+Ed,{scale:Bl,domain:w_,range:M_}),size_strategy_defineProperty(e,Ed+"-"+Td,{scale:Kl,domain:C_,range:k_}),e}()[e+"-"+t]},E_={config:{},domain:{sanitization:function sanitization(e,t){return e.scale().domain(t),t}},range:{},scale:{},uniqueValues:{}},T_=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var A_=function(){function SizeAxis(e){!function size_axis_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SizeAxis),sn(this,E_),this._id=Ht(),this._config=Object.assign({},this.constructor.defaultConfig(),e),this._domainType="linear"===this._config.type?Ed:Td,this._rangeType=this._config.interpolate||"linear"!==this._config.type?Ed:Td,this._sizeStrategy=this.setStrategy(this._domainType,this._rangeType),this._scale=this.createScale(this._sizeStrategy),this._range=this._config.range,this.updateDomain(e.domain)}return T_(SizeAxis,[{key:"setStrategy",value:function setStrategy(e,t){this.config().intervals;return P_(e,t)}},{key:"createScale",value:function createScale(e){var t=this.config().range;return scale_creator_createScale({type:e.scale,range:t})}},{key:"getSize",value:function getSize(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.config(),n=t.scaleFactor,r=t.value,i=this.scale(),a=this.domain()||[1,1];return i&&a[0]!==a[1]?this._sizeStrategy.range(e,i,this.domain(),this.uniqueValues())*n:r*n}},{key:"updateDomain",value:function updateDomain(e){if(e){var t=(0,this._sizeStrategy.domain)(e,this.config().intervals);this.domain(t.domain),this.uniqueValues(t.uniqueVals),this.scale().domain(t.scaleDomain||this.domain())}return this}},{key:"getScaleFactor",value:function getScaleFactor(){return this.config().scaleFactor}},{key:"serialize",value:function serialize(){return{type:this.constructor.type(),scale:this.scale(),domain:this.domain(),range:this.range(),config:this.config()}}},{key:"id",value:function id(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return b_}},{key:"type",value:function type(){return"size"}}]),SizeAxis}(),O_=Math.PI,N_=2*O_,R_=N_-1e-6;function node_modules_d3_path_src_path_Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function muze_axis_node_modules_d3_path_src_path_path(){return new node_modules_d3_path_src_path_Path}node_modules_d3_path_src_path_Path.prototype=muze_axis_node_modules_d3_path_src_path_path.prototype={constructor:node_modules_d3_path_src_path_Path,moveTo:function moveTo(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function lineTo(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function quadraticCurveTo(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function arcTo(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,c=r-t,l=a-e,u=o-t,f=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>1e-6)if(Math.abs(u*s-c*l)>1e-6&&i){var h=n-a,d=r-o,_=s*s+c*c,p=h*h+d*d,y=Math.sqrt(_),g=Math.sqrt(f),m=i*Math.tan((O_-Math.acos((_+f-p)/(2*y*g)))/2),v=m/g,b=m/y;Math.abs(v-1)>1e-6&&(this._+="L"+(e+v*l)+","+(t+v*u)),this._+="A"+i+","+i+",0,0,"+ +(u*h>l*d)+","+(this._x1=e+b*s)+","+(this._y1=t+b*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function arc(e,t,n,r,i,a){e=+e,t=+t;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=e+o,l=t+s,u=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+c+","+l),n&&(f<0&&(f=f%N_+N_),f>R_?this._+="A"+n+","+n+",0,1,"+u+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=O_)+","+u+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function rect(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function toString(){return this._}};var F_=muze_axis_node_modules_d3_path_src_path_path,D_=function(e){return function constant(){return e}},L_=(Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt,1e-12),I_=Math.PI,j_=2*I_;function d3_shape_src_curve_linear_Linear(e){this._context=e}d3_shape_src_curve_linear_Linear.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var z_=function(e){return new d3_shape_src_curve_linear_Linear(e)};d3_shape_src_curve_radial_curveRadial(z_);function d3_shape_src_curve_radial_Radial(e){this._curve=e}function d3_shape_src_curve_radial_curveRadial(e){function radial(t){return new d3_shape_src_curve_radial_Radial(e(t))}return radial._curve=e,radial}d3_shape_src_curve_radial_Radial.prototype={areaStart:function areaStart(){this._curve.areaStart()},areaEnd:function areaEnd(){this._curve.areaEnd()},lineStart:function lineStart(){this._curve.lineStart()},lineEnd:function lineEnd(){this._curve.lineEnd()},point:function point(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};Array.prototype.slice;var B_={draw:function draw(e,t){var n=Math.sqrt(t/I_);e.moveTo(n,0),e.arc(0,0,n,0,j_)}},H_=(Math.sqrt(1/3),Math.sin(I_/10)/Math.sin(7*I_/10)),U_=(Math.sin(j_/10),Math.cos(j_/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function d3_shape_src_curve_basis_point(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function d3_shape_src_curve_basis_Basis(e){this._context=e}d3_shape_src_curve_basis_Basis.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 3:d3_shape_src_curve_basis_point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:d3_shape_src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function d3_shape_src_curve_basisClosed_BasisClosed(e){this._context=e}d3_shape_src_curve_basisClosed_BasisClosed.prototype={areaStart:U_,areaEnd:U_,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:d3_shape_src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function d3_shape_src_curve_basisOpen_BasisOpen(e){this._context=e}d3_shape_src_curve_basisOpen_BasisOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:d3_shape_src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function d3_shape_src_curve_bundle_Bundle(e,t){this._basis=new d3_shape_src_curve_basis_Basis(e),this._beta=t}d3_shape_src_curve_bundle_Bundle.prototype={lineStart:function lineStart(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],a=t[0],o=e[n]-i,s=t[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+r*o),this._beta*t[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};(function custom(e){function bundle(t){return 1===e?new d3_shape_src_curve_basis_Basis(t):new d3_shape_src_curve_bundle_Bundle(t,e)}return bundle.beta=function(e){return custom(+e)},bundle})(.85);function node_modules_d3_shape_src_curve_cardinal_point(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function d3_shape_src_curve_cardinal_Cardinal(e,t){this._context=e,this._k=(1-t)/6}d3_shape_src_curve_cardinal_Cardinal.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:node_modules_d3_shape_src_curve_cardinal_point(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:node_modules_d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new d3_shape_src_curve_cardinal_Cardinal(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function d3_shape_src_curve_cardinalClosed_CardinalClosed(e,t){this._context=e,this._k=(1-t)/6}d3_shape_src_curve_cardinalClosed_CardinalClosed.prototype={areaStart:U_,areaEnd:U_,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:node_modules_d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new d3_shape_src_curve_cardinalClosed_CardinalClosed(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function d3_shape_src_curve_cardinalOpen_CardinalOpen(e,t){this._context=e,this._k=(1-t)/6}d3_shape_src_curve_cardinalOpen_CardinalOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:node_modules_d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new d3_shape_src_curve_cardinalOpen_CardinalOpen(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function node_modules_d3_shape_src_curve_catmullRom_point(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>L_){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>L_){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function d3_shape_src_curve_catmullRom_CatmullRom(e,t){this._context=e,this._alpha=t}d3_shape_src_curve_catmullRom_CatmullRom.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:node_modules_d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new d3_shape_src_curve_catmullRom_CatmullRom(t,e):new d3_shape_src_curve_cardinal_Cardinal(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function d3_shape_src_curve_catmullRomClosed_CatmullRomClosed(e,t){this._context=e,this._alpha=t}d3_shape_src_curve_catmullRomClosed_CatmullRomClosed.prototype={areaStart:U_,areaEnd:U_,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:node_modules_d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new d3_shape_src_curve_catmullRomClosed_CatmullRomClosed(t,e):new d3_shape_src_curve_cardinalClosed_CardinalClosed(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function d3_shape_src_curve_catmullRomOpen_CatmullRomOpen(e,t){this._context=e,this._alpha=t}d3_shape_src_curve_catmullRomOpen_CatmullRomOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:node_modules_d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new d3_shape_src_curve_catmullRomOpen_CatmullRomOpen(t,e):new d3_shape_src_curve_cardinalOpen_CardinalOpen(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function d3_shape_src_curve_linearClosed_LinearClosed(e){this._context=e}d3_shape_src_curve_linearClosed_LinearClosed.prototype={areaStart:U_,areaEnd:U_,lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){this._point&&this._context.closePath()},point:function point(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function node_modules_d3_shape_src_curve_monotone_sign(e){return e<0?-1:1}function d3_shape_src_curve_monotone_slope3(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(node_modules_d3_shape_src_curve_monotone_sign(a)+node_modules_d3_shape_src_curve_monotone_sign(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function d3_shape_src_curve_monotone_slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function node_modules_d3_shape_src_curve_monotone_point(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function d3_shape_src_curve_monotone_MonotoneX(e){this._context=e}function d3_shape_src_curve_monotone_MonotoneY(e){this._context=new d3_shape_src_curve_monotone_ReflectContext(e)}function d3_shape_src_curve_monotone_ReflectContext(e){this._context=e}function d3_shape_src_curve_natural_Natural(e){this._context=e}function d3_shape_src_curve_natural_controlPoints(e){var t,n,r=e.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}d3_shape_src_curve_monotone_MonotoneX.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:node_modules_d3_shape_src_curve_monotone_point(this,this._t0,d3_shape_src_curve_monotone_slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,node_modules_d3_shape_src_curve_monotone_point(this,d3_shape_src_curve_monotone_slope2(this,n=d3_shape_src_curve_monotone_slope3(this,e,t)),n);break;default:node_modules_d3_shape_src_curve_monotone_point(this,this._t0,n=d3_shape_src_curve_monotone_slope3(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(d3_shape_src_curve_monotone_MonotoneY.prototype=Object.create(d3_shape_src_curve_monotone_MonotoneX.prototype)).point=function(e,t){d3_shape_src_curve_monotone_MonotoneX.prototype.point.call(this,t,e)},d3_shape_src_curve_monotone_ReflectContext.prototype={moveTo:function moveTo(e,t){this._context.moveTo(t,e)},closePath:function closePath(){this._context.closePath()},lineTo:function lineTo(e,t){this._context.lineTo(t,e)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},d3_shape_src_curve_natural_Natural.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=[],this._y=[]},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=d3_shape_src_curve_natural_controlPoints(e),i=d3_shape_src_curve_natural_controlPoints(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};function d3_shape_src_curve_step_Step(e,t){this._context=e,this._t=t}d3_shape_src_curve_step_Step.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=this._y=NaN,this._point=0},lineEnd:function lineEnd(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var V_={type:"ordinal",range:[10,100],value:"circle"},q_={config:{},domain:{},scale:{},uniqueValues:{},generator:{}},W_=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var G_,Y_=function(){function ShapeAxis(e){!function shape_axis_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ShapeAxis),sn(this,q_),this._id=Ht(),this._config=Object.assign({},this.constructor.defaultConfig(),e),this._range=e.range||["circle","diamond","star","cross","square","wye","triangle"],this._generator=e.generator,this._scale=scale_creator_createScale({type:"ordinal",range:this._range})}return W_(ShapeAxis,[{key:"getShape",value:function getShape(e){if(!this.scale()||!this.domain()||!e)return this.config().value;if(this._generatedShapes)return this._generatedShapes[e];var t=this.scale()(e);return"string"===t?function(){var e=D_(B_),t=D_(64),n=null;function symbol(){var r;if(n||(n=r=F_()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return symbol.type=function(t){return arguments.length?(e="function"==typeof t?t:D_(t),symbol):e},symbol.size=function(e){return arguments.length?(t="function"==typeof e?e:D_(+e),symbol):t},symbol.context=function(e){return arguments.length?(n=null==e?null:e,symbol):n},symbol}().type(Gt[t]):t}},{key:"updateDomain",value:function updateDomain(e){return this.uniqueValues(e),this.domain(e),this.scale().domain(e),this.generator()&&(this._generatedShapes=function shapeGenerator(e,t){var n={};return e.forEach(function(e){n[e]=t(e)}),n}(e,this.generator())),this}},{key:"serialize",value:function serialize(){return{type:this.constructor.type(),scale:this.scale(),domain:this.domain(),range:this.range(),config:this.config()}}},{key:"id",value:function id(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return V_}},{key:"type",value:function type(){return"shape"}}]),ShapeAxis}();function data_type_scale_map_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var X_="measure",$_="temporal",Z_=(data_type_scale_map_defineProperty(G_={},"dimension",Hl),data_type_scale_map_defineProperty(G_,X_,Bl),data_type_scale_map_defineProperty(G_,$_,Ul),c.BAND),K_=function resolveDimByField(e,t,n,r){var i="x"===e?"width":"height",a=[n[e+"FieldType"],t[e+"Axis"]],o=a[0],s=a[1],c=n.transformType,l=n.sizeEncoding,u=n.sizeConfig,f=n.measurement,h=l.value,d=0,_=void 0,p=0,y=0;if(void 0!==o)if(n[e+"0Field"]){var g=r[e],m=r[e+"0"],x=void 0,w=void 0;if(void 0===g&&void 0===m||null===g&&null===m)return{enterSpace:null,enter:null,pos:null,space:null};o===b.MEASURE||o===v.TEMPORAL?(x=Math.min(g,m),w=Math.max(g,m)):(x=g,w=m);var C="x"===e?[x,w]:[w,x];_=s.getScaleValue(C[0])+s.getUnitWidth()/2,p=Math.abs(s.getScaleValue(C[1])-_)+s.getUnitWidth()/2,d=_,y=0}else if(o===v.CATEGORICAL||o===v.TEMPORAL){if(_=s.getScaleValue(r[e])+(u["x"===e?"barWidthOffset":"barHeightOffset"]||0),p=u["x"===e?"barWidth":"barHeight"],void 0!==h){var k=h*p;p-=k,_+=k/2}d=_,y=p}else{var S=s.getScaleValue(0),M=s.getScaleValue(r[e]),P=s.getScaleValue(r[e+"0"]);y=0,"x"===e?(_=r[e]<0||c===Ra?M:S,p=Math.abs(_-(c===Ra?P:r[e]>=0?M:S))):(_=c===Ra||r[e]>=0?M:S,p=Math.abs(_-(c===Ra?P:r[e]>=0?S:M))),d=S}else _=0,p=f[i];return{enterSpace:y,enter:d,pos:_,space:p}},J_=function resolveDimensions(e,t,n){var r={xAxis:n.x,yAxis:n.y},i=K_("x",r,t,e),a=i.enterSpace,o=i.enter,s=i.pos,c=i.space,l=K_("y",r,t,e),u=l.enterSpace;return{enter:{x:o,y:l.enter,width:a,height:u},update:{x:s,y:l.pos,width:c,height:l.space}}},Q_=function getBarMeasurement(e,t,n){var r=void 0,i=void 0,a=void 0,o=e.scale(),s=n.timeDiff,c=n.transformType,l=n.keys,u=n.pad,f=n.innerPadding,h=function getGroupWidth(e,t){var n=e.getUnitWidth(),r=e.scale(),i=r.range(),a=r.domain();return n||Math.abs(i[1]-i[0])/Math.abs(a[1]-a[0])*t}(e,s),d=e.constructor.type()===Z_;if("group"===c){var _=d?0:e.config().padding*h/2;t.range([_,h-_]).domain(l),t.paddingInner(f),r=t.bandwidth(),a=h-(d?0:f*h),i=l.map(function(e){return t(e)-(d?0:h/2)})}else if(void 0!==u){var p=void 0;if(d){var y=o.step();p=o.padding()*y,r=o.bandwidth()+p}else r=h;i=l.map(function(){return d?-p/2:-r/2})}else a=r=h-(d?0:f*h),i=l.map(function(){return d?0:-r/2});return{width:r,offsetValues:i,groupWidth:a,padding:d?f*e.scale().step():f*h}},ep=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),tp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var np=b.MEASURE,rp=function(e){function BarLayer(){var e;!function bar_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BarLayer);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function bar_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=BarLayer.__proto__||Object.getPrototypeOf(BarLayer)).call.apply(e,[this].concat(n)));return i._bandScale=band(),i._pointMap={},i}return function bar_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(BarLayer,Oo),tp(BarLayer,[{key:"elemType",value:function elemType(){return"rect"}},{key:"calculateDomainFromData",value:function calculateDomainFromData(e,t,n){var r=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(BarLayer.prototype.__proto__||Object.getPrototypeOf(BarLayer.prototype),"calculateDomainFromData",this).call(this,e,t,n);return["x","y"].forEach(function(e){t[e+"FieldType"]===np&&r[e]&&(t[e+"0Field}"]?r[e]=r[e].sort(function(e,t){return e-t}):r[e][0]=Math.min(r[e][0],0))}),r}},{key:"translatePoints",value:function translatePoints(e,t){return function getTranslatedPoints(e,t,n){for(var r=[],i=e.config().encoding,a=e.axes(),o=a.color,s=e.data().getFieldsConfig(),c=i.color,l=c.field,u=i.size||{},f=e.encodingFieldsInf(),h=f.x0Field,d=f.y0Field,_=f.xFieldSubType,p=f.yFieldSubType,y=e._store.get("measurement"),g=_===v.CATEGORICAL||_===v.TEMPORAL,m=p===v.CATEGORICAL||p===v.TEMPORAL,b=g?"x":m?"y":null,x=e.transformType(),w=l&&s[l]&&s[l].index,C=0,k=t.length;C<k;C++){var S=t[C],M={},P={},E=J_(S,{xFieldType:_,yFieldType:p,x0Field:h,y0Field:d,transformType:x,measurement:y,sizeConfig:n,sizeEncoding:u},a),T=mo({datum:S,index:C},{colorEncoding:c,colorAxis:o,colorFieldIndex:w}),A=T.color,O=T.rawColor;M.fill=A,P.stateColor={},P.originalColor=O,P.colorTransform={};var N,R=E.update;if(!isNaN(R.x)&&!isNaN(R.y)&&void 0!==S._id)N={enter:E.enter,update:R,style:M,_data:S._data,_id:S._id,meta:P},r.push(N),e.cachePoint(S[b],N)}return r=Mo(e,r)}(this,e,t)}},{key:"render",value:function render(e){var t=this.config(),n=t.transition,r=this._store,i=r.get("normalizedData"),a=r.get("transformedData").map(function(e){return e.key}),o=this.data().getFieldsConfig(),s=this.axes(),c=s.y&&s.y.scale().range()[0],l=s.x&&s.x.scale().range()[1],u=t.defClassName,f=Jt(u,this.id(),t.classPrefix),h=t.className,d=Pr(e),_=Object.values(o).filter(function(e){return e.def.type===b.DIMENSION}).map(function(e){return e.index});return d.classed(f.join(" "),!0),d.classed(h,!0),function clipElement(e,t,n){var r=Er(zn(e),"clipPath",[1],"#"+n);Er(r,"rect",[1]).attr("x",t.x).attr("y",t.x).attr("width",t.width).attr("height",t.height),r.attr("clip-path","url(#"+n+")")}(e,{x:0,y:0,width:l,height:c},"id-"+this.id()),this._points=this.generateDataPoints(i,a),Rr({data:this._points,container:e,selector:"g",append:"g",each:function each(e,r,i){var o=(f[0]+"-"+(a[i]||i)).toLowerCase();r.style("display","block"),Ml({container:r.node(),points:e,className:o,transition:n,style:{},keyFn:function keyFn(e){return _.map(function(t){return e._data[t]}).join("-")},classnameFn:t.individualClassName})}}),this}},{key:"generateDataPoints",value:function generateDataPoints(e,t){var n=this,r=this.config(),i=this.axes(),a=this.transformType(),o=this.encodingFieldsInf(),s=["x","y"].map(function(e){if(o[e+"FieldType"]===b.DIMENSION){var s=o[e+"FieldSubType"]===v.TEMPORAL?n.dataProps().timeDiffs[e]:0;return Q_(i[e],n._bandScale,{timeDiff:s,transformType:a,keys:t,pad:r["pad"+e.toUpperCase()],innerPadding:r.innerPadding})}return{}}),c=ep(s,2),l=c[0],u=c[1],f=l.offsetValues||[],h=u.offsetValues||[];return this._plotSpan={x:l.groupWidth||0,y:u.groupWidth||0},this._plotPadding={x:l.padding||0,y:u.padding||0},this._pointMap={},e.map(function(e,t){return n.translatePoints(e,{barWidth:l.width,barWidthOffset:f[t]||0,barHeight:u.width,barHeightOffset:h[t]||0})})}},{key:"getPlotPadding",value:function getPlotPadding(){return this._plotPadding}},{key:"getNearestPoint",value:function getNearestPoint(e,t){if(!this.data())return null;var n,r,i=void 0,a=void 0,o=void 0,s=void 0,c=void 0,l=void 0,u=null,f=this.data(),h=f.getData(),d=f.getFieldsConfig(),_=this.axes(),p=h.data,y=this._pointMap,g=this.encodingFieldsInf(),m=g.xField,x=g.yField,w=g.xFieldSubType,C=g.yFieldSubType;w===b.MEASURE?(i=_.y.invert(t),s=d[x].index,o=C):(i=_.x.invert(e),s=d[m].index,o=w),o===v.CATEGORICAL&&(a=y[i]),o===v.TEMPORAL&&(a=y[i=(c=[].concat(function bar_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(new Set(p.map(function(e){return e[s]})))))[Xt(c,i)]]),n=a&&a.length,a&&a.sort(function(e,t){return e.update.y-t.update.y});for(var k=0;k<n;k++){var S=a[k],M=S.update;if(e>=M.x&&e<=M.width+M.x&&t>=M.y&&t<=M.height+M.y){u=S;break}u=null}return(r=u&&u._data)&&(l=this.getIdentifiersFromData(r,u._id)),u?{dimensions:[u.update],id:l,layerId:this.id()}:u}},{key:"getPlotSpan",value:function getPlotSpan(){return this._plotSpan}}],[{key:"formalName",value:function formalName(){return"bar"}},{key:"defaultConfig",value:function defaultConfig(){return Pl}},{key:"defaultPolicy",value:function defaultPolicy(e,t){var n=Oo.defaultPolicy(e,t),r=n.encoding.color.field,i=n.transform;return r&&(i.groupBy=r),n}}]),BarLayer}(),ip={defClassName:"layer-tick",className:"",classPrefix:"muze",interaction:{highlight:[{type:"stroke",intensity:[0,20,-20,0]}],fade:[{type:"stroke",intensity:[0,-0,30,0]}],focus:[{type:"stroke",intensity:[0,-30,30,0]}]},transform:{type:"identity"},transition:{effect:"cubic",duration:1e3},encoding:{color:{},x:{},y:{},x0:{},y0:{},strokeOpacity:{value:.5},fillOpacity:{value:.5}},states:{highlight:{className:"muze-layer-tick-highlight"},fadeout:{className:"muze-layer-tick-fadeout"},selected:{className:"muze-layer-tick-selected"}}},ap=function(e){var t=e.points,n=e.container,r=e.keyFn,i=e.className,a=Pr(n),o=a.selectAll("path").data(t,r),s=o.enter().append("path");return a.attr("class",i||""),s.each(function(e){var t=Pr(this),n=e.enter||{};Object.entries(n).forEach(function(e){return!isNaN(e[1])&&t.attr(e[0],e[1])})}),o.exit().remove(),o.merge(s).each(function(e){var t=Pr(this),n=e.update,r=e.style||{},i=void 0!==n.x0?n.x0:n.x,a=void 0!==n.y0?n.y0:n.y,o="M "+n.x+" "+n.y+" L "+i+" "+a;e.className&&t.classed(e.className,!0),t.attr("d",o),Object.entries(r).forEach(function(e){return t.style(e[0],e[1])})})},op=(n(27),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var sp=function(e){function TickLayer(){return function tick_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TickLayer),function tick_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(TickLayer.__proto__||Object.getPrototypeOf(TickLayer)).apply(this,arguments))}return function tick_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(TickLayer,Ts),op(TickLayer,[{key:"elemType",value:function elemType(){return"path"}},{key:"translatePoints",value:function translatePoints(e,t,n){for(var r=[],i=Co(n),a=i.xAxis,o=i.yAxis,s=this.data().getFieldsConfig(),c=this.config().individualClassName,l=this.encodingFieldsInf(),u=l.xField,f=l.yField,h=l.x0Field,d=l.y0Field,_=l.xFieldType,p=l.yFieldType,y=_===b.DIMENSION,g=p===b.DIMENSION,m=y?za.X:g?za.Y:null,v=t.color,x=v&&v.field,w=s[x]&&s[x].index,C=this._store.get("measurement"),k=n.color,S=a?a.getUnitWidth():0,M=o?o.getUnitWidth():0,P=0,E=e.length;P<E;P++){var T=void 0,A=void 0,O=void 0,N=void 0,R=e[P],F=R._data;u&&(A=(T=a.getScaleValue(R.x))+S),f&&(O=null!==(N=o.getScaleValue(R.y))?N+M:null),u||(T=0,A=C.width,isNaN(N)||(O=N+=M/2)),f||(N=0,O=C.height,A=T+=S/2),h&&(A=a.getScaleValue(R.x0)+S,N+=M/2,O-=M/2),d&&(O=o.getScaleValue(R.y0)+M,T+=S/2,A-=S/2);var D={},L={},I=mo({datum:R,index:P},{colorEncoding:v,colorAxis:k,colorFieldIndex:w}),j=I.color,z=I.rawColor;if(D.stroke=j,L.stateColor={},L.originalColor=z,L.colorTransform={},!isNaN(T)&&!isNaN(N)){var B={enter:{},update:{x:T,y:N,x0:A,y0:O},style:D,_data:F,_id:R._id,meta:L};c instanceof Function&&(B.className=c(R,P)),r.push(B),this.cachePoint(R[m],B)}}return r=Mo(this,r)}}],[{key:"defaultConfig",value:function defaultConfig(){return ip}},{key:"formalName",value:function formalName(){return"tick"}},{key:"drawFn",value:function drawFn(){return ap}}]),TickLayer}();function layer_factory_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var cp,lp=function sanitizeEncoding(e){for(var t in e)"string"==typeof e[t]&&(e[t]={field:e[t]})},up=function(){var e={},t={setLayerRegistry:function setLayerRegistry(e){t._layerRegistry=e},getSerializedConf:function getSerializedConf(t,n){var r=void 0,i=e[t],a=hn({},n);if(i)r=i.map(function(e){var n={};return function parseLayerDefinition(e,t,n,r){for(var i in t)if(Object.hasOwnProperty.call(t,i)){var a=void 0,o=void 0,s=t[i];un(s)?(e[i]={},parseLayerDefinition(e[i],s,n,r)):"string"==typeof s&&(a=s.split("."))&&a[0]===r?void 0!==(o=bn.apply(void 0,[n].concat(layer_factory_toConsumableArray(a.slice(1,a.length)))))&&(e[i]=o):e[i]=s}}(n,e,a,t),lp(n.encoding),n});else{var o=a.encoding;lp(o),r=a}return r},getLayerInstance:function getLayerInstance(e){var n=t._layerRegistry,r=(e=e instanceof Array?e:[e]).map(function(e){return n[e.mark].create()});return 1===r.length?r[0]:r},composeLayers:function composeLayers(t,n){e[t]=n}};return t}();function defaults_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var fp=(defaults_defineProperty(cp={},"area",ds),defaults_defineProperty(cp,"arc",ms),defaults_defineProperty(cp,"line",cs),defaults_defineProperty(cp,"text",Cs),defaults_defineProperty(cp,"point",Ts),defaults_defineProperty(cp,"tick",sp),defaults_defineProperty(cp,"bar",rp),defaults_defineProperty(cp,"base",Oo),cp);function rowDiffsetIterator(e,t){e.length>0&&e.split(",").forEach(function(e){var n=e.split("-"),r=+n[0],i=+(n[1]||n[0]);if(i>=r)for(var a=r;a<=i;a+=1)t(a)})}var hp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var dp=function(){function Field(e,t){!function field_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Field),this._ref=e,this._rowDiff=t}return hp(Field,[{key:"sanitize",value:function sanitize(){return this._ref.sanitize()}},{key:"parsed",value:function parsed(e){return this._ref.parsed(e)}},{key:"domain",value:function domain(){var e,domain=null;(e=this.getData(),"dimension"===this._ref.fieldType&&this._ref.subType()!==v.TEMPORAL)?domain=[].concat(function field_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(new Set(e))):domain=[Math.min.apply(null,e),Math.max.apply(null,e)];return domain}},{key:"parse",value:function parse(e){return this._ref.parse(e)}},{key:"clone",value:function clone(e){return this._ref.clone(e)}},{key:"fieldName",value:function fieldName(){return this._ref.fieldName()}},{key:"type",value:function type(){return this._ref.type()}},{key:"description",value:function description(){return this._ref.description()}},{key:"subType",value:function subType(){return this._ref.subType()}},{key:"getMinDiff",value:function getMinDiff(){return this._ref.getMinDiff()}},{key:"unit",value:function unit(){return this._ref.unit()}},{key:"scale",value:function scale(){return this._ref.scale()}},{key:"defAggFn",value:function defAggFn(){return this._ref.defAggFn()}},{key:"getData",value:function getData(){var e=this,t=[];return rowDiffsetIterator(this._rowDiff,function(n){t.push(e._ref.data[n])}),t}},{key:"bins",value:function bins(){return this._ref.bins()}},{key:"name",get:function get(){return this._ref.name}},{key:"schema",get:function get(){return this._ref.schema}},{key:"data",get:function get(){return this._ref.data}}]),Field}(),_p={data:{},createNamespace:function createNamespace(e,t){var n=t||Ht();return this.data[n]={name:n,fields:e,fieldsObj:function fieldsObj(){var e={};return this.fields.forEach(function(t){e[t.name]=t}),e},getMeasure:function getMeasure(){var e={};return this.fields.forEach(function(t){t.schema.type===b.MEASURE&&(e[t.name]=t)}),e},getDimension:function getDimension(){var e={};return this.fields.forEach(function(t){t.schema.type===b.DIMENSION&&(e[t.name]=t)}),e}},this.data[n]}},pp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var yp=function(){function Value(e,t){!function value_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Value),Object.defineProperty(this,"_value",{enumerable:!1,configurable:!1,writable:!1,value:e}),this.field=t}return pp(Value,[{key:"toString",value:function toString(){return String(this.value)}},{key:"valueOf",value:function valueOf(){return this.value}},{key:"value",get:function get(){return this._value}}]),Value}(),gp=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function createBinnedFieldData(e,t,n){var r=n.buckets,i=n.numOfBins,a=n.binSize,o=n.start,s=[],c=[],l=e.domain(),u=gp(l,2),f=u[0],h=u[1],d=h,_=[],p=void 0,y=void 0,g=void 0,m=void 0;if(rowDiffsetIterator(t,function(t){s.push({data:e.data[t],index:t})}),!r){var v=((h+=1)-f)%(a=a||(h-f)/i);for(i||0===v||(h=h+a-v),p=f+a;p<=h;)_.push(p),p+=a;r={start:o=o||f,end:_}}y=0===r.start?0:r.start||f,r.end.forEach(function(e){s.filter(function(t){return t.data>=y&&t.data<e}).forEach(function(t){c[t.index]=y+"-"+e}),y=e}),s.filter(function(e){return e.data<r.start}).forEach(function(e){c[e.index]=f+"-"+r.start}),s.filter(function(e){return e.data>=r.end[r.end.length-1]}).forEach(function(e){c[e.index]=r.end[r.end.length-1]+"-"+d}),r.end.unshift(r.start),m=new Set(r.end),f<r.start&&m.add(f),d>r.end[r.end.length-1]&&m.add(d),m=[].concat(function bucket_creator_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(m)).sort(function(e,t){return e-t}),g=[];for(var b=1;b<m.length;b++)g.push((m[b-1]+m[b])/2);return{data:c,mid:g,range:m}}var mp={SELECT:"select",PROJECT:"project",GROUPBY:"group",COMPOSE:"compose",CAL_VAR:"calculatedVariable",BIN:"bin"},vp={CROSS:"cross",LEFTOUTER:"leftOuter",RIGHTOUTER:"rightOuter",NATURAL:"natural",FULLOUTER:"fullOuter"};function childIterator(e,t,n){e._children.forEach(function(e){if(e._derivation&&1===e._derivation.length)switch(n){case mp.SELECT:e._derivation[0].op===mp.SELECT&&t(e,e._derivation[0].criteria);break;case mp.PROJECT:e._derivation[0].op===mp.PROJECT&&t(e,e._derivation[0].meta.actualProjField);break;case mp.GROUPBY:e._derivation[0].op===mp.GROUPBY&&t(e,{groupByString:e._derivation[0].meta.groupByString,reducer:e._derivation[0].criteria});break;case mp.CAL_VAR:if(e._derivation[0].op===mp.CAL_VAR){var r=[e._derivation[0].meta.config,[e._derivation[0].meta.fields,e._derivation[0].criteria]];t.apply(void 0,[e].concat(r))}}})}function selectIterator(e,t){childIterator(e,t,mp.SELECT)}function calculatedVariableIterator(e,t){childIterator(e,t,mp.CAL_VAR)}function projectIterator(e,t){childIterator(e,t,mp.PROJECT)}function groupByIterator(e,t){childIterator(e,t,mp.GROUPBY)}var bp=function compose(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=e,r=void 0,i=[],a=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{saveChild:!0}).saveChild;return t.forEach(function(e){n=e(n),i.push.apply(i,function compose_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n._derivation)),r||(r=n)}),a&&n.addParent(e,i),i.length>1&&r.dispose(),n}},xp=function bin(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.bin.apply(e,t)}},wp=function select(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.select.apply(e,t)}},Cp=function project(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.project.apply(e,t)}},kp=function calculateVariable(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.calculateVariable.apply(e,t)}},Sp=function sort(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.sort.apply(e,t)}},Mp=function(e){var t=0;return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){e[r]instanceof Array||(e[r]=Array.from({length:t})),e[r].push(n)}),t++}},Pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ep="object",Tp=Object.prototype.toString,Ap="[object Object]",Op="[object Array]";function checkCyclicRef(e,t){for(var n=t.length,r=-1;n;){if(e===t[n])return r=n;n-=1}return r}function extend2_extend2(e,t,n){return(void 0===e?"undefined":Pp(e))!==Ep&&(void 0===t?"undefined":Pp(t))!==Ep?null:(void 0===t?"undefined":Pp(t))!==Ep||null===t?e:((void 0===e?"undefined":Pp(e))!==Ep&&(e=t instanceof Array?[]:{}),function extend2_merge(e,t,n,r,i){var a,o,s,c,l;if(i?(r.push(e),i.push(t)):(r=[e],i=[t]),t instanceof Array)for(a=0;a<t.length;a+=1){try{o=e[a],s=t[a]}catch(e){continue}(void 0===s?"undefined":Pp(s))!==Ep?n&&void 0===s||(e[a]=s):(null!==o&&(void 0===o?"undefined":Pp(o))===Ep||(o=e[a]=s instanceof Array?[]:{}),-1!==(l=checkCyclicRef(s,i))?o=e[a]=r[l]:extend2_merge(o,s,n,r,i))}else for(a in t){try{o=e[a],s=t[a]}catch(e){continue}if(null!==s&&(void 0===s?"undefined":Pp(s))===Ep)(c=Tp.call(s))===Ap?(null!==o&&(void 0===o?"undefined":Pp(o))===Ep||(o=e[a]={}),-1!==(l=checkCyclicRef(s,i))?o=e[a]=r[l]:extend2_merge(o,s,n,r,i)):c===Op?(null!==o&&o instanceof Array||(o=e[a]=[]),-1!==(l=checkCyclicRef(s,i))?o=e[a]=r[l]:extend2_merge(o,s,n,r,i)):e[a]=s;else{if(n&&void 0===s)continue;e[a]=s}}return e}(e,t,n),e)}function isArray(e){return Array.isArray(e)}function isCallable(e){return"function"==typeof e}function helper_uniqueValues(e){return[].concat(function utils_helper_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(new Set(e)))}function isArrEqual(e,t){if(!isArray(e)||!isArray(t))return e===t;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function formatNumber(e){return e}function getCommonSchema(e,t){var n=[],r=[];return e.fields.forEach(function(e){r.push(e.schema.name)}),t.fields.forEach(function(e){-1!==r.indexOf(e.schema.name)&&n.push(e.schema.name)}),n}function defaultFilterFn(){return!0}function crossProduct(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:vp.CROSS,a=[],o=[],s=n||defaultFilterFn,c=e.getFieldspace(),l=t.getFieldspace(),u=c.name,f=l.name,h=c.name+"."+l.name,d=getCommonSchema(c,l);if(u===f)throw new Error("DataModels must have different alias names");return c.fields.forEach(function(e){var t=extend2_extend2({},e.schema);-1===d.indexOf(t.name)||r||(t.name=c.name+"."+t.name),a.push(t)}),l.fields.forEach(function(e){var t=extend2_extend2({},e.schema);-1!==d.indexOf(t.name)?r||(t.name=l.name+"."+t.name,a.push(t)):a.push(t)}),rowDiffsetIterator(e._rowDiffset,function(e){var n=!1,h=void 0;rowDiffsetIterator(t._rowDiffset,function(t){var _=[],p={};if(p[u]={},p[f]={},c.fields.forEach(function(t){_.push(t.data[e]),p[u][t.name]=t.data[e]}),l.fields.forEach(function(e){-1!==d.indexOf(e.schema.name)&&r||_.push(e.data[t]),p[f][e.name]=e.data[t]}),s(p)){var y={};_.forEach(function(e,t){y[a[t].name]=e}),n&&vp.CROSS!==i?o[h]=y:(o.push(y),n=!0,h=e)}else if((i===vp.LEFTOUTER||i===vp.RIGHTOUTER)&&!n){var g={},m=c.fields.length-1;_.forEach(function(e,t){g[a[t].name]=t<=m?e:null}),n=!0,h=e,o.push(g)}})}),new Cy(o,a,h)}function defSortFn(e,t){var n=""+e,r=""+t;return n<r?-1:n>r?1:0}function mergeSort(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:defSortFn;return e.length>1&&function merge_sort_sort(e,t,n,r){if(n===t)return e;var i=t+Math.floor((n-t)/2);return merge_sort_sort(e,t,i,r),merge_sort_sort(e,i+1,n,r),function merge_sort_merge(e,t,n,r,i){for(var a=e,o=[],s=t;s<=r;s+=1)o[s]=a[s];for(var c=t,l=n+1,u=t;u<=r;u+=1)c>n?(a[u]=o[l],l+=1):l>r?(a[u]=o[c],c+=1):i(o[c],o[l])<=0?(a[u]=o[c],c+=1):(a[u]=o[l],l+=1)}(e,t,i,n,r),e}(e,0,e.length-1,t),e}function data_builder_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function getSortFn(e,t,n){var r=void 0;switch(e){case b.MEASURE:case v.TEMPORAL:r="desc"===t?function retFunc(e,t){return t[n]-e[n]}:function retFunc(e,t){return e[n]-t[n]};break;default:r=function retFunc(e,r){var i=""+e[n],a=""+r[n];return i<a?"desc"===t?1:-1:i>a?"desc"===t?-1:1:0}}return r}function groupData(e,t){var n=new Map,r=[];return e.forEach(function(e){var i=e[t];n.has(i)?r[n.get(i)][1].push(e):(r.push([i,[e]]),n.set(i,r.length-1))}),r}function createSortingFnArg(e,t,n){var r={label:e[0]};return t.reduce(function(t,r,i){return t[r]=e[1].map(function(e){return e[n[i].index]}),t},r),r}function dataBuilder(e,t,n,r,i){var a={schema:[],data:[],uids:[]},o=(i=Object.assign({},{addUid:!1,columnWise:!1},i)).addUid,s=r&&r.length>0,c=[];if(n.split(",").forEach(function(t){for(var n=0;n<e.length;n+=1)if(e[n].name===t){c.push(e[n]);break}}),c.forEach(function(e){a.schema.push(e.schema)}),o&&a.schema.push({name:"uid",type:"identifier"}),rowDiffsetIterator(t,function(e){a.data.push([]);var t=a.data.length-1;c.forEach(function(n,r){a.data[t][r+0]=n.data[e]}),o&&(a.data[t][c.length]=e),a.uids.push(e),s&&a.data[t].push(e)}),s&&function sortData(e,t){for(var n=e.data,r=e.schema,i=void 0,a=void 0,o=void 0,s=t.length-1;s>=0;s--)i=t[s][0],a=t[s][1],(o=py(r,i))&&(isCallable(a)?mergeSort(n,function(e,t){return a(e[o.index],t[o.index])}):isArray(a)?function(){var e=groupData(n,o.index),t=a[a.length-1],i=a.slice(0,a.length-1),s=i.map(function(e){return py(r,e)});e.forEach(function(e){e.push(createSortingFnArg(e,i,s))}),mergeSort(e,function(e,n){var r=e[2],i=n[2];return t(r,i)}),n.length=0,e.forEach(function(e){n.push.apply(n,data_builder_toConsumableArray(e[1]))})}():(a="desc"===String(a).toLowerCase()?"desc":"asc",mergeSort(n,getSortFn(o.type,a,o.index))));e.uids=[],n.forEach(function(t){e.uids.push(t.pop())})}(a,r),i.columnWise){var l=Array.apply(void 0,data_builder_toConsumableArray(Array(a.schema.length))).map(function(){return[]});a.data.forEach(function(e){e.forEach(function(e,t){l[t].push(e)})}),a.data=l}return a}function difference_difference(e,t){var n={},r=[],i=[],a=[],o=e.getFieldspace(),s=t.getFieldspace(),c=o.fieldsObj(),l=s.fieldsObj(),u=o.name+" union "+s.name;if(!isArrEqual(e._colIdentifier.split(",").sort(),t._colIdentifier.split(",").sort()))return null;function prepareDataHelper(e,t,r){rowDiffsetIterator(e._rowDiffset,function(e){var o={},s="";i.forEach(function(n){var r=t[n].data[e];s+="-"+r,o[n]=r}),n[s]||(r&&a.push(o),n[s]=!0)})}return e._colIdentifier.split(",").forEach(function(e){var t=c[e];r.push(extend2_extend2({},t.schema)),i.push(t.schema.name)}),prepareDataHelper(t,l,!1),prepareDataHelper(e,c,!0),new Fy(a,r,u)}function group_by_function_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function group_by_function_sum(e){var t=e[0]instanceof Array;return e.reduce(function(e,n){return t?e.map(function(e,t){return e+n[t]}):e+n},t?Array.apply(void 0,group_by_function_toConsumableArray(Array(e[0].length))).map(function(){return 0}):0)}function avg(e){var t=e[0]instanceof Array,n=e.length||1,r=group_by_function_sum(e);return t?r.map(function(e){return e/n}):r/n}var Np={sum:group_by_function_sum,avg:avg,min:function group_by_function_min(e){return e[0]instanceof Array?e.reduce(function(e,t){return e.map(function(e,n){return Math.min(e,t[n])})},Array.apply(void 0,group_by_function_toConsumableArray(Array(e[0].length))).map(function(){return 1/0})):Math.min.apply(Math,group_by_function_toConsumableArray(e))},max:function group_by_function_max(e){return e[0]instanceof Array?e.reduce(function(e,t){return e.map(function(e,n){return Math.max(e,t[n])})},Array.apply(void 0,group_by_function_toConsumableArray(Array(e[0].length))).map(function(){return-1/0})):Math.max.apply(Math,group_by_function_toConsumableArray(e))},first:function first(e){return e[0]},last:function last(e){return e[e.length-1]},count:function group_by_function_count(e){var t=e[0]instanceof Array,n=e.length;return t?Array.apply(void 0,group_by_function_toConsumableArray(Array(e[0].length))).map(function(){return n}):n},std:function std(e){return Math.sqrt(function group_by_function_variance(e){var t=avg(e);return avg(e.map(function(e){return Math.pow(e-t,2)}))}(e))}},Rp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Fp=function(){function ReducerStore(){var e=this;!function reducer_store_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ReducerStore),this.store=new Map,this.store.set("defReducer",group_by_function_sum),Object.entries(Np).forEach(function(t){e.store.set(t[0],t[1])})}return Rp(ReducerStore,[{key:"defaultReducer",value:function defaultReducer(){if(arguments.length){var e=arguments.length<=0?void 0:arguments[0];return"function"==typeof e?this.store.set("defReducer",e):"string"==typeof e&&-1!==Object.keys(Np).indexOf(e)&&this.store.set("defReducer",Np[e]),this}return this.store.get("defReducer")}},{key:"register",value:function register(e,t){var n=this;return"string"==typeof e&&"function"==typeof t&&this.store.set(e,t),function(){n.__unregister(e)}}},{key:"__unregister",value:function __unregister(e){this.store.has(e)&&this.store.delete(e)}},{key:"resolve",value:function resolve(e){return e instanceof Function?e:this.store.get(e)}}]),ReducerStore}(),Dp=function(){var e=null;return function getStore(){return null===e&&(e=new Fp),e}()}(),Lp=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function getFieldArr(e,t){var n=[],r=e.getPartialFieldspace(),i=r.getDimension(),a=r.getMeasure();return Object.entries(i).forEach(function(e){var r=Lp(e,1)[0];t&&t.length?-1!==t.indexOf(r)&&n.push(r):n.push(r)}),Object.entries(a).forEach(function(e){var r=Lp(e,1)[0];"discrete"===a[r].subType()&&(t&&t.length?-1!==t.indexOf(r)&&n.push(r):n.push(r))}),n}function getReducerObj(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},r=t,i=e.getPartialFieldspace().getMeasure(),a=Dp.defaultReducer();return"function"==typeof t&&(a=t),Object.entries(i).forEach(function(e){var o=Lp(e,1)[0];"string"==typeof t[o]&&(r[o]=Dp.resolve(r[o])?Dp.resolve(r[o]):a),"function"!=typeof t[o]&&(r[o]=void 0),n[o]=r[o]||Dp.resolve(i[o].defAggFn())||a}),n}function group_by_groupBy(e,t,n,r){var i=getFieldArr(e,t),a=getReducerObj(e,n),o=e.getPartialFieldspace(),s=o.fieldsObj(),c=o.name,l=[],u=[],f=[],h={},d=[],_=void 0;Object.entries(s).forEach(function(e){var t=Lp(e,2),n=t[0],r=t[1];(-1!==i.indexOf(n)||a[n])&&(f.push(extend2_extend2({},r.schema)),"measure"===r.schema.type&&"discrete"!==r.schema.subtype?u.push(n):"dimension"!==r.schema.type&&"discrete"!==r.schema.subtype||l.push(n))});var p=0;return rowDiffsetIterator(e._rowDiffset,function(e){var t="";l.forEach(function(n){t=t+"-"+s[n].data[e]}),void 0===h[t]?(h[t]=p,d.push({}),l.forEach(function(t){d[p][t]=s[t].data[e]}),u.forEach(function(t){d[p][t]=[s[t].data[e]]}),p+=1):u.forEach(function(n){d[h[t]][n].push(s[n].data[e])})}),d.forEach(function(e){var t=e;u.forEach(function(n){t[n]=a[n](e[n])})}),r?(r.__calculateFieldspace(),_=r):_=new Fy(d,f,c),_}function naturalJoinFilter(e,t){var n=e.getFieldspace(),r=t.getFieldspace(),i=n.name,a=r.name,o=getCommonSchema(n,r);return function(e){var t=!0;return o.forEach(function(n){t=!(e[i][n]!==e[a][n]||!t)}),t}}function natural_join_naturalJoin(e,t){return crossProduct(e,t,naturalJoinFilter(e,t),!0)}function union_union(e,t){var n={},r=[],i=[],a=[],o=e.getFieldspace(),s=t.getFieldspace(),c=o.fieldsObj(),l=s.fieldsObj(),u=o.name+" union "+s.name;if(!isArrEqual(e._colIdentifier.split(",").sort(),t._colIdentifier.split(",").sort()))return null;function prepareDataHelper(e,t){rowDiffsetIterator(e._rowDiffset,function(e){var r={},o="";i.forEach(function(n){var i=t[n].data[e];o+="-"+i,r[n]=i}),n[o]||(a.push(r),n[o]=!0)})}return e._colIdentifier.split(",").forEach(function(e){var t=c[e];r.push(extend2_extend2({},t.schema)),i.push(t.schema.name)}),prepareDataHelper(e,c),prepareDataHelper(t,l),new Fy(a,r,u)}function leftOuterJoin(e,t,n){return crossProduct(e,t,n,!1,vp.LEFTOUTER)}function rightOuterJoin(e,t,n){return crossProduct(t,e,n,!1,vp.RIGHTOUTER)}function fullOuterJoin(e,t,n){return union_union(leftOuterJoin(e,t,n),rightOuterJoin(e,t,n))}var Ip=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var jp=function(){function PartialField(e,t,n){!function partial_field_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PartialField),this.name=e,this.data=t||[],this.schema=n,this.fieldDescription=n.description,this.fieldType=n.type,this.sanitize()}return Ip(PartialField,[{key:"sanitize",value:function sanitize(){var e=this;return this.data=this.data.map(function(t){return e.parsed(e.parse(t))}),this}},{key:"parsed",value:function parsed(e){return e}},{key:"domain",value:function domain(){throw new Error("Not yet implemented!")}},{key:"subType",value:function subType(){return null}},{key:"parse",value:function parse(){throw new Error("Not yet implemented!")}},{key:"clone",value:function clone(e){e=e||extend2_extend2([],this.data);var t=extend2_extend2({},this.schema);return new this.constructor(this.name,e,t)}},{key:"fieldName",value:function fieldName(){return this.name}},{key:"type",value:function type(){return this.fieldType}},{key:"description",value:function description(){return this.fieldDescription}}]),PartialField}(),zp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Bp=function(e){function Measure(e,t,n){!function measure_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Measure);var r=function measure_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Measure.__proto__||Object.getPrototypeOf(Measure)).call(this,e,t,n));return r.fieldUnit=n.unit,r.fieldScale=n.scale,r.fieldDefAggFn=n.defAggFn,r.fieldNumberformat=n.numberFormat instanceof Function?n.numberFormat:formatNumber,r}return function measure_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Measure,jp),zp(Measure,[{key:"domain",value:function domain(){return function(e){var t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.forEach(function(e){e<t&&(t=e),e>n&&(n=e)}),[t,n]}(this.data)}},{key:"parse",value:function parse(e){return e=parseFloat(e,10),Number.isNaN(e)?null:e}},{key:"unit",value:function unit(){return this.fieldUnit}},{key:"scale",value:function scale(){return this.fieldScale}},{key:"numberFormat",value:function numberFormat(){var e=this.fieldNumberformat;return function(t){return e(t)}}},{key:"defAggFn",value:function defAggFn(){return this.fieldDefAggFn}}]),Measure}(),Hp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Up=function(e){function Dimension(){return function dimension_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Dimension),function dimension_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Dimension.__proto__||Object.getPrototypeOf(Dimension)).apply(this,arguments))}return function dimension_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Dimension,jp),Hp(Dimension,[{key:"domain",value:function domain(){return helper_uniqueValues(this.data)}},{key:"parse",value:function parse(e){return(e=void 0===e||null===e?"":e.toString()).trim()}},{key:"parsed",value:function parsed(e){this._unique=this._unique||{};var t=this._unique;return e in t?t[e]++:t[e]=1,e}}]),Dimension}(),Vp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var qp=function(e){function Categorical(e,t,n){!function categorical_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Categorical);var r=function categorical_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Categorical.__proto__||Object.getPrototypeOf(Categorical)).call(this,e,t,n));return r.subtype=v.CATEGORICAL,r}return function categorical_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Categorical,Up),Vp(Categorical,[{key:"subType",value:function subType(){return this.subtype}}]),Categorical}(),Wp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Gp=function(e){function DateTime(e,t,n){!function datetime_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DateTime);var r=function datetime_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(DateTime.__proto__||Object.getPrototypeOf(DateTime)).call(this,e,t,n));return r.subtype=v.TEMPORAL,r.minDiff=Kt(r.data),r}return function datetime_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(DateTime,Up),Wp(DateTime,[{key:"subType",value:function subType(){return this.subtype}},{key:"getMinDiff",value:function getMinDiff(){return this.minDiff}},{key:"parse",value:function parse(e){return this.schema.format?(this._dtf=this._dtf||new DateTimeFormatter(this.schema.format),this._dtf.getNativeDate(e).getTime()):+new Date(e)}}]),DateTime}(),Yp=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Xp=function(e){function DiscreteMeasure(e,t,n,r){!function discreteMeasure_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DiscreteMeasure);var i=function discreteMeasure_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(DiscreteMeasure.__proto__||Object.getPrototypeOf(DiscreteMeasure)).call(this,e,t,n));return i.bin=r,i.subtype="discrete",i}return function discreteMeasure_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(DiscreteMeasure,Bp),Yp(DiscreteMeasure,[{key:"parse",value:function parse(e){return(e=void 0===e||null===e?"":e.toString()).trim()}},{key:"bins",value:function bins(){return this.bin}},{key:"subType",value:function subType(){return this.subtype}}]),DiscreteMeasure}();var $p=function createFields(e,t,n){var r={};return n&&n.length||(n=t.map(function(e){return e.name})),n.forEach(function(e,t){r[e]=t}),t.map(function(t){return function createUnitField(e,t){switch(t.type){case b.MEASURE:switch(t.subtype){case"discrete":return new Xp(t.name,e,t,t.bins);default:return new Bp(t.name,e,t)}case b.DIMENSION:default:switch(t.subtype){case v.CATEGORICAL:return new qp(t.name,e,t);case v.TEMPORAL:return new Gp(t.name,e,t);case v.GEO:default:return new qp(t.name,e,t)}}}(e[r[t.name]],t)})},Zp={dataFormat:m.AUTO};var Kp=function DSVArr(e,t){t=Object.assign({},{firstRowHeader:!0},t);var n=void 0,r=[],i=Mp(r);return n=t.firstRowHeader?e.splice(0,1)[0]:[],e.forEach(function(e){return i.apply(void 0,function dsv_arr_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(e))}),[n,r]},Jp={},Qp={},ey=34,ty=10,ny=13;function objectConverter(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}")}var ry=function(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function parseRows(e,t){var r,i=[],a=e.length,o=0,s=0,c=a<=0,l=!1;function token(){if(c)return Qp;if(l)return l=!1,Jp;var t,r,i=o;if(e.charCodeAt(i)===ey){for(;o++<a&&e.charCodeAt(o)!==ey||e.charCodeAt(++o)===ey;);return(t=o)>=a?c=!0:(r=e.charCodeAt(o++))===ty?l=!0:r===ny&&(l=!0,e.charCodeAt(o)===ty&&++o),e.slice(i+1,t-1).replace(/""/g,'"')}for(;o<a;){if((r=e.charCodeAt(t=o++))===ty)l=!0;else if(r===ny)l=!0,e.charCodeAt(o)===ty&&++o;else if(r!==n)continue;return e.slice(i,t)}return c=!0,e.slice(i,a)}for(e.charCodeAt(a-1)===ty&&--a,e.charCodeAt(a-1)===ny&&--a;(r=token())!==Qp;){for(var u=[];r!==Jp&&r!==Qp;)u.push(r),r=token();t&&null==(u=t(u,s++))||i.push(u)}return i}function formatRow(t){return t.map(formatValue).join(e)}function formatValue(e){return null==e?"":t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function parse(e,t){var n,r,i=parseRows(e,function(e,i){if(n)return n(e,i-1);r=e,n=t?function customConverter(e,t){var n=objectConverter(e);return function(r,i){return t(n(r),i,e)}}(e,t):objectConverter(e)});return i.columns=r||[],i},parseRows:parseRows,format:function format(t,n){return null==n&&(n=function inferColumns(e){var t=Object.create(null),n=[];return e.forEach(function(e){for(var r in e)r in t||n.push(t[r]=r)}),n}(t)),[n.map(formatValue).join(e)].concat(t.map(function(t){return n.map(function(e){return formatValue(t[e])}).join(e)})).join("\n")},formatRows:function formatRows(e){return e.map(formatRow).join("\n")}}},iy=ry(","),ay=(iy.parse,iy.parseRows,iy.format,iy.formatRows,ry("\t"));ay.parse,ay.parseRows,ay.format,ay.formatRows;var oy=function DSVStr(e,t){t=Object.assign({},{firstRowHeader:!0,fieldSeparator:","},t);var n=ry(t.fieldSeparator);return Kp(n.parseRows(e),t)};var sy=function FlatJSON(e){var t={},n=0,r=void 0,i=[],a=Mp(i);return e.forEach(function(e){var i=[];for(var o in e)o in t?r=t[o]:(t[o]=n++,r=n-1),i[r]=e[o];a.apply(void 0,i)}),[Object.keys(t),i]};var cy=function Auto(e,t){var n=void 0;if(function isString(e){return"string"==typeof e}(e))n=oy;else if(isArray(e)&&isArray(e[0]))n=Kp;else{if(!isArray(e)||0!==e.length&&!function isObject(e){return e===Object(e)}(e[0]))throw new Error("Couldn't detect the data format");n=sy}return n(e,t)},ly=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function src_helper_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function prepareSelectionData(e,t){var n={},r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value;n[c.name]=new yp(c.data[t],c)}}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}var uy=function persistDerivation(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3],a=void 0;t!==mp.COMPOSE?(a={op:t,meta:r,criteria:i},e._derivation.push(a)):(a=[].concat(src_helper_toConsumableArray(i)),e._derivation.length=0,(n=e._derivation).push.apply(n,src_helper_toConsumableArray(a)))},fy=function filterPropagationModel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.operation||"and",i=n.filterByMeasure||!1,a=[];a=null===t?[function(){return!1}]:t.map(function(e){return function(e){var t=e.getData(),n=t.schema,r=e.getFieldsConfig(),a=t.data;return function fn(e){return!!a.length&&a.some(function(t){return n.every(function(n){if(!(n.name in e))return!0;if(!i&&n.type!==b.DIMENSION)return!0;var a=r[n.name].index;return t[a]===e[n.name].valueOf()})})}}(e)});var o=void 0;"and"===r?o=e.clone(!1,!1).select(function(e){return a.every(function(t){return t(e)})},{saveChild:!1,mode:x.ALL}):o=e.clone(!1,!1).select(function(e){return a.some(function(t){return t(e)})},{mode:x.ALL,saveChild:!1});return o},hy=function cloneWithSelect(e,t,n,r){var i=e.clone(r.saveChild),a=function selectHelper(e,t,n,r){var i=[],a=-1,o=void 0,s=function checker(e){return n(prepareSelectionData(t,e),e)};return r.mode===x.INVERSE&&(s=function checker(e){return!n(prepareSelectionData(t,e))}),rowDiffsetIterator(e,function(e){s(e)&&(-1!==a&&e===a+1?(o=i.length-1,i[o]=i[o].split("-")[0]+"-"+e):i.push(""+e),a=e)}),i.join(",")}(i._rowDiffset,i.getPartialFieldspace().fields,t,n);return i._rowDiffset=a,i.__calculateFieldspace().calculateFieldsConfig(),r.saveChild&&uy(i,mp.SELECT,{config:n},t),i},dy=function cloneWithProject(e,t,n,r){var i=e.clone(n.saveChild),a=t;return n.mode===x.INVERSE&&(a=r.filter(function(e){return-1===t.indexOf(e)})),i._colIdentifier=a.join(","),i.__calculateFieldspace().calculateFieldsConfig(),n.saveChild&&uy(i,mp.PROJECT,{projField:t,config:n,actualProjField:a},null),i},_y=function updateData(e,t,n,r){r=Object.assign(Object.assign({},Zp),r);var i=u[r.dataFormat];if(!i||"function"!=typeof i)throw new Error("No converter function found for "+r.dataFormat+" format");var a=i(t,r),o=ly(a,2),s=o[0],c=o[1],l=$p(c,n,s),f=_p.createNamespace(l,r.name);return e._partialFieldspace=f,e._rowDiffset=c.length&&c[0].length?"0-"+(c[0].length-1):"",e._colIdentifier=n.map(function(e){return e.name}).join(),e},py=function fieldInSchema(e,t){for(var n=0;n<e.length;++n)if(t===e[n].name)return{type:e[n].subtype||e[n].type,index:n};return null},yy=function propagateIdentifiers(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],i=arguments[4],a=function forwardPropagation(e,t,i){propagateIdentifiers(e,t,n,r,i)};e!==r&&e.handlePropagation({payload:n.payload,data:t,sourceIdentifiers:n.sourceIdentifiers,sourceId:n.propagationSourceId,groupedPropModel:!!i}),selectIterator(e,function(e,n){if(e!==r){var o=t[0].select(n,{saveChild:!1}),s=t[1].select(n,{saveChild:!1});a(e,[o,s],i)}}),projectIterator(e,function(e,n){if(e!==r){var o=t[0].project(n,{saveChild:!1}),s=t[1].project(n,{saveChild:!1});a(e,[o,s],i)}}),groupByIterator(e,function(e,n){if(e!==r){var i=n.reducer,o=n.groupByString,s=t[0].groupBy(o.split(","),i,{saveChild:!1}),c=t[1].groupBy(o.split(","),i,{saveChild:!1});a(e,[s,c],!0)}}),calculatedVariableIterator(e,function(e){for(var n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];if(e!==r){var c,l,u=(c=t[0].clone(!1,!1)).calculateVariable.apply(c,o.concat([{saveChild:!1,replaceVar:!0}])),f=(l=t[1].clone(!1,!1)).calculateVariable.apply(l,o.concat([{saveChild:!1,replaceVar:!0}]));a(e,[u,f],i)}})},gy=function getRootDataModel(e){return e._parent?getRootDataModel(e._parent):e},my=function propagateToAllDataModels(e,t,n){var r=void 0,i=void 0,a=n.propagationNameSpace,o=n.payload,s=n.propagationSourceId;if(null===e)r=null;else{var c,l=Object.entries(a.mutableActions).filter(function(e){return e[0]!==s}).map(function(e){return Object.values(e[1]).map(function(e){return e.criteria})});r=(c=[]).concat.apply(c,[].concat(src_helper_toConsumableArray(l),[e]))}var u=t.groupByModel,f=t.model,h={payload:o,propagationSourceId:s,sourceIdentifiers:e};u&&(i=fy(u,r,{filterByMeasure:!0}),yy(u,i,h)),i=fy(f,r,{filterByMeasure:!u}),yy(f,i,h,u)},vy=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var by=function(){function Relation(){!function relation_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Relation);var e=void 0;this._parent=null,this._derivation=[],this._children=[];for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];1===n.length&&(e=n[0])instanceof Relation?(this._colIdentifier=e._colIdentifier,this._rowDiffset=e._rowDiffset,this._parent=e,this._partialFieldspace=this._parent._partialFieldspace,this._fieldStoreName=Ht(),this.__calculateFieldspace().calculateFieldsConfig()):(_y.apply(void 0,[this].concat(n)),this._fieldStoreName=this._partialFieldspace.name,this.__calculateFieldspace().calculateFieldsConfig(),this._propagationNameSpace={mutableActions:{},immutableActions:{}})}return vy(Relation,[{key:"getSchema",value:function getSchema(){return this.getFieldspace().fields.map(function(e){return e.schema})}},{key:"getName",value:function getName(){return this._fieldStoreName}},{key:"getFieldspace",value:function getFieldspace(){return this._fieldspace}},{key:"__calculateFieldspace",value:function __calculateFieldspace(){return this._fieldspace=function updateFields(e,t,n){var r=ly(e,2),i=r[0],a=r[1],o=a.length?a.split(","):[],s=t.fieldsObj(),c=o.map(function(e){return new dp(s[e],i)});return _p.createNamespace(c,n)}([this._rowDiffset,this._colIdentifier],this.getPartialFieldspace(),this._fieldStoreName),this}},{key:"getPartialFieldspace",value:function getPartialFieldspace(){return this._partialFieldspace}},{key:"join",value:function join(e,t){return crossProduct(this,e,t)}},{key:"naturalJoin",value:function naturalJoin(e){return crossProduct(this,e,naturalJoinFilter(this,e),!0)}},{key:"union",value:function union(e){return union_union(this,e)}},{key:"difference",value:function difference(e){return difference_difference(this,e)}},{key:"select",value:function select(e,t){var n={mode:x.NORMAL,saveChild:!0},r={saveChild:(t=Object.assign({},n,t)).saveChild},i=void 0;t.mode===x.ALL?i=[hy(this,e,{mode:x.NORMAL},r),hy(this,e,{mode:x.INVERSE},r)]:i=hy(this,e,t,r);return i}},{key:"isEmpty",value:function isEmpty(){return!this._rowDiffset.length||!this._colIdentifier.length}},{key:"clone",value:function clone(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=void 0;if(!1===(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])){var n=this.getData({getAllFields:!0}),r=n.data,i=n.schema,a=r.map(function(e){var t={};return i.forEach(function(n,r){t[n.name]=e[r]}),t});t=new this.constructor(a,i)}else t=new this.constructor(this);return e&&this._children.push(t),t}},{key:"project",value:function project(e,t){var n={mode:x.NORMAL,saveChild:!0};t=Object.assign({},n,t);var r=this.getFieldsConfig(),i=Object.keys(r),a=t.mode,o=e.reduce(function(e,t){return"RegExp"===t.constructor.name?e.push.apply(e,function relation_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(i.filter(function(e){return-1!==e.search(t)}))):t in r&&e.push(t),e},[]);o=Array.from(new Set(o)).map(function(e){return e.trim()});var s=void 0;a===x.ALL?s=[dy(this,o,{mode:x.NORMAL,saveChild:t.saveChild},i),dy(this,o,{mode:x.INVERSE,saveChild:t.saveChild},i)]:s=dy(this,o,t,i);return s}},{key:"getFieldsConfig",value:function getFieldsConfig(){return this._fieldConfig}},{key:"calculateFieldsConfig",value:function calculateFieldsConfig(){return this._fieldConfig=this._fieldspace.fields.reduce(function(e,t,n){return e[t.name]={index:n,def:{name:t._ref.name,type:t._ref.fieldType,subtype:t._ref.subType()}},e},{}),this}},{key:"dispose",value:function dispose(){this._parent.removeChild(this),this._parent=null}},{key:"removeChild",value:function removeChild(e){var t=this._children.findIndex(function(t){return t===e});-1===t||this._children.splice(t,1)}},{key:"addParent",value:function addParent(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];uy(this,mp.COMPOSE,null,t),this._parent=e,e._children.push(this)}}]),Relation}(),xy=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),wy=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Cy=function(e){function DataModel(){var e;!function datamodel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DataModel);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function datamodel_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=DataModel.__proto__||Object.getPrototypeOf(DataModel)).call.apply(e,[this].concat(n)));return i._onPropagation=[],i._sortingDetails=[],i}return function datamodel_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(DataModel,by),wy(DataModel,[{key:"getData",value:function getData(e){e=Object.assign({},{order:"row",formatter:null,withUid:!1,getAllFields:!1,sort:[]},e);var t=this.getPartialFieldspace().fields,n=dataBuilder.call(this,this.getPartialFieldspace().fields,this._rowDiffset,e.getAllFields?t.map(function(e){return e.name}).join():this._colIdentifier,e.sort,{columnWise:"column"===e.order,addUid:!!e.withUid});if(!e.formatter)return n;var r=e.formatter,i=n.data,a=n.schema,o=n.uids,s=a.map(function(e){return e.name}),c=Object.keys(r).reduce(function(e,t){var n=s.indexOf(t);return-1!==n&&e.push([n,r[t]]),e},[]);return"column"===e.order?c.forEach(function(e){var t=e[0],n=e[1];i[t].forEach(function(e,r){i[t][r]=n.call(void 0,e,o[r],a[t])})}):i.forEach(function(e,t){c.forEach(function(n){var r=n[0],i=n[1];e[r]=i.call(void 0,e[r],o[t],a[r])})}),n}},{key:"groupBy",value:function groupBy(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{saveChild:!0},r=""+e.join(),i=[this,e,t],a=group_by_groupBy.apply(void 0,i);return n.saveChild&&(this._children.push(a),uy(a,mp.GROUPBY,{fieldsArr:e,groupByString:r,defaultReducer:Dp.defaultReducer()},t)),a._parent=this,a}},{key:"sort",value:function sort(e){var t=this.getData({order:"row",sort:e}),n=[t.schema.map(function(e){return e.name})].concat(t.data),r=new this.constructor(n,t.schema,null,{dataFormat:"DSVArr"});return r._sortingDetails=e,r}},{key:"addField",value:function addField(e){var t=e.fieldName();this._colIdentifier+=","+t;var n=this._partialFieldspace;if(n.fieldsObj()[e.fieldName()]){var r=n.fields.findIndex(function(e){return e.name===t});r>=0&&(n.fields[r]=e)}else n.fields.push(e);return this.__calculateFieldspace().calculateFieldsConfig(),this}},{key:"calculateVariable",value:function calculateVariable(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{saveChild:!0,replaceVar:!1},r=this.getFieldsConfig(),i=t.slice(0,t.length-1),a=t[t.length-1];if(r[e.name]&&!n.replaceVar)throw new Error(e.name+" field already exists in model.");var o=i.map(function(e){var t=r[e];if(!t)throw new Error(e+" is not a valid column name.");return t.index}),s=this.clone(),c=s.getFieldspace().fields,l=o.map(function(e){return c[e]}),u=[];rowDiffsetIterator(s._rowDiffset,function(e){var t=l.map(function(t){return t.data[e]});u[e]=a.apply(void 0,function datamodel_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t).concat([e,c]))});var f=$p([u],[e],[e.name]),h=xy(f,1)[0];return s.addField(h),n.saveChild&&uy(s,mp.CAL_VAR,{config:e,fields:i},a),s}},{key:"propagate",value:function propagate(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.isMutableAction,i=n.sourceId,a=gy(this),o=a._propagationNameSpace,s={groupByModel:function getRootGroupByModel(e){return e._parent&&e._derivation.find(function(e){return"group"!==e.op})?getRootGroupByModel(e._parent):e}(this),model:a};return my(e,s,{propagationNameSpace:o,payload:t,propagationSourceId:i}),r&&function propagateImmutableActions(e,t,n){var r=t.groupByModel,i=t.model,a=e.immutableActions;for(var o in a){var s=a[o];for(var c in s){var l=s[c].criteria;my(l,{groupByModel:r,model:i},{propagationNameSpace:e,payload:s[c].payload,propagationSourceId:n})}}}(o,s,i),this}},{key:"addToPropNamespace",value:function addToPropNamespace(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0,r=t.actionName,i=t.payload,a=t.isMutableAction,o=gy(this)._propagationNameSpace,s=t.criteria;return a?(!o.mutableActions[e]&&(o.mutableActions[e]={}),n=o.mutableActions[e]):(!o.immutableActions[e]&&(o.immutableActions[e]={}),n=o.immutableActions[e]),null===s?delete n[r]:n[r]={criteria:s,payload:i},this}},{key:"on",value:function on(e,t){switch(e){case"propagation":this._onPropagation.push(t)}return this}},{key:"unsubscribe",value:function unsubscribe(e){switch(e){case"propagation":this._onPropagation=[]}return this}},{key:"handlePropagation",value:function handlePropagation(e){var t=this;this._onPropagation.forEach(function(n){return n.call(t,e)})}},{key:"bin",value:function bin(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.clone(),r=t.name||e+"_binned";if(this.getFieldsConfig()[r]||!this.getFieldsConfig()[e])throw new Error("Field "+e+" already exists.");var i=createBinnedFieldData(this._partialFieldspace.fields.find(function(t){return t.name===e}),this._rowDiffset,t),a=$p([i.data],[{name:r,type:b.MEASURE,subtype:"discrete",bins:{range:i.range,mid:i.mid}}],[r])[0];return n.addField(a),uy(n,mp.BIN,{measureName:e,config:t,binFieldName:r},null),n}}],[{key:"Reducers",get:function get(){return Dp}}]),DataModel}(),ky=Np.sum,Sy=Np.avg,My=Np.min,Py=Np.max,Ey=Np.first,Ty=Np.last,Ay=Np.count,Oy=Np.std,Ny=n(3);Cy.Operators=l,Cy.Stats=f,Cy.version=Ny.version;var Ry,Fy=Cy,Dy=n(4),Ly="x",Iy="y",jy="rows",zy="columns",By="col",Hy="row",Uy="color",Vy="shape",qy="size",Wy="left",Gy="right",Yy="cell",Xy="xAxes",$y="yAxes",Zy="entryCell",Ky="exitCell",Jy="radius",Qy="angle",eg="Primary",tg="Secondary";function local_options_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ng=(local_options_defineProperty(Ry={},"config",{}),local_options_defineProperty(Ry,jy,[]),local_options_defineProperty(Ry,zy,[]),local_options_defineProperty(Ry,Uy,""),local_options_defineProperty(Ry,Vy,""),local_options_defineProperty(Ry,qy,""),local_options_defineProperty(Ry,"detail",""),local_options_defineProperty(Ry,"layers",""),local_options_defineProperty(Ry,"transform",[]),Ry),rg=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var ig=function(){function SimpleGroup(){!function simple_group_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SimpleGroup)}return rg(SimpleGroup,[{key:"data",value:function data(){throw new Error(ln.INTERFACE_IMPL)}},{key:"config",value:function config(){throw new Error(ln.INTERFACE_IMPL)}},{key:"serialize",value:function serialize(){throw new Error(ln.INTERFACE_IMPL)}},{key:"measurement",value:function measurement(){throw new Error(ln.INTERFACE_IMPL)}}]),SimpleGroup}(),ag=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var og=function(){function Variable(){!function variable_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Variable)}return ag(Variable,[{key:"type",value:function type(){throw new Error(ln.INTERFACE_IMPL)}},{key:"toString",value:function toString(){throw new Error(ln.INTERFACE_IMPL)}}]),Variable}(),sg=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var cg=function(e){function ComposedVars(){var e;!function composed_vars_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ComposedVars);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function composed_vars_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=ComposedVars.__proto__||Object.getPrototypeOf(ComposedVars)).call.apply(e,[this].concat(n)));return i.vars(n),i}return function composed_vars_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(ComposedVars,og),sg(ComposedVars,[{key:"vars",value:function vars(){return arguments.length?(this._vars=arguments.length<=0?void 0:arguments[0],this):this._vars}},{key:"data",value:function data(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.length?(this.vars().forEach(function(e){return e.data(t[0])}),this):this._data}},{key:"getMembers",value:function getMembers(){return this.vars().map(function(e){return e.getMembers()[0]})}},{key:"type",value:function type(){return this.vars()[0].type()}},{key:"toString",value:function toString(){return this.vars().map(function(e){return e.toString()}).join(",")}},{key:"numberFormat",value:function numberFormat(){return this.vars()[0].numberFormat()}},{key:"subtype",value:function subtype(){return this.vars()[0].subtype()}},{key:"getMinDiff",value:function getMinDiff(){return this.vars()[0].getMinDiff()}}]),ComposedVars}(),lg=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var ug=function(e){function SimpleVariable(e){!function simple_var_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SimpleVariable);var t=function simple_var_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SimpleVariable.__proto__||Object.getPrototypeOf(SimpleVariable)).call(this));return t.oneVar(e),t}return function simple_var_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SimpleVariable,og),lg(SimpleVariable,[{key:"oneVar",value:function oneVar(){return arguments.length?(this._oneVar=arguments.length<=0?void 0:arguments[0],this):this._oneVar}},{key:"data",value:function data(){return arguments.length?(this._data=arguments.length<=0?void 0:arguments[0],this):this._data}},{key:"toString",value:function toString(){return this.oneVar()}},{key:"numberFormat",value:function numberFormat(){var e=this.data().getFieldsConfig()[this.oneVar()].index,t=this.data().getFieldspace().fields[e]._ref;return"measure"===this.type()?t.numberFormat():function(e){return e}}},{key:"getMembers",value:function getMembers(){return[this.oneVar()]}},{key:"type",value:function type(){return this.data().getFieldsConfig()[this.oneVar()].def.type}},{key:"subtype",value:function subtype(){var e=this.data().getFieldsConfig()[this.oneVar()].def;return e.subtype||e.type}},{key:"getMinDiff",value:function getMinDiff(){return this.data().getFieldspace().fieldsObj()[this.oneVar()].getMinDiff()}}]),SimpleVariable}(),fg=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function field_sanitizer_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var hg=function convertToVar(e,t){var n=[];return t&&t.forEach(function(t){t instanceof cg?(n.push(t),t.data(e)):n.push(new ug(t).data(e))}),n},dg=function transformFields(e,t){var n=[jy,zy].map(function(n){var r=function normalizeFields(e,t){var n=[],r=e[t];return r[0]instanceof Array?(n[0]=r[0]||[],n[1]=r[1]||[]):n[0]=r,n}(t,n),i=[hg(e,r[0])];return r[1]&&(i[1]=hg(e,r[1])),function orderFields(e,t){var n=[[],[]],r=[[],[]],i=[[],[]],a=[[],[]];e.forEach(function(e,t){e.forEach(function(e){"dimension"===e.type()?(n[t].push(e),"temporal"===e.subtype()?i[t].push(e):a[t].push(e)):r[t].push(e)})});var o=r[0].length+(r[1]?r[1].length:0);if(!e[1]&&(r[1]=t===zy?r[0]:[],r[0]=t!==zy?r[0]:[],n[1]=[],n[0]=n[0],0===o)){var s=[].concat(field_sanitizer_toConsumableArray(n[0]),field_sanitizer_toConsumableArray(n[1]));t===zy?(n[1]=s[s.length-1]?[s[s.length-1]]:[],s.splice(-1,1)):n[1]=[],n[0]=[].concat(field_sanitizer_toConsumableArray(s))}return n[0].length&&n[1].length&&o>0&&(n[0]=[].concat(field_sanitizer_toConsumableArray(n[0]),field_sanitizer_toConsumableArray(n[1])),n[1]=[]),{fields:n.map(function(e,t){return 1===t?r[t].concat(n[t]):n[t].concat(r[t])}),dimensions:[].concat(field_sanitizer_toConsumableArray(n[0]),field_sanitizer_toConsumableArray(n[1])),measures:[].concat(field_sanitizer_toConsumableArray(r[0]),field_sanitizer_toConsumableArray(r[1])),temporal:[].concat(field_sanitizer_toConsumableArray(i[0]),field_sanitizer_toConsumableArray(i[1])),categorical:[].concat(field_sanitizer_toConsumableArray(a[0]),field_sanitizer_toConsumableArray(a[1]))}}(i,n)}),r=fg(n,2),i=r[0],a=r[1],o=i.fields,s=i.dimensions,c=i.measures,l=i.temporal,u=i.categorical,f=a.fields,h=a.dimensions,d=a.measures;return{rows:o,rowDimensions:s,rowMeasures:c,rowTemporalFields:l,rowCategoricalFields:u,columns:f,columnTemporalFields:a.temporal,columnCategoricalFields:a.categorical,columnDimensions:h,columnMeasures:d}},_g=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),pg=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var yg=function(){function VisualEncoder(){!function visual_encoder_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VisualEncoder)}return pg(VisualEncoder,[{key:"createAxis",value:function createAxis(){throw new Error(ln.INTERFACE_IMPL)}},{key:"setCommonDomain",value:function setCommonDomain(){throw new Error(ln.INTERFACE_IMPL)}},{key:"getLayerConfig",value:function getLayerConfig(){throw new Error(ln.INTERFACE_IMPL)}},{key:"fieldInfo",value:function fieldInfo(){return arguments.length?(this._fieldInfo=hn(this._fieldInfo||{},arguments.length<=0?void 0:arguments[0]),this):this._fieldInfo}},{key:"fieldSanitizer",value:function fieldSanitizer(e,t){return this.fieldInfo(dg(e,t)),this.fieldInfo()}},{key:"axisFrom",value:function axisFrom(){return arguments.length?(this._axisFrom=arguments.length<=0?void 0:arguments[0],this):this._axisFrom}},{key:"headerFrom",value:function headerFrom(){return arguments.length?(this._headerFrom=arguments.length<=0?void 0:arguments[0],this):this.__headerFrom}},{key:"setAxisAndHeaders",value:function setAxisAndHeaders(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=jg(Hy,t.rows,e),r=_g(n,2),i=r[0],a=r[1],o=jg("column",t.columns,e),s=_g(o,2),c=s[0],l=s[1];return this.axisFrom({row:a,column:l}),this.headerFrom({row:i,column:c}),this}}]),VisualEncoder}(),gg={linear:Jd,band:e_,temporal:r_,size:A_,color:v_,shape:Y_},mg={dimension:c.BAND,categorical:c.BAND,measure:c.LINEAR,temporal:c.TIME},vg=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function encoder_helper_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var bg=function generateAxisFromMap(e,t,n,r){var i=void 0,a=[],o=t.fields,c=t.index,l=n.cacheMaps[e+"AxesMap"];o.forEach(function(t,r){i=Fg(e,c,mg[t.subtype()]);var o=function getAxisConfig(e,t,n){var r=void 0,i=e.index,a=e.axisIndex,o=e.axisType,c=n.config,l=n.position,u=c.axes&&c.axes[o]||{};r="both"===l?(o===Iy?[s.LEFT,s.RIGHT]:[s.TOP,s.BOTTOM])[a]:l;var f={id:o+"-"+i+"-"+a,name:t.toString(),field:t.toString(),labels:{rotation:0},numberFormat:t.numberFormat(),orientation:r,type:mg[t.subtype()]};return hn(f,u)}({index:c,axisIndex:r,axisType:e},t,n);if(l.has(i)){var u=l.get(i);u[r]&&u[r].config(o)}else{var f=function createSimpleAxis(e,t,n){var r=n.labelManager;return new(0,gg[mg[t.subtype()]])(e,{labelManager:r})}(o,t,n);a.push(f)}}),a.length&&l.set(i,a);var u=!0,f=!1,h=void 0;try{for(var d,_=l.entries()[Symbol.iterator]();!(u=(d=_.next()).done);u=!0){var p=d.value;vg(p,1)[0]===i&&r.add(i)}}catch(e){f=!0,h=e}finally{try{!u&&_.return&&_.return()}finally{if(f)throw h}}return l.get(i)},xg=function getIndex(e,t){for(var n=0,r=-1;-1===r&&n<e.length;)e[n].toString()===t.toString()&&(r=n),n++;return r},wg=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Cg=function(e){function CartesianEncoder(){return function cartesian_encoder_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CartesianEncoder),function cartesian_encoder_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(CartesianEncoder.__proto__||Object.getPrototypeOf(CartesianEncoder)).apply(this,arguments))}return function cartesian_encoder_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(CartesianEncoder,yg),wg(CartesianEncoder,[{key:"createAxis",value:function createAxis(e,t){var n=this,r={},i=e.axes,a=t.projections,o=t.indices,s=a.rowFields,c=a.columnFields,l=[{fields:s,index:o.rowIndex},{fields:c,index:o.columnIndex}],u=i.x||[],f=i.y||[];return[s,c].forEach(function(t,i){var a=0===i?Hy:"column",o=0===i?Iy:Ly;t.length>1?e.position="both":e.position=n.axisFrom()[a],r[o]=bg(o,l[i],e,o===Ly?u:f)}),r}},{key:"getFacetsAndProjections",value:function getFacetsAndProjections(e,t){for(var n=[],r=[],i=0,a=[],o=[],s=e[0],c=e[1],l=s.length,u=c.length,f=this.axisFrom(),h=0;h<l;h++){var d=[s[h]],_=s[h];if("measure"===_.type()){var p=c[i];p&&"measure"===p.type()&&(i++,d=[_,p]),r.push(d)}else n.push(_),a.push(_)}if(u>i)for(var y=i;y<u;y++){var g=c[y],m=[g];"measure"===g.type()?r.push(m):(n.push(g),o.push(g))}if((a.length||o.length)&&!r.length)if(f[t=t===By?"column":t]!==Wy&&"top"!==f[t]||!a.length){var v=o[0];r=[[v]];var b=xg(a,v);b>-1&&(r=[[v,v]],a.splice(b,1)),o.splice(0,1)}else{var x=a.length-1,w=a[x];r=[[w]];var C=xg(o,w);C>-1&&(r=[[w,w]],o.splice(C,1)),a.splice(x,1)}return{facets:n=(n=[].concat(a,o)).filter(function(e,t,n){return t===n.findIndex(function(t){return t.toString()===e.toString()})}),projections:r}}},{key:"fieldSanitizer",value:function fieldSanitizer(e,t){return function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(CartesianEncoder.prototype.__proto__||Object.getPrototypeOf(CartesianEncoder.prototype),"fieldSanitizer",this).call(this,e,t)}},{key:"datamodelForEncoder",value:function datamodelForEncoder(e){return e}},{key:"serializeLayerConfig",value:function serializeLayerConfig(e){var t=[];return e.length&&e.forEach(function(e){var n=up.getSerializedConf(e.mark,e);t.push({mark:e.mark,def:n})}),t}},{key:"getLayerConfig",value:function getLayerConfig(e,t){var n=[],r=e.columnFields,i=e.rowFields;return r.forEach(function(e){var r=e.toString();i.forEach(function(i){var a=[],o=i.toString(),s={x:{field:r},y:{field:o}},c=i.subtype(),l=function getDefaultMark(e,t){return"categorical"===e||"categorical"===t?"bar":"temporal"===e||"temporal"===t?"line":"point"}(e.subtype(),c);a=[{mark:l,def:{mark:l,encoding:s}}];var u=function getLayerConfFromFields(e,t,n){return n.filter(function(n){var r,i,a,o=n instanceof Array?n:[n],s=(r=[]).concat.apply(r,encoder_helper_toConsumableArray(o.map(function(e){return e.def instanceof Array?e.def.map(function(e){return e.axis?{y:{field:e.axis.y},x:{field:e.axis.x}}:e.encoding}):e.def.encoding}))).filter(function(e){return void 0!==e});if(!s.length)return!0;var c=(i=[]).concat.apply(i,encoder_helper_toConsumableArray(s.map(function(e){return[e.x&&e.x.field,e.x0&&e.x0.field]}))).filter(function(e){return void 0!==e&&null!==e}),l=(a=[]).concat.apply(a,encoder_helper_toConsumableArray(s.map(function(e){return[e.y&&e.y.field,e.y0&&e.y0.field]}))).filter(function(e){return void 0!==e&&null!==e});if(!c.length&&!l.length)return!0;var u=!!c.length&&c.every(function(t){return-1!==e.indexOf(t)}),f=!!l.length&&l.every(function(e){return-1!==t.indexOf(e)});return c.length&&l.length?u&&f:u||f})}(e.getMembers(),i.getMembers(),t||[]);u.length&&(a=u.map(function(e){var t=e.def;return t instanceof Array?(a[0].def.mark=l,{mark:e.mark,def:t.map(function(e){return hn(hn({},a[0].def),e)})}):hn(hn({},a[0]),e)})),n.push.apply(n,function cartesian_encoder_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a))})}),n}}],[{key:"type",value:function type(){return"cartesian"}}]),CartesianEncoder}(),kg=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function polar_encoder_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Sg=function(e){function PolarEncoder(){return function polar_encoder_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,PolarEncoder),function polar_encoder_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(PolarEncoder.__proto__||Object.getPrototypeOf(PolarEncoder)).apply(this,arguments))}return function polar_encoder_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(PolarEncoder,yg),kg(PolarEncoder,[{key:"createAxis",value:function createAxis(e,t){var n=e.axes,r=t.indices,i=r.rowIndex,a=r.columnIndex,o=n.pie||[];return o[i]=o[i]||[],o[i][a]=[],n.pie=o,n.x=null,n.y=null,n}},{key:"getFacetsAndProjections",value:function getFacetsAndProjections(e){for(var t=0,n=[],r=[],i=e[0],a=e[1],o=i.length,s=a.length,c=0;c<o;c++){var l=i[c];if("measure"===l.type()){var u=a[t++],f=u?[l,u]:[l];r.push(f)}else n.push(l)}if(s>t)for(var h=t;h<s;h++){var d=a[h],_=[d];"measure"===d.type()?r.push(_):n.push(d)}return{facets:n,projections:r}}},{key:"setCommonDomain",value:function setCommonDomain(){return this}},{key:"layers",value:function layers(){return arguments.length?(this._layers=arguments.length<=0?void 0:arguments[0],this):this._layers}},{key:"fieldSanitizer",value:function fieldSanitizer(e,t){var n=[[],[]],r=[[],[]],i=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(PolarEncoder.prototype.__proto__||Object.getPrototypeOf(PolarEncoder.prototype),"fieldSanitizer",this).call(this,e,t),a=t.layers,o=i.rows,s=i.columns,c=a[0].encoding,l=c&&c.radius?c.radius.field:null,u=c&&c.angle?c.angle.field:null,f=[n,r];return[o,s].forEach(function(e,t){e.forEach(function(e,n){return e.forEach(function(e){e.toString()!==l&&e.toString()!==u&&"measure"!==e.type()&&f[t][n].push(e)})})}),r=[].concat(polar_encoder_toConsumableArray(new Set(r))),n=[].concat(polar_encoder_toConsumableArray(new Set(n))),this.fieldInfo({rows:n,columns:r}),this.fieldInfo()}},{key:"datamodelForEncoder",value:function datamodelForEncoder(e,t,n){t.color,t.size;var r=[],i=this.layers(),a=e.getFieldsConfig();if(i&&i[0]){var o=i[0].def.encoding||{};[Jy,Qy,qy,Uy].forEach(function(e){var t=o[e]?o[e].field:"";a[t]&&"measure"!==a[t].def.type&&r.push(t)})}return e.groupBy([].concat(polar_encoder_toConsumableArray(n),r))}},{key:"getLayerConfig",value:function getLayerConfig(e,t){var n=[],r=e.columnFields,i=e.rowFields;return[].concat(polar_encoder_toConsumableArray(r),polar_encoder_toConsumableArray(i)).forEach(function(){var e={mark:"arc",def:{encoding:{}}};t&&t.length>0&&(e=hn(e,t[0])),n.push(e)}),0===n.length&&(n=t),this.layers(n),n}},{key:"serializeLayerConfig",value:function serializeLayerConfig(e){var t=[];return e.length&&e.forEach(function(e){var n=up.getSerializedConf(e.mark,e);t.push({mark:e.mark,def:n})}),t}}],[{key:"type",value:function type(){return"polar"}}]),PolarEncoder}(),Mg=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Pg=function(e){function RetinalEncoder(){return function retinal_encoder_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,RetinalEncoder),function retinal_encoder_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(RetinalEncoder.__proto__||Object.getPrototypeOf(RetinalEncoder)).apply(this,arguments))}return function retinal_encoder_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(RetinalEncoder,yg),Mg(RetinalEncoder,[{key:"createAxis",value:function createAxis(e){var t=e.datamodel,n=e.config,r={};return[Uy,Vy,qy].forEach(function(e){r[""+e]=function createRetinalAxis(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.axisType,r=e.datamodel,i=t.field,a=[],o=gg[n];return t.type=t.type?t.type:Lg(r,i||null),a.push(new o(t)),a}({axisType:e,datamodel:t},n[e])}),r}},{key:"getLayerConfig",value:function getLayerConfig(e,t){var n=[];return t.forEach(function(t){var r=t;[Uy,Vy,qy].forEach(function(t){if(e[t]&&e[t].field){var n=r.def;r.def instanceof Array?n.forEach(function(n){n.encoding=n.encoding||{},n.encoding[t]=n.encoding[t]||{},n.encoding[t].field=e[t].field}):(n.encoding=n.encoding||{},n.encoding[t]=e[t]||{},n.encoding[t].field=e[t].field)}}),n.push(r)}),n}},{key:"setCommonDomain",value:function setCommonDomain(e){var t=e.datamodel,n=e.axes,r=e.encoding;return Object.entries(r).forEach(function(e){if(e[1]&&e[1].field){var r=e[1].field;r&&(!r[1]||r[1]&&!r[1].domain)&&n[e[0]].forEach(function(e){var n=Ig(t,r);e.updateDomain(n)})}}),n}}],[{key:"type",value:function type(){return"retinal"}}]),RetinalEncoder}(),Eg=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Tg=void 0;function group_utils_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function group_utils_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ag,Og=function initStore(){return new nn(group_utils_defineProperty({},0,0))},Ng=function isDistributionEqual(e){return[].concat(group_utils_toConsumableArray(e[0]),group_utils_toConsumableArray(e[1])).reduce(function(e,t){var n=t.type();return"measure"!==n&&"temporal"!==n||(e=!0),e},!1)},Rg=function initializeCacheMaps(){return{cellMap:new Map,xAxesMap:new Map,yAxesMap:new Map,entryCellMap:new Map,exitCellMap:new Map}},Fg=function getAxisKey(e,t,n){return e+"-axis-"+t+"-"+n},Dg=function headerCreator(e,t,n,r){return e.length>0?e[0].map(function(i,a){return new n({type:"header"},{labelManager:r}).source(function getHeaderText(e,t,n){var r="";if(t===n-1&&e.length>n){for(var i=t;i<e.length-1;i++)r+=e[i].toString()+" / ";return r+=e[e.length-1].toString()}return e[t]?e[t].toString():""}(t,a,e[0].length))}):[]},Lg=function getAxisType(e,t){var n="ordinal";return t&&"dimension"!==e.getFieldsConfig()[t].def.type&&(n="linear"),n},Ig=function retriveDomainFromData(e,t){return e.getFieldspace().fields.find(function(e){return e._ref.name===t.toString()}).domain()},jg=function getHeaderAxisFrom(e,t,n){var r=n[e],i="",a=e===Hy?[Wy,Gy]:["bottom","top"],o=Eg(t,2),s=o[0],c=o[1],l=function firstFieldType(e){return s.length?s[e].type():null},u=function secondFieldType(e){return c.length?c[e].type():null};return"dimension"===l(s.length-1)&&"dimension"===u(0)?(i=r?a[1-a.indexOf(r)]:a[1],r="column"===e&&s[s.length-1].toString()===c[0].toString()?"top":r||a[0]):"dimension"===u(c.length-1)?(i=e===Hy?Gy:"bottom",r=e===Hy?Gy:"bottom"):(i=e===Hy?Wy:"top",r=e===Hy?Wy:"top"),"measure"===l(s.length-1)&&"measure"===u(0)?r=e===Hy?Wy:"top":"measure"===u(0)&&(r=e===Hy?Gy:"bottom"),[i,r]},zg=function setFacetsAndProjections(e,t,n){var r=t.fields,i=t.type,a=n.simpleEncoder.getFacetsAndProjections(r,i),o=a.facets,s=a.projections;return e.facets(group_utils_defineProperty({},i+"Facets",o)),e.projections(group_utils_defineProperty({},i+"Projections",s)),{facets:o,projections:s,fields:r}},Bg=function createSelection(e,t,n,r){var i=e||function dataSelect(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return new Br(e)}([]),a=(i=i.data(n,r)).enter().append(t).merge(i);return i.exit()&&i.exit().remove(),a},Hg=function getBorders(e,t){var n={top:!1,bottom:!1},r={left:!1,right:!1},i={top:!1,bottom:!1,left:!1,right:!1},a=e.rows,o=e.columns,s=e.values,c=Eg(a,2),l=c[0],u=c[1],f=Eg(o,2),h=f[0],d=f[1],_=t.fieldInfo(),p=_.rowDimensions,y=_.columnDimensions,g=_.rowTemporalFields,m=_.columnTemporalFields,v=_.columnMeasures,b=_.rowMeasures,x=p.length+y.length,w=b.length+v.length,C=g.length+m.length;if("polar"===t.constructor.type()){if(!x)return{showRowBorders:n,showColBorders:r,showValueBorders:i}}else if(!w&&!C&&x<=2)return{showRowBorders:n,showColBorders:r,showValueBorders:i};return n=function getRowBorders(e,t){var n={};return!e[0]||e[0].length<=1?n.left=!1:n.left=!0,!t[0]||t[0].length<=1?n.right=!1:n.right=!0,n}(l,u),r=function getColumnsBorders(e,t){var n={};return!e||e.length<=1?n.top=!1:n.top=!0,!t||t.length<=1?n.bottom=!1:n.bottom=!0,n}(h,d),i=function getValueBorders(e,t){var n={top:!0,left:!0,bottom:!0,right:!0},r=[Wy,Gy],i=["top","bottom"];return e.forEach(function(e,t){e[0]&&e[0].length?n[r[t]]=!0:n[r[t]]=!1}),t.forEach(function(e,t){e.length?n[i[t]]=!0:n[i[t]]=!1}),n}([l,u],[h,d]),s.length>1&&(i.top=!0,i.bottom=!0),s.length&&s[0].length>1&&(i.left=!0,i.right=!0),{showRowBorders:n,showColBorders:r,showValueBorders:i}};function action_behaviour_map_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ug=(action_behaviour_map_defineProperty(Ag={},a.DRAG,{behaviours:[r.BRUSH],touch:!1}),action_behaviour_map_defineProperty(Ag,a.HOVER,{behaviours:[r.HIGHLIGHT]}),action_behaviour_map_defineProperty(Ag,a.LONGTOUCH,{behaviours:[r.SELECT],touch:!0}),action_behaviour_map_defineProperty(Ag,a.TOUCHDRAG,{behaviours:[r.BRUSH],touch:!0}),action_behaviour_map_defineProperty(Ag,a.CLICK,{behaviours:[r.SELECT],touch:!1}),Ag),Vg="config",qg="data",Wg="axes",Gg="layerDef",Yg="width",Xg="height",$g="mount",Zg="primaryXAxisUpdated",Kg="primaryYAxisUpdated",Jg="secondaryXAxisUpdated",Qg="secondaryYAxisUpdated",em="transform",tm="dataDomain",nm="layersCreated",rm="fields",im="timeDiffs",am="layerAxisIndex";function visual_unit_src_helper_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var om=function fetchDependencies(e,t){return t.map(function(t){return e.axes()[""+t]})},sm=function getLayerFromDef(e,t,n){var r=n,i=e._layerDeps;n||(r=up.getLayerInstance(t));var a={},o=xn(r),s=(t=xn(t)).reduce(function(e,t,n){var r=o[n];return r.config(t),r.dependencies(i),t.name&&r.alias(t.name),e[r.alias()]=t.source||[],a[r.alias()]=r,e},{}),c=function getDependencyOrder(e){for(var t=[],n={},r=Object.keys(e),i=function visit(i){if(t.length===r.length)return!0;n[i]=!0;for(var a=e[i],o=0;o<a.length;o++){var s=a[o];n[s]||visit(s)}return t.push(i),!1},a=0;a<r.length&&!i(r[a]);a++);return t}(s);return function linkDependencies(e,t,n,r){t.forEach(function(t){var i=t.alias(),a=n[i],o={unit:e};a.length&&(o.layers={},a.forEach(function(e){o.layers[e]=r[e]}),o.layers[i]=t),t.linkLayerStore(o)})}(e,o,s,a),c.map(function(e){return a[e]})},cm=function attachDataToLayers(e,t,n){e.forEach(function(e){var r=e.config().dataSource,i=r instanceof Function?r(t):n[r]||t;e.data(i)})},lm=function attachAxisToLayers(e,t,n){t.forEach(function(t){var r=t.id(),i={};en(e,function(t){var a=n[r];a&&e[t]&&(i[t]=e[t][a[t]||0])}),Object.keys(i).length&&t.axes(i)})},um=function getLayerAxisIndex(e,t){var n={};return e.forEach(function(e){var r=e.config(),i=r.axis,a=r.encoding,o=e.id();["x","y"].forEach(function(e){var r=void 0,s=Qt(bn(i,e),a[e]&&a[e].field);r=t[e]?t[e].findIndex(function(e){return-1!==e.getMembers().indexOf(s)}):0,!n[o]&&(n[o]={}),n[o][e]=r})}),n},fm=function unionDomainFromLayers(e,t,n,r){var i={};return(e=e.filter(function(e){return null!==e.getDataDomain()})).forEach(function(e){var a={},o=e.config(),s=o.encoding,c=e.getDataDomain(),l=e.id();null!==c&&!1!==o.calculateDomain&&(a=Object.entries(c),i=c.x||c.y?a.reduce(function(e,i){var a=i[0],o=s[a].field,c=n[l][a],u=""+t[a][c];return e[u]=e[u]||[],e[u]=function unionDomain(e,t){var n,r=void 0;e=e.filter(function(e){return e.length}),r=t===v.CATEGORICAL?r=(n=[]).concat.apply(n,common_utils_toConsumableArray(e)):[Math.min.apply(Math,common_utils_toConsumableArray(e.map(function(e){return e[0]}))),Math.max.apply(Math,common_utils_toConsumableArray(e.map(function(e){return e[1]})))];return r}([e[u],i[1]],r[o].def.subtype?r[o].def.subtype:r[o].def.type),e},i):a)}),i},hm=function getLayersBy(e,t,n){return e.filter(function(e){return("type"===t?e.constructor.formalName():e.alias())===n})},dm=function removeLayersBy(e,t,n){e.filter(function(e){return("type"===t?e.config().mark:e.alias())!==n||(e.remove(),!1)})},_m=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function grid_lines_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var pm,ym=c.LINEAR,gm=function getGridLayerDefinitions(e,t,n){return["x","y"].map(function(r){return Qt(t[r]&&t[r].show,function getDefaultVisibilty(e,t){return t.constructor.type()===ym&&e}(t.show,e.axes()[r][0]))&&function getLayerDefinition(e,t,n,r){var i,a=void 0,o=e.config(),s=o.classPrefix,c=o.gridLines,l=o.gridBands,u=c.color,f=c.zeroLineColor,h="band"===n?l.defClassName:c.defClassName,d=l[r].color,_=t[r][0],p=_.constructor.type()===ym;"band"===n&&p?(grid_lines_defineProperty(i={},r,r+"value"),grid_lines_defineProperty(i,r+"0",r+"value0"),a=i):a=grid_lines_defineProperty({},r,p?r+"value":r+"dim");return a.color={value:function value(e,t){var i=p&&_.domain()[0]<0;return"band"===n?d[t%2]:i&&0===e[r]?f:u}},{definition:{defClassName:h+"-"+r,className:o.className,individualClassName:function individualClassName(e,t){return p&&_.domain()[0]<0&&0===e.y&&"band"!==n?s+"-axis-zero-line":s+"-grid-"+n+"-"+r+"-"+t%2},padY:"band"===n?0:void 0,encoding:a},axes:grid_lines_defineProperty({},r,_),interactive:!1}}(e,e.axes(),n,r)}).filter(function(e){return void 0!==e})},mm=function renderGridLineLayers(e,t){var n=e.axes(),r=e.config().classPrefix;n&&(n.x&&n.x.length||n.y&&n.y.length)&&(!function createGridLineLayer(e,t){var n=e.config(),r=e._layerDeps,i={width:e.width(),height:e.height()};["band","line"].forEach(function(a){var o=void 0,s=void 0,c=void 0;"band"===a?(o="bar",s=n.gridBands,c=e._gridbands):(o="tick",s=n.gridLines,c=e._gridlines),gm(e,s,a).forEach(function(e,n){var a=void 0,s=e.definition,l=e.axes,u=up.getSerializedConf(o,s);u.mark=o,c[n]?a=c[n]:(a=up.getLayerInstance(u)).dependencies(r),a.config(u).measurement(i).data(t).axes(l),c[n]=a})})}(e,function getGridLayerData(e,t,n){var r=e.x[0].getTickValues(),i=e.y[0].getTickValues(),a=bn(n,bn(t,"x",0).getMembers()[0],"def","subtype"),o=bn(n,bn(t,"y",0).getMembers()[0],"def","subtype"),s=[],c=[{name:"yvalue",type:"measure"},{name:"xvalue",type:"measure"},{name:"yvalue0",type:"measure"},{name:"xvalue0",type:"measure"},{name:"xdim",type:"dimension",subtype:a},{name:"ydim",type:"dimension",subtype:o}],l=Math.max(i.length,r.length);r=a===v.TEMPORAL?r.map(function(e){return e.getTime()}):r,i=o===v.TEMPORAL?i.map(function(e){return e.getTime()}):i;for(var u=0;u<l;u+=1)s.push({yvalue:i[u],yvalue0:i[u+1],xvalue:r[u],xvalue0:r[u+1],xdim:r[u],ydim:i[u]});return new Fy(s,c)}(n,e.fields(),e.data().getFieldsConfig())),[[e._gridlines,r+"-grid-lines"],[e._gridbands,r+"-grid-bands"]].forEach(function(e){var n=_m(e,2),r=n[0],i=n[1],a=Er(t,"g",[1],"."+i);Er(a,"g",r,"."+(i+"-group"),{update:function update(e,t){t.mount(e.node())}})}))},vm={classPrefix:"muze",defClassName:"visual-unit",className:"",trackerClassName:"visual-unit-tracker",gridLines:{defClassName:"axis-grid-lines",className:"",show:!0,color:"#efefef",zeroLineColor:"#b6b6b6"},gridBands:{defClassName:"axis-grid-bands",className:"",show:!1,y:{color:["#fff","#fbfbfb"]},x:{color:["#fff","#f9f9f9"]}},arcLayerClassName:"layer-arc",interaction:{tooltip:{mode:"consolidated"}},sideEffectClassName:"side-effect-container"};function src_local_options_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var bm=(src_local_options_defineProperty(pm={},Vg,{value:null,meta:{sanitization:function sanitization(e,t){return hn(t||hn({},vm),e)}}}),src_local_options_defineProperty(pm,Gg,{value:null}),src_local_options_defineProperty(pm,Wg,{value:null,meta:{sanitization:function sanitization(e,t){return Object.assign(t||{},e)}}}),src_local_options_defineProperty(pm,Yg,{value:null}),src_local_options_defineProperty(pm,Xg,{value:null}),src_local_options_defineProperty(pm,$g,{value:null}),src_local_options_defineProperty(pm,em,{value:null}),src_local_options_defineProperty(pm,rm,{value:null}),src_local_options_defineProperty(pm,qg,{value:null,meta:{preset:function preset(e,t){if(t._cache){var n=t.cachedData();t.cachedData([].concat(function local_options_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n),[e]))}else t.cachedData([e])}}}),pm),xm=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function listener_map_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var wm,Cm={0:"primary",1:"secondary"},km=[Zg,Jg,Kg,Qg],Sm=function listenerMap(e){return[{type:"registerImmediateListener",props:[Wg],listener:function listener(t){var n=xm(t,2)[1];["x","y"].forEach(function(t){(n[t]||[]).forEach(function(t,n){t.on("update",function(){e.store().commit(h[Cm[n]+(t.isReverse()?"Y":"X")+"AxisUpdated"],!0)})})})}},{type:"registerImmediateListener",props:[Vg],listener:function listener(t){var n=xm(t,2)[1];n&&e.firebolt().config(n.interaction)}},{type:"computed",props:[nm],listener:function listener(t){return t(Gg,rm,function(t,n){var r=t.value,i=n.value;if(r&&i){var a=function createLayers(e,t){var n=e._layersMap,r={},i=t.reduce(function(t,i,a){var o,s=i.mark,c=i.def,l=s+"-"+a,u=sm(e,c,n[l]);return t=(o=t).concat.apply(o,visual_unit_src_helper_toConsumableArray(u)),n[l]=u,r[l]=l,t},[]);for(var a in n)a in r||(n[a].forEach(function(e){return e.remove()}),delete n[a]);return i}(e,t.value);return e.layers(a),e._layerAxisIndex=um(e.layers(),i),e._lifeCycleManager.notify({client:a,action:"initialized",formalName:"layer"}),!0}return null})}},{type:"computed",props:[im],listener:function listener(e){return e(qg,rm,Wg,function(e,t,n){var r=e.value,i=t.value,a=n.value;if(r&&i&&a){var o={};return["x","y"].forEach(function(e){var t=i[e][0];t&&t.subtype()===v.TEMPORAL&&(o[e]=t.getMinDiff(),a[e][0].minDiff(o[e]))}),o}return null})}},{type:"computed",props:[tm],listener:function listener(t){return t(qg,nm,Wg,em,function(t,n,r,i){var a=t.value,o=e._layerAxisIndex,s=r.value;if(a&&n.value&&s&&o){var c=e.layers(),l=function transformDataModels(e,t){var n=[],r={},i={};for(var a in e)if({}.hasOwnProperty.call(e,a)){var o=e[a];if(o instanceof Array){var s=o.slice(0,o.length-1),c=o[o.length-1];o.length>1?(n=[].concat(visual_unit_src_helper_toConsumableArray(n),visual_unit_src_helper_toConsumableArray(s)),i[a]={fn:c,deps:s}):r[a]=c(t)}else r[a]=o(t)}return{dataModels:r,queuedTransforms:i}}(i.value,a),u=l.dataModels,f=l.queuedTransforms;return e._transformedDataModels=u,e._queuedTransforms=f,e._lifeCycleManager.notify({client:c,action:"beforeupdate",formalName:"layer"}),cm(c,a,e._transformedDataModels),e._dimensionMeasureMap=function getDimensionMeasureMap(e,t){var n={};for(var r in e.forEach(function(e){var r=e.encodingFieldsInf(),i=r.colorField,a=r.sizeField,o=r.shapeField,s=[r.xField,r.yField].filter(function(e){return t[e]&&t[e].def.type===b.MEASURE});[i,a,o].forEach(function(e){var r;t[e]&&t[e].def.type===b.DIMENSION&&(!n[e]&&(n[e]=[]),(r=n[e]).push.apply(r,visual_unit_src_helper_toConsumableArray(s)))})}),n)({}).hasOwnProperty.call(n,r)&&(n[r]=[].concat(visual_unit_src_helper_toConsumableArray(new Set(n[r]))));return n}(c,a.getFieldsConfig(),e.retinalFields()),lm(s,c,o),e._lifeCycleManager.notify({client:c,action:"updated",formalName:"layer"}),fm(c,e.fields(),o,a.getFieldsConfig())}return null})}},{type:"registerImmediateListener",props:[tm],listener:function listener(t){var n=xm(t,2)[1];null!==n&&e.updateAxisDomain(n)}},{type:"registerImmediateListener",props:[$g].concat(km),listener:function listener(){var t=e._queuedTransforms,n=e._transformedDataModels,r=e.axes(),i=r.x,a=r.y;if(a&&a[0].domain().length&&i&&i[0].domain().length)for(var o in t)if({}.hasOwnProperty.call(t,o)){var s=t[o],c=om(e,s.deps),l=e.data();n[o]=s.fn.apply(s,listener_map_toConsumableArray(c).concat([l])),cm(e.layers(),l,n)}}},{type:"registerImmediateListener",props:[$g,Vg,Yg,Xg].concat(km),listener:function listener(t,n,r,i){var a=xm(t,2)[1],o=xm(n,2)[1],s=xm(r,2)[1],c=xm(i,2)[1];a&&s&&c&&o&&e.render(a)}}]};function props_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mm=(props_defineProperty(wm={},"facetByFields",{}),props_defineProperty(wm,"retinalFields",{}),props_defineProperty(wm,"parentAlias",{}),props_defineProperty(wm,"layers",{}),props_defineProperty(wm,"store",{}),props_defineProperty(wm,"cachedData",{}),wm),Pm=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Em=function registerListeners(e){var t=e.context;t.store().registerImmediateListener([qg,$g],function(t,n){if(t[1]&&n[1]){var r=e.context.cachedData()[0];e.createSelectionSet(e.context.data().getData().uids),e.attachPropagationListener(r)}},!0),t._layerDeps.throwback.registerChangeListener([C.ON_LAYER_DRAW],function(n){Pm(n,2)[1]&&(e.initializeSideEffects(),e.config(t.config().interaction),e.mapActionsAndBehaviour())})};function payload_generator_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Tm={brush:function brush(e,t,n){var r=n.payload,i=function getRangeFromData(e,t,n){var r=t[0].getData(),i=n.payload.criteria,a=n.sourceIdentifiers,o=r.schema,s=e.data().getFieldsConfig(),c=r.data;return e.id()===n.sourceId?i:null!==a?o.reduce(function(e,t,n){var r=void 0,i=t.name,a=s[i],o=(a&&(a.def.subtype?a.def.subtype:a.def.type))===v.CATEGORICAL;return a?(r=o?c.map(function(e){return e[n]}):[Math.min.apply(Math,payload_generator_toConsumableArray(c.map(function(e){return e[n]}))),Math.max.apply(Math,payload_generator_toConsumableArray(c.map(function(e){return e[n]})))],e[i]=r,e):e},{}):null}(e,t,n),a=Object.assign({},r);return a.criteria=i,a},__default:function __default(e,t,n){var r=n.payload,i=n.sourceIdentifiers,a=t[0].getData(),o=a.schema,s=Object.assign({},r);o=a.schema;var c=a.data;return s.criteria=i?[o.map(function(e){return e.name})].concat(payload_generator_toConsumableArray(c)):null,s}},Am=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Om=function(e){function UnitFireBolt(){var e;!function src_firebolt_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,UnitFireBolt);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function firebolt_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=UnitFireBolt.__proto__||Object.getPrototypeOf(UnitFireBolt)).call.apply(e,[this].concat(n)));return i._entryExitSet={},Em(i),i}return function firebolt_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(UnitFireBolt,ii),Am(UnitFireBolt,[{key:"dispatchBehaviour",value:function dispatchBehaviour(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=void 0,i=void 0===n.propagate||n.propagate,a=this._actions.behavioural[e],o=this.context,s=this._behaviourEffectMap,c=s[e]&&s[e],l=this.throwback(),u=o.id(),f=a.dispatch(t,n)(),h=f.find(function(e){return!e.sourceSelectionSet});if(this._entryExitSet[e]=h,i)!function propagateValues(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=void 0,i=n.payload,a=n.selectionSet,o=i.criteria,s=e.context,c=s.cachedData()[0],l=s.id(),u=n.sideEffects.find(function(t){return e._sideEffects[t.name||t].constructor.mutates(!0)}),f=a.mergedEnter.model;if(i.sourceUnit=l,i.sourceFacets=s.facetByFields(),i.action=t,i.sourceCanvas=s.parentAlias(),null===o)r=null;else if(un(o)){var h=Object.keys(o||{});r=f?f.project(h):null}else{var d=o[0];r=f?f.project(d):null}c.addToPropNamespace(l,{payload:i,criteria:r,isMutableAction:u,actionName:u?u.name||u:t}),c.propagate(r,i,{isMutableAction:u,sourceId:l})}(this,e,{payload:t,selectionSet:f.find(function(e){return e.sourceSelectionSet}),sideEffects:c});else{var d=function getApplicableSideEffects(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.context,a=i.id(),o=i.parentAlias(),s=r.propPayload&&r.propPayload.sourceCanvas,c=r.propPayload&&r.propPayload.sourceUnit,l=e._sourceSideEffects,u=c===a;return(t.sideEffects?t.sideEffects:n).filter(function(e){return u||null===t.criteria?s!==o||!1!==e.applyOnSource:!l[e]})}(this,t,c,n);this.applySideEffects(d,h,t)}return!(r=l.get(C.ACTION_INF))&&(r={}),r[e]={payload:t,sourceUnit:i?u:t.sourceUnit},l.commit(C.ACTION_INF,r),this}},{key:"enableSideEffectOnPropagation",value:function enableSideEffectOnPropagation(e){return this._sourceSideEffects[e]=!1,this}},{key:"disableSideEffectOnPropagation",value:function disableSideEffectOnPropagation(e){return this._sourceSideEffects[e]=!0,this}},{key:"onDataModelPropagation",value:function onDataModelPropagation(){var e=this;return function(t){var n=!0,r=t.data,i=t.payload,a=t.sourceIdentifiers,o=i.action,s=Tm[o]||Tm.__default;if(a){var c=a.getFieldsConfig(),l=Object.keys(c),u=Object.keys(r[0].getFieldsConfig());Object.values(c).some(function(e){return e.def.type===b.MEASURE})||(n=l.some(function(e){return-1!==u.indexOf(e)}))}var f=s(e.context,r,t);f&&e.dispatchBehaviour(o,f,{propagate:!1,data:r,propPayload:i,sourceIdentifiers:a,persistent:!1,isSourceFieldPresent:n,sourceId:t.sourceId})}}},{key:"initializeSideEffects",value:function initializeSideEffects(){var e=this;(function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0})(UnitFireBolt.prototype.__proto__||Object.getPrototypeOf(UnitFireBolt.prototype),"initializeSideEffects",this).call(this);var t=this.sideEffects();for(var n in t)({}).hasOwnProperty.call(t,n)&&(t[n]instanceof Ui&&t[n].drawingContext(function(){return e.context.getDrawingContext()}),t[n].sourceInf(function(){return e.context.getSourceInfo()}),t[n].marksFromIdentifiers(function(t){return e.context.getPlotPointsFromIdentifiers(t)}))}},{key:"throwback",value:function throwback(){return arguments.length?(this._throwback=arguments.length<=0?void 0:arguments[0],this):this._throwback}},{key:"remove",value:function remove(){return this.context.cachedData()[0].unsubscribe("propagation"),this}},{key:"getEntryExitSet",value:function getEntryExitSet(e){return this._entryExitSet[e]}}]),UnitFireBolt}(),Nm=(n(29),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());function visual_unit_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function visual_unit_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Rm=function(){function VisualUnit(e,t){var n,r=this;!function visual_unit_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VisualUnit),this._id=Ht(),this._dependencies=t,this._layerDeps={throwback:new nn({onlayerdraw:!1}),smartLabel:t.smartLabel},this._renderedResolve=null,this._renderedPromise=new Promise(function(e){r._renderedResolve=e}),this._layerDeps.throwback.registerChangeListener([C.ON_LAYER_DRAW],function(){r._renderedResolve()}),this._lifeCycleManager=t.lifeCycleManager,this._layersMap={},this._gridlines=[],this._gridbands=[],this._layerAxisIndex={},this._transformedDataModels={},up.setLayerRegistry(e.layerRegistry),sn(this,Mm),this.cachedData([]),this.store(new nn((visual_unit_defineProperty(n={},Zg,null),visual_unit_defineProperty(n,Kg,null),visual_unit_defineProperty(n,Jg,null),visual_unit_defineProperty(n,Qg,null),n))),an(this,bm,this.store().model),this.firebolt(new Om(this,{physical:Li,behavioural:i,physicalBehaviouralMap:Ug},o,Na)),vn(this,Sm)}return Nm(VisualUnit,[{key:"firebolt",value:function firebolt(){return arguments.length?(this._firebolt=arguments.length<=0?void 0:arguments[0],this):this._firebolt}},{key:"getDataDomain",value:function getDataDomain(){return this.store().get(tm)}},{key:"id",value:function id(){return this._id}},{key:"lockModel",value:function lockModel(){return this._store.model.lock(),this}},{key:"unlockModel",value:function unlockModel(){return this._store.model.unlock(),this}},{key:"render",value:function render(e){var t=this.config(),n=t.className,r=t.defClassName,i=t.sideEffectClassName,a=t.classPrefix,o=Jt(r,this.id(),t.classPrefix),s=this.width(),c=this.height(),l=Pr(e).style("position","relative");this._rootSvg=Er(l,"svg",[null],n).style("width",s+"px").style("height",c+"px");var u=this._rootSvg.node();return Or(u,{width:s,height:c,class:o.join(" ")}),mm(this,u),function renderLayers(e,t,n,r){e._lifeCycleManager.notify({client:n,action:"beforedraw",formalName:"layer"});var i=e.config().classPrefix,a=e.layers().sort(function(e,t){return e.config().order-t.config().order}),o=Er(t,"g",[1],i+"-layer-group");Er(o,"g",a,null,{update:function update(t,n){n.measurement(r),n.dataProps({timeDiffs:e.store().get(im)}),n.mount(t.node())}})}(this,u,this.layers(),{width:s,height:c}),this._sideEffectGroup=function createSideEffectGroup(e,t){return Er(e,"g",[1],t).node()}(u,a+"-"+i),this}},{key:"done",value:function done(){return this._renderedPromise}},{key:"enableCaching",value:function enableCaching(){return this._cache=!0,this}},{key:"clearCaching",value:function clearCaching(){return this._cache=!1,this.cachedData([this.cachedData()[0]]),this}},{key:"getDrawingContext",value:function getDrawingContext(){var e=this._rootSvg&&this._rootSvg.node(),t=this.width(),n=this.height();return{htmlContainer:this.mount(),svgContainer:e,width:t,height:n,boundWidth:t,boundHeight:n,sideEffectGroup:this._sideEffectGroup,xOffset:0,yOffset:0}}},{key:"serialize",value:function serialize(){return{layers:this.layers().map(function(e){return e.serialize()}),config:this.config(),axes:this.store().get("axes").map(function(e){return e.serialize()})}}},{key:"addLayer",value:function addLayer(e){var t,n=this,r=e.name,i=this.getLayerByName(r),a={width:this.width(),height:this.height()};if(i)return[i];var o=up.getSerializedConf(e.mark,e),s=sm(this,o);(t=this.layers()).push.apply(t,visual_unit_toConsumableArray(s));var c=um(s,this.fields());return this._layerAxisIndex=Object.assign(this._layerAxisIndex,c),lm(this.axes(),s,c),this.layers().forEach(function(e){e.measurement(a),e.dataProps({timeDiffs:n.store().get(im)})}),s}},{key:"remove",value:function remove(){var e=this._dependencies.lifeCycleManager;return e.notify({client:this,action:"beforeremove",formalName:"unit"}),this.store().unsubscribeAll(),Pr(this.mount()).remove(),this.firebolt().remove(),e.notify({client:this.layers(),action:"beforeremove",formalName:"layer"}),this.layers().forEach(function(e){return e.remove()}),e.notify({client:this.layers(),action:"removed",formalName:"layer"}),e.notify({client:this,action:"removed",formalName:"unit"}),this}},{key:"getDataModelFromIdentifiers",value:function getDataModelFromIdentifiers(e,t){if(null===e)return null;var n=this.data();return mn(n,e,t)}},{key:"resetData",value:function resetData(){return this.data(this.cachedData()[0]),this}},{key:"getSourceInfo",value:function getSourceInfo(){return{dimensionMeasureMap:this._dimensionMeasureMap,fields:this.fields(),data:this.data(),axes:this.axes()}}},{key:"getDefaultTargetContainer",value:function getDefaultTargetContainer(){var e=this.config(),t=e.classPrefix;return[t+"-"+e.defClassName,t+"-"+e.arcLayerClassName+" path"]}},{key:"highlightPoint",value:function highlightPoint(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._layers.forEach(function(n){return!1!==n.config().interactive&&n.highlightPoint(e.uids,t)}),this}},{key:"dehighlightPoint",value:function dehighlightPoint(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._layers.forEach(function(n){return!1!==n.config().interactive&&n.dehighlightPoint(e.uids,t)}),this}},{key:"fadeOutSelection",value:function fadeOutSelection(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.layers().forEach(function(n){return!1!==n.config().interactive&&n.fadeOutSelection(e.uids,t)}),this}},{key:"unfadeSelection",value:function unfadeSelection(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.layers().forEach(function(n){return!1!==n.config().interactive&&n.unfadeSelection(e.uids,t)}),this}},{key:"focusSelection",value:function focusSelection(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.layers().forEach(function(n){return!1!==n.config().interactive&&n.focusSelection(e.uids,t)}),this}},{key:"focusOutSelection",value:function focusOutSelection(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.layers().forEach(function(n){return!1!==n.config().interactive&&n.focusOutSelection(e.uids,t)}),this}},{key:"getLayersByType",value:function getLayersByType(e){return hm(this.layers(),"type",e)}},{key:"getLayerByName",value:function getLayerByName(e){return hm(this.layers(),"name",e)[0]}},{key:"updateAxisDomain",value:function updateAxisDomain(e){var t=this;return["x","y"].forEach(function(n){var r=t.axes()[n];r&&r.forEach(function(r,i){return r.updateDomainCache(e[""+t.fields()[n][i]])})}),this}},{key:"getNearestPoint",value:function getNearestPoint(e,t,n){var r=void 0,i=this.layers(),a=i.length,o={dimensions:[],id:null},s=function getNearestDimensionalValue(e,t){var n=e.fields();if(!n.x.length||!n.y.length)return null;var r=e.data(),i=e.axes(),a=r.getFieldsConfig(),o=bn(n,"x",0).getMembers()[0],s=bn(n,"y",0).getMembers()[0],c=a[o]&&(a[o].def.subtype?a[o].def.subtype:a[o].def.type),l=a[s]&&(a[s].def.subtype?a[s].def.subtype:a[s].def.type),u=[["x",c,o],["y",l,s]].find(function(e){return e[1]===v.CATEGORICAL||e[1]===v.TEMPORAL});if(!u||c!==b.MEASURE&&l!==b.MEASURE)return null;var f=u[2],h=a[f].index,d=i[u[0]][0].invert(t[u[0]]);if(u[1]===v.TEMPORAL){var _=[].concat(visual_unit_src_helper_toConsumableArray(new Set(r.getData().data.map(function(e){return e[h]}))));d=_[Xt(_,d)]}return void 0!==d?[[f],[d]]:null}(this,{x:e,y:t});if(null!==s&&n.getAllPoints)return o.id=s,o;for(var c=0;c<a;c++){var l=i[c];if(!1!==l.config().interactive&&(r=l.getNearestPoint(e,t,n)),r)return r}return o}},{key:"getPlotPointsFromIdentifiers",value:function getPlotPointsFromIdentifiers(e){for(var t=[],n=this.layers(),r=n.length,i=0;i<r;i++){var a=n[i];!1!==a.config().interactive&&(t=[].concat(visual_unit_toConsumableArray(t),visual_unit_toConsumableArray(a.getPointsFromIdentifiers(e))))}return t}},{key:"removeLayerByName",value:function removeLayerByName(e){return dm("name",e),this}},{key:"removeLayersByType",value:function removeLayersByType(e){return dm("type",e),this}}],[{key:"formalName",value:function formalName(){return"unit"}},{key:"create",value:function create(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new(Function.prototype.bind.apply(this,[null].concat(t)))}}]),VisualUnit}(),Fm=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function matrix_model_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Dm=function getFieldNames(e){return[e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]].map(function(e){return e.reduce(function(e,t){return e=[].concat(matrix_model_toConsumableArray(e),matrix_model_toConsumableArray(t.getMembers()))},[])})},Lm=function createSelectedDataModel(e,t,n){return e.select(function(e){return t.every(function(t,r){return e[t].value===n[r]})})},Im=function uniqueKeyGenerator(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=t.facets,a=t.dataModel,o=t.uniqueValues;if(i[n+1]){var s=i[n];o.forEach(function(t){var o=a.select(function(e){return e[s].value===t}),c=Ig(o,i[n+1]);uniqueKeyGenerator(e,{facets:i,dataModel:o,uniqueValues:c},n+1,[].concat(matrix_model_toConsumableArray(r),[t]))})}else o.forEach(function(t){e.push([].concat(matrix_model_toConsumableArray(r),[t]))})},jm=function projectRows(e,t){var n=t.allColumnProjections,r=t.rowProjections,i=t.optionalProjections;return r.length>0?r.map(function(t){var r=Dm(t,n),a=Fm(r,2),o=a[0],s=a[1];return e.project([].concat(matrix_model_toConsumableArray(o),matrix_model_toConsumableArray(s),matrix_model_toConsumableArray(i)))}):[e]},zm=function pushToMatrix(e,t){var n,r=[],i=e.matrix,a=e.datamodel,o=e.facetInfo,s=e.fieldInfo,c=s.rowProjections,l=s.colProjections,u=s.optionalProjections,f=o.rowIndex,h=o.columnIndex,d=c[f%c.length]||[];l.length>0?r=l.map(function(e,n){var r=Dm(e,d),i=Fm(r,2),s=i[0],c=i[1],_=a.project([].concat(matrix_model_toConsumableArray(s),matrix_model_toConsumableArray(c),matrix_model_toConsumableArray(u))),p={rowFields:d,columnFields:e},y={rowIndex:f,columnIndex:h*l.length+n};return t(_,{projections:p,indices:y},o)}):r=[t(a,{projections:{rowFields:d,columnFields:[]},indices:{rowIndex:f,columnIndex:h}},o)];i[f]=i[f]||[],(n=i[f]).push.apply(n,matrix_model_toConsumableArray(r))},Bm=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function cell_creator_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Hm=function createValueCells(e,t,n,r){var i=n.projections,a=n.indices,o=i.rowFields,s=i.columnFields,c=a.rowIndex,l=a.columnIndex,u=e.suppliedLayers,f=e.cell,h=e.resolver,d=e.config,_=e.encoder,p=h.axes(),y=h.cacheMaps(),g=h.matrixLayers(),m=h.dependencies().smartlabel,v=h.horizontalAxis(),b=h.verticalAxis(),x=h.datamodelTransform(),w=y.entryCellMap,C=y.exitCellMap,k=_.getLayerConfig({columnFields:s,rowFields:o},u||[]),S={config:d,labelManager:m,axes:p,cacheMaps:y};n.normalizedColumns=b.fields,n.normalizedRows=v.fields;var M=_.createAxis(S,n);g[c]=g[c]?g[c]:[],g[c][l]=k;var P=function getCellKey(e,t){return"cell-"+e+"-"+t}(c,l),E={y:o,x:s},T=[[].concat(cell_creator_toConsumableArray(r.rowFacets[0]),cell_creator_toConsumableArray(r.colFacets[0])),[].concat(cell_creator_toConsumableArray(r.rowFacets[1]),cell_creator_toConsumableArray(r.colFacets[1]))],A=C.has(P)?C.get(P):new f;return A.data(t).axes(M).fields(E).transform(x).facetByFields(T),w.set(P,A),C.delete(P),function updateCells(e,t,n){[Hy,By].forEach(function(r){var i=e[r+"Cells"](),a=t[r+"Facets"][1].join();!i[a]&&(i[a]=[]),i[a].push(n),e[r+"Cells"](i)})}(h,r,A),w.get(P)},Um=function createAxisCells(e,t,n,r){return Bg(e,function(e){return e},t,function(e,t){return t+e.reduce(function(e,t){return e+(t.id+n)},"")}).map(function(e){if(e&&e[n]){var t=e[n],i=t.config().orientation;return(new r.AxisCell).source(t).config({isOffset:i===s.LEFT||i===s.TOP})}return new r.BlankCell})},Vm=function headerPlaceholderGn(e,t,n,r){var i=e.axis,a=e.keys,o=e.type,s=e.facetConfig,c=i.length/a.length,l=a.length?i.map(function(e,t){return a[Math.floor(t/c)]}):[];return Bg(t[o+"Headers"],function(e){return e},l,function(e,t){return e.join(",")+"-"+t}).map(function(e){return function createTextCells(e,t,n,r){return Bg(e,function(e){return new n.TextCell({},{labelManager:r}).source(e)},t,function(e,t){return e+t})}(null,e,n,r).map(function(t,n,r){return t.source(e[r]).config(s||{})})})},qm=function generatePlaceholders(e,t,n){var r=void 0,i=e.matrices,a=e.fields,o=e.facetsAndProjections,s=e.selection,c=e.facetConfig,l=e.encoders,u=a.rows,f=a.columns,h=i.valuesMatrix,d=o.rowProjections,_=o.colProjections,p=h.rowKeys,y=h.columnKeys,g=l.simpleEncoder._axisFrom,m=l.simpleEncoder._headerFrom;r=s||{},["pie",Ly,Iy].forEach(function(n){var i=n===Ly?g.column:g.row;r=function axisPlaceholderGn(e,t,n){var r=e.matrices.axesMatrix;return function(e,i){var a=r[""+e];if(a&&a.length)if(e===Ly||e===Iy){var o=e===Iy?jy:zy;[eg,tg].forEach(function(e,r){var s=""+o+e,c=r,l=a;i!==Gy&&"bottom"!==i||(c=1-c),bn(a,0,c)||(l=[]),t[s]=Um(t[s],l,c,n)})}else t.rowsPrimary=Um(t.rowPrime,a.map(function(){return[]}),0,n),t.columnsPrimary=Um(t.colPrime,a[0],0,n);return t}}(e,r,t)(n,i)});var v=r,b=v.rowsPrimary,x=v.rowsSecondary,w=v.columnsPrimary,C=v.columnsSecondary,k=b&&b.getObjects().length?b.getObjects():x&&x.getObjects().length?x.getObjects():[],S=w&&w.getObjects().length?w.getObjects():C&&C.getObjects().length?C.getObjects():[];return[{type:Wy,section:u[0],axis:k,headerFrom:m.row},{type:Gy,section:u[1],axis:k,headerFrom:m.row},{type:"top",section:f[0],axis:S,headerFrom:m.column},{type:"bottom",section:f[1],axis:S,headerFrom:m.column}].forEach(function(e,i){var a=void 0,o=void 0,s=e.type,l=e.section,u=e.axis,f=e.headerFrom;if(i<2?(a=p,o=d.length>0?d.length:1):(a=y,o=_.length>0?_.length:1),l.length&&f===s&&u&&a.length){var h={axis:u,length:o,type:s},g=[];i<2?(h.keys=a,h.facetConfig=c.rows,g=Vm(h,r,t,n)):(h.facetConfig=c.columns,h.keys=a[0].map(function(e,t){return a.map(function(e){return e[t]})}),g=Vm(h,r,t,n)),r[s+"Headers"]=g}else r[s+"Headers"]=null}),r},Wm=function computeMatrices(e,t){var n=e.resolver,r=e.datamodel,i=e.componentRegistry,a=e.encoders,o=t.globalConfig,s=t.selection,c=t.transform,l=n.dependencies().smartlabel,u=r.getFieldsConfig(),f=n.layerConfig(),h=n.registry(),d=n.horizontalAxis().fields,_=n.verticalAxis().fields,p=n.optionalProjections(t,f),y=n.getAllFields(),g={normalizedColumns:_,normalizedRows:d,facetsAndProjections:y,layers:f,fieldMap:u,otherEncodings:p,encoders:a,facetConfig:o.facetConfig||{},axisFrom:o.axisFrom||{},selection:s},m={GeomCell:n.getCellDef(h.GeomCell),AxisCell:n.getCellDef(h.AxisCell),BlankCell:n.getCellDef(h.BlankCell),TextCell:n.getCellDef(h.TextCell)},v=Ng(d),b=Ng(_);n.colCells({}),n.rowCells({}),n.datamodelTransform(c||{}),n.resetSimpleAxes();var x={exitCellMap:n.cacheMaps().entryCellMap,entryCellMap:new Map};n.cacheMaps(x);var w=function getMatrixModel(e,t,n){var r=[],i=[],a=[],o=[],s=[],c=[],l=t.rowFacets,u=t.colFacets;if(t.colProjections.forEach(function(e){o.push.apply(o,matrix_model_toConsumableArray(e))}),t.allColumnProjections=o,l.length>0){var f=l[0].toString(),h=Ig(e,f);Im(i,{facets:l,dataModel:e,uniqueValues:h}),i.forEach(function(n){var i,a=Dm(l),o=Fm(a,1)[0],s=Lm(e,o,n);c.push([o,n]),(i=r).push.apply(i,matrix_model_toConsumableArray(jm(s,t)))})}else{var d;(d=r).push.apply(d,matrix_model_toConsumableArray(jm(e,t)))}if(r=r.length>0?r:[[]],u.length>0){var _=u.map(function(e){return""+e}),p=_[0],y=Ig(e,p);Im(a,{facets:_,dataModel:e,uniqueValues:y}),r.forEach(function(r,i){c[i]=c[i]||[[],[]],a.forEach(function(a,o){s[i]=s[i]||[];var l=r.constructor&&"DataModel"===r.constructor.name?r:e,f=Lm(l,_,a),h={matrix:s,datamodel:f,facetInfo:{rowFacets:c[i],colFacets:[u,a],rowIndex:i,columnIndex:o},fieldInfo:t};zm(h,n)})})}else r.forEach(function(r,i){c[i]=c[i]||[[],[]];var a={matrix:s,datamodel:r||e,facetInfo:{rowFacets:c[i],colFacets:[[],[]],rowIndex:i,columnIndex:0},fieldInfo:t};zm(a,n)});var g=a.length>0?a[0].map(function(e,t){return a.map(function(e){return e[t]})}):a;return{matrix:s,rowKeys:i,columnKeys:g}}(r,y,n.valueCellsCreator(m.GeomCell,o,a.simpleEncoder));n.cacheMaps().exitCellMap.forEach(function(e){e.remove()}),n.cacheMaps().exitCellMap.clear(),n.valueMatrix(w.matrix),n.createUnits(i,t);var C=function mutateAxesFromMap(e,t){var n=null,r=null,i=e.xAxesMap,a=e.yAxesMap,o=t.x,s=t.y;return o&&o.forEach(function(e){var t=i.get(e);(n=n||[]).push(t)}),s&&s.forEach(function(e){var t=a.get(e);(r=r||[]).push(t)}),{xAxes:n,yAxes:r}}(n.cacheMaps(),n.axes()),k=C.xAxes,S=C.yAxes;n.axes({x:k,y:S});var M=function generateMatrices(e,t,n,r){var i=e.unitHeight,a=e.unitWidth,o=e.facetsAndProjections,s=e.normalizedRows,c=e.normalizedColumns,l=e.selection,u=e.axisFrom,f=e.facetConfig,h=e.encoders,d=qm({fields:{rows:s,columns:c},matrices:t,facetsAndProjections:o,selection:l,axisFrom:u,facetConfig:f,encoders:h},n,r),_=d.columnsPrimary,p=d.columnsSecondary,y=d.rowsPrimary,g=d.rowsSecondary,m=d.leftHeaders,v=d.topHeaders,b=d.bottomHeaders,x=d.rightHeaders,w=[y,g,_,p].map(function(e){return e?e.getObjects():[]}),C=Bm(w,4),k=C[0],S=C[1],M=C[2],P=C[3],E=[m,x].map(function(e){return e?e.getObjects().map(function(e){return e.getObjects()}):[]}),T=Bm(E,2),A=T[0],O=T[1],N=A.length?A.map(function(e,t){return k[t]=k[t]?[k[t]]:[],[].concat(cell_creator_toConsumableArray(e),cell_creator_toConsumableArray(k[t]))}):k?k.map(function(e){return[e]}):[],R=S.length?S.map(function(e,t){return[e].concat(cell_creator_toConsumableArray(O[t]||[]))}):O.length?O.map(function(e){return[].concat(cell_creator_toConsumableArray(e))}):[],F=[];v&&v.getObjects().forEach(function(e){e.getObjects().forEach(function(e,t){F[t]=F[t]||[],F[t].push(e)})});M.length&&F.push(M);var D=[];P.length&&D.push(P);var L=D.length;b&&b.getObjects().forEach(function(e){e.getObjects().forEach(function(e,t){D[t+L]=D[t+L]||[],D[t+L].push(e)})});if(!N.length&&!R.length){var I=new n.BlankCell;I.setAvailableSpace(a,i),N=[[I]]}if(!(F.length||D.length&&D[0].length)){var j=new n.BlankCell;j.setAvailableSpace(a,i),D=[[j]]}return{rows:[N,R],columns:[F,D],selectionObj:d}}(g,{valuesMatrix:w,axesMatrix:n.axes()},m,l),P=M.rows,E=M.columns,T=M.selectionObj;return n.rowMatrix(P),n.columnMatrix(E),{rows:n.rowMatrix(),columns:n.columnMatrix(),values:n.valueMatrix(),isColumnSizeEqual:b,isRowSizeEqual:v,selection:T}},Gm=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Ym=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function matrix_resolver_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Xm=function(){function MatrixResolver(e){!function matrix_resolver_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MatrixResolver),this._registry={},this._layerConfig=[],this._matrixLayers=[],this._dependencies=e,this._rowMatrix=[],this._columnMatrix=[],this._valueMatrix=[],this._facets={},this._projections={},this._datamodelTransform={},this._units=[],this._cacheMaps={},this._axes={x:{},y:{},color:[],size:[],shape:[]},this.cacheMaps(Rg())}return Ym(MatrixResolver,[{key:"registry",value:function registry(){var e=this;return arguments.length?(Object.entries(arguments.length<=0?void 0:arguments[0]).forEach(function(t){e._registry[t[0]]=t[1]}),this):this._registry}},{key:"dependencies",value:function dependencies(){return arguments.length?(this._dependencies=arguments.length<=0?void 0:arguments[0],this):this._dependencies}},{key:"units",value:function units(){return arguments.length?(this._units=arguments.length<=0?void 0:arguments[0],this):this._units}},{key:"layerConfig",value:function layerConfig(){return arguments.length?(this._layerConfig=arguments.length<=0?void 0:arguments[0],this):this._layerConfig}},{key:"matrixLayers",value:function matrixLayers(){return arguments.length?(this._matrixLayers=arguments.length<=0?void 0:arguments[0],this):this._matrixLayers}},{key:"datamodelTransform",value:function datamodelTransform(){return arguments.length?(this._datamodelTransform=arguments.length<=0?void 0:arguments[0],this):this._datamodelTransform}},{key:"cacheMaps",value:function cacheMaps(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.length?([Yy,Xy,$y,Zy,Ky].forEach(function(t){e._cacheMaps[t+"Map"]=n[0][t+"Map"]||e._cacheMaps[t+"Map"]}),this):this._cacheMaps}},{key:"rowCells",value:function rowCells(){return arguments.length?(this._rowCells=arguments.length<=0?void 0:arguments[0],this):this._rowCells}},{key:"colCells",value:function colCells(){return arguments.length?(this._colCells=arguments.length<=0?void 0:arguments[0],this):this._colCells}},{key:"axes",value:function axes(){return arguments.length?(this._axes=Object.assign({},this._axes,arguments.length<=0?void 0:arguments[0]),this):this._axes}},{key:"rowMatrix",value:function rowMatrix(){return arguments.length?(this._rowMatrix=arguments.length<=0?void 0:arguments[0],this):this._rowMatrix}},{key:"columnMatrix",value:function columnMatrix(){return arguments.length?(this._columnMatrix=arguments.length<=0?void 0:arguments[0],this):this._columnMatrix}},{key:"valueMatrix",value:function valueMatrix(){return arguments.length?(this._valueMatrix=arguments.length<=0?void 0:arguments[0],this):this._valueMatrix}},{key:"facets",value:function facets(){var e=this;return arguments.length?(Object.entries(arguments.length<=0?void 0:arguments[0]).forEach(function(t){e._facets[t[0]]=t[1]}),this):this._facets}},{key:"projections",value:function projections(){var e=this;return arguments.length?(Object.entries(arguments.length<=0?void 0:arguments[0]).forEach(function(t){e._projections[t[0]]=t[1]}),this):this._projections}},{key:"optionalProjections",value:function optionalProjections(e,t){var n={},optionalProjections=[];return[qy,Uy,Vy].forEach(function(t){if(e[t]&&e[t].field){var r=e[t];n[t]=r.field,optionalProjections.push(r.field)}}),e.detail&&optionalProjections.push.apply(optionalProjections,matrix_resolver_toConsumableArray(e.detail)),t.length&&t.forEach(function(e){e.encoding&&Object.values(e.encoding).forEach(function(e){e&&-1===optionalProjections.indexOf(e.field)&&optionalProjections.push(e.field?e.field:e)})}),this.projections({optionalProjections:optionalProjections}),n}},{key:"horizontalAxis",value:function horizontalAxis(e,t){return e?(this._horizontalAxis=zg(this,{type:Hy,fields:e},t),this):this._horizontalAxis}},{key:"verticalAxis",value:function verticalAxis(e,t){return e?(this._verticalAxis=zg(this,{type:By,fields:e},t),this):this._verticalAxis}},{key:"getCellDef",value:function getCellDef(e){var t=this.registry();return Object.values(t).forEach(function(t){t.prototype instanceof e&&(e=t)}),e}},{key:"valueCellsCreator",value:function valueCellsCreator(e,t,n,r){this.matrixLayers([]);var i={config:t,suppliedLayers:n.serializeLayerConfig(this.layerConfig()),resolver:this,cell:e,encoder:n,newCacheMap:r};return function(e,t,n){return Hm(i,e,t,n)}}},{key:"forEach",value:function forEach(e,t){this[e]().forEach(function(e,n){e.forEach(function(e,r){t(n,r,e)})})}},{key:"getAllFields",value:function getAllFields(){var e=this.projections();return Object.entries(this.facets()).forEach(function(t){e[t[0]]=t[1]}),e}},{key:"resetSimpleAxes",value:function resetSimpleAxes(){return this.axes({x:new Set,y:new Set})}},{key:"createUnits",value:function createUnits(e,t){var n=t.globalConfig,r=t.alias,i=e.layerRegistry,a=e.sideEffectRegistry,o=this.dependencies(),s=o.smartlabel,c=o.lifeCycleManager,l=[],u=function extractUnitConfig(e){var t={};return["interaction","gridLines","gridBands"].forEach(function(n){void 0!==e[n]&&(t[n]=e[n])}),t}(n||{});return this.forEach("valueMatrix",function(e,t,n){var o=n.source();o||(o=Rm.create({layerRegistry:i,sideEffectRegistry:a},{smartLabel:s,lifeCycleManager:c}),n.source(o),l.push(o)),o.parentAlias(r),n.config(u)}),c.notify({client:l,action:"initialized",formalName:"unit"}),this.units(l)}},{key:"setDomains",value:function setDomains(e,t,n){var r=e.color,i=e.shape,a=e.size,o=this.getAllFields(),s=o.rowFacets,c=o.colFacets,l=[].concat(matrix_resolver_toConsumableArray(s.map(function(e){return e.toString()})),matrix_resolver_toConsumableArray(c.map(function(e){return e.toString()}))),u={datamodel:n.simpleEncoder.datamodelForEncoder(t,e,l),axes:this.axes(),encoding:{color:r,shape:i,size:a}};return n.retinalEncoder.setCommonDomain(u),this}},{key:"getRetinalAxes",value:function getRetinalAxes(){var e=this.axes(),t=e.color,n=e.shape,r=e.size;return{color:[].concat(matrix_resolver_toConsumableArray(t)),shape:[].concat(matrix_resolver_toConsumableArray(n)),size:[].concat(matrix_resolver_toConsumableArray(r))}}},{key:"getSimpleAxes",value:function getSimpleAxes(e){return this.axes()[""+e]}},{key:"createRetinalAxes",value:function createRetinalAxes(e,t,n){var r=this,i=this.layerConfig();this.optionalProjections(t,i);var a=n.retinalEncoder.createAxis({datamodel:e,config:t,axes:this.axes()}),o=this.dependencies().lifeCycleManager;[Uy,Vy,qy].forEach(function(e){r.axes()[e]=a[e]}),o.notify({client:this.axes(),action:"initialized",formalName:"axis"}),o.notify({client:this.units(),action:"beforeupdate",formalName:"unit"});var s=[],c=this.matrixLayers();return this.forEach("valueMatrix",function(e,r,i){i.axes(a),i.source()&&i.source().retinalFields(t),i.layerDef(n.retinalEncoder.getLayerConfig(t,c[e][r])),i.updateModel(),s.push(i.source())}),o.notify({client:s,action:"updated",formalName:"unit"}),this}},{key:"createHeaders",value:function createHeaders(e,t){var n=[],r=[],i=e.rows,a=e.columns,o=this.dependencies(),s=o.smartlabel,c=o.lifeCycleManager,l=this.getCellDef(this.registry().TextCell),u=this.getCellDef(this.registry().BlankCell),f=Gm(i,2),h=f[0],d=f[1],_=Gm(a,2),p=_[0],y=_[1],g=t.rows,m={left:Dg(h,g[0],l,s),right:Dg(d,g[1],l,s)},v={left:h.length>0?h[0].map(function(){return new u}):[],right:d.length>0?d[0].map(function(){return new u}):[]},b=[Wy,Gy].map(function(e){return p.map(function(t,n){return n===p.length-1?m[e]:v[e]})}),x=Gm(b,2),w=x[0],C=x[1];if(0===p.length){var k=[Wy,Gy].map(function(e){return y.map(function(t,n){return 0===n?m[e]:v[e]})}),S=Gm(k,2);n=S[0],r=S[1]}else n=y.map(function(){return h.length>0?h[0].map(function(){return new u}):[]}),r=y.map(function(){return d.length>0?d[0].map(function(){return new u}):[]});return c.notify({client:[w,C,n,r],action:"initialized",formalName:"facet-headers"}),{topLeft:w,topRight:C,bottomLeft:n,bottomRight:r}}},{key:"getMatrices",value:function getMatrices(e,t,n,r){return Wm({datamodel:e,componentRegistry:n,encoders:r,resolver:this},t)}}]),MatrixResolver}(),$m=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Zm=function(){function ValueMatrix(e){!function value_matrix_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ValueMatrix);var t={};this.matrix(e),this.filter(function(){return!0}),this.each(function(e){var n=e.valueOf();if(n&&n.id){var r=n.id();t[r]=n}}),this.instancesById(t)}return $m(ValueMatrix,[{key:"instancesById",value:function instancesById(){return arguments.length?(this._instancesById=arguments.length<=0?void 0:arguments[0],this):this._instancesById}},{key:"matrix",value:function matrix(){return arguments.length?(this._matrix=arguments.length<=0?void 0:arguments[0],this):this._matrix}},{key:"filter",value:function filter(){return arguments.length?(this._filterFn=arguments.length<=0?void 0:arguments[0],this):this._filterFn}},{key:"width",value:function width(){var e=0;return this.matrix().forEach(function(t){var n=0;t.forEach(function(e){n+=e.getLogicalSpace().width}),e=Math.max(e,n)}),e}},{key:"height",value:function height(){var e=0;return this.matrix().forEach(function(t){var n=0;t.forEach(function(e){n=Math.max(n,e.getLogicalSpace().height)}),e+=n}),e}},{key:"each",value:function each(e){var t=this.matrix(),n=this.filter();return t.forEach(function(r,i){r.forEach(function(r,a){n(r)&&e(r,i,a,t)})}),this}},{key:"findPlaceHolderById",value:function findPlaceHolderById(e){return this.instancesById()[e]}},{key:"getMatrixArray",value:function getMatrixArray(){return this.matrix()}}]),ValueMatrix}();var Km=function setupChangeListeners(e){return e.store().registerImmediateListener([].concat(function change_listener_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Object.keys(ng)),[0]),function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=e.data(),a=n[0],o=n[1],s=n[2],c=n[3],l=n[4],u=n[5],f=n[6],h=n[7],d=n[8];if(i&&o[1]&&s[1]){var _=e.resolver(),p={selection:e.selection(),alias:e.alias(),globalConfig:a[1]||{},rows:o[1],columns:s[1],color:c[1],shape:l[1],size:u[1],detail:f[1],layers:h[1],transform:d[1]},y={color:c[1],shape:l[1],size:u[1]},g={};g.retinalEncoder=new Pg,g.simpleEncoder=function getEncoder(e){var t=new Cg;return e&&(t=e.every(function(e){return"arc"===e.mark})?new Sg:t),t}(h[1]),e.groupType(g.simpleEncoder.constructor.type());var m=g.simpleEncoder.fieldSanitizer(i,p);g.simpleEncoder.setAxisAndHeaders(a[1]?a[1].axisFrom:{},m),h[1]&&_.layerConfig(h[1]),_.horizontalAxis(m.rows,g).verticalAxis(m.columns,g);var v=_.getMatrices(i,p,e.registry(),g);e.selection(v.selection),_.createRetinalAxes(i,y,g),_.setDomains(p,i,g),function setMatrixInstances(e,t){e.matrixInstance({value:new Zm(t.values),left:new Zm(t.rows[0]),right:new Zm(t.rows[1]),top:new Zm(t.columns[0]),bottom:new Zm(t.columns[1])})}(e,v),e.cornerMatrices(_.createHeaders(v,m)),e.placeholderInfo(v),e.metaData({border:Hg(v,g.simpleEncoder)})}return e}),e},Jm={alias:{},data:{sanitization:function sanitization(e,t){if(e._data!==t){var n=e.store(),r=n.get(0);n.commit(0,++r)}return t}},cornerMatrices:{},groupType:{},matrixInstance:{},metaData:{},placeholderInfo:{},resolver:{},registry:{sanitization:function sanitization(e,t){return e.resolver&&e.resolver().registry(t.cellRegistry),t}},selection:{},store:{}},Qm=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function visual_group_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function visual_group_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ev,tv,nv=function(e){function VisualGroup(e,t){!function visual_group_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VisualGroup);var n=function visual_group_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(VisualGroup.__proto__||Object.getPrototypeOf(VisualGroup)).call(this)),r=e.componentSubRegistry;return n._dependencies=t,sn(n,Jm),n.store(Og()),n._data=[],n._matrixInstance={},n._mount=null,n._selection={},n._placeholderInfo={},n._cornerMatrices={},n.resolver(new Xm(n._dependencies)),n.registry({layerRegistry:r.layerRegistry.get(),cellRegistry:r.cellRegistry.get()}),an(n,ng,n.store().model),Km(n),n}return function visual_group_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(VisualGroup,ig),Qm(VisualGroup,[{key:"lockModel",value:function lockModel(){return this.store().model.lock(),this}},{key:"unlockModel",value:function unlockModel(){return this.store().model.unlock(),this}},{key:"where",value:function where(e){return function findInGroup(e,t){var n=null;return[Uy,qy,Vy].forEach(function(t){Tg.store.get(t)&&e===Tg.store.get(t)[0]&&(n=t)}),n?{channel:n}:([Hy,By].forEach(function(r){t[r+"Facets"].forEach(function(t){t.toString()===e&&(n={channel:"facet",type:r===By?"column":Hy})})}),n||([Hy,By].forEach(function(r){t[r+"Projections"].forEach(function(t){t.forEach(function(t){t.toString()===e&&(n=r===By?Ly:Iy)})})}),n?{channel:n}:null))}(e,this.resolver().getAllFields())}},{key:"getAxes",value:function getAxes(e){return"retinal"===e?this.resolver().getRetinalAxes():this.resolver().getSimpleAxes(e)}},{key:"getCells",value:function getCells(e){return this.resolver()[e+"Cells"]()}},{key:"getFieldsFromChannel",value:function getFieldsFromChannel(e){var t=this.resolver().getAllFields(),n=t.rowProjections,r=t.colProjections;return e===Iy?n:r}},{key:"getCellsByFacetKey",value:function getCellsByFacetKey(e){var t=this.resolver();return t.rowCells()[e]||t.colCells()[e]||[]}},{key:"getAxesByFacetKey",value:function getAxesByFacetKey(e,t){var n=this.resolver();return(n.rowCells()[t]||n.colCells()[t])[0].valueOf().axes()[e]||[]}},{key:"serialize",value:function serialize(){var e,t=this.store();return visual_group_defineProperty(e={},"config",t.get("config")),visual_group_defineProperty(e,"mount",t.get("mount")),e}},{key:"getDimensionMeasureMap",value:function getDimensionMeasureMap(e){var t=this.resolver().projections(),n=t.rowFacets.map(function(e){return""+e}),r=t.colFacets.map(function(e){return""+e}),i=t.rowProjections&&t.rowProjections[0]||[],a=t.colProjections&&t.colProjections[0]||[],o={},s=i.filter(function(e){return e.type()===b.MEASURE}),c=a.filter(function(e){return e.type()===b.MEASURE});return this.getCellsByFacetKey(e).map(function(e){return e.valueOf()}).forEach(function(e){var t=e._dimensionMeasureMap;for(var n in t)({}).hasOwnProperty.call(t,n)&&(!o[n]&&(o[n]=[]),o[n]=[].concat(visual_group_toConsumableArray(new Set([].concat(visual_group_toConsumableArray(o[n]),visual_group_toConsumableArray(t[n]))))))}),n.forEach(function(e){o[e]=s.map(function(e){return""+e})}),r.forEach(function(e){o[e]=c.map(function(e){return""+e})}),o}},{key:"findUnitById",value:function findUnitById(e){return this.matrixInstance().value.findPlaceHolderById(e)}}]),VisualGroup}();n(0);function firebolt_action_behaviour_map_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var rv,iv,av=(firebolt_action_behaviour_map_defineProperty(ev={},a.DRAG,{target:"muze-gradient-shape",behaviours:[r.BRUSH]}),firebolt_action_behaviour_map_defineProperty(ev,a.HOVER,{target:["muze-legend-columns"],behaviours:[r.HIGHLIGHT]}),firebolt_action_behaviour_map_defineProperty(ev,a.CLICK,{target:["muze-legend-columns"],behaviours:[r.SELECT]}),ev),ov=(firebolt_action_behaviour_map_defineProperty(tv={},r.SELECT,r.FILTER),firebolt_action_behaviour_map_defineProperty(tv,r.BRUSH,r.HIGHLIGHT),tv);function firebolt_behaviour_effect_map_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var sv=(firebolt_behaviour_effect_map_defineProperty(rv={},"brush",["selectionBox",{name:"highlighter",strategy:"fade"}]),firebolt_behaviour_effect_map_defineProperty(rv,"highlight",["highlighter"]),firebolt_behaviour_effect_map_defineProperty(rv,"select",[{name:"highlighter",strategy:"fade"}]),rv),cv=(firebolt_behaviour_effect_map_defineProperty(iv={},"brush",[{name:"highlighter",strategy:"fade"}]),firebolt_behaviour_effect_map_defineProperty(iv,"highlight",[{name:"highlighter",strategy:"fade"}]),iv),lv={size:"getSize",shape:"getShape",color:"getColor"};var uv=function propagate(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=void 0,a=e.context.constructor.type(),o=r.payload,s=e.context.data(),c=e.context.metaData(),l=c.getData().schema[0].type,u={},f=e.context._id;u.action=ov[t]||t,u.sideEffects=cv[t];var h=e._actions.behavioural[u.action].constructor.mutates();if(null===o.criteria)i=null;else{var d=n.mergedEnter,_=s.filter(function(e){return-1!==d.uids.indexOf(e.id)}).map(function(e){return e.value});if("step"===a||"discrete"===a&&"measure"===l){var p=Object.keys(o.criteria||{})[0];_=s.filter(function(e){return-1!==d.uids.indexOf(e.id)}).map(function(e){return e.range}),i=c.select(function(e){for(var t=!1,n=0;n<_.length&&!0!==(t=e[p].value>=_[n][0]&&e[p].value<=_[n][1]);n++);return t},{saveChild:!1})}else"gradient"===a?i=gn(c,o.criteria):_.length?i=function assembleModelFromIdentifiers(e,t){var n=[],r=void 0,i=e.getFieldsConfig();return t.length?function(){for(var e=t[0],a=e.length,o=0;o<a;o++){var s=e[o],c=void 0;(c=s===w.ROW_ID?{name:s,type:b.DIMENSION}:i[s]&&Object.assign({},i[s].def))&&n.push(Object.assign(c))}r=[];for(var l=t[0],u=function _loop2(e){var n={};t[e].forEach(function(e,t){n[l[t]]=e}),r.push(n)},f=1;f<t.length;f+=1)u(f)}():(r=[],n=[]),new e.constructor(r,n)}(c,[o.criteria[0]].concat(function firebolt_helper_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(_.map(function(e){return[e]})))):(u.criteria=null,i=c.select(function(){return!0},{saveChild:!1}))}c.addToPropNamespace("legend-"+f,{payload:u,criteria:null===u.criteria?null:i,isMutableAction:h,actionName:u.action}),c.propagate(i,u,{isMutableAction:h,sourceId:f})},fv=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var hv=function(e){function LegendFireBolt(){var e;!function legend_firebolt_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LegendFireBolt);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function legend_firebolt_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=LegendFireBolt.__proto__||Object.getPrototypeOf(LegendFireBolt)).call.apply(e,[this].concat(n)));return i.initializeSideEffects(),i}return function legend_firebolt_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(LegendFireBolt,ii),fv(LegendFireBolt,[{key:"dispatchBehaviour",value:function dispatchBehaviour(e,t){var n=this._actions.behavioural[e];if(n){var r=this._behaviourEffectMap[e],i=n.dispatch(t,{})()[0];this.applySideEffects(r,i,t),uv(this,e,i,{payload:t})}}},{key:"getAddSetFromCriteria",value:function getAddSetFromCriteria(e){var t=void 0,n=void 0,r=this.context.constructor.type();return null===e?n=null:"step"===r?(t=Object.values(e),n=this.context.data().filter(function(e){return-1!==t.indexOf(e.range)}).map(function(e){return e.id})):"gradient"===r?n=[]:(t=e[1])?n=this.context.data().filter(function(e){return-1!==t.indexOf(e.value)}).map(function(e){return e.id}):(t=Object.values(e),n=this.context.data().filter(function(e){return-1!==t.indexOf(e.range)}).map(function(e){return e.id})),{uids:n,model:null}}},{key:"getFullData",value:function getFullData(){return null}}]),LegendFireBolt}();function drag_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dv,_v=function hover(e){return function(t,n){var r=function dispatchBehaviour(t){var r={criteria:e.context.getCriteriaFromData(t)};n.forEach(function(t){return e.dispatchBehaviour(t,r)})};Pr(t).on("mouseover",r).on("mousemove",r).on("mouseout",function(){n.forEach(function(t){return e.dispatchBehaviour(t,{criteria:null})})})}},pv=function click(e){return function(t,n){Pr(t).on("click",function dispatchBehaviour(t){var r={criteria:e.context.getCriteriaFromData(t)};n.forEach(function(t){return e.dispatchBehaviour(t,r)})})}};function firebolt_physical_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var yv=(firebolt_physical_defineProperty(dv={},"drag",function drag(e){return function(t,n){var r={},i={},a=void 0,o=Lr(),s=e.context,c=s.measurement().gradientDimensions,l="horizontal"===s.config().align?"x":"y",u=s.axis().source().scale(),f=u.range()["x"===l?0:1];Pr(t).call(o().on("start",function(){var e=Dr();r={x:e.x,y:e.y}}).on("drag",function(){var t=Dr();(i={x:t.x,y:t.y}).x=Math.max(0,Math.min(i.x,c.width)),i.y=Math.max(0,Math.min(i.y,c.height)),a={criteria:drag_defineProperty({},s.fieldName(),[u.invert(r[l]+f),u.invert(i[l]+f)].sort(function(e,t){return e-t}))},n.forEach(function(t){return e.dispatchBehaviour(t,a)})}).on("end",function(){var t=Dr();(i={x:t.x,y:t.y}).x=Math.max(0,Math.min(i.x,c.width)),i.y=Math.max(0,Math.min(i.y,c.height)),a=r[l]===i[l]?{criteria:{}}:{criteria:drag_defineProperty({},s.fieldName(),[u.invert(r[l]+f),u.invert(i[l]+f)].sort(function(e,t){return e-t}))},n.forEach(function(t){return e.dispatchBehaviour(t,a)})}))}}),firebolt_physical_defineProperty(dv,"hover",_v),firebolt_physical_defineProperty(dv,"click",pv),dv);function selection_box_drag_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var gv=function getSelectionCriteria(e,t,n){var r=[],i=t.axisScale,a=t.axisType,o=n.startPos,s=n.endPos,c=n.selectionBoxMeasure,l=n.drawingInfMeasure,u=n.offset,f=e[a];return r=o[a]===s[a]?[]:f+c>=l+u?[i.invert(l+u-c),i.invert(l+u)]:f-u<u?[i.invert(2*u),i.invert(c+2*u)]:[i.invert(f),i.invert(f+c)],"x"===a||r.reverse(),r},mv=(n(32),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var vv=function(e){function SelectionBox(){return function side_effects_selection_box_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SelectionBox),function side_effects_selection_box_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(SelectionBox.__proto__||Object.getPrototypeOf(SelectionBox)).apply(this,arguments))}return function side_effects_selection_box_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(SelectionBox,Ui),mv(SelectionBox,[{key:"apply",value:function apply(e,t){var n=this.firebolt,r=n.context,i=this.config(),a=r.axis().source(),o=i.classPrefix+"-"+i.className,s=t.criteria[n.context.fieldName()],c=a.scale(),l=s?[a.getScaleValue(s[0]),a.getScaleValue(s[1])]:[],u="horizontal"===r.config().align?"x":"y",f=n.context.measurement().gradientDimensions["x"===u?"height":"width"],h=c.range()["x"===u?0:1],d=r.getDrawingContext().svgContainer,_=Er(d,"g",[1],i.classPrefix+"-selection-box-group"),p=void 0,y=void 0,g=void 0,m=void 0;"horizontal"===n.context.config().align?(p=l[0]-h||0,y=0,g=l[1]-l[0]||0,m=f):(p=0,y=l[1]-h||0,m=l[0]-l[1]||0,g=f);Er(_,"rect",[{domain:s,x:p,y:y,width:g,height:m}],o,{enter:function enterFn(e){!function selectionBoxDrag(e){return function(t,n){var r={},i=void 0,a={},o=Lr(),s=e.context,c=s.axis().source().scale(),l="horizontal"===s.config().align?"x":"y",u={drawingInfMeasure:s.measurement().gradientDimensions["x"===l?"width":"height"],offset:c.range()["x"===l?0:1]},f={};Pr(t).call(o().on("start",function(){var e=Dr();r=function getMousePos(e,t){var n=e.getBoundingClientRect();return{x:t.x-n.x,y:t.y-n.y}}(this,e.sourceEvent),f=e.subject}).on("drag",function(){var t=Dr(),o=f["x"===l?"width":"height"];f.x+=t.dx,f.y+=t.dy,u.selectionBoxMeasure=o,u.startPos=r,u.endPos=a;var h=gv(f,{axisScale:c,axisType:l},u);i={criteria:selection_box_drag_defineProperty({},s.fieldName(),h),fadeOut:!0},e.dispatchBehaviour(n[0],i)}).on("end",function(){var t=Dr(),o=f["x"===l?"width":"height"];u.selectionBoxMeasure=o,u.startPos=r,u.endPos=a;var h=gv(t,{axisScale:c,axisType:l},u);i={criteria:selection_box_drag_defineProperty({},s.fieldName(),h),fadeOut:!0,config:{transition:{duration:200}}},e.dispatchBehaviour(n[0],i)}))}}(n)(e.node(),["brush"])}}).attr("y",y).attr("x",p).attr("width",g).attr("height",m)}}],[{key:"formalName",value:function formalName(){return"selectionBox"}},{key:"defaultConfig",value:function defaultConfig(){return{className:"legend-selection-box",classPrefix:"muze"}}}]),SelectionBox}(),bv=function strategies(e){var t=e.context,n=function classed(e,n,r){var i=t.config().classPrefix;Pr(t.mount()).selectAll("."+i+"-legend-columns").filter(function(t){return-1!==e.uids.indexOf(t.id)}).selectAll(t.elemType()).classed(n,r)};return{fade:function fade(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.config().classPrefix;e.mergedEnter.length||e.mergedExit.length?(n(e.mergedExit,r.className||i+"-legend-brighten",!1),n(e.mergedExit,r.className||i+"-legend-fadeout",!0),n(e.mergedEnter,r.className||i+"-legend-fadeout",!1)):n(e.completeSet,r.className||i+"-legend-fadeout",!1)},brighten:function brighten(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.config().classPrefix;e.mergedEnter.length||e.mergedExit.length?(n(e.mergedEnter,r.className||i+"-legend-brighten",!0),n(e.mergedExit,r.className||i+"-legend-brighten",!1)):n(e.completeSet,r.className||i+"-legend-brighten",!1)}}},xv=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var wv=function(e){function LegendHighlighter(){var e;!function legend_highlighter_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,LegendHighlighter);for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=function legend_highlighter_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(e=LegendHighlighter.__proto__||Object.getPrototypeOf(LegendHighlighter)).call.apply(e,[this].concat(n)));return i._strategies=bv(i.firebolt),i._strategy="brighten",i}return function legend_highlighter_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(LegendHighlighter,ji),xv(LegendHighlighter,[{key:"apply",value:function apply(e,t,n){(0,this._strategies[n||this._strategy])(e,this)}}],[{key:"formalName",value:function formalName(){return"highlighter"}}]),LegendHighlighter}(),Cv={config:{sanitization:function sanitization(e,t){return hn(e._config||{},t)}},data:{},fieldName:{},legendContainer:{},measurement:{sanitization:function sanitization(e,t){var n=hn(e._measurement,t);return["padding","border","margin"].forEach(function(e){n[e]=Math.min(n[e]>0?n[e]:0,.1*n.maxWidth,.1*n.maxHeight)}),n}},logicalSpace:{},metaData:{},range:{sanitization:function sanitization(e,t){return e.scale().range(t),e.resetLogicalSpace(),e.store().commit("range",t),t}},scale:{},smartTicks:{},store:{},title:{}},kv=Math.PI,Sv=2*kv,Mv=Sv-1e-6;function muze_legend_node_modules_d3_path_src_path_Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function muze_legend_node_modules_d3_path_src_path_path(){return new muze_legend_node_modules_d3_path_src_path_Path}muze_legend_node_modules_d3_path_src_path_Path.prototype=muze_legend_node_modules_d3_path_src_path_path.prototype={constructor:muze_legend_node_modules_d3_path_src_path_Path,moveTo:function moveTo(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function lineTo(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function quadraticCurveTo(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function arcTo(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-e,c=r-t,l=a-e,u=o-t,f=l*l+u*u;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>1e-6)if(Math.abs(u*s-c*l)>1e-6&&i){var h=n-a,d=r-o,_=s*s+c*c,p=h*h+d*d,y=Math.sqrt(_),g=Math.sqrt(f),m=i*Math.tan((kv-Math.acos((_+f-p)/(2*y*g)))/2),v=m/g,b=m/y;Math.abs(v-1)>1e-6&&(this._+="L"+(e+v*l)+","+(t+v*u)),this._+="A"+i+","+i+",0,0,"+ +(u*h>l*d)+","+(this._x1=e+b*s)+","+(this._y1=t+b*c)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function arc(e,t,n,r,i,a){e=+e,t=+t;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),c=e+o,l=t+s,u=1^a,f=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+c+","+l),n&&(f<0&&(f=f%Sv+Sv),f>Mv?this._+="A"+n+","+n+",0,1,"+u+","+(e-o)+","+(t-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):f>1e-6&&(this._+="A"+n+","+n+",0,"+ +(f>=kv)+","+u+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function rect(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function toString(){return this._}};var Pv=muze_legend_node_modules_d3_path_src_path_path,Ev=function(e){return function constant(){return e}},Tv=(Math.abs,Math.atan2,Math.cos,Math.max,Math.min,Math.sin,Math.sqrt,1e-12),Av=Math.PI,Ov=2*Av;function node_modules_d3_shape_src_curve_linear_Linear(e){this._context=e}node_modules_d3_shape_src_curve_linear_Linear.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var Nv=function(e){return new node_modules_d3_shape_src_curve_linear_Linear(e)};node_modules_d3_shape_src_curve_radial_curveRadial(Nv);function node_modules_d3_shape_src_curve_radial_Radial(e){this._curve=e}function node_modules_d3_shape_src_curve_radial_curveRadial(e){function radial(t){return new node_modules_d3_shape_src_curve_radial_Radial(e(t))}return radial._curve=e,radial}node_modules_d3_shape_src_curve_radial_Radial.prototype={areaStart:function areaStart(){this._curve.areaStart()},areaEnd:function areaEnd(){this._curve.areaEnd()},lineStart:function lineStart(){this._curve.lineStart()},lineEnd:function lineEnd(){this._curve.lineEnd()},point:function point(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};Array.prototype.slice;var Rv={draw:function draw(e,t){var n=Math.sqrt(t/Av);e.moveTo(n,0),e.arc(0,0,n,0,Ov)}},Fv=(Math.sqrt(1/3),Math.sin(Av/10)/Math.sin(7*Av/10)),Dv=(Math.sin(Ov/10),Math.cos(Ov/10),Math.sqrt(3),Math.sqrt(3),Math.sqrt(12),function(){});function node_modules_d3_shape_src_curve_basis_point(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function node_modules_d3_shape_src_curve_basis_Basis(e){this._context=e}node_modules_d3_shape_src_curve_basis_Basis.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 3:node_modules_d3_shape_src_curve_basis_point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:node_modules_d3_shape_src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function node_modules_d3_shape_src_curve_basisClosed_BasisClosed(e){this._context=e}node_modules_d3_shape_src_curve_basisClosed_BasisClosed.prototype={areaStart:Dv,areaEnd:Dv,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:node_modules_d3_shape_src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function node_modules_d3_shape_src_curve_basisOpen_BasisOpen(e){this._context=e}node_modules_d3_shape_src_curve_basisOpen_BasisOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:node_modules_d3_shape_src_curve_basis_point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function node_modules_d3_shape_src_curve_bundle_Bundle(e,t){this._basis=new node_modules_d3_shape_src_curve_basis_Basis(e),this._beta=t}node_modules_d3_shape_src_curve_bundle_Bundle.prototype={lineStart:function lineStart(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,i=e[0],a=t[0],o=e[n]-i,s=t[n]-a,c=-1;++c<=n;)r=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+r*o),this._beta*t[c]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};(function custom(e){function bundle(t){return 1===e?new node_modules_d3_shape_src_curve_basis_Basis(t):new node_modules_d3_shape_src_curve_bundle_Bundle(t,e)}return bundle.beta=function(e){return custom(+e)},bundle})(.85);function muze_legend_node_modules_d3_shape_src_curve_cardinal_point(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function node_modules_d3_shape_src_curve_cardinal_Cardinal(e,t){this._context=e,this._k=(1-t)/6}node_modules_d3_shape_src_curve_cardinal_Cardinal.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:muze_legend_node_modules_d3_shape_src_curve_cardinal_point(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:muze_legend_node_modules_d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new node_modules_d3_shape_src_curve_cardinal_Cardinal(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function node_modules_d3_shape_src_curve_cardinalClosed_CardinalClosed(e,t){this._context=e,this._k=(1-t)/6}node_modules_d3_shape_src_curve_cardinalClosed_CardinalClosed.prototype={areaStart:Dv,areaEnd:Dv,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:muze_legend_node_modules_d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new node_modules_d3_shape_src_curve_cardinalClosed_CardinalClosed(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function node_modules_d3_shape_src_curve_cardinalOpen_CardinalOpen(e,t){this._context=e,this._k=(1-t)/6}node_modules_d3_shape_src_curve_cardinalOpen_CardinalOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:muze_legend_node_modules_d3_shape_src_curve_cardinal_point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function cardinal(t){return new node_modules_d3_shape_src_curve_cardinalOpen_CardinalOpen(t,e)}return cardinal.tension=function(e){return custom(+e)},cardinal})(0);function muze_legend_node_modules_d3_shape_src_curve_catmullRom_point(e,t,n){var r=e._x1,i=e._y1,a=e._x2,o=e._y2;if(e._l01_a>Tv){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>Tv){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);a=(a*l+e._x1*e._l23_2a-t*e._l12_2a)/u,o=(o*l+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,a,o,e._x2,e._y2)}function node_modules_d3_shape_src_curve_catmullRom_CatmullRom(e,t){this._context=e,this._alpha=t}node_modules_d3_shape_src_curve_catmullRom_CatmullRom.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:muze_legend_node_modules_d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new node_modules_d3_shape_src_curve_catmullRom_CatmullRom(t,e):new node_modules_d3_shape_src_curve_cardinal_Cardinal(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function node_modules_d3_shape_src_curve_catmullRomClosed_CatmullRomClosed(e,t){this._context=e,this._alpha=t}node_modules_d3_shape_src_curve_catmullRomClosed_CatmullRomClosed.prototype={areaStart:Dv,areaEnd:Dv,lineStart:function lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:muze_legend_node_modules_d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new node_modules_d3_shape_src_curve_catmullRomClosed_CatmullRomClosed(t,e):new node_modules_d3_shape_src_curve_cardinalClosed_CardinalClosed(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function node_modules_d3_shape_src_curve_catmullRomOpen_CatmullRomOpen(e,t){this._context=e,this._alpha=t}node_modules_d3_shape_src_curve_catmullRomOpen_CatmullRomOpen.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:muze_legend_node_modules_d3_shape_src_curve_catmullRom_point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};(function custom(e){function catmullRom(t){return e?new node_modules_d3_shape_src_curve_catmullRomOpen_CatmullRomOpen(t,e):new node_modules_d3_shape_src_curve_cardinalOpen_CardinalOpen(t,0)}return catmullRom.alpha=function(e){return custom(+e)},catmullRom})(.5);function node_modules_d3_shape_src_curve_linearClosed_LinearClosed(e){this._context=e}node_modules_d3_shape_src_curve_linearClosed_LinearClosed.prototype={areaStart:Dv,areaEnd:Dv,lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){this._point&&this._context.closePath()},point:function point(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function muze_legend_node_modules_d3_shape_src_curve_monotone_sign(e){return e<0?-1:1}function node_modules_d3_shape_src_curve_monotone_slope3(e,t,n){var r=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(r||i<0&&-0),o=(n-e._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(muze_legend_node_modules_d3_shape_src_curve_monotone_sign(a)+muze_legend_node_modules_d3_shape_src_curve_monotone_sign(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function node_modules_d3_shape_src_curve_monotone_slope2(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function muze_legend_node_modules_d3_shape_src_curve_monotone_point(e,t,n){var r=e._x0,i=e._y0,a=e._x1,o=e._y1,s=(a-r)/3;e._context.bezierCurveTo(r+s,i+s*t,a-s,o-s*n,a,o)}function node_modules_d3_shape_src_curve_monotone_MonotoneX(e){this._context=e}function node_modules_d3_shape_src_curve_monotone_MonotoneY(e){this._context=new node_modules_d3_shape_src_curve_monotone_ReflectContext(e)}function node_modules_d3_shape_src_curve_monotone_ReflectContext(e){this._context=e}function node_modules_d3_shape_src_curve_natural_Natural(e){this._context=e}function node_modules_d3_shape_src_curve_natural_controlPoints(e){var t,n,r=e.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,o[t]-=n*o[t-1];for(i[r-1]=o[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}node_modules_d3_shape_src_curve_monotone_MonotoneX.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:muze_legend_node_modules_d3_shape_src_curve_monotone_point(this,this._t0,node_modules_d3_shape_src_curve_monotone_slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,muze_legend_node_modules_d3_shape_src_curve_monotone_point(this,node_modules_d3_shape_src_curve_monotone_slope2(this,n=node_modules_d3_shape_src_curve_monotone_slope3(this,e,t)),n);break;default:muze_legend_node_modules_d3_shape_src_curve_monotone_point(this,this._t0,n=node_modules_d3_shape_src_curve_monotone_slope3(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(node_modules_d3_shape_src_curve_monotone_MonotoneY.prototype=Object.create(node_modules_d3_shape_src_curve_monotone_MonotoneX.prototype)).point=function(e,t){node_modules_d3_shape_src_curve_monotone_MonotoneX.prototype.point.call(this,t,e)},node_modules_d3_shape_src_curve_monotone_ReflectContext.prototype={moveTo:function moveTo(e,t){this._context.moveTo(t,e)},closePath:function closePath(){this._context.closePath()},lineTo:function lineTo(e,t){this._context.lineTo(t,e)},bezierCurveTo:function bezierCurveTo(e,t,n,r,i,a){this._context.bezierCurveTo(t,e,r,n,a,i)}},node_modules_d3_shape_src_curve_natural_Natural.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=[],this._y=[]},lineEnd:function lineEnd(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=node_modules_d3_shape_src_curve_natural_controlPoints(e),i=node_modules_d3_shape_src_curve_natural_controlPoints(t),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function point(e,t){this._x.push(+e),this._y.push(+t)}};function node_modules_d3_shape_src_curve_step_Step(e,t){this._context=e,this._t=t}node_modules_d3_shape_src_curve_step_Step.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=this._y=NaN,this._point=0},lineEnd:function lineEnd(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};var Lv="horizontal",Iv="vertical",jv={height:30,width:30,maxWidth:1/0,maxHeight:1/0,padding:3,margin:2,border:1},zv={classPrefix:"muze",formatter:{bounds:{lower:"less than",upper:"more than"}},item:{text:{position:"right",width:10},shape:{height:20,width:20,color:"rgba(0,0,0,.5)",type:"circle"}}},Bv=function SHAPE_MAP(e){return e&&function(){var e=Ev(Rv),t=Ev(64),n=null;function symbol(){var r;if(n||(n=r=Pv()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),r)return n=null,r+""||null}return symbol.type=function(t){return arguments.length?(e="function"==typeof t?t:Ev(t),symbol):e},symbol.size=function(e){return arguments.length?(t="function"==typeof e?e:Ev(+e),symbol):t},symbol.context=function(e){return arguments.length?(n=null==e?null:e,symbol):n},symbol}().type(Gt[e])};function legend_helper_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Hv=function getScaleInfo(e){var t=e.constructor.type();return{scaleType:t,domain:e.uniqueValues(),steps:e.config().steps,scaleFn:lv[t]}},Uv=function getInterpolatedData(e,t){for(var n=[],r=dn()(e[0],e[1]),i=0;i<=t;i++)n[i]=r(i/t);return n},Vv=function getDomainBounds(e,t,n){var r,i=t.scaleFn,a=t.scaleType,o=t.scale,s=n.domain,c=n.domainBounds,l=n.domainLeg,u=n.steps,f=s["lower"===e?0:u.length-1],h=u["lower"===e?0:u.length-1];return legend_helper_defineProperty(r={},a,"size"===a?o[i](f)*o.getScaleFactor():o[i](f)),legend_helper_defineProperty(r,"value",c[e]),legend_helper_defineProperty(r,"id","lower"===e?0:l.length+2),legend_helper_defineProperty(r,"range",[f,h]),r},qv=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Wv=function(){function SimpleLegend(e){!function simple_legend_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SimpleLegend),this._data=[],this._metaData=[],this._mount=null,this._fieldName=null,this._title="",this._metaData=null,this._labelManager=e.labelManager,this._cells=e.cells,this._id=Ht(),this._measurement=Object.assign({},this.constructor.defaultMeasurement()),this._config=Object.assign({},this.constructor.defaultConfig()),sn(this,Cv),this._computedStyle=Ir(Pr("body"),this.config().classPrefix+"-legend-item-info"),this._firebolt=new hv(this,{behavioural:i,physical:yv,physicalBehaviouralMap:av},d,sv)}return qv(SimpleLegend,[{key:"id",value:function id(){return this._id}},{key:"firebolt",value:function firebolt(){return arguments.length?this:this._firebolt}},{key:"elemType",value:function elemType(){return"path"}},{key:"mount",value:function mount(){return arguments.length?(this._mount=arguments.length<=0?void 0:arguments[0],this.render(),this):this._mount}},{key:"getLabelSpaces",value:function getLabelSpaces(){return this._labelManager.setStyle(Ir(Pr("body"),this.config().classPrefix+"-legend-item-info")),function getItemMeasures(e,t,n){var r=[];return e.forEach(function(e,i){var a=t?e[t]:e,o=n.getOriSize(a),s=o.height,c=o.width;r[i]={height:s+1,width:c+1}}),r}(this.data(),"value",this._labelManager)}},{key:"setLegendMeasures",value:function setLegendMeasures(){var e=this.measurement(),t=e.width,n=e.height,r=e.maxWidth,i=e.maxHeight,a=e.padding,o=e.margin,s=e.border,c=this.config().align,l=2*a,u=2*s,f=2*o;this.data(this.dataFromScale(this.scale()));var h=this.getTitleSpace(),d=h.height>0?1.25*h.height:0,_=h.width,p=this.getLabelSpaces(l,c),y=function computeItemSpaces(e,t,n){var r=0,i=0,a={width:0,height:0},o=t.effPadding,s=t.titleWidth,c=t.labelSpaces,l=t.titleHeight,u=t.maxWidth,f=e.item,h=e.align,d=f.shape,_=f.text.position,p=[],y=[],g=0;return c.forEach(function(e,t){var c={width:0,height:0},l={width:0,height:0};"left"===_||"right"===_?(e.width+=o,l.width=(n[t].size?2*Math.sqrt(n[t].size/Math.PI):d.width)+o,g=Math.max(l.width,g),c.width=e.width+g,e.height=Math.max(e.height,d.height)+o,l.height=e.height,c.height=e.height):(e.width=Math.max(e.width,n[t].size?2*Math.sqrt(n[t].size/Math.PI):d.width)+o,l.width=e.width,c.width=e.width,g=Math.max(l.width,g),e.height+=o,l.height=d.height+o,c.height=e.height+l.height),"horizontal"===h?r=Math.max(r,c.height):(r+=c.height,i=Math.max(i,c.width,s)),a={width:Math.max(c.width,a.width),height:Math.max(c.height,a.height)},p.push(c),y.push(l)}),p.forEach(function(e,t){"horizontal"===h?(e.height=r,y[t].width=g,"left"===_||"right"===_?(c[t].height=r,y[t].height=r,p[t].width=c[t].width+g):(c[t].width=g,p[t].width=g,c[t].width=g),i=Math.max(i+p[t].width,s)):(e.width=Math.max(i,u),"top"===_||"bottom"===_?(c[t].width=i,y[t].width=i):(y[t].width=g,p[t].width=c[t].width+g,c[t].width=a.width-g,i=Math.max(i,e.width,s)))}),{totalHeight:r+=l+o,totalWidth:i,itemSpaces:p,shapeSpaces:y,maxItemSpaces:a,maxShapeWidth:g}}(this.config(),{effPadding:l,titleWidth:_,labelSpaces:p,titleHeight:d,maxWidth:r,maxHeight:i},this.data()),g=y.totalHeight,m=y.totalWidth,v=y.itemSpaces,b=y.shapeSpaces,x=y.maxItemSpaces,w=y.maxShapeWidth;return this.measurement({width:Math.max(m,t)+f+u,height:Math.max(g,n)+f+u,labelSpaces:p,shapeSpaces:b,itemSpaces:v,maxItemSpaces:x,maxShapeWidth:w,titleSpaces:{width:Math.min(r,this.measurement().width)-f-u,height:d}}),this}},{key:"getTitleSpace",value:function getTitleSpace(){return this._labelManager.setStyle(Ir(Pr("body"),this.config().classPrefix+"-legend-title")),this._labelManager.getOriSize(this.title()?this.title():"")}},{key:"renderTitle",value:function renderTitle(e){var t=this.measurement(),n=t.titleSpaces,r=t.border,i=t.padding;return function titleCreator(e,t,n,r){return Er(e,"div",[1],r+"-legend-title").style("width","100%").style("height",n.height+"px").style("padding-left",n.padding+"px").style("padding-right",n.padding+"px").style("border-bottom-width",n.border+"px").style("text-align","center").text(t).node()}(e,this.title(),{height:n.height,border:r,padding:i},this.config().classPrefix)}},{key:"render",value:function render(){var e=this.firebolt(),t=this.config().classPrefix,n=this.measurement(),r=n.maxWidth,i=n.maxHeight,a=n.width,o=n.height,s=n.margin,c=n.border,l=Er(Pr(this.mount()),"div",[1],t+"-legend-box");return l.classed(t+"-legend-box-"+this._id,!0),l.style("float","left"),l.style("width",Math.min(r,a)-2*s+"px").style("height",Math.min(i,o)-2*s+"px").style("margin",s+"px").style("border-width",c+"px"),this.legendContainer(l.node()),this.renderTitle(l),e.mapActionsAndBehaviour(),e.createSelectionSet(this.data().map(function(e){return e.id})),l}},{key:"getCriteriaFromData",value:function getCriteriaFromData(e){var t=this.fieldName();return"measure"===this.metaData().getData().schema[0].type?function simple_legend_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,e.range):[[t],[e.value]]}}],[{key:"create",value:function create(e){return new SimpleLegend(e)}},{key:"defaultConfig",value:function defaultConfig(){return zv}},{key:"defaultMeasurement",value:function defaultMeasurement(){return jv}}]),SimpleLegend}(),Gv=function applyItemStyle(e,t,n,r){var i=r.measurement(),a=i.padding,o=i.labelSpaces,s=i.shapeSpaces,c=i.maxShapeWidth,l=n?2*-a:0;return"value"===e[0]?o[e[6]][t]+"px":("width"!==t||n?s[e[6]][t]-l:c)+"px"},Yv=function renderShape(e,t,n,r){var i=r.classPrefix,a=r.shapeHeight,o=r.maxShapeWidth,s=r.padding,c=r.color,l=Er(t,"svg",function(e){return[e]},i+"-legend-shape-svg").attr("width",o).attr("height",a).style("width",o+"px").style("height",a+"px");"rect"!==e?Er(l,"path",[n[1]],i+"-legend-shape").attr("d",e).attr("transform","translate("+(o/2-s)+" "+a/2+")").attr("fill",n[2]||c):Er(l,"rect",[n[1]],i+"-legend-shape").attr("x",0).attr("y",0).attr("width",o).attr("height",a).attr("fill",n[2]||c)},Xv=function createLegendSkeleton(e,t,n,r){var i,a,o,s,c=e.measurement(),l=c.margin,u=c.border,f=c.titleSpaces,h=c.width,d=c.height,_=c.maxWidth,p=c.maxHeight;a=d-(f.height+2*l+2*u),i=h-(2*l+2*u),o=p-(f.height+2*l+2*u),s=_-(2*l+2*u);var y=Er(t,"div",[1],n+"-legend-body");return s&&s<i&&(y=y.style("width",s+"px").style("overflow-x","scroll"),y=Er(y,"div",[1],n+"-legend-overflow")),o&&o<a&&(y.style("height",o+"px").style("overflow-y","scroll"),y=Er(y,"div",[1],n+"-legend-overflow")),y.style("width",i+"px"),y.style("height",a+"px"),{legendItem:function getItemContainers(e,t,n){var r={},i=n.measurement(),a=i.itemSpaces,o=i.maxItemSpaces,s=n.config(),c=s.classPrefix,l=s.align;"vertical"===l?(r.row=t,r.column=function(e){return[e]}):(r.row=[1],r.column=t);var u=Er(e,"div",r.row,c+"-legend-row");u.style("height",function(e,t){return a[t].height+"px"}),"vertical"===l&&u.style("width",function(e,t){return o.width+"px"});var f=Er(u,"div",r.column,c+"-legend-columns");return"vertical"!==l&&f.style("width",function(e,t){return a[t].width+"px"}),f}(y,r,e)}},$v=function createItemSkeleton(e,t){var n=e.config(),r=n.classPrefix,i=n.item,a=e.measurement().padding,o=i.text.position,s=["value","shape"];"right"!==o&&"bottom"!==o||(s=["shape","value"]);var c=Er(t,"div",function(t,n){return s.map(function(r){return[r,t[r],t.color,t.size,t.value,e.fieldName(),n]})},r+"-legend-item-info");c.style("padding",a+"px");var l="bottom"===o||"top"===o?"center":"right"===o?"start":"end";return c.classed(l,!0),{itemSkeleton:c}},Zv=function renderDiscreteItem(e,t){var n=e._labelManager,r=e.config(),i=r.item,a=r.classPrefix,o=e.measurement(),s=o.maxShapeWidth,c=o.padding,l=i.shape,u=l.width,f=l.height,h=l.color,d=l.type;n.useEllipsesOnOverflow(!0),Tr(t,{width:function width(t){return Gv(t,"width",!1,e)},height:function height(t){return Gv(t,"height",!1,e)},"text-align":"center"}),n.setStyle(e._computedStyle),t.each(function(e){if("value"===e[0])Pr(this).text(e[1]);else{var t=function getLegendShape(e,t,n,r){var i=Bv(e[1]);return i?i.size(e[3]||Math.min(t,n)*Math.PI):Bv(r).size(e[3]||Math.min(t,n)*Math.PI)}(e,u,f,d);Yv(t,Pr(this),e,{classPrefix:a,shapeWidth:2*Math.sqrt(e[3]/Math.PI)||u,shapeHeight:f,maxShapeWidth:s,padding:c,color:h})}})},Kv=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function discrete_legend_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jv=function(e){function DiscreteLegend(){return function discrete_legend_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,DiscreteLegend),function discrete_legend_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(DiscreteLegend.__proto__||Object.getPrototypeOf(DiscreteLegend)).apply(this,arguments))}return function discrete_legend_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(DiscreteLegend,Wv),Kv(DiscreteLegend,[{key:"dataFromScale",value:function dataFromScale(e){var t=Hv(e),n=t.scaleType,r=t.domain,i=t.scaleFn,a=[].concat(function discrete_legend_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(new Set(r))),o=this.metaData().getData().schema[0].type;return a=a.map(function(t,r){var s,c=0,l=0;"measure"===o?l=[c=(+a[r]).toFixed(0),(a[r+1]?+a[r+1]:+c).toFixed(0)]:(c=a[r],l=[a[r]]);return discrete_legend_defineProperty(s={},n,e[i](t)),discrete_legend_defineProperty(s,"value",c),discrete_legend_defineProperty(s,"id",r),discrete_legend_defineProperty(s,"range",l),s}).filter(function(e){return null!==e.value}),a="size"===n?a.sort(function(e,t){return e[n]-t[n]}):a}},{key:"render",value:function render(){var e=this.firebolt(),t=this.data(),n=this.config().classPrefix,r=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(DiscreteLegend.prototype.__proto__||Object.getPrototypeOf(DiscreteLegend.prototype),"render",this).call(this,this.mount()),i=Xv(this,r,n,t).legendItem,a=$v(this,i).itemSkeleton;return Zv(this,a),r.selectAll("div").style("float","left"),e.mapActionsAndBehaviour(),e.createSelectionSet(this.data().map(function(e){return e.id})),r}}],[{key:"create",value:function create(e){return new DiscreteLegend(e)}},{key:"type",value:function type(){return"discrete"}}]),DiscreteLegend}(),Qv=function getGradientDomain(e){return"number"==typeof e[0].value?e.reduce(function(e,t){return[Math.min(t.value,e[0]),Math.max(t.value,e[1])]},[Number.MAX_VALUE,Number.MIN_VALUE]):e.map(function(e){return e.value})},eb=function createLegendSkeleton(e,t,n){var r=Qv(n),i=Er(e,"div",[1],t+"-legend-body"),a=Er(i,"svg",[1],t+"-gradient"),o=Er(a,"g",[1],t+"-gradient-group");return{legendContainer:i,legendGradCont:o,legendGradSvg:a,linearGradient:function makeLinearGradient(e,t,n){var r=Er(e,"defs",[1]),i=Er(r,"linearGradient",[1]).attr("id","linear-gradient").attr("x1","0%").attr("y2","0%");return Er(i,"stop",t,"stop-gradient").attr("offset",function(e){return 100*(e.value-n[0])/(n[1]-n[0])+"%"}).attr("stop-color",function(e){return e.color}),i}(a,n,r),legendRect:Er(o,"rect",[1],t+"-gradient-shape")}},tb=function renderAxis(e,t,n,r){var i=e.axis();i.setAvailableSpace(r,n),i.render(t.node())},nb=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function gradient_legend_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gradient_legend_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var rb=function(e){function GradientLegend(){return function gradient_legend_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GradientLegend),function gradient_legend_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(GradientLegend.__proto__||Object.getPrototypeOf(GradientLegend)).apply(this,arguments))}return function gradient_legend_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(GradientLegend,Wv),nb(GradientLegend,[{key:"axis",value:function axis(){return arguments.length?(this._axis=arguments.length<=0?void 0:arguments[0],this):this._axis}},{key:"dataFromScale",value:function dataFromScale(e){var t=[],n=Hv(e),r=n.scaleType,i=n.domain,a=n.steps,o=n.scaleFn;return a instanceof Array?(i[0]<a[0]&&(t[0]=i[0]),t=[].concat(gradient_legend_toConsumableArray(t),gradient_legend_toConsumableArray(a)),i[i.length-1]>a[a.length-1]&&t.push(i[1])):t=Uv(i,a),(t=[].concat(gradient_legend_toConsumableArray(new Set(t))).sort(function(e,t){return e-t})).map(function(n,i){var a,s=t[i];return gradient_legend_defineProperty(a={},r,"size"===r?e[o](n)*e.getScaleFactor():e[o](Math.floor(n))),gradient_legend_defineProperty(a,"value",+s.toFixed(2)),gradient_legend_defineProperty(a,"id",i),a}).filter(function(e){return null!==e.value})}},{key:"getLabelSpaces",value:function getLabelSpaces(e){this.config({item:{text:{position:this.config().position}}});var t=function createAxis(e){var t=e.data(),n=e.config().align,r=e._cells.AxisCell,i=new Jd({id:"legend-"+e._id,orientation:n===Iv?"right":"bottom",style:e._computedStyle,nice:!1,tickValues:t.map(function(e){return e.value}),fixedBaseline:!1},{labelManager:e._labelManager});return i.domain(Qv(t)),i.range([1,1]),(new r).source(i).config({margin:{left:0,bottom:0,top:0,right:0}})}(this),n=t.getLogicalSpace(),r={width:n.width-e,height:n.height-e},i=t.source().domain().length,a=new Array(i).fill(r);return this.axis(t),a}},{key:"getDrawingContext",value:function getDrawingContext(){return{svgContainer:this._legendGradientSvg}}},{key:"render",value:function render(){var e=this.firebolt(),t=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(GradientLegend.prototype.__proto__||Object.getPrototypeOf(GradientLegend.prototype),"render",this).call(this,this.mount());return function renderGradient(e,t){var n,r,i=e.config(),a=i.align,o=i.classPrefix,s=i.item,c=e.data(),l=eb(t,o,c),u=l.legendContainer,f=l.legendGradSvg,h=l.legendGradCont,d=l.linearGradient,_=l.legendRect,p=e.axis().source().getAxisDimensions().tickLabelDim,y=e.measurement(),g=y.padding,m=y.margin,v=y.border,b=y.titleSpaces,x=y.height,w=y.width,C={};n=Math.floor(x-(b.height+2*m+2*v)),r=Math.floor(w-(2*m+2*v)),a===Lv?(C.height=s.shape.height,C.width=r-2*g-p.width/2,d.attr("x2","100%"),h.attr("transform","translate( "+p.width/2+" 0)"),tb(e,u,n-s.shape.height-g,r-2*g-1)):(C.height=n-2*g-p.height/2,C.width=s.shape.width,d.attr("x2","0%").attr("y1","100%"),h.attr("transform","translate(0 "+p.height/2+")"),tb(e,u,n-2*g-1,r-s.shape.width-2*g)),Tr(u,{height:x+"px",width:w+"px",padding:g+"px"}),Tr(f,{height:C.height+"px",width:C.width+"px"}),Tr(_,{fill:"url(#linear-gradient)"}),_.attr("height",C.height),_.attr("width",C.width),e.measurement({gradientDimensions:C}),e._legendGradientSvg=f}(this,t),t.selectAll("div").style("float","left"),e.mapActionsAndBehaviour(),e.createSelectionSet(this.data().map(function(e){return e.id})),t}},{key:"getCriteriaFromData",value:function getCriteriaFromData(e){return[[this.fieldName()],[e.value]]}}],[{key:"create",value:function create(e){return new GradientLegend(e)}},{key:"type",value:function type(){return"gradient"}}]),GradientLegend}(),ib=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),ab=function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0};function step_legend_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function step_legend_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var ob,sb=function(e){function StepLegend(){return function step_legend_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,StepLegend),function step_legend_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(StepLegend.__proto__||Object.getPrototypeOf(StepLegend)).apply(this,arguments))}return function step_legend_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(StepLegend,Wv),ib(StepLegend,[{key:"dataFromScale",value:function dataFromScale(e){var t=[],n=Hv(e),r=n.scaleType,i=n.domain,a=n.steps,o=n.scaleFn,s=this.config().formatter,c={lower:null,upper:null};if(a instanceof Array?(i[0]<a[0]&&(c.lower=[s.bounds.lower+" "+a[0]]),t=[].concat(step_legend_toConsumableArray(t),step_legend_toConsumableArray(a)),i[i.length-1]>a[a.length-1]&&(c.upper=[s.bounds.upper+" "+a[a.length-1]])):t=Uv(i,a),t=(t=[].concat(step_legend_toConsumableArray(new Set(t))).sort(function(e,t){return e-t})).map(function(n,i){var a,s=null;return i<t.length-1&&(s=n.toFixed(1)+" - "+ +t[i+1].toFixed(1)),step_legend_defineProperty(a={},r,"size"===r?e[o](n)*e.getScaleFactor():e[o](n)),step_legend_defineProperty(a,"value",s),step_legend_defineProperty(a,"id",i+1),step_legend_defineProperty(a,"range",[n,t[i+1]]),a}).filter(function(e){return null!==e.value}),c.lower){var l=Vv("lower",{scale:e,scaleFn:o,scaleType:r},{domain:i,steps:a,domainBounds:c});t=[l].concat(step_legend_toConsumableArray(t))}if(c.upper){var u=Vv("upper",{scale:e,scaleFn:o,scaleType:r},{domain:i,steps:a,domainBounds:c,domainLeg:t});t=[].concat(step_legend_toConsumableArray(t),[u])}return t}},{key:"getLabelSpaces",value:function getLabelSpaces(e,t){var n=this.config().position;return this.config({item:{text:{position:n}}}),ab(StepLegend.prototype.__proto__||Object.getPrototypeOf(StepLegend.prototype),"getLabelSpaces",this).call(this,e,t)}},{key:"elemType",value:function elemType(){return"rect"}},{key:"render",value:function render(){var e=this.firebolt(),t=this.data(),n=this.config().classPrefix,r=ab(StepLegend.prototype.__proto__||Object.getPrototypeOf(StepLegend.prototype),"render",this).call(this,this.mount()),i=Xv(this,r,n,t).legendItem;return function renderStepItem(e,t){var n=void 0,r=void 0,i=e._labelManager,a=e.config(),o=a.item,s=a.position,c=a.classPrefix,l=e.measurement(),u=l.maxItemSpaces,f=l.maxShapeWidth,h=o.shape,d=h.width,_=h.height,p=h.color,y={horizontal:!1,vertical:!1};r=_,n=d,i.useEllipsesOnOverflow(!0),"bottom"===s||"top"===s?(n=u.width,y.horizontal=!0):"left"!==s&&"right"!==s||(r=u.height,y.vertical=!0),Tr(t,{width:function width(t){return Gv(t,"width",y.horizontal,e)},height:function height(t){return Gv(t,"height",y.vertical,e)},"text-align":"center"}),i.setStyle(e._computedStyle),t.each(function(e){"value"===e[0]?Pr(this).text(e[1]):Yv("rect",Pr(this),e,{classPrefix:c,shapeWidth:n,shapeHeight:r,maxShapeWidth:f,color:p})})}(this,$v(this,i).itemSkeleton),r.selectAll("div").style("float","left"),e.mapActionsAndBehaviour(),e.createSelectionSet(this.data().map(function(e){return e.id})),r}},{key:"getCriteriaFromData",value:function getCriteriaFromData(e){return step_legend_defineProperty({},this.fieldName(),e.range)}}],[{key:"create",value:function create(e){return new StepLegend(e)}},{key:"type",value:function type(){return"step"}}]),StepLegend}();function constants_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var cb="width",lb="height",ub="padding",fb="border",hb="config",db=["script","style"],_b={classPrefix:"muze",interaction:{sideEffect:"individual"},showHeaders:!1,minWidth:300,minHeight:200,border:{style:"solid",color:"#d6d6d6",width:2,collapse:!0,spacing:0}},pb=(constants_defineProperty(ob={},"discrete",Jv),constants_defineProperty(ob,"step-color",sb),constants_defineProperty(ob,"gradient",rb),ob);var yb=function share(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return new(Function.prototype.bind.apply(cg,[null].concat(function operators_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(t.map(function(e){return new ug(e)})))))};function operators_html(e){for(var t="",n=arguments.length<=1?0:arguments.length-1,r=0;r<n;++r)t+=e[r]+(arguments.length<=r+1?void 0:arguments[r+1]);t+=e[r];var i=document.createDocumentFragment(),a=document.createElement("div");i.appendChild(a),a.innerHTML=t,function treeShakeNode(e){if(e.nodeType===Node.ELEMENT_NODE)if(-1!==db.indexOf(e.tagName.toLowerCase()))e.parentNode.removeChild(e);else{var t=!0,n=!1,r=void 0;try{for(var i,a=e.childNodes[Symbol.iterator]();!(t=(i=a.next()).done);t=!0)treeShakeNode(i.value)}catch(e){n=!0,r=e}finally{try{!t&&a.return&&a.return()}finally{if(n)throw r}}}}(a);var o=a.innerHTML;return function(){return o}}var gb="all",mb=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var vb=new(function(){function ActionModel(){!function action_model_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ActionModel),this._registrableComponents=[],this._targetComponent=gb}return mb(ActionModel,[{key:"registerPhysicalActions",value:function registerPhysicalActions(e){return this._registrableComponents.forEach(function(t){t.once("canvas.updated").then(function(t){t.client.getMatrixInstance("value").each(function(t){return t.valueOf().firebolt().registerPhysicalActions(e)})})}),this}},{key:"registerBehaviouralActions",value:function registerBehaviouralActions(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._registrableComponents.forEach(function(e){e.once("canvas.updated").then(function(){e.getMatrixInstance("value").each(function(e){var n;return(n=e.valueOf().firebolt()).registerBehaviouralActions.apply(n,t)})})}),this}},{key:"registerPhysicalBehaviouralMap",value:function registerPhysicalBehaviouralMap(e){return this._registrableComponents.forEach(function(t){t.once("canvas.updated").then(function(t){t.client.getMatrixInstance("value").each(function(t){return t.valueOf().firebolt().registerPhysicalBehaviouralMap(e)})})}),this}},{key:"mapSideEffects",value:function mapSideEffects(e){var t=this._registrableComponents,n=this._targetComponent;return t.forEach(function(t){"visual-group"!==n&&n!==gb||t.firebolt().mapSideEffects(e),t.once("canvas.updated").then(function(){"visual-unit"!==n&&n!==gb||t.getMatrixInstance("value").each(function(t){return t.valueOf().firebolt().mapSideEffects(e)})})}),this}},{key:"for",value:function _for(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this._registrableComponents=t,this}},{key:"target",value:function target(e){return this._targetComponent=e,this}},{key:"registerSideEffects",value:function registerSideEffects(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=this._registrableComponents,i=this._targetComponent;return r.forEach(function(e){"visual-group"!==i&&i!==gb||e.firebolt().registerSideEffects(t),"visual-unit"!==i&&i!==gb||e.once("canvas.updated").then(function(e){e.client.getMatrixInstance("value").each(function(e){return e.valueOf().firebolt().registerSideEffects(t)})})}),this}}]),ActionModel}()),bb={data:{value:null,meta:{typeCheck:"constructor",typeExpected:"DataModel"}},width:{value:0,meta:{sanitization:rn,typeCheck:Number.isInteger}},height:{value:0,meta:{sanitization:rn,typeCheck:Number.isInteger}},minUnitWidth:{value:150,meta:{sanitization:rn,typeCheck:Number.isInteger}},minUnitHeight:{value:150,meta:{sanitization:rn,typeCheck:Number.isInteger}},config:{value:null,meta:{typeCheck:"constructor",typeExpected:"Object",sanitization:function sanitization(e,t){var n=Object.assign(t||{},_b);return hn(n,e)}}}},xb={top:0,center:1,bottom:2},wb="width",Cb="height",kb="top",Sb="left",Mb="right",Pb="bottom",Eb="center",Tb="rowLeft",Ab="rowRight",Ob="colBottom",Nb="colTop",Rb="rowSpan",Fb="colSpan",Db="rowRoot",Lb="columnRoot",Ib=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var jb,zb,Bb,Hb=function(){function GenericLayout(e,t,n,r){!function generic_layout_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GenericLayout),this._config={},this._measurement={},this._matrices=[],this._dependencies=r,this.measurement(t),this.mountPoint(e),this.config(n)}return Ib(GenericLayout,[{key:"serialize",value:function serialize(){return{measurement:this.measurement(),config:this.config(),matrices:this.matrices()}}},{key:"config",value:function config(e){return e?(this._config=hn(this._config||{},e),this):this._config}},{key:"measurement",value:function measurement(e){return e?(this._measurement=hn(this._measurement||{},e),this):this._measurement}},{key:"matrices",value:function matrices(e){return e?(this._matrices=Ut([kb,Eb,Pb],e),this):this._matrices}},{key:"rowMatrix",value:function rowMatrix(e){return e?(this._rowMatrix=e,this):this._rowMatrix}},{key:"columnMatrix",value:function columnMatrix(e){return e?(this._columnMatrix=e,this):this._columnMatrix}},{key:"centerMatrix",value:function centerMatrix(e){return e?(this._centerMatrix=e,this):this._centerMatrix}},{key:"mountPoint",value:function mountPoint(e){return e?(this._mountPoint=e,this):this._mountPoint}}]),GenericLayout}();function grid_layout_defaults_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ub=(grid_layout_defaults_defineProperty(zb={},"border",(grid_layout_defaults_defineProperty(jb={},"style","solid"),grid_layout_defaults_defineProperty(jb,"color","#d6d6d6"),grid_layout_defaults_defineProperty(jb,wb,2),grid_layout_defaults_defineProperty(jb,"collapse",!0),grid_layout_defaults_defineProperty(jb,"spacing",0),jb)),grid_layout_defaults_defineProperty(zb,"gutterSpace",{rows:[],columns:[]}),grid_layout_defaults_defineProperty(zb,"distribution",{rows:[],columns:[]}),grid_layout_defaults_defineProperty(zb,"breakPage",{rows:[],columns:[]}),grid_layout_defaults_defineProperty(zb,"isRowSizeEqual",!1),grid_layout_defaults_defineProperty(zb,"isColumnSizeEqual",!1),grid_layout_defaults_defineProperty(zb,"columnPointer",0),grid_layout_defaults_defineProperty(zb,"rowPointer",0),zb),Vb=(grid_layout_defaults_defineProperty(Bb={},"width",100),grid_layout_defaults_defineProperty(Bb,"height",100),grid_layout_defaults_defineProperty(Bb,"unitWidth",100),grid_layout_defaults_defineProperty(Bb,"unitHeight",100),Bb),qb="rgba(0,0,0,0)";function span_maker_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Wb=function columnFilter(e,t,n,r,i){var a=n[r-1],o=n[r];if(i===Tb){if(!a)return e;for(var s=0;s<=t&&o[s].valueOf()===a[s].valueOf();s+=1);return s-1===t?null:e}if(i===Ab){if(!a||0===t)return e;for(var c=t;c<o.length&&a[c].valueOf()===o[c].valueOf();c+=1);return c===o.length?null:e}if(i===Ob){if(0===r)return e;var l=o[t-1];if(l){if(l.valueOf()===e.valueOf()){var u=n[r+1];return u?u[t].valueOf()===u[t-1].valueOf()?null:e:null}return e}return e}if(i===Nb){if(r===n.length-1&&n.length>1)return e;var f=o[t-1];if(f&&f.valueOf()===e.valueOf()){var h=n[r-1];return h?h[t].valueOf()===h[t-1].valueOf()?null:e:null}return e}return e},Gb=function calcRowSpan(e,t,n,r){var i=1;if(!e||"string"!=typeof e.valueOf())return 1;for(var a=!1;!a;)n[r+i]&&null===n[r+i][t]?i+=1:a=!0;return i},Yb=function calcColSpan(e,t,n,r){var i=1;if(!e||"string"!=typeof e.valueOf())return 1;for(var a=!1;!a;)null===n[r][t+i]?i+=1:a=!0;return i},Xb=function mask(e,t){return e.map(function(n,r){if(t===Tb||t===Ab){for(var i=n.map(function(n,i){return Wb(n,i,e,r,t)}),a=[],o=n.length-i.length,s=0;s<o;s+=1)a.push(null);return t===Ab?(a.unshift.apply(a,span_maker_toConsumableArray(i)),a):(a.push.apply(a,span_maker_toConsumableArray(i)),a)}var c=n.map(function(n,i){return Wb(n,i,e,r,t)}),l=[];return l.push.apply(l,span_maker_toConsumableArray(c)),l})};function applyBorders(e,t,n,r){var i=t.width,a=t.style,o=t.color,s=t.showRowBorders,c=t.showColBorders,l=t.showValueBorders,u=i+"px "+a;n===Eb&&1===r?[kb,Pb,Sb,Mb].forEach(function(t){e.style("border-"+t,u+" "+(l[t]?o:qb))}):n===Eb?function applyRowBorders(e,t,n,r){var i=t+" "+(n?r:qb);[kb,Pb].forEach(function(t){e.style("border-"+t,i)})}(e,u,s[0===r?Sb:Mb],o):1===r&&function applyColBorders(e,t,n,r){var i=t+" "+(n?r:qb);[Sb,Mb].forEach(function(t){e.style("border-"+t,i)})}(e,u,c[n],o)}function renderMatrix(e,t,n,r,i){e.forEach(function(e,a){var o=Er(t,"div",[1],i+"-grid-"+n+"-"+(a+1)).classed(i+"-grid-"+n,!0).classed(i+"-grid",!0).style(wb,r.viewWidth[a]+"px"),s=function cellSpanMaker(e,t,n){if(t===kb||t===Pb){var r=Xb(e,t===kb?Nb:Ob),i=r.map(function(e,t){return e.map(function(e,n){return Yb(e,n,r,t)}).filter(function(e){return 1!==e})});return{viewMatrix:r,spans:i}}if(0===n||2===n){var a=Xb(e,0===n?Tb:Ab),o=[];return a.forEach(function(e,t){o[t]=o[t]||[],e.forEach(function(e,n){if(a[t][n]){var r=Gb(e,n,a,t);r&&o[t].push(r)}})}),{viewMatrix:a,spans:o}}return{viewMatrix:e}}(e,n,a),c=s.viewMatrix,l=s.spans;n!==Eb&&o.style(Cb,r.viewHeight[xb[n]]+"px");var u=function renderTable(e,t,n){var r=Er(e,"table",["layout"],t+"-table"),i=Er(r,"tbody",["layout"],t+"-body"),a=Er(i,"tr",n,t+"-tr");return{table:r,body:i,rows:a,cells:Er(a,"td",function(e,t){return e.filter(function(e){return null!==e}).map(function(e){return{placeholder:e,rowIndex:t}})},t+"-td",{},function(e){return e.placeholder.id})}}(o,i+"-grid",c).cells;n===Eb&&l?u.attr(Rb,function(e,t){return l[e.rowIndex][t]}):n!==kb&&n!==Pb||1!==a||u.attr(Fb,function(e,t){var n=l[e.rowIndex][t],r=e.placeholder;return n>1&&r.setAvailableSpace(0,r.height),n}),u.each(function(e){e.placeholder&&e.placeholder.render(this)}).exit().each(function(e){e.placeholder&&e.placeholder.remove()}),applyBorders(u,r.border,n,a)})}var $b=function splitMatrices(e,t,n){return e.map(function(e){return e.slice(t,n)})};var Zb=function createArrow(e,t,n){return Er(e,"div",t,"table-arrow-"+n).classed("table-arrow",!0)};function node_modules_d3_collection_src_map_Map(){}function node_modules_d3_collection_src_map_map(e,t){var n=new node_modules_d3_collection_src_map_Map;if(e instanceof node_modules_d3_collection_src_map_Map)e.each(function(e,t){n.set(t,e)});else if(Array.isArray(e)){var r,i=-1,a=e.length;if(null==t)for(;++i<a;)n.set(i,e[i]);else for(;++i<a;)n.set(t(r=e[i],i,e),r)}else if(e)for(var o in e)n.set(o,e[o]);return n}node_modules_d3_collection_src_map_Map.prototype=node_modules_d3_collection_src_map_map.prototype={constructor:node_modules_d3_collection_src_map_Map,has:function has(e){return"$"+e in this},get:function get(e){return this["$"+e]},set:function set(e,t){return this["$"+e]=t,this},remove:function remove(e){var t="$"+e;return t in this&&delete this[t]},clear:function clear(){for(var e in this)"$"===e[0]&&delete this[e]},keys:function keys(){var keys=[];for(var e in this)"$"===e[0]&&keys.push(e.slice(1));return keys},values:function values(){var values=[];for(var e in this)"$"===e[0]&&values.push(this[e]);return values},entries:function entries(){var entries=[];for(var e in this)"$"===e[0]&&entries.push({key:e.slice(1),value:this[e]});return entries},size:function size(){var size=0;for(var e in this)"$"===e[0]&&++size;return size},empty:function empty(){for(var e in this)if("$"===e[0])return!1;return!0},each:function each(e){for(var t in this)"$"===t[0]&&e(this[t],t.slice(1),this)}};var Kb=node_modules_d3_collection_src_map_map,Jb=function(){var e,t,n,r=[],i=[];function apply(n,i,a,o){if(i>=r.length)return null!=e&&n.sort(e),null!=t?t(n):n;for(var s,c,l,u=-1,f=n.length,h=r[i++],d=Kb(),_=a();++u<f;)(l=d.get(s=h(c=n[u])+""))?l.push(c):d.set(s,[c]);return d.each(function(e,t){o(_,t,apply(e,i,a,o))}),_}return n={object:function object(e){return apply(e,0,d3_collection_src_nest_createObject,d3_collection_src_nest_setObject)},map:function map(e){return apply(e,0,d3_collection_src_nest_createMap,d3_collection_src_nest_setMap)},entries:function entries(e){return function _entries(e,n){if(++n>r.length)return e;var a,o=i[n-1];return null!=t&&n>=r.length?a=e.entries():(a=[],e.each(function(e,t){a.push({key:t,values:_entries(e,n)})})),null!=o?a.sort(function(e,t){return o(e.key,t.key)}):a}(apply(e,0,d3_collection_src_nest_createMap,d3_collection_src_nest_setMap),0)},key:function key(e){return r.push(e),n},sortKeys:function sortKeys(e){return i[r.length-1]=e,n},sortValues:function sortValues(t){return e=t,n},rollup:function rollup(e){return t=e,n}}};function d3_collection_src_nest_createObject(){return{}}function d3_collection_src_nest_setObject(e,t,n){e[t]=n}function d3_collection_src_nest_createMap(){return Kb()}function d3_collection_src_nest_setMap(e,t,n){e.set(t,n)}function node_modules_d3_collection_src_set_Set(){}var Qb=Kb.prototype;function node_modules_d3_collection_src_set_set(e,t){var n=new node_modules_d3_collection_src_set_Set;if(e instanceof node_modules_d3_collection_src_set_Set)e.each(function(e){n.add(e)});else if(e){var r=-1,i=e.length;if(null==t)for(;++r<i;)n.add(e[r]);else for(;++r<i;)n.add(t(e[r],r,e))}return n}node_modules_d3_collection_src_set_Set.prototype=node_modules_d3_collection_src_set_set.prototype={constructor:node_modules_d3_collection_src_set_Set,has:Qb.has,add:function add(e){return this["$"+(e+="")]=e,this},remove:Qb.remove,clear:Qb.clear,values:Qb.keys,size:Qb.size,empty:Qb.empty,each:Qb.each};function src_utils_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function utils_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var ex=function findInPage(e,t){var n=0;for(var r in t)if(e<t[r]){n=r;break}return n},tx=function combineMatrices(e,t){var n=t.isTransposed,r=e[0].length>0?e[0]:e[1];return n?(r=e[0].length>0?[].concat(utils_toConsumableArray(e[0])):[],r=e[1].length>0?[].concat(utils_toConsumableArray(r),utils_toConsumableArray(e[1])):r):r=r.map(function(t,n){var r=[];return e[0].length>0&&(r=[].concat(utils_toConsumableArray(e[0][n]))),e[1].length>0&&(r=[].concat(utils_toConsumableArray(r),utils_toConsumableArray(e[1][n]))),r}),r},nx=function computeLogicalSpace(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=arguments[2],r=t.isTransposed,i=void 0!==r&&r,a=t.unitMeasures,o=function getMeasureInfo(e){return e?{firstMeasure:Cb,secondMeasure:wb}:{firstMeasure:wb,secondMeasure:Cb}}(i),s=o.firstMeasure,c=o.secondMeasure,l=e.values,u=function getMinMeasures(e,t){return e?{height:0,width:t.width}:{height:t.height,width:0}}(i,a);if(l[0].key){var f,h=(src_utils_defineProperty(f={},s,0),src_utils_defineProperty(f,c,0),f);return l.forEach(function(e){var r=computeLogicalSpace(e,t,n);h[s]=Math.max(h[s],r[s],u[s]),h[c]+=+r[c]}),e.space=h,h}return function getLogicalSpace(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=t.firstMeasure,o=t.secondMeasure,s=0,c=0;return e.values.forEach(function(t){var r,l=0,u=0;t.forEach(function(e,t){e.logicalSpace(null);var r=e.getLogicalSpace();u=Math.max(u,+r[o],n[o]),i[t]=Math.max(i[t]||0,r[a]),l+=+i[t]}),c+=u,s=Math.max(s,l),e.space=(src_utils_defineProperty(r={},o,Math.ceil(c)),src_utils_defineProperty(r,a,Math.ceil(s)),r)}),src_utils_defineProperty(r={},o,c),src_utils_defineProperty(r,a,s),r}(e,{firstMeasure:s,secondMeasure:c},u,n)},rx=function extraCellsRemover(e,t,n){return e.slice(t,-n)},ix={config:{sanitization:function sanitization(e,t){return hn(e._config||{},t)}},maxMeasures:{},availableSpace:{},logicalSpace:{}},ax={distribution:[],classPrefix:"muze",isDistributionEqual:!0,unitMeasures:{height:100,width:100,border:1},isTransposed:!1,facet:"primary",extraCellLengths:[]},ox=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var sx=function(){function VisualMatrix(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function visual_matrix_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,VisualMatrix),this._lastLevelKey=0,this._primaryMatrix=e[0]||[],this._secondaryMatrix=e[1]||[],this._maxMeasures=[],this._availableSpace={},sn(this,ix);var n=Object.assign({},this.constructor.defaultConfig());this.config(hn(n,t)),this._breakPointer=this.config().isTransposed?e[0].length:e[0].length>0?e[0][0].length:0,this._layoutMatrix=tx([e[0]||[],e[1]||[]],this.config()),this._tree={key:this.config().isTransposed?Lb:Db,values:this.createTree()},this._logicalSpace=this.setLogicalSpace()}return ox(VisualMatrix,[{key:"primaryMatrix",value:function primaryMatrix(){return arguments.length?this:this._primaryMatrix}},{key:"secondaryMatrix",value:function secondaryMatrix(){return arguments.length?this:this._secondaryMatrix}},{key:"tree",value:function tree(){return arguments.length?this:this._tree}},{key:"createTree",value:function createTree(){var e=function createTree(e){var t={},n=0,r="primary",i=Jb(),a=[],o=e._layoutMatrix,s=e.primaryMatrix(),c=e.secondaryMatrix(),l=e.config(),u=l.isTransposed,f=l.breakPage;if(u){if(r=0===s.length?"primary":0===c.length?"secondary":s.length>=c.length?"primary":"secondary",s.length>0){for(var h=0;h<s.length-1;h++)a.push(h);a.push(s.length-1),"secondary"===r&&(n=s.length-1)}if(c.length>0){for(var d=s.length,_=c.length-1;_>0;_--)a.push(_+d);a.push(d),"primary"===r&&(n=d)}var p;a.forEach(function(e){var t=-1;return i.key(function(n){return t++,n[e].valueOf()+"-"+ex(t,f)})}),p=o[0].map(function(e,t){return o.map(function(e){return e[t]})}),t=i.entries(p)}else{if(r=0===s.length?"primary":0===c.length?"secondary":s.length>=c.length?"primary":"secondary",s.length>0){for(var y=0;y<s[0].length-1;y++)a.push(y);a.push(s[0].length-1),"secondary"!==r&&0!==c.length||(n=s[0].length-1)}if(c.length>0){for(var g=s.length>0?s[0].length:0,m=c[0].length-1;m>0;m--)a.push(m+g);a.push(g),"primary"===r&&(n=g)}else n=s.length>0?s[0].length-1:0;a.forEach(function(e){var t=-1;return i.key(function(n){return t++,n[e].valueOf()+"-"+ex(t,f)})}),t=i.entries(o)}return{tree:t,lastLevelKey:n}}(this),t=e.tree,n=e.lastLevelKey;return this._lastLevelKey=n,t}},{key:"setLogicalSpace",value:function setLogicalSpace(){var e=this.config().isTransposed,t=this.tree();return function createMatrixEachLevel(e,t){if(e.values[0].key){var n=[];return e.values.forEach(function(e){t?createMatrixEachLevel(e,t).forEach(function(e,t){var r;n[t]=n[t]||[],(r=n[t]).push.apply(r,utils_toConsumableArray(e))}):n.push.apply(n,utils_toConsumableArray(createMatrixEachLevel(e,t)))}),e.matrix=n,n}return e.matrix=t?e.values[0].map(function(t,n){return e.values.map(function(e){return e[n]})}):e.values,e.matrix}(t,e),nx(t,this.config(),this.maxMeasures())}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()}},{key:"setAvailableSpace",value:function setAvailableSpace(e,t){this.availableSpace({width:e,height:t});var n=this.tree(),r=this.populateMaxMeasures(Cb,n),i=this.populateMaxMeasures(wb,n),a=this.calculateDepth(i,r);return this.viewableMatrix=this.createViewPortMatrix(a),this.viewableMeasures=this.redistribute(this.viewableMatrix,e,t),this}},{key:"populateMaxMeasures",value:function populateMaxMeasures(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(i[r]=Math.max(i[r]||0,t.space[e]),t.values){var a=r+1;t.values.forEach(function(t){t.space&&(i=n.populateMaxMeasures(e,t,a,i))})}return i}},{key:"calculateDepth",value:function calculateDepth(e,t){var n=void 0,r=void 0,i=this.availableSpace(),a=i.height,o=i.width;for(n=0;n<t.length&&!(t[n]<=a);n++);for(r=0;r<e.length&&!(e[r]<=o);r++);return Math.min(e.length-1,Math.max(n,r))}},{key:"redistribute",value:function redistribute(e,t,n){var r=this,i=[],a=[],o=this.config().isTransposed;return e.forEach(function(e){var s={mWidth:0,mHeight:0,matrix:e.matrix,width:t,height:n,maxHeights:i,maxWidths:a},c=o?r.redistributeColumnWise(s):r.redistributeRowWise(s);a=c.maxWidths,i=c.maxHeights}),e.map(function(e,s){var c=void 0,l=void 0,u={matrixInst:e,maxWidths:a,maxHeights:i,matrixIndex:s},f=r.getCellDimensions(u),h=f.heights,d=f.widths,_=f.rowHeights,p=f.columnWidths;return o?(c=h,l=[t,t]):(c=[n,n],l=d),{rowHeights:{primary:_[0],secondary:_[1]},columnWidths:{primary:p[0],secondary:p[1]},height:{primary:c[0],secondary:c[1]},width:{primary:l[0],secondary:l[1]}}})}},{key:"getViewableSpaces",value:function getViewableSpaces(){return this.viewableMeasures}},{key:"getViewableData",value:function getViewableData(){return this.viewableMatrix}},{key:"removeExtraCells",value:function removeExtraCells(){var e=this.config(),t=e.isTransposed,n=e.extraCellLengths,r=this._layoutMatrix,i=hn({},this.tree()),a=n[0],o=n[1]||Number.NEGATIVE_INFINITY,s=t?r.slice(0).map(function(e){return rx(e,a,o)}):rx(r,a,o);return i.values=rx(i.values,a,o),i.matrix=t?i.matrix.map(function(e){return rx(e,a,o)}):rx(i.matrix,a,o),{tree:i,layoutMatrix:s}}},{key:"createViewPortMatrix",value:function createViewPortMatrix(e){var t=[];return function createMatrixInstances(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments[1],n=arguments[2],r=arguments[3],i=r._breakPointer,a=r.config().isTransposed,o=n.tree,s=n.layoutMatrix;if(0===t){var c=function breakMatrix(e,t,n){var r=[],i=[];return t?e.forEach(function(e,t){t>=n?i.push(e):r.push(e)}):e.forEach(function(e,t){e.forEach(function(e,a){a>=n?(i[t]=i[t]||[],i[t].push(e)):(r[t]=r[t]||[],r[t].push(e))})}),[r,i]}(o.matrix,a,i);return e.push({matrix:o.matrix,primaryMatrix:c[0],secondaryMatrix:c[1],space:o.space}),e}var l=t-1;return o.values.forEach(function(t){createMatrixInstances(e,l,{tree:t,layoutMatrix:s},r)}),e}(t,e,this.removeExtraCells(),this),t}},{key:"redistributeRowWise",value:function redistributeRowWise(e){var t,n,r=[],i=this.maxMeasures(),a=this.config(),o=a.isDistributionEqual,s=a.distribution,c=a.isTransposed,l=a.gutter,u=e.matrix,f=e.width,h=e.height,d=e.maxHeights,_=e.maxWidths;n=function spaceTakenByColumn(e,t){var n=0,r=0;return e.forEach(function(e){var i=e[t].getLogicalSpace();r=Math.max(r,i.width),n+=i.height}),{width:r,height:n}}(u,this._lastLevelKey).height;var p=i.reduce(function(e,t){return e+=t});return r=p>0?i.map(function(e){return e+e/p*(f-p)}):i.map(function(){return 0}),t=function getDistributedHeight(e){var t,n=0,r=0,i=e.isTransposed,a=e.distribution,o=e.availableHeight,s=e.height,c=e.isDistributionEqual,l=e.gutter,u=e.matrix,f=e.cIdx;a&&void 0!==a[0]&&(n=a.reduce(function(e,t){return e+=t})),l&&void 0!==l[0]&&(r=l.reduce(function(e,t){return e+=t})),t=o-Math.floor(o*r);var h=u.length;return u.map(function(r,o){var l=r[f].getLogicalSpace().height;if(!i){if(a.length>0&&h===a.length)return t*a[o]/n-2;if(c||0===e.height)return t/h-2}return l+l/s*(t-s)-2})}({matrix:u,cIdx:this._lastLevelKey,height:n,availableHeight:h,isDistributionEqual:o,distribution:s,isTransposed:c,gutter:l}),_.push(r),d.push(t),{maxWidths:_,maxHeights:d}}},{key:"redistributeColumnWise",value:function redistributeColumnWise(e){var t=[],n=e.matrix,r=e.width,i=e.maxHeights,a=e.maxWidths,o=this.config().unitMeasures.border,s=function spaceTakenByRow(e){var t=0,n=0;return e.forEach(function(e){var r=e.getLogicalSpace();t=Math.max(t,r.height),n+=r.width}),{width:n,height:t}}(n[this._lastLevelKey]).width,c=function getDistributedWidth(e,t){var n=e.availableWidth,r=e.width,i=e.row,a=t.isDistributionEqual,o=t.isTransposed,s=t.distribution,c=0;return s&&s[0]&&(c=s.reduce(function(e,t){return e+=t})),i.map(function(e,t){var l=e.getLogicalSpace().width;if(o){if(s.length>0)return n*s[t]/c-2;if(a||0===r){var u=i.length;return n/u-2}}return l+l/r*(n-r)-2})}({row:n[this._lastLevelKey],width:s,availableWidth:r},this.config());n.forEach(function(e,n){return e.forEach(function(e,r){var i=e.getLogicalSpace().height;e.setAvailableSpace(c[r]-o,i),t[n]=Math.max(t[n]||0,e.getLogicalSpace().height)})}),i.length>0&&(t=t.map(function(e,t){return Math.max(e,i[0][t])})),i.push(t);for(var l=0;l<i.length;l++)i[l]=t;return a.push(c),{maxHeights:i,maxWidths:a}}},{key:"getCellDimensions",value:function getCellDimensions(e){var t=this,n=[],r=[],i=[],a=[],o=this.config(),s=o.isTransposed,c=o.unitMeasures.border,l=e.matrixInst,u=e.maxWidths,f=e.maxHeights,h=e.matrixIndex,d=l.matrix,_=[[0],[0]],p=[[0],[0]],y=[0,0],g=[0,0],m=this._breakPointer;return d.forEach(function(e,o){e.forEach(function(e,l){var d=f[h][o]||0,v=u[h][l];s?(e.setAvailableSpace(v-c,d),n=[l,o],r=[_,p],i=[y,g],a=[d,v]):(e.setAvailableSpace(v,d-c),n=[o,l],r=[p,_],i=[g,y],a=[v,d]),0===n[0]&&n[1]<m?(r[0][0][n[1]]=a[0],i[0][0]=(i[0][0]||0)+a[0]):0===n[0]&&n[1]>=m&&(r[0][1][n[1]-m]=a[0],i[0][1]=(i[0][1]||0)+a[0]),n[1]===t._lastLevelKey&&(r[1][0][n[0]]=a[1],r[1][1][n[0]]=a[1])})}),{heights:y,widths:g,rowHeights:_,columnWidths:p}}}],[{key:"defaultConfig",value:function defaultConfig(){return ax}}]),VisualMatrix}(),cx=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function layout_helper_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function computations_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function setMatrixMeasurement(e,t,n){if(e){var r=e.getLogicalSpace();n&&r[t]!==n&&(t===Cb?e.setAvailableSpace(r.width,n):e.setAvailableSpace(n,r.height))}}var lx=function setAvailableSpace(e,t,n){e.forEach(function(e,r){e.forEach(function(e,i){e.setAvailableSpace(t[i],n[r])})})},ux=function setViewSpaces(e,t,n){var r=e.config()[t+"Pointer"];return n.length-1<r&&(r=0,e.config(function computations_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t+"Pointer",r))),r},fx=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var hx=function(e){function GridLayout(e,t,n,r){!function layout_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GridLayout);var i=function layout_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(GridLayout.__proto__||Object.getPrototypeOf(GridLayout)).call(this,t,n,r));return i.matrices(e),i.config(i.constructor.defaultConfig()),i._layoutId=Ht(),i}return function layout_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(GridLayout,Hb),fx(GridLayout,[{key:"matrices",value:function matrices(e){return e?(this._matrices=function generateVisualMatrices(e,t){var n=[],r=[],i=[],a=[],o=void 0,s=void 0,c=e.config(),l=c.isRowSizeEqual,u=c.isColumnSizeEqual,f=c.gutterSpace,h=c.distribution,d=c.border,_=c.breakPage,p=e.measurement(),y=p.minUnitHeight,g=p.minUnitWidth,m=t.top,v=t.center,b=t.bottom,x=cx(m,3),w=x[0],C=x[1],k=x[2],S=cx(v,3),M=S[0],P=S[1],E=S[2],T=cx(b,3),A=T[0],O=T[1],N=T[2];return M.length>0&&(n=[].concat(layout_helper_toConsumableArray(w),layout_helper_toConsumableArray(M),layout_helper_toConsumableArray(A))),E.length>0&&(r=[].concat(layout_helper_toConsumableArray(k),layout_helper_toConsumableArray(E),layout_helper_toConsumableArray(N))),C.length>0&&C[0].length>0&&(i=C.map(function(e,t){return[].concat(layout_helper_toConsumableArray(w[t]),layout_helper_toConsumableArray(e),layout_helper_toConsumableArray(k[t]))})),O.length>0&&O[0].length>0&&(a=O.map(function(e,t){return[].concat(layout_helper_toConsumableArray(A[t]),layout_helper_toConsumableArray(e),layout_helper_toConsumableArray(N[t]))})),e.rowMatrix(new sx([n,r],{isDistributionEqual:l,distribution:h.rows,gutter:f.rows,unitMeasures:{width:g,height:y,border:d.width},breakPage:_.rows.map(function(e){return e+Math.max(w.length,k.length)}),extraCellLengths:[w.length,A.length]})),o=w.length>0?w[0].length:A.length>0?A[0].length:0,s=k.length>0?k[0].length:N.length>0?N[0].length:0,e.columnMatrix(new sx([i,a],{isDistributionEqual:u,distribution:h.columns,gutter:f.columns,isTransposed:!0,unitMeasures:{width:g,height:y,border:d.width},breakPage:_.columns,extraCellLengths:[o,s]})),e.centerMatrix(P),t}(this,e),this):function get(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var i=Object.getPrototypeOf(e);return null===i?void 0:get(i,t,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0}(GridLayout.prototype.__proto__||Object.getPrototypeOf(GridLayout.prototype),"matrices",this).call(this,e)}},{key:"triggerReflow",value:function triggerReflow(){return function computeLayoutMeasurements(e){var t,n,r,i,a,o=e.rowMatrix(),s=e.columnMatrix(),c=e.centerMatrix(),l=e.measurement(),u=l.width,f=l.height,h=e.config().border,d=e.matrices(),_=d.top,p=d.bottom,y=function getMatrixMeasurement(e,t){return e?e.getLogicalSpace()[t]:0}(o,wb),g=u-y;setMatrixMeasurement(s,wb,g);var m=s.getViewableSpaces();ux(e,"column",m);var v=m[e.config().columnPointer],b=v.height.primary+v.height.secondary,x=f-b;setMatrixMeasurement(o,Cb,x);var w=o.getViewableSpaces();ux(e,"row",w);var C=(t=[]).concat.apply(t,computations_toConsumableArray(w.map(function(e){return e.rowHeights.primary}))),k=(n=[]).concat.apply(n,computations_toConsumableArray(w.map(function(e){return e.columnWidths.primary}))),S=(r=[]).concat.apply(r,computations_toConsumableArray(w.map(function(e){return e.columnWidths.secondary}))),M=s.getViewableSpaces(),P=(i=[]).concat.apply(i,computations_toConsumableArray(M.map(function(e){return e.columnWidths.primary}))),E=M[0].rowHeights.primary,T=(a=[]).concat.apply(a,computations_toConsumableArray(M.map(function(e){return e.rowHeights.secondary}))),A=h.width;c.forEach(function(e,t){e.forEach(function(e,n){e.setAvailableSpace(P[n]-A,C[t]-A)})}),lx(_[0],k,E),lx(_[2],S,E),lx(p[0],k,T),lx(p[2],S,T)}(this),this.setViewInformation(),this}},{key:"arrowClick",value:function arrowClick(e,t){var n=this.config(),r=n.columnPointer,i=n.rowPointer;switch(e){case kb:i--;break;case Pb:i++;break;case Sb:r--;break;case Mb:r++}return this.config({rowPointer:i,columnPointer:r}),t&&t(),this.setViewInformation(),this.renderGrid(),this.renderArrows(),this}},{key:"setViewInformation",value:function setViewInformation(){var e=this.config(),t=e.rowPointer,n=e.columnPointer,r=e.border,i=function getViewMatrices(e,t,n){for(var r=e.rowMatrix(),i=e.columnMatrix(),a=e.centerMatrix(),o=e.matrices(),s=r.getViewableData(),c=i.getViewableData(),l={row:0,column:0},u=t-1;u>=0;u--){var f=Math.max(s[u].primaryMatrix.length,s[u].secondaryMatrix.length);l.row+=f}for(var h=n-1;h>=0;h--){var d=c[h],_=d.primaryMatrix,p=d.secondaryMatrix,y=Math.max(_[0]?_[0].length:0,p[0]?p[0].length:0);l.column+=y}o.top[1]=c[n].primaryMatrix,o.bottom[1]=c[n].secondaryMatrix,o.center[0]=s[t].primaryMatrix,o.center[2]=s[t].secondaryMatrix;var g=Math.max(o.center[0].length,o.center[2].length),m=Math.max(o.top[1][0]?o.top[1][0].length:0,o.bottom[1][0]?o.bottom[1][0].length:0);return o.center[1]=a.slice(l.row,l.row+g).map(function(e){return e.slice(l.column,l.column+m)}),{matrices:o,rowPages:s.length,columnPages:c.length}}(this,t,n),a=function getViewMeasurements(e){var t=e.rowMatrix(),n=e.columnMatrix(),r=e.measurement(),i=r.width,a=r.height,o=e.config(),s=o.columnPointer,c=o.rowPointer,l=t.getViewableSpaces()[c].width,u=l.primary,f=l.secondary,h=n.getViewableSpaces()[s].height,d=h.primary,_=h.secondary;return{viewWidth:[u,i-(u+f),f],viewHeight:[d,a-(d+_),_]}}(this);return a.border=r,this.viewInfo={viewMatricesInfo:i,layoutDimensions:a},this}},{key:"getViewInformation",value:function getViewInformation(){return this.viewInfo}},{key:"renderGrid",value:function renderGrid(e){if(this.mountPoint(e),!this.mountPoint())return this;var t=this.getViewInformation(),n=t.viewMatricesInfo,r=t.layoutDimensions;return function renderMatrices(e,t,n){var r=t.top,i=t.center,a=t.bottom,o=e.config(),s=o.breakPage,c=o.gutterSpace,l=o.classPrefix,u=e.measurement().width,f=e.mountPoint(),h=[],d=[],_=[],p=n.viewHeight[1]*c.rows[s.rows[0]-1],y=s.rows.length;if(s.rows.length>0&&Math.max(i[0].length,i[2].length)<=s.rows[y-1]){var g=0,m=r[1].length/y,v=a[1].length/y;s.rows.forEach(function(e,t){_[t]=$b(r,t*m,(t+1)*m),h[t]=$b(i,g,e),d[t]=$b(a,t*v,(t+1)*v),g=e})}else _=[r],h=[i],d=[a];f.each(function(e,t){renderMatrix(_[t],Pr(this),kb,n,l),renderMatrix(h[t],Pr(this),Eb,n,l),renderMatrix(d[t],Pr(this),Pb,n,l)}).style(wb,u+"px").style("margin-bottom",function(e,t){return t!==d.length-1?Math.floor(p)+"px":0})}(this,n.matrices,r),this}},{key:"renderArrows",value:function renderArrows(e){var t=this;this._arrowContainer||(this._arrowContainer=e);var n=function renderArrows(e,t,n){var r=e.config(),i=r.columnPointer,a=r.rowPointer,o=n.rowPages,s=n.columnPages;return{bottom:Zb(t,a+1!==o?[1]:[],Pb),top:Zb(t,a>0?[1]:[],kb),right:Zb(t,i+1!==s?[1]:[],Mb),left:Zb(t,i>0?[1]:[],Sb)}}(this,this._arrowContainer,this.getViewInformation().viewMatricesInfo);return Object.entries(n).forEach(function(e){var n=e[0];e[1].on("click",function(){return t.arrowClick(n)})}),this}}],[{key:"defaultMeasurement",value:function defaultMeasurement(){return Vb}},{key:"defaultConfig",value:function defaultConfig(){return Ub}},{key:"create",value:function create(){return new GridLayout(null,null,this.defaultMeasurement(),this.defaultConfig())}}]),GridLayout}(),dx=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var _x=function(){function TransactionSupport(){!function transaction_support_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TransactionSupport)}return dx(TransactionSupport,[{key:"data",value:function data(){throw new Error(ln.INTERFACE_IMPl)}},{key:"width",value:function width(){throw new Error(ln.INTERFACE_IMPl)}},{key:"height",value:function height(){throw new Error(ln.INTERFACE_IMPl)}},{key:"config",value:function config(){throw new Error(ln.INTERFACE_IMPl)}}]),TransactionSupport}(),px="left",yx="right",gx="bottom",mx="top",vx="muze",bx="header",xx="data",wx="axes",Cx="facetByFields",kx="fields",Sx="transform",Mx="layerDef",Px="config",Ex="text",Tx="axis",Ax="geom",Ox="blank",Nx=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Rx,Fx,Dx=function(){function SimpleCell(e){!function simple_cell_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SimpleCell),this._id=Ht();var t=hn({},this.constructor.defaultConfig());this._config=hn(t,e||{}),this._mount=null}return Nx(SimpleCell,[{key:"valueOf",value:function valueOf(){throw new Error(ln.INTERFACE_IMPL)}},{key:"id",value:function id(){throw new Error(ln.INTERFACE_IMPL)}},{key:"serialize",value:function serialize(){throw new Error(ln.INTERFACE_IMPL)}},{key:"getLogicalSpace",value:function getLogicalSpace(){throw new Error(ln.INTERFACE_IMPL)}},{key:"setAvailableSpace",value:function setAvailableSpace(){throw new Error(ln.INTERFACE_IMPL)}},{key:"render",value:function render(){throw new Error(ln.INTERFACE_IMPL)}},{key:"remove",value:function remove(){throw new Error(ln.INTERFACE_IMPL)}},{key:"type",get:function get(){return"simple"}}],[{key:"defaultConfig",value:function defaultConfig(){return{}}}]),SimpleCell}();function enums_defaults_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Lx,Ix=(enums_defaults_defineProperty(Fx={},"margin",(enums_defaults_defineProperty(Rx={},px,0),enums_defaults_defineProperty(Rx,yx,0),enums_defaults_defineProperty(Rx,mx,0),enums_defaults_defineProperty(Rx,gx,0),Rx)),enums_defaults_defineProperty(Fx,"spaceFixer",2),enums_defaults_defineProperty(Fx,"isOffset",!1),enums_defaults_defineProperty(Fx,"verticalAlign",mx),enums_defaults_defineProperty(Fx,"textAlign","center"),enums_defaults_defineProperty(Fx,"show",!0),Fx);function src_props_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var jx={mount:{},availHeight:{},availWidth:{},config:{sanitization:function sanitization(e,t){return hn(e._config,t)}},logicalSpace:{},source:{}},zx={data:{},caption:{},config:{},axes:{sanitization:function sanitization(e,t){return Object.assign(e._axes,t)}},facetByFields:{},fields:{},transform:{},layerDef:{}},Bx=(src_props_defineProperty(Lx={},Ex,jx),src_props_defineProperty(Lx,Ax,hn(zx,jx)),src_props_defineProperty(Lx,Tx,jx),src_props_defineProperty(Lx,Ox,jx),Lx),Hx=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Ux=function(e){function AxisCell(e){!function axis_cell_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AxisCell);var t=function axis_cell_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(AxisCell.__proto__||Object.getPrototypeOf(AxisCell)).call(this,e));return t._axis=null,t._availHeight=null,t._availWidth=null,t._logicalSpace=null,sn(t,Bx[Tx]),t}return function axis_cell_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(AxisCell,Dx),Hx(AxisCell,[{key:"valueOf",value:function valueOf(){return this.source().id}},{key:"serialize",value:function serialize(){return{type:Tx,axis:this.source().serialize()}}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||this.logicalSpace(function computeAxisSpace(e){var t=void 0,n=void 0,r=e.source(),i=e.config(),a=i.spaceFixer,o=i.margin,s=r.getLogicalSpace(),c=s.width,l=s.height;return!0===r.config().show?(n=Math.floor(l+o.top+o.bottom+a),t=Math.floor(c+o.left+o.right+a)):(t=c,n=l),{width:t,height:n}}(this)),this.logicalSpace()}},{key:"setAvailableSpace",value:function setAvailableSpace(e,t){this.availWidth(e),this.availHeight(t);var n=this.config(),r=n.margin,i=n.isOffset;return this.source().setAvailableSpace(e,t,r,i),this.logicalSpace(null),this.source().logicalSpace(null),this}},{key:"render",value:function render(e){if(!e)return this;var t=this.source(),n=this.availHeight(),r=this.availWidth(),i=this.config().margin,a=i.top,o=i.bottom,s=i.left,c=i.right,l=t.config().show,u=Er(Pr(e),"div",[this],vx+"-axis-cell"),f=Er(u,"svg",[1],vx+"-axis-container");return this.mount(e),0!==r&&r||f.attr("width","0px"),0!==n&&n||f.attr("height","0px"),u.style("width",(l?r:0)+"px").style("height",(l?n:0)+"px").style("margin-top",a).style("margin-bottom",o).style("margin-left",s).style("margin-right",c),t.mount(f.node()),f}},{key:"remove",value:function remove(){return this.source()&&this.source().remove(),this.mount()&&this.mount().remove(),this}},{key:"type",get:function get(){return Tx}},{key:"id",get:function get(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return Ix}}]),AxisCell}(),Vx=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var qx=function(e){function BlankCell(e){!function blank_cell_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BlankCell);var t=function blank_cell_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(BlankCell.__proto__||Object.getPrototypeOf(BlankCell)).call(this,e));return sn(t,Bx[Ox]),t}return function blank_cell_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(BlankCell,Dx),Vx(BlankCell,[{key:"valueOf",value:function valueOf(){return this.id}},{key:"serialize",value:function serialize(){return{type:Ox}}},{key:"getLogicalSpace",value:function getLogicalSpace(){var e=this.config().spaceFixer;return this.logicalSpace()?this.logicalSpace():{width:this.width||e,height:this.height||e}}},{key:"setAvailableSpace",value:function setAvailableSpace(e,t){return this.availWidth(e),this.availHeight(t),this.logicalSpace(null),this}},{key:"render",value:function render(e){if(e){var t=this.config().style;this.mount(e);var n=Pr(e),r=Er(n,"div",[this.id]);r.classed(vx+"-blank-cell",!0),r.style("width",this.availWidth()+"px"),r.style("height",this.availHeight()+"px"),r.html(""),t&&Tr(r,t)}return this}},{key:"remove",value:function remove(){return this.mount()&&this.mount().remove(),this}},{key:"type",get:function get(){return Ox}},{key:"id",get:function get(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return Ix}}]),BlankCell}(),Wx=(n(34),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}());var Gx=function(e){function TextCell(e,t){!function text_cell_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TextCell);var n=function text_cell_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(TextCell.__proto__||Object.getPrototypeOf(TextCell)).call(this,e));return n._dependencies=t,n._className=n._config.className||(n._config.type===bx?vx+"-"+bx+"-cell":vx+"-"+Ex+"-cell"),n._computedStyle=Ir(Pr("body"),n._className),n._dependencies.labelManager.setStyle(n._computedStyle),n._minTickDiff=n._dependencies.labelManager.getOriSize("WW"),sn(n,Bx[Ex]),n}return function text_cell_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(TextCell,Dx),Wx(TextCell,[{key:"valueOf",value:function valueOf(){return this.source()}},{key:"dependencies",value:function dependencies(){return this._dependencies}},{key:"serialize",value:function serialize(){return{text:this.source(),type:Ex}}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||this.logicalSpace(function computeTextSpace(e){var t=e.dependencies().labelManager,n=t.getOriSize(e.source()),r=e.config(),i=r.margin,a=r.show;return t.setStyle(e._computedStyle),a?{width:n.width+i.left+i.right+e._minTickDiff.width,height:n.height+i.top+i.bottom+e._minTickDiff.height}:{width:0,height:0}}(this)),this.logicalSpace()}},{key:"setAvailableSpace",value:function setAvailableSpace(e,t){return this.availWidth(e),this.availHeight(t),this.logicalSpace(null),this}},{key:"render",value:function render(e){var t=this.availWidth(),n=this.config(),r=n.margin,i=n.show,a=n.verticalAlign,o=n.textAlign;if(this.mount(e),i){var s=Pr(e),c=Er(s,"div",[this.id],vx+"-text-cell");s.style("vertical-align",a),c.classed(this._className,!0),c.style("width",t?t+"px":"100%"),[mx,gx,px,yx].forEach(function(e){c.style("padding-"+e,r[e]+"px")}),c.style("text-align",o),c.style("display","inline"),c.html(this.source())}return this}},{key:"remove",value:function remove(){return this.mount()&&this.mount().remove(),this}},{key:"type",get:function get(){return Ex}},{key:"id",get:function get(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return Ix}}]),TextCell}(),Yx=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Xx,$x=function(e){function GeomCell(e){!function geom_cell_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GeomCell);var t=function geom_cell_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(GeomCell.__proto__||Object.getPrototypeOf(GeomCell)).call(this,e));return t._unit=null,t._layers=null,t._axes={},t._datamodel={},t._facetByFields={},t._fields=null,t._transform=null,t._caption=null,sn(t,Bx[Ax]),t}return function geom_cell_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(GeomCell,Dx),Yx(GeomCell,[{key:"valueOf",value:function valueOf(){return this.source()}},{key:"serialize",value:function serialize(){return{type:Ax,unit:this.source().serialize(),caption:this.caption()}}},{key:"updateModel",value:function updateModel(){var e=this,t=this.source();return t.lockModel(),[xx,wx,Cx,kx,Sx,Mx,Px].forEach(function(n){e[n]()&&t[n](e[n]())}),t.unlockModel(),this}},{key:"getCaptionSpace",value:function getCaptionSpace(){var e=this.caption(),t={width:0,height:0};return e&&(t=e.getLogicalSpace()),t}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||this.logicalSpace(function computeGeomSpace(e){var t=e.source().config(),n=t.width,r=t.height;return{width:Math.ceil(n),height:Math.ceil(r+e.getCaptionSpace().height)}}(this)),this.logicalSpace()}},{key:"setAvailableSpace",value:function setAvailableSpace(e,t){var n=this.source();return this.availWidth(e),this.availHeight(t),n.lockModel(),n.width(e).height(t-this.getCaptionSpace().height),n.unlockModel(),this.logicalSpace(null),this}},{key:"render",value:function render(e){if(e){this.mount(e);var t=this.availHeight(),n=this.availWidth(),r=this.caption(),i=Er(Pr(e),"div",[1],vx+"-geom-cell");if(r){var a=Er(i,"div",[r],vx+"-unit-caption").node();r.render(a)}var o=Er(i,"div",[1],vx+"-unit");i.style("width",n+"px").style("height",t+"px"),o.style("width",n+"px").style("height",t-this.getCaptionSpace().height+"px"),this.source().mount(o.node())}return this}},{key:"remove",value:function remove(){return this.mount()&&this.mount().remove(),this.source().remove(),this}},{key:"type",get:function get(){return Ax}},{key:"id",get:function get(){return this.source().id()}}],[{key:"defaultConfig",value:function defaultConfig(){return Ix}}]),GeomCell}();function src_defaults_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Zx=(src_defaults_defineProperty(Xx={},"SimpleCell",Dx),src_defaults_defineProperty(Xx,"TextCell",Gx),src_defaults_defineProperty(Xx,"AxisCell",Ux),src_defaults_defineProperty(Xx,"GeomCell",$x),src_defaults_defineProperty(Xx,"BlankCell",qx),Xx),Kx=function cellRegistry(){var e=Zx;return{set:function set(t,n){return e[t]=n,cellRegistry},get:function get(){return e}}};function component_resolver_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Jx=function createHeading(e,t,n,r){return e?function headerCreator(e,t,n,r){var i=e.content,a=r||new Gx({type:t},{labelManager:n});return a.source(i),{height:a.getLogicalSpace().height,cell:a}}(e,"title"===t?"header":"text",n,r):""},Qx=function legendInitializer(e,t,n,r){var i=[],a=n.height,o=n.width,s=n.headerHeight,c=e.show,l=e.align,u=e.title;c&&function legendDataCreator(e){var t=void 0,n=[],r=e.getRetinalAxes();return Object.entries(r).forEach(function(r){var i=r[1][0],a=r[0],o=e[a]();if(o&&o.field){var s=i.config(),c=s.type,l=s.interpolate;t=pb.discrete,"linear"===c&&"color"===a&&(t=l?pb.gradient:pb["step-color"]),n.push({scale:i,canvas:e,fieldName:o.field,LegendCls:t})}}),n}(t).forEach(function(n,c){var f={},h={},d=n.LegendCls,_=n.scale,p=n.fieldName;f=r[c]?r[c].legend:d.create({labelManager:t._dependencies.smartlabel,cells:{AxisCell:Ux,TextCell:Gx}}),h.maxHeight="vertical"===l?a-s:.2*a,h.maxWidth="horizontal"===l?o:.2*o,[lb,cb,ub,fb,hb].forEach(function(t){e[t]&&(h[t]=t===lb?Math.min(h.maxHeight,e[t]):t===cb?Math.min(h.maxWidth,e[t]):e[t])}),f.scale(_).title(u&&null!==u[c]?u[c]:p).fieldName(p).config(e).metaData(t.data().project([p])).measurement(h).setLegendMeasures(),i.push({canvas:t,legend:f})});return i},ew=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function layout_maker_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var tw,nw,rw=Kx().get().BlankCell,iw=function createBlankCell(){return new rw},aw=function fillArray(e,t){return e.map(function(){return t()})},ow=function blankMatrixCreator(e,t,n){for(var r=[],i=0;i<e;i++){var a=new Array(t).fill([]);a=aw(a,n),r.push(a)}return r},sw=function blankCellCreator(e,t){return e.map(function(n,r){if(0===n.length&&t[r]>0){var i=Math.max(e[0].length,e[1].length);return ow(i,t[r],iw)}return n.length>0?n[0]&&n[0].length<=t[r]?n.map(function(e){var i=new Array(t[r]-n[0].length).fill(1);return i=aw(i,iw),[].concat(layout_maker_toConsumableArray(i),layout_maker_toConsumableArray(e))}):ow(n.length,t[r],iw):n})},cw=function prepareLayout(e,t,n,r){var i=void 0,a=void 0,o=void 0,s=void 0,c=t.rows,l=t.columns,u=t.values,f=t.cornerMatrices,h=n.showHeaders,d=function getMaxRows(e){var t=[0,0];return t[0]=Math.max(t[0],e[0].length?e[0][0].length:0),t[1]=Math.max(t[1],e[1].length?e[1][0].length:0),t}(c),_=f.topLeft,p=f.topRight,y=f.bottomLeft,g=f.bottomRight;if(h)i=_,a=p,o=y,s=g;else{var m=[l[0].length,l[1].length],v=sw([new Array(m[0]),new Array(m[0])],d),b=ew(v,2);i=b[0],a=b[1];var x=sw([new Array(m[1]),new Array(m[1])],d),w=ew(x,2);o=w[0],s=w[1]}e.measurement(r).config(n).matrices({top:[i,l[0],a],center:[c[0],u,c[1]],bottom:[o,l[1],s]}).triggerReflow()},lw=function getRenderDetails(e,t){var n=hn({},e.config()),r=e.getPlaceholderDetails(),i=r.isColumnSizeEqual,a=r.isRowSizeEqual,o=r.rows,s=r.columns,c=r.values,l=e.config(),u=l.minWidth,f=l.minHeight,h=l.classPrefix,d=l.showHeaders,_=e.legend(),p=e.title()[1],y=e.subtitle()[1],g=_.position,m=function arrangeComponents(e){var t,n=e.legend(),r=e.title()[1],i=e.subtitle()[1],a=[["legend","layout"],["layout","legend"]];return{headers:(component_resolver_defineProperty(t={},"top-top",["title","subtitle","group"]),component_resolver_defineProperty(t,"bottom-bottom",["group","subtitle","title"]),component_resolver_defineProperty(t,"top-bottom",["title","group","subtitle"]),component_resolver_defineProperty(t,"bottom-top",["subtitle","group","title"]),t)[(r.position||"top")+"-"+(i.position||"top")],legends:"left"===n.position||"top"===n.position?a[0]:a[1]}}(e),v=t.getBoundingClientRect(),b=v.height,x=v.width,w=e.height()>=0?e.height():b||f,C=e.width()>=0?e.width():x||u,k=function createHeaders(e,t,n){var r=0,i={};return t>200&&n>200&&["title","subtitle"].forEach(function(t){var n=e[t](),a=function resolveTitleSubTitleContent(e){return"function"!=typeof e||e._sanitize?function escapeHTML(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return(""+e).replace(/[&<>"'/]/g,function(e){return t[e]})}(e()):e()}(n[0]);if(a.length){var o=n[1];o.width=e.width(),o.content=a;var s=Jx(o,t,e.dependencies().smartlabel,e[t+"Cell"]),c=s.height,l=s.cell;i[t+"Cell"]=l,r+=c+o.padding}}),{headerHeight:r,headers:i}}(e,w,C),S=k.headers,M=k.headerHeight;e.legendComponents(function createLegend(e,t,n,r){var i={height:n,width:r,headerHeight:t},a=e.legend(),o=a.show,s=a.position;a.classPrefix=e.config().classPrefix;var c="left"===s||"right"===s?"vertical":"horizontal";return a.show=o?"vertical"===c&&r>200||"horizontal"===c&&n>200:o,a.align=c,Qx(a,e,i,e.legends||[])}(e,M,w,C));var P=function getLegendSpace(e,t,n){var r=e.legendComponents(),i=e.legend(),a={width:0,height:0};return r.map(function(e){return e.legend.measurement()}).forEach(function(e){var r,o;o=Math.min(e.width,e.maxWidth),r=Math.min(e.height,e.maxHeight),"horizontal"===i.align?a.width+o>n?(a.width=n,a.height+=r):(a.width+=o,a.height=Math.max(a.height,r)):a.height+r>t?(a.height=r,a.width+=o):(a.height+=r,a.width=Math.max(a.width,o))}),"horizontal"===i.align&&(a.width=n),a}(e,w,C),E="left"===g||"right"===g?P.width:0,T="top"===g||"bottom"===g?P.height:0,A={headers:S,legends:e.legendComponents(),canvases:[e],rows:o,columns:s,values:c,cornerMatrices:e.getCornerMatrices()},O={mountSpace:{height:b,width:x},headerHeight:M,legendSpace:P,canvasWidth:C,canvasHeight:w,width:C-E,height:w-M-T,minUnitHeight:e.minUnitHeight(),minUnitWidth:e.minUnitWidth()};return{layoutConfig:n=hn(n,{classPrefix:h,showHeaders:d,border:hn(e.getGroupMetaData().border,e.config().border),layoutArrangement:m,legend:_,title:p,subtitle:y,isColumnSizeEqual:i,isRowSizeEqual:a}),components:A,measurement:O}},uw={position:"bottom",show:!0},fw={position:"top",align:"center",padding:8},hw={position:"bottom",align:"center",padding:16};function canvas_local_options_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dw=(canvas_local_options_defineProperty(tw={},"rows",{value:null,meta:{typeCheck:"constructor",typeExpected:"Array"}}),canvas_local_options_defineProperty(tw,"columns",{value:null,meta:{typeCheck:"constructor",typeExpected:"Array"}}),canvas_local_options_defineProperty(tw,"color",{value:null,meta:{typeCheck:"constructor",typeExpected:"Object",sanitization:function sanitization(e){return"string"==typeof e?{field:e}:e}}}),canvas_local_options_defineProperty(tw,"shape",{value:null,meta:{typeCheck:"constructor",typeExpected:"Object",sanitization:function sanitization(e){return"string"==typeof e?{field:e}:e}}}),canvas_local_options_defineProperty(tw,"size",{value:null,meta:{typeCheck:"constructor",typeExpected:"Object",sanitization:function sanitization(e){return"string"==typeof e?{field:e}:e}}}),canvas_local_options_defineProperty(tw,"detail",{value:[],meta:{typeCheck:"constructor",typeExpected:"Array"}}),canvas_local_options_defineProperty(tw,"layers",{value:null,meta:{typeCheck:"constructor",typeExpected:"Array"}}),canvas_local_options_defineProperty(tw,"transform",{value:null,meta:{typeCheck:"constructor",typeExpected:"Object"}}),canvas_local_options_defineProperty(tw,"mount",{value:null}),tw),_w=(canvas_local_options_defineProperty(nw={},"title",{value:[null,null],meta:{typeCheck:["constructor","constructor"],typeExpected:["Function","Object"],spreadParams:!0,sanitization:[function(e){if("string"==typeof e){var n=function t(){return e};return n._sanitized=!0,n}return e},function(e){var t=hn({},fw);return hn(t,e)}]}}),canvas_local_options_defineProperty(nw,"subtitle",{value:[null,null],meta:{typeCheck:["constructor","constructor"],typeExpected:["Function","Object"],spreadParams:!0,sanitization:[function(e){if("string"==typeof e){var t=function sub(){return e};return t._sanitized=!0,t}return e},function(e){var t=hn({},hw);return hn(t,e)}]}}),canvas_local_options_defineProperty(nw,"legend",{value:null,meta:{sanitization:function sanitization(e){var t=hn({},uw);return hn(t,e)}}}),canvas_local_options_defineProperty(nw,"resolve",{value:null}),nw),pw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),yw=function renderHeader(e,t,n,r){var i=r[n+"Cell"],a=e[""+n],o=a.position,s=a.align,c=a.padding,l=Er(t,"div",[1],e.classPrefix+"-"+n+"-container");i&&i.render(l.node()),l.style("width","100%"),a&&i&&l.style("float","left").style("text-align",s).style("padding-"+("top"===o?"bottom":"top"),c+"px")},gw=function renderComponents(e,t,n,r){var i=t.headers,a=t.legends,o=n.classPrefix,s=function getSkeletons(e,t,n){var r=t.layoutArrangement,i=t.classPrefix,a=r.headers,o=r.legends,s=n.canvasWidth,c=n.canvasHeight,l=n.mountSpace,u=Pr(e),f={};l.height&&l.height<c&&u.style("overflow-y","scroll"),l.width&&l.width<s&&u.style("overflow-x","scroll");var h=Er(u,"div",[1],i+"-viz").style("width",s+"px");return a.forEach(function(e){f[e]=Er(h,"div",[1],i+"-"+e+"-container"),f[e].style("width",s+"px")}),Er(h,"div",a).style("width",s+"px").each(function(e,t){f[e]=Pr(this).attr("class",i+"-"+e+"-container"),"group"===e&&Er(f[e],"div",o,i+"-"+e+"-container-"+t).each(function(e){f[e]=Pr(this).classed(i+"-"+e+"-container",!0)})}),f}(e.mount(),n,r),c=s.title,l=s.legend,u=s.subtitle,f=function prepareGridContainer(e,t,n,r){if(e){var i=t.height,a=t.width,o=Er(Pr(e),"div",[1],n+"-grid-layout").attr("id",n+"-grid-layout-"+r).style("height",i+"px").style("width",a+"px");return{mount:Er(o,"div",[1],n+"-layout-grid-container").attr("id",n+"-layout-grid-container-"+r).style("height",i+"px").style("width",a+"px").style("overflow-x",a>300?"none":"scroll").style("overflow-y",i>300?"none":"scroll"),container:o}}}(s.layout.node(),r,o,e.alias()),h=f.mount,d=f.container,_=e.layout().getViewInformation().layoutDimensions.viewWidth[0];r.padding=_,function setLabelRotationForAxes(e){var t=0,n=e.xAxes()||[];!function(){for(var e=0;e<n.length;e++)for(var r=0;r<n[e].length;r++)if(0!==n[e][r].config().labels.rotation)return void(t=n[e][r].config().labels.rotation)}(),t&&n.forEach(function(e){e.forEach(function(e){e.config({labels:{rotation:t,smartTicks:!1}})})})}(e),e.layout().renderGrid(h).renderArrows(d),function renderLegend(e,t,n,r){var i=[],a=r.legendSpace,o=r.headerHeight,s=r.height,c=r.width,l=e.legend,u=e.classPrefix,f=l.position,h=Er(t,"div",[1],u+"-legend"),d="left"===f||"right"===f?"vertical":"horizontal",_="vertical"===d?a.width:c,p="vertical"===d?s-o:a.height;if([t,h].forEach(function(e){e.style("width",_+"px").style("height",p+"px").style("float","left")}),"vertical"===d){var y=-1,g=p,m=0;n.forEach(function(e){var t=e.legend;t.measurement().height>g?(y++,m=0,g=p):y<0&&y++,i[y]=i[y]||[],g-=Math.min(t.measurement().height,g),m=Math.max(t.measurement().width,m),i[y].push({legendInstance:t,legendHeight:p,legendWidth:m})});var v=Er(h,["div"],i,u+"-legend-section").each(function(e,t){return Pr(void 0).classed(u+"-legend-section-"+t,!0)}).classed(u+"-legend-vertical-section",!0).style("width",function(e){return e[0].legendWidth+"px"});Er(v,["div"],function(e){return e},u+"-legend-components").each(function(e){e.legendInstance.mount(this)}).style("width",function(e){return e.legendWidth+"px"})}else{var b=Er(h,"div",[1],u+"-legend-section-0").classed(u+"-legend-horizontal-section",!0).classed(u+"-legend-section",!0).style("width",_+"px");Er(b,"div",n,u+"-legend-components").each(function(e){e.legend.mount(this)})}}(n,l,a,r),yw(n,c,"title",i),yw(n,u,"subtitle",i),function createSideEffectContainer(e){var t=e.layout(),n=t.mountPoint(),r=t.getViewInformation().layoutDimensions,i=pw(r.viewHeight,2),a=i[0],o=i[1],s=pw(r.viewWidth,2),c=s[0],l=s[1],u=e.config().classPrefix,f=Er(n,"div",[1],u+"-canvas-side-effect-container");f.style("position","absolute").style("left",c+"px").style("top",a+"px").style("width",l+"px").style("height",o+"px").style("pointer-events","none"),Er(f,"svg",[1],u+"-canvas-side-effect-container").style("position","absolute").attr("width",l).attr("height",o).style("pointer-events","none")}(e),function shiftHeaders(e,t,n){var r=e.classPrefix,i=e.title,a=e.subtitle,o=e.legend,s=n.legendSpace;t+="left"===o.position?s.width:0,i&&Pr("."+r+"-title-container").style("padding-left","left"===i.align?t+"px":0),a&&Pr("."+r+"-subtitle-container").style("padding-left","left"===a.align?t+"px":0),Pr("."+r+"-legend-horizontal-section").style("padding-left",t+"px").selectAll("."+r+"-legend-body, ."+r+"-legend-title").style("max-width",s.width-t+"px")}(n,_,r)};function canvas_helper_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var mw=function changeSideEffectAvailability(e,t,n){for(var r in e)if({}.hasOwnProperty.call(e,r))for(var i in e[r]){var a=e[r][i],o=!0;t&&!1===t(a,r)&&(o=!1),o&&(n?a.enable():a.disable())}},vw=function getDrawingContext(e,t){return function(){var n=e.config().classPrefix,r=n+"-canvas-side-effect-container",i=e.layout(),a=i.getViewInformation().layoutDimensions,o=i.mountPoint(),s=o.select("."+r+" svg").node(),c=o.select("."+r).node(),l=a.viewWidth[1],u=a.viewHeight[1],f=e.composition().visualGroup.getCellsByFacetKey(t);if(!f[0])return{};var h=f[0].valueOf().getDrawingContext().svgContainer.getBoundingClientRect(),d=s.getBoundingClientRect(),_=h.left-d.left,p=h.top-d.top;return{svgContainer:s,htmlContainer:c,width:l,height:u,boundWidth:h.width,boundHeight:h.height,xOffset:_,yOffset:p,sideEffectGroup:Er(Pr(s),"g",[1],n+"-side-effect-group-"+t.replace(/,|\s*/g,"")).node()}}},bw=function getSourceInfo(e,t){return function(){var n=[],r=[],i={},a=e.composition().visualGroup,o=a.getAxes("retinal"),s=a.getDimensionMeasureMap(t);for(var c in s)({}).hasOwnProperty.call(s,c)&&(!i[c]&&(i[c]=[]),i[c]=[].concat(canvas_helper_toConsumableArray(new Set([].concat(canvas_helper_toConsumableArray(i[c]),canvas_helper_toConsumableArray(s[c]))))));return{dimensionMeasureMap:i,axes:{x:n=[].concat(canvas_helper_toConsumableArray(n),canvas_helper_toConsumableArray(a.getAxesByFacetKey("x",t))),y:r=[].concat(canvas_helper_toConsumableArray(r),canvas_helper_toConsumableArray(a.getAxesByFacetKey("y",t))),color:o.color,size:o.size,shape:o.shape},fields:{x:e.getFieldsFromChannel("x"),y:e.getFieldsFromChannel("y")}}}},xw=function getMarksFromIdentifiers(e,t){return function(n){var r=e.composition().visualGroup.getCellsByFacetKey(t);return r&&r[0]?r[0].valueOf().getPlotPointsFromIdentifiers(n):null}},ww="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),kw=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Sw=function(e){function GroupFireBolt(){return function canvas_firebolt_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,GroupFireBolt),function canvas_firebolt_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(GroupFireBolt.__proto__||Object.getPrototypeOf(GroupFireBolt)).apply(this,arguments))}return function canvas_firebolt_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(GroupFireBolt,ii),kw(GroupFireBolt,[{key:"dispatchBehaviour",value:function dispatchBehaviour(e,t){var n=Object.assign(t),r=n.criteria,i=this.context.data();n.action=e;var a=mn(i,r);return i.propagate(a,n,{sourceId:this.context.alias()}),this}},{key:"throwback",value:function throwback(e){var t=this;return this.context.getValueMatrix().each(function(t){t.valueOf().firebolt().throwback(e)}),e.registerChangeListener([C.ACTION_INF],function(n){var r=Cw(n,2)[1];if(null!==r){for(var i in r){var a=r[i].payload,o=r[i].sourceUnit;t.applySideEffects(i,a,o)}e.commit(C.ACTION_INF,null)}}),this}},{key:"applySideEffects",value:function applySideEffects(e,t,n){var r=this,i=t.sideEffects||this._behaviourEffectMap[e],a=this.context,o=a.layout().getViewInformation().viewMatricesInfo.matrices.center[1],s=a.composition().visualGroup,c=this._sourceSideEffects,l=s.findUnitById(n),u=this.sideEffects(),f=l&&l.facetByFields();i.forEach(function(i){var a=void 0,l=void 0;"object"===(void 0===i?"undefined":ww(i))?(l=i.name,a=i.strategy):l=i;var h=u[l];for(var d in h){var _=h[d],p=d.split(","),y=_.enabled,g=!0;f&&d&&!p.every(function(e){return-1!==f[1].indexOf(e)})&&(g=!c[i]),y&&g&&function(){var i=s.getCellsByFacetKey(d);if(o.some(function(e){return-1!==e.indexOf(i&&i[0])})){var c=r.getSelectionSetFromUnits(t.criteria,d,e)();t.sourceUnit=n,_.apply(c,t,a)}}()}})}},{key:"registerSideEffects",value:function registerSideEffects(e){for(var t in e)"visual-unit"!==e[t].target()&&(this._sideEffectDefinitions[e[t].formalName()]=e[t]);return this}},{key:"initializeSideEffects",value:function initializeSideEffects(){var e=void 0,t=!0,n=!0,r=this.context,i=this._sideEffectDefinitions,a=this._sideEffects,o=r.getFieldsFromChannel("x"),s=r.getFieldsFromChannel("y");if(o.length){var c=o[0][o[0].length-1].type();n=n&&(c===b.DIMENSION||c===v.TEMPORAL)}if(s.length){var l=s[0][s[0].length-1].type();t=t&&(l===b.DIMENSION||l===v.TEMPORAL)}for(var u in t?e=r.composition().visualGroup.getCells("row"):n&&(e=r.composition().visualGroup.getCells("col")),e)if({}.hasOwnProperty.call(e,u))for(var f in i)if({}.hasOwnProperty.call(i,f)){var h=i[f];!a[f]&&(a[f]={});var d=a[f][u]=new h(this);d.drawingContext(vw(r,u)),d.sourceInf(bw(r,u)),d.marksFromIdentifiers(xw(r,u))}return this}},{key:"getSelectionSetFromUnits",value:function getSelectionSetFromUnits(e,t,n){var r=this;return function(){var i=null;return function(){if(i)return i;var a=r.context.composition().visualGroup.getCellsByFacetKey(t).map(function(e){return e.valueOf()}),o=null;return null!==e&&a.forEach(function(e){var t=e.firebolt().getEntryExitSet(n);if(t){var r=t().entrySet.model;if(r&&o){var i=function concatModels(e,t){for(var n=e.getData(),r=t.getData(),i=n.data,a=r.data,o=n.schema,s=r.schema,c={},l={},u={},f=0;f<i.length;f++)for(var h=function _loop3(e){var t=i[f],n=a[e],r=t.filter(function(e,t){return o[t].type===b.DIMENSION}),h=n.filter(function(e,t){return s[t].type===b.DIMENSION});if(r.every(function(e){return-1!==h.indexOf(e)})){var d=r.join();!u[d]&&(u[d]={}),t.forEach(function(e,t){u[d][o[t].name]=e}),n.forEach(function(e,t){u[d][s[t].name]=e})}else{var _=r.join(),p=h.join();u[_]||u[p]||(!c[_]&&(c[_]={}),!l[p]&&(l[p]={}),t.forEach(function(e,t){c[_][o[t].name]=e}),n.forEach(function(e,t){l[p][s[t].name]=e}))}},d=0;d<a.length;d++)h(d);var _=[].concat(common_utils_toConsumableArray(o),common_utils_toConsumableArray(s.filter(function(e){return-1===o.findIndex(function(t){return t.name===e.name})})));return[[].concat(common_utils_toConsumableArray(Object.values(c)),common_utils_toConsumableArray(Object.values(l)),common_utils_toConsumableArray(Object.values(u))),_]}(r,o),a=Cw(i,2),s=a[0],c=a[1];o=new Fy(s,c)}else o=r}}),i={entrySet:{model:o}}}}}},{key:"disable",value:function disable(e){return mw(this.sideEffects(),e,!1),this}},{key:"enable",value:function enable(e){return mw(this.sideEffects(),e,!0),this}}]),GroupFireBolt}(),Mw={sideEffect:"individual"},Pw=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Ew=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function canvas_toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var Tw=function(e){function Canvas(e){!function canvas_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Canvas);var t=function canvas_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Canvas.__proto__||Object.getPrototypeOf(Canvas)).call(this));t._allOptions=Object.assign({},bb,dw),t._registry={},t._composition={},t._cachedProps={},t._alias=null,t._renderedResolve=null,t._renderedPromise=new Promise(function(e){t._renderedResolve=e}),t._layout=new hx,t._throwback=new nn(function canvas_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},C.ACTION_INF,null)),t._store=new nn({}),t.firebolt(new Sw(t,{behavioural:i},o,Na));var n=an(t,bb,t._store.model),r=Pw(n,2)[1];return an(t,dw,r),an(t,_w,r),t.dependencies(Object.assign({},e,t._dependencies)),t.alias("canvas-"+Ht()),t.title("",{}),t.subtitle("",{}),t.legend({}),t.setupChangeListener(),t}return function canvas_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Canvas,_x),Ew(Canvas,[{key:"layout",value:function layout(){return arguments.length?this:this._layout}},{key:"composition",value:function composition(){return arguments.length?(this._composition=arguments.length<=0?void 0:arguments[0],this):this._composition}},{key:"done",value:function done(){return this._renderedPromise}},{key:"alias",value:function alias(){if(arguments.length){var e=this.composition().visualGroup;return this._alias=arguments.length<=0?void 0:arguments[0],e&&e.alias(this.alias()),this}return this._alias}},{key:"firebolt",value:function firebolt(){return arguments.length?(this._firebolt=arguments.length<=0?void 0:arguments[0],this):this._firebolt}},{key:"registry",value:function registry(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length){var r=Object.assign({},t[0].components),i=Object.assign({},t[0].componentSubRegistry);this._registry={components:r,componentSubRegistry:i};var a=function initCanvas(e){return[new e._registry.components.VisualGroup(e._registry,e.dependencies())]}(this);return this.composition({visualGroup:a[0]}),this.composition().visualGroup.alias(this.alias()),this}return this._registry}},{key:"dependencies",value:function dependencies(){return arguments.length?(this._dependencies=arguments.length<=0?void 0:arguments[0],this):this._dependencies}},{key:"lifeCycle",value:function lifeCycle(e){var t=this.dependencies().lifeCycleManager;return e?(t.register(e),this):t}},{key:"headerHeight",value:function headerHeight(){return arguments.length>0?(this._headerHeight=arguments.length<=0?void 0:arguments[0],this):this._headerHeight}},{key:"legendComponents",value:function legendComponents(){return arguments.length>0?(this._legendComponents=arguments.length<=0?void 0:arguments[0],this):this._legendComponents}},{key:"once",value:function once(e){return this.dependencies().lifeCycleManager.retrieve(e)}},{key:"setupChangeListener",value:function setupChangeListener(){var e=this,t=this._store;t.registerImmediateListener("mount",function(){var n=Object.keys(e._allOptions),r=[].concat(canvas_toConsumableArray(n),canvas_toConsumableArray(Object.keys(_w)));t.registerChangeListener(r,function(){for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];!n.every(function(e,t){var n=function equalityChecker(){return!1};switch(e){case"rows":case"columns":n=cn("Array");break;case"shape":case"size":case"color":case"detail":n=cn("Object")}return!n(r[t][0],r[t][1])})&&function dispatchProps(e){var t=e.dependencies().lifeCycleManager;t.notify({client:e,action:"beforeupdate"});var n=e.composition().visualGroup;n.lockModel();var r=e._allOptions;for(var i in r){var a=e[i]();null!==a&&n[i]&&n[i](a)}n.unlockModel(),e._cachedProps={},t.notify({client:e,action:"initialized"}),t.notify({client:e,action:"updated"})}(e),e.render()},!0)})}},{key:"render",value:function render(){var e=this,t=this.mount(),n=this.dependencies().lifeCycleManager,r=this.resolve(),i=this.firebolt(),a=lw(this,t),o=a.components,s=a.layoutConfig,c=a.measurement;n.notify({client:this,action:"beforedraw"}),cw(this.layout(),o,s,c),gw(this,o,s,c),n.notify({client:this,action:"drawn"}),i.initializeSideEffects(),function resolveInteractionPolicy(e,t){var n=t.sideEffect,r=t.tooltip,i=e.firebolt();if("common"===n){i.enable(function(e){return e instanceof Ui});var a=i.sideEffects();e.getValueMatrix().each(function(e){return e.valueOf().firebolt().disable(function(e){return e instanceof Ui&&a[e.constructor.formalName()]})})}else n instanceof Function?n(e):i.disable();if("consolidated"===r){var o=i.sideEffects().tooltip;for(var s in o)o[s].enable();e.getValueMatrix().each(function(e){return e.valueOf().firebolt().sideEffects().tooltip.disable()})}else if("fragmented"===r){var c=i.sideEffects().tooltip;for(var l in c)c[l].disable();e.getValueMatrix().each(function(e){var t=e.valueOf().firebolt();t.enableSideEffectOnPropagation("tooltip"),t.sideEffects().tooltip.enable()})}else r instanceof Function&&r(e)}(this,function mergeInteractionPolicy(e){return hn(hn({},Mw),e)}(r||{})),i.throwback(this._throwback);var l=[];this.getValueMatrix().each(function(e){l.push(e.valueOf().done())}),Promise.all(l).then(function(){e._renderedResolve()})}},{key:"getPlaceholderDetails",value:function getPlaceholderDetails(){return this.composition().visualGroup.placeholderInfo()}},{key:"getCornerMatrices",value:function getCornerMatrices(){return this.composition().visualGroup.cornerMatrices()}},{key:"where",value:function where(e){return this.composition().visualGroup.where(e)}},{key:"getFieldsFromChannel",value:function getFieldsFromChannel(e){return this.composition().visualGroup.getFieldsFromChannel(e)}},{key:"xAxes",value:function xAxes(){return this.composition().visualGroup.getAxes("x")}},{key:"yAxes",value:function yAxes(){return this.composition().visualGroup.getAxes("y")}},{key:"getGroupMetaData",value:function getGroupMetaData(){return this.composition().visualGroup.metaData()}},{key:"getMatrixInstance",value:function getMatrixInstance(e){return this.composition().visualGroup.matrixInstance()[e]}},{key:"getRetinalAxes",value:function getRetinalAxes(){return this.composition().visualGroup.getAxes("retinal")}},{key:"getValueMatrix",value:function getValueMatrix(){return this.composition().visualGroup.matrixInstance().value}}],[{key:"withSettings",value:function withSettings(e,t,n){var r=new Canvas(n);for(var i in e)r[i](e[i]);return r.registry(t),r}},{key:"formalName",value:function formalName(){return"canvas"}}]),Canvas}(),Aw={VisualGroup:nv,VisualUnit:Rm},Ow={cellRegistry:Kx,layerRegistry:function(){var e=fp,t={set:function set(n,r){return e[n]=r,t},get:function get(){return e}};return t}},Nw=(n(36),function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function sliceIterator(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&s.return&&s.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),Rw={},Fw=Aw,Dw=function muze(){var e=an({},bb),t=Nw(e,2),n=t[0],r=t[1],i=Object.assign({},Aw),a=Object.assign(Ow),o={};for(var s in a)o[s]=a[s]();return n.canvas=function(){var e=r.serialize(),t=Tw.withSettings(e,{components:i,componentSubRegistry:o},n.globalDependencies());return function enableChainedTransaction(e,t,n){n.forEach(function(n){return e.on(n,function(e){var r=jt(e,2)[1];return t[n](r)})})}(r,t,Object.keys(e)),t},n.globalDependencies=function(){return Rw.smartlabel||(Rw.smartlabel=new g.a(1,"body")),{smartlabel:Rw.smartlabel,lifeCycleManager:new Xr}},n.settings=function(){return r.serialize()},n.registry=function(e){for(var t in e)t in Fw&&(i[t]=e[t]);return n},n},Lw=Object.assign({SurrogateSideEffect:Bi,SpawnableSideEffect:Ui},o);Dw.DataModel=Fy,Dw.pkg=Dy,Dw.SideEffects=Lw,Dw.ActionModel=vb,Dw.layerFactory=up,Dw.operators=_;t.default=Dw}])});
//# sourceMappingURL=muze.js.map