!function webpackUniversalModuleDefinition(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define("muze",[],factory):"object"==typeof exports?exports.muze=factory():root.muze=factory()}(window,function(){return function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function getDefault(){return module.default}:function getModuleExports(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=18)}([function(module,exports,__webpack_require__){(function(module){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}!function(e,t){"object"==_typeof(exports)&&"object"==_typeof(module)?module.exports=t():(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=t)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==_typeof(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e){e.exports=JSON.parse('{"name":"datamodel","description":"Relational algebra compliant in-memory tabular data store","homepage":"https://github.com/chartshq/datamodel","version":"2.3.1","license":"MIT","main":"dist/datamodel.js","keywords":["datamodel","data","relational","algebra","model","muze","fusioncharts","table","tabular","operation"],"author":"Muzejs.org (https://muzejs.org/)","repository":{"type":"git","url":"https://github.com/chartshq/datamodel.git"},"contributors":[{"name":"Akash Goswami","email":"akashgoswami90s@gmail.com"},{"name":"Subhash Haldar"},{"name":"Rousan Ali","email":"rousanali786@gmail.com","url":"https://rousan.io"},{"name":"Ujjal Kumar Dutta","email":"duttaujjalkumar@live.com"},{"name":"Ranajit Banerjee","email":"ranajit.113124@gmail.com"},{"name":"Adarsh Lilha","email":"adarshlilha@gmail.com"},{"name":"Swati Mukherjee","email":"swati020494@gmail.com"}],"dependencies":{"d3-dsv":"^1.0.8"},"devDependencies":{"babel-cli":"6.26.0","babel-core":"^6.26.3","babel-eslint":"6.1.2","babel-loader":"^7.1.4","babel-plugin-transform-runtime":"^6.23.0","babel-preset-env":"^1.7.0","babel-preset-es2015":"^6.24.1","babel-preset-flow":"^6.23.0","chai":"3.5.0","cross-env":"^5.0.5","eslint":"3.19.0","eslint-config-airbnb":"15.1.0","eslint-plugin-import":"2.7.0","eslint-plugin-jsx-a11y":"5.1.1","eslint-plugin-react":"7.3.0","istanbul-instrumenter-loader":"^3.0.0","jsdoc":"3.5.5","json2yaml":"^1.1.0","karma":"1.7.1","karma-chai":"0.1.0","karma-chrome-launcher":"2.1.1","karma-coverage-istanbul-reporter":"^1.3.0","karma-mocha":"1.3.0","karma-spec-reporter":"0.0.31","karma-webpack":"2.0.3","marked":"^0.5.0","mocha":"3.4.2","mocha-webpack":"0.7.0","transform-runtime":"0.0.0","webpack":"^4.12.0","webpack-cli":"^3.0.7","webpack-dev-server":"^3.1.4"},"scripts":{"test":"npm run lint && npm run ut","ut":"karma start karma.conf.js","utd":"karma start --single-run false --browsers Chrome karma.conf.js ","build":"npm run build:prod","build:dev":"webpack --mode development","build:prod":"webpack --mode production","start":"webpack-dev-server --config webpack.config.dev.js --mode development --open","lint":"eslint ./src","lint-errors":"eslint --quiet ./src","docs":"rm -rf yaml && mkdir yaml && jsdoc -c jsdoc.conf.json"}}')},function(e,t,n){var r=n(2);e.exports=r.default?r.default:r},function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"DataFormat",function(){return o}),n.d(r,"DimensionSubtype",function(){return u}),n.d(r,"MeasureSubtype",function(){return c}),n.d(r,"FieldType",function(){return f}),n.d(r,"FilteringMode",function(){return l}),n.d(r,"GROUP_BY_FUNCTIONS",function(){return s});var i={};n.r(i),n.d(i,"Dimension",function(){return Me}),n.d(i,"Measure",function(){return Le}),n.d(i,"FieldParser",function(){return Be}),n.d(i,"fieldRegistry",function(){return Nt}),n.d(i,"columnMajor",function(){return v});var a={};n.r(a),n.d(a,"sum",function(){return Zn}),n.d(a,"avg",function(){return $n}),n.d(a,"min",function(){return Qn}),n.d(a,"max",function(){return er}),n.d(a,"first",function(){return tr}),n.d(a,"last",function(){return nr}),n.d(a,"count",function(){return rr}),n.d(a,"sd",function(){return ir});var o={FLAT_JSON:"FlatJSON",DSV_STR:"DSVStr",DSV_ARR:"DSVArr",AUTO:"Auto"},u={CATEGORICAL:"categorical",TEMPORAL:"temporal",BINNED:"binned",ID:"__id"},c={CONTINUOUS:"continuous"},f={MEASURE:"measure",DIMENSION:"dimension"},l={NORMAL:"normal",INVERSE:"inverse",ALL:"all"},s={SUM:"sum",AVG:"avg",MIN:"min",MAX:"max",FIRST:"first",LAST:"last",COUNT:"count",STD:"std"};function p(e){return e instanceof Date?e:new Date(e)}function d(e){return e<10?"0"+e:e}function h(e){this.format=e,this.dtParams=void 0,this.nativeDate=void 0}RegExp.escape=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},h.TOKEN_PREFIX="%",h.DATETIME_PARAM_SEQUENCE={YEAR:0,MONTH:1,DAY:2,HOUR:3,MINUTE:4,SECOND:5,MILLISECOND:6},h.defaultNumberParser=function(e){return function(t){var n;return isFinite(n=parseInt(t,10))?n:e}},h.defaultRangeParser=function(e,t){return function(n){var r,i=void 0;if(!n)return t;var a=n.toLowerCase();for(i=0,r=e.length;i<r;i++)if(e[i].toLowerCase()===a)return i;return void 0===i?t:null}},h.getTokenDefinitions=function(){var e={short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],long:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},t={short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],long:["January","February","March","April","May","June","July","August","September","October","November","December"]};return{H:{name:"H",index:3,extract:function extract(){return"(\\d+)"},parser:h.defaultNumberParser(),formatter:function formatter(e){return p(e).getHours().toString()}},l:{name:"l",index:3,extract:function extract(){return"(\\d+)"},parser:h.defaultNumberParser(),formatter:function formatter(e){var t=p(e).getHours()%12;return(0===t?12:t).toString()}},p:{name:"p",index:3,extract:function extract(){return"(AM|PM)"},parser:function parser(e){return e?e.toLowerCase():null},formatter:function formatter(e){return p(e).getHours()<12?"AM":"PM"}},P:{name:"P",index:3,extract:function extract(){return"(am|pm)"},parser:function parser(e){return e?e.toLowerCase():null},formatter:function formatter(e){return p(e).getHours()<12?"am":"pm"}},M:{name:"M",index:4,extract:function extract(){return"(\\d+)"},parser:h.defaultNumberParser(),formatter:function formatter(e){return d(p(e).getMinutes())}},S:{name:"S",index:5,extract:function extract(){return"(\\d+)"},parser:h.defaultNumberParser(),formatter:function formatter(e){return d(p(e).getSeconds())}},K:{name:"K",index:6,extract:function extract(){return"(\\d+)"},parser:h.defaultNumberParser(),formatter:function formatter(e){return p(e).getMilliseconds().toString()}},a:{name:"a",index:2,extract:function extract(){return"("+e.short.join("|")+")"},parser:h.defaultRangeParser(e.short),formatter:function formatter(t){var n=p(t).getDay();return e.short[n].toString()}},A:{name:"A",index:2,extract:function extract(){return"("+e.long.join("|")+")"},parser:h.defaultRangeParser(e.long),formatter:function formatter(t){var n=p(t).getDay();return e.long[n].toString()}},e:{name:"e",index:2,extract:function extract(){return"(\\d+)"},parser:h.defaultNumberParser(),formatter:function formatter(e){return p(e).getDate().toString()}},d:{name:"d",index:2,extract:function extract(){return"(\\d+)"},parser:h.defaultNumberParser(),formatter:function formatter(e){return d(p(e).getDate())}},b:{name:"b",index:1,extract:function extract(){return"("+t.short.join("|")+")"},parser:h.defaultRangeParser(t.short),formatter:function formatter(e){var n=p(e).getMonth();return t.short[n].toString()}},B:{name:"B",index:1,extract:function extract(){return"("+t.long.join("|")+")"},parser:h.defaultRangeParser(t.long),formatter:function formatter(e){var n=p(e).getMonth();return t.long[n].toString()}},m:{name:"m",index:1,extract:function extract(){return"(\\d+)"},parser:function parser(e){return h.defaultNumberParser()(e)-1},formatter:function formatter(e){return d(p(e).getMonth()+1)}},y:{name:"y",index:0,extract:function extract(){return"(\\d{2})"},parser:function parser(e){var t=void 0;if(e){var n=e.length;e=e.substring(n-2,n)}var r=h.defaultNumberParser()(e),i=new Date,a=Math.trunc(i.getFullYear()/100);return p(t=""+a+r).getFullYear()>i.getFullYear()&&(t=""+(a-1)+r),p(t).getFullYear()},formatter:function formatter(e){var t=p(e).getFullYear().toString(),n=void 0;return t&&(n=t.length,t=t.substring(n-2,n)),t}},Y:{name:"Y",index:0,extract:function extract(){return"(\\d{4})"},parser:h.defaultNumberParser(),formatter:function formatter(e){return p(e).getFullYear().toString()}}}},h.getTokenFormalNames=function(){var e=h.getTokenDefinitions();return{HOUR:e.H,HOUR_12:e.l,AMPM_UPPERCASE:e.p,AMPM_LOWERCASE:e.P,MINUTE:e.M,SECOND:e.S,SHORT_DAY:e.a,LONG_DAY:e.A,DAY_OF_MONTH:e.e,DAY_OF_MONTH_CONSTANT_WIDTH:e.d,SHORT_MONTH:e.b,LONG_MONTH:e.B,MONTH_OF_YEAR:e.m,SHORT_YEAR:e.y,LONG_YEAR:e.Y}},h.tokenResolver=function(){var e=h.getTokenDefinitions(),t=function t(){for(var e=0,t=void 0,n=void 0,r=arguments.length;e<r;e++)t=arguments.length<=e?void 0:arguments[e],(arguments.length<=e?void 0:arguments[e])&&(n=t);return n?n[0].parser(n[1]):null};return{YEAR:[e.y,e.Y,t],MONTH:[e.b,e.B,e.m,t],DAY:[e.a,e.A,e.e,e.d,t],HOUR:[e.H,e.l,e.p,e.P,function(e,t,n,r){var i=void 0,a=void 0,o=void 0,u=void 0;return t&&(a=n||r)?("pm"===a[0].parser(a[1])&&(o=!0),i=t):i=t||e,i?(u=i[0].parser(i[1]),o&&(u+=12),u):null}],MINUTE:[e.M,t],SECOND:[e.S,t]}},h.findTokens=function(e){for(var t=h.TOKEN_PREFIX,n=h.getTokenDefinitions(),r=Object.keys(n),i=[],a=void 0,o=void 0;(a=e.indexOf(t,a+1))>=0;)o=e[a+1],-1!==r.indexOf(o)&&i.push({index:a,token:o});return i},h.formatAs=function(e,t){var n,r=p(e),i=h.findTokens(t),a=h.getTokenDefinitions(),o=String(t),u=h.TOKEN_PREFIX,c=void 0,f=void 0,l=void 0;for(l=0,n=i.length;l<n;l++)f=a[c=i[l].token].formatter(r),o=o.replace(new RegExp(u+c,"g"),f);return o},h.prototype.parse=function(e,t){var n=h.tokenResolver(),r=this.extractTokenValue(e),i=h.DATETIME_PARAM_SEQUENCE,a=t&&t.noBreak,o=[],u=[],c=void 0,f=void 0,l=void 0,s=void 0,p=void 0,d=void 0,v=void 0,y=void 0,m=[];for(c in n)if({}.hasOwnProperty.call(n,c)){for(u.length=0,l=(f=n[c]).splice(f.length-1,1)[0],p=0,y=f.length;p<y;p++)void 0===(s=r[(d=f[p]).name])?u.push(null):u.push([d,s]);if(null==(v=l.apply(this,u))&&!a)break;o[i[c]]=v}return o.length&&this.checkIfOnlyYear(o.length)?m.unshift(o[0],0,1):m.unshift.apply(m,o),m},h.prototype.extractTokenValue=function(e){var t,n=this.format,r=h.getTokenDefinitions(),i=h.TOKEN_PREFIX,a=h.findTokens(n),o={},u=void 0,c=void 0,f=void 0,l=void 0,s=void 0,p=void 0;s=String(n);var d=a.map(function(e){return e.token}),v=a.length;for(p=v-1;p>=0;p--)(f=a[p].index)+1!==s.length-1?(void 0===u&&(u=s.length),l=s.substring(f+2,u),s=s.substring(0,f+2)+RegExp.escape(l)+s.substring(u,s.length),u=f):u=f;for(p=0;p<v;p++)c=a[p],s=s.replace(i+c.token,r[c.token].extract());var y=e.match(new RegExp(s))||[];for(y.shift(),p=0,t=d.length;p<t;p++)o[d[p]]=y[p];return o},h.prototype.getNativeDate=function(e){var t=null;if(Number.isFinite(e))t=new Date(e);else if(!this.format&&Date.parse(e))t=new Date(e);else{var n=this.dtParams=this.parse(e);n.length&&(this.nativeDate=new(Function.prototype.bind.apply(Date,[null].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n)))),t=this.nativeDate)}return t},h.prototype.checkIfOnlyYear=function(e){return 1===e&&this.format.match(/y|Y/g).length},h.prototype.formatAs=function(e,t){var n=void 0;return t?n=this.nativeDate=this.getNativeDate(t):(n=this.nativeDate)||(n=this.getNativeDate(t)),h.formatAs(n,e)};var v=function v(e){var t=0;return function(){for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];r.forEach(function(n,r){e[r]instanceof Array||(e[r]=Array.from({length:t})),e[r].push(n)}),t++}},y="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)},m=Object.prototype.toString;function b(e,t){for(var n=t.length,r=-1;n;){if(e===t[n])return n;n-=1}return r}function g(e,t,n){return"object"!==(void 0===e?"undefined":y(e))&&"object"!==(void 0===t?"undefined":y(t))?null:"object"!==(void 0===t?"undefined":y(t))||null===t?e:("object"!==(void 0===e?"undefined":y(e))&&(e=t instanceof Array?[]:{}),function e(t,n,r,i,a){var o,u,c,f,l;if(a?(i.push(t),a.push(n)):(i=[t],a=[n]),n instanceof Array)for(o=0;o<n.length;o+=1){try{u=t[o],c=n[o]}catch(e){continue}"object"!==(void 0===c?"undefined":y(c))?r&&void 0===c||(t[o]=c):(null!==u&&"object"===(void 0===u?"undefined":y(u))||(u=t[o]=c instanceof Array?[]:{}),-1!==(l=b(c,a))?u=t[o]=i[l]:e(u,c,r,i,a))}else for(o in n){try{u=t[o],c=n[o]}catch(e){continue}if(null!==c&&"object"===(void 0===c?"undefined":y(c)))"[object Object]"===(f=m.call(c))?(null!==u&&"object"===(void 0===u?"undefined":y(u))||(u=t[o]={}),-1!==(l=b(c,a))?u=t[o]=i[l]:e(u,c,r,i,a)):"[object Array]"===f?(null!==u&&u instanceof Array||(u=t[o]=[]),-1!==(l=b(c,a))?u=t[o]=i[l]:e(u,c,r,i,a)):t[o]=c;else{if(r&&void 0===c)continue;t[o]=c}}return t}(e,t,n),e)}function _(e){return Array.isArray(e)}var w=function w(){return"id-"+(new Date).getTime()+Math.round(1e4*Math.random())};function O(e,t){if(!_(e)||!_(t))return e===t;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function E(e){return e}var j=function j(e){return"string"==typeof e?o.DSV_STR:_(e)&&_(e[0])?o.DSV_ARR:_(e)&&(0===e.length||function(e){return e===Object(e)}(e[0]))?o.FLAT_JSON:null},A={data:{},createNamespace:function createNamespace(e,t,n){var r=t||w();return this.data[r]={name:r,fields:e,idField:n,fieldsObj:function fieldsObj(){var e=this._cachedFieldsObj;return e||(e=this._cachedFieldsObj={},this.fields.forEach(function(t){e[t.name()]=t})),e},getMeasure:function getMeasure(){var e=this._cachedMeasure;return e||(e=this._cachedMeasure={},this.fields.forEach(function(t){t.schema().type===f.MEASURE&&(e[t.name()]=t)})),e},getDimension:function getDimension(){var e=this._cachedDimension;return this._cachedDimension||(e=this._cachedDimension={},this.fields.forEach(function(t){t.schema().type===f.DIMENSION&&(e[t.name()]=t)})),e}},this.data[r]}},k=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),D=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i=Bn(r,t);Object.defineProperties(this,{_value:{enumerable:!1,configurable:!1,writable:!1,value:t},_formattedValue:{enumerable:!1,configurable:!1,writable:!1,value:i},_internalValue:{enumerable:!1,configurable:!1,writable:!1,value:n}}),this.field=r}return k(e,[{key:"toString",value:function value(){return String(this.value)}},{key:"valueOf",value:function value(){return this.value}},{key:"value",get:function get(){return this._value}},{key:"formattedValue",get:function get(){return this._formattedValue}},{key:"internalValue",get:function get(){return this._internalValue}}]),e}();function S(e,t){e.length>0&&e.split(",").forEach(function(e){var n=e.split("-"),r=+n[0],i=+(n[1]||n[0]);if(i>=r)for(var a=r;a<=i;a+=1)t(a)})}var F=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),N=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._value=t}return F(e,null,[{key:"invalidAwareVals",value:function value(t){return t?Object.assign(e._invalidAwareValsMap,t):e._invalidAwareValsMap}}]),F(e,[{key:"value",value:function value(){return this._value}},{key:"toString",value:function value(){return String(this._value)}}],[{key:"isInvalid",value:function value(t){return t instanceof e||!!e.invalidAwareVals()[t]}},{key:"getInvalidType",value:function value(t){return t instanceof e?t:e.invalidAwareVals()[t]}}]),e}();N.NULL=new N("null"),N.NA=new N("na"),N.NIL=new N("nil"),N._invalidAwareValsMap={invalid:N.NA,nil:N.NIL,null:N.NULL,undefined:N.NA};var T=N,P=function P(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};var C="__id__",M={SELECT:"select",PROJECT:"project",GROUPBY:"group",COMPOSE:"compose",CAL_VAR:"calculatedVariable",BIN:"bin",SORT:"sort"},R="cross",x="leftOuter",U="rightOuter";function B(e,t){var n=[],r=[];return e.fields.forEach(function(e){r.push(e.schema().name)}),t.fields.forEach(function(e){-1!==r.indexOf(e.schema().name)&&n.push(e.schema().name)}),n}function Y(){return!0}function H(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:R,a=[],o=[],u=n||Y,c=e.getFieldspace(),f=t.getFieldspace(),l=c.name,s=f.name,p=c.name+"."+f.name,d=B(c,f);if(l===s)throw new Error("DataModels must have different alias names");return c.fields.forEach(function(e){var t=g({},e.schema());-1===d.indexOf(t.name)||r||(t.name=c.name+"."+t.name),a.push(t)}),f.fields.forEach(function(e){var t=g({},e.schema());-1!==d.indexOf(t.name)?r||(t.name=f.name+"."+t.name,a.push(t)):a.push(t)}),S(e._rowDiffset,function(n){var p=!1,h=void 0;S(t._rowDiffset,function(v){var y=[],m={};m[l]={},m[s]={},c.fields.forEach(function(e){y.push(e.partialField.data[n]),m[l][e.name()]={rawValue:e.partialField.data[n],formattedValue:e.formattedData()[n]}}),f.fields.forEach(function(e){-1!==d.indexOf(e.schema().name)&&r||y.push(e.partialField.data[v]),m[s][e.name()]={rawValue:e.partialField.data[v],formattedValue:e.formattedData()[v]}});var b=fn(m[l]),g=fn(m[s]);if(u(b,g,function(){return e.detachedRoot()},function(){return t.detachedRoot()},{})){var _={};y.forEach(function(e,t){_[a[t].name]=e}),p&&R!==i?o[h]=_:(o.push(_),p=!0,h=n)}else if((i===x||i===U)&&!p){var w={},O=c.fields.length-1;y.forEach(function(e,t){w[a[t].name]=t<=O?e:null}),p=!0,h=n,o.push(w)}})}),new qn(o,a,{name:p})}function J(e,t){var n=""+e,r=""+t;return n<r?-1:n>r?1:0}function z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J;return e.length>1&&function G(e,t,n,r){if(n===t)return e;var i=t+Math.floor((n-t)/2);return G(e,t,i,r),G(e,i+1,n,r),function(e,t,n,r,i){for(var a=e,o=[],u=t;u<=r;u+=1)o[u]=a[u];for(var c=t,f=n+1,l=t;l<=r;l+=1)c>n?(a[l]=o[f],f+=1):f>r?(a[l]=o[c],c+=1):i(o[c],o[f])<=0?(a[l]=o[c],c+=1):(a[l]=o[f],f+=1)}(e,t,i,n,r),e}(e,0,e.length-1,t),e}var Q,K=function K(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function W(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function X(e,t){var n="desc"===String(t).toLowerCase()?"desc":"asc";return function(e,t){var n=void 0;switch(e){case c.CONTINUOUS:case u.TEMPORAL:n="asc"===t?function(e,t){return e-t}:function(e,t){return t-e};break;default:n="asc"===t?function(e,t){return(e=""+e)==(t=""+t)?0:e>t?1:-1}:function(e,t){return(e=""+e)==(t=""+t)?0:e>t?-1:1}}return n}(e.type,n)}function q(e,t){var n=new Map,r=[];return e.forEach(function(e){var i=e[t];n.has(i)?r[n.get(i)][1].push(e):(r.push([i,[e]]),n.set(i,r.length-1))}),r}function Z(e,t,n){var r={label:e[0]};return t.reduce(function(t,r,i){return t[r]=e[1].map(function(e){return e[n[i].index]}),t},r),r}function $(e,t,n){for(var r=void 0,i=void 0,a=void 0,o=n.length-1;o>=0;o--)r=n[o][0],i=n[o][1],(a=Pn(t,r))&&("function"==typeof i?z(e,function(e,t){return i(e[a.index],t[a.index])}):_(i)?function(){var n=q(e,a.index),r=i[i.length-1],o=i.slice(0,i.length-1),u=o.map(function(e){return Pn(t,e)});n.forEach(function(e){e.push(Z(e,o,u))}),z(n,function(e,t){var n=e[2],i=t[2];return r(n,i)}),e.length=0,n.forEach(function(t){e.push.apply(e,W(t[1]))})}():function(){var t=X(a,i);z(e,function(e,n){return t(e[a.index],n[a.index])})}())}function te(e,t,n,r,i){var a=e.fields,o=e.idField.data(),c={schema:[],data:[],uids:[]},l=(i=Object.assign({},{addUid:!1,columnWise:!1},i)).addUid,s=r&&r.length>0,p=[];if(n.split(",").forEach(function(e){for(var t=0;t<a.length;t+=1)if(a[t].name()===e){p.push(a[t]);break}}),p.forEach(function(e){c.schema.push(e.schema())}),l&&c.schema.push({name:C,type:f.DIMENSION,subtype:u.ID}),S(t,function(e){c.data.push([]);var t=c.data.length-1;p.forEach(function(n,r){c.data[t][r+0]=n.partialField.data[e]}),l&&(c.data[t][p.length]=o[e]),c.uids.push(o[e]),s&&c.data[t].push(o[e])}),s&&function(e,t){var n=e.schema,r=e.data;if(0!==(t=t.filter(function(e){return!!Pn(n,e[0])})).length){var i=t.findIndex(function(e){return null===e[1]});i=-1!==i?i:t.length;var a=t.slice(0,i),o=t.slice(i);$(r,n,a),r=function ee(e,t,n,r){if(0===(n=n.filter(function(e){return null!==e[1]||(r.push(e[0]),!1)})).length)return e;var i=function e(t,n,r,i){if(0===t.length)return n;var a=t[0],o=new Map;n.reduce(function(e,t){var n=t[a.index];return e.has(n)?e.get(n).push(t):e.set(n,[t]),e},o);var u=!0,c=!1,f=void 0;try{for(var l,s=o[Symbol.iterator]();!(u=(l=s.next()).done);u=!0){var p=l.value,d=K(p,2),h=d[0],v=d[1],y=e(t.slice(1),v,r,i);o.set(h,y),Array.isArray(y)&&$(y,r,i)}}catch(e){c=!0,f=e}finally{try{!u&&s.return&&s.return()}finally{if(c)throw f}}return o}(r=r.map(function(e){return Pn(t,e)}),e,t,n);return e.map(function(e){for(var t=0,n=i;!Array.isArray(n);)n=n.get(e[r[t++].index]);return n.shift()})}(r,n,o,a.map(function(e){return e[0]})),e.uids=r.map(function(e){return e.pop()}),e.data=r}}(c,r),i.columnWise){var d=Array.apply(void 0,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array(c.schema.length))).map(function(){return[]});c.data.forEach(function(e){e.forEach(function(e,t){d[t].push(e)})}),c.data=d}return c}function ne(e,t){var n={},r=[],i=[],a=[],o=e.getFieldspace(),u=t.getFieldspace(),c=o.fieldsObj(),f=u.fieldsObj(),l=o.name+" union "+u.name;if(!O(e._colIdentifier.split(",").sort(),t._colIdentifier.split(",").sort()))return null;function s(e,t,r){S(e._rowDiffset,function(e){var o={},u="";i.forEach(function(n){var r=t[n].partialField.data[e];u+="-"+r,o[n]=r}),n[u]||(r&&a.push(o),n[u]=!0)})}return e._colIdentifier.split(",").forEach(function(e){var t=c[e];r.push(g({},t.schema())),i.push(t.schema().name)}),s(t,f,!1),s(e,c,!0),new qn(a,r,{name:l})}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ie(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var ae=s.SUM,oe=s.AVG,ue=s.FIRST,ce=s.LAST,fe=s.COUNT,le=s.STD,se=s.MIN,pe=s.MAX;function de(e){return e.filter(function(e){return!(e instanceof T)})}function he(e){if(_(e)&&!(e[0]instanceof Array)){var t=de(e);return t.length?t.reduce(function(e,t){return e+t},0):T.NULL}return T.NULL}function ve(e){if(_(e)&&!(e[0]instanceof Array)){var t=he(e),n=e.length||1;return Number.isNaN(t)||t instanceof T?T.NULL:t/n}return T.NULL}var ge,ye=(re(Q={},ae,he),re(Q,oe,ve),re(Q,se,function(e){if(_(e)&&!(e[0]instanceof Array)){var t=de(e);return t.length?Math.min.apply(Math,ie(t)):T.NULL}return T.NULL}),re(Q,pe,function(e){if(_(e)&&!(e[0]instanceof Array)){var t=de(e);return t.length?Math.max.apply(Math,ie(t)):T.NULL}return T.NULL}),re(Q,ue,function(e){return e[0]}),re(Q,ce,function(e){return e[e.length-1]}),re(Q,fe,function(e){return _(e)?e.length:T.NULL}),re(Q,le,function(e){return Math.sqrt(function(e){var t=ve(e);return ve(e.map(function(e){return Math.pow(e-t,2)}))}(e))}),Q),me=ae,be=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_e=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=new Map,this.store.set("defReducer",he),Object.entries(ye).forEach(function(e){t.store.set(e[0],e[1])})}return be(e,[{key:"defaultReducer",value:function value(){if(!arguments.length)return this.store.get("defReducer");var e=arguments.length<=0?void 0:arguments[0];if("function"==typeof e)this.store.set("defReducer",e);else{if(e=String(e),-1===Object.keys(ye).indexOf(e))throw new Error("Reducer "+e+" not found in registry");this.store.set("defReducer",ye[e])}return this}},{key:"register",value:function value(e,t){var n=this;if("function"!=typeof t)throw new Error("Reducer should be a function");return e=String(e),this.store.set(e,t),function(){n.__unregister(e)}}},{key:"__unregister",value:function value(e){this.store.has(e)&&this.store.delete(e)}},{key:"resolve",value:function value(e){return e instanceof Function?e:this.store.get(e)}}]),e}(),we=(null===(ge=null)&&(ge=new _e),ge),Oe=function Oe(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function je(e,t){var n=B(e.getFieldspace(),t.getFieldspace());return function(e,t){var r=!0;return n.forEach(function(n){r=!(e[n].internalValue!==t[n].internalValue||!r)}),r}}function Ae(e,t){var n={},r=[],i=[],a=[],o=e.getFieldspace(),u=t.getFieldspace(),c=o.fieldsObj(),f=u.fieldsObj(),l=o.name+" union "+u.name;if(!O(e._colIdentifier.split(",").sort(),t._colIdentifier.split(",").sort()))return null;function s(e,t){S(e._rowDiffset,function(e){var r={},o="";i.forEach(function(n){var i=t[n].partialField.data[e];o+="-"+i,r[n]=i}),n[o]||(a.push(r),n[o]=!0)})}return e._colIdentifier.split(",").forEach(function(e){var t=c[e];r.push(g({},t.schema())),i.push(t.schema().name)}),s(e,c),s(t,f),new ur(a,r,{name:l})}function ke(e,t,n){return H(e,t,n,!1,x)}function De(e,t,n){return H(t,e,n,!1,U)}var Se=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Fe=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.name=t,this.schema=r,this.parser=i,this.data=this._sanitize(n)}return Se(e,[{key:"_sanitize",value:function value(e){var t=this;return e.map(function(e){return t.parser.parse(e,{format:t.schema.format})})}}]),e}(),Ne=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Te=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.partialField=t,this.rowDiffset=n}return Ne(e,[{key:"domain",value:function value(){throw new Error("Not yet implemented")}},{key:"schema",value:function value(){return this.partialField.schema}},{key:"name",value:function value(){return this.partialField.name}},{key:"type",value:function value(){return this.partialField.schema.type}},{key:"subtype",value:function value(){return this.partialField.schema.subtype}},{key:"description",value:function value(){return this.partialField.schema.description}},{key:"displayName",value:function value(){return this.partialField.schema.displayName||this.partialField.schema.name}},{key:"data",value:function value(){var e=this,t=[];return S(this.rowDiffset,function(n){t.push(e.partialField.data[n])}),t}},{key:"formattedData",value:function value(){throw new Error("Not yet implemented")}}],[{key:"parser",value:function value(){throw new Error("Not yet implemented")}},{key:"BUILDER",get:function get(){return{_params:{},_context:this,fieldName:function fieldName(e){return this._params.name=e,this},schema:function schema(e){return this._params.schema=e,this},data:function data(e){return this._params.data=e,this},partialField:function partialField(e){return this._params.partialField=e,this},rowDiffset:function rowDiffset(e){return this._params.rowDiffset=e,this},build:function build(){var e=null;if(this._params.partialField instanceof Fe)e=this._params.partialField;else{if(!this._params.schema||!this._params.data)throw new Error("Invalid Field parameters");e=new Fe(this._params.name,this._params.data,this._params.schema,this._context.parser())}return new this._context(e,this._params.rowDiffset)}}}}]),e}(),Pe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Me=function(e){function t(){return function Ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function Ce(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Te),Pe(t,[{key:"domain",value:function value(){return this._cachedDomain||(this._cachedDomain=this.calculateDataDomain()),this._cachedDomain}},{key:"calculateDataDomain",value:function value(){throw new Error("Not yet implemented")}},{key:"formattedData",value:function value(){return this.data()}}]),t}(),Re=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Le=function(e){function t(){return function xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function Ue(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Te),Re(t,[{key:"domain",value:function value(){return this._cachedDomain||(this._cachedDomain=this.calculateDataDomain()),this._cachedDomain}},{key:"unit",value:function value(){return this.partialField.schema.unit}},{key:"defAggFn",value:function value(){return this.partialField.schema.defAggFn||me}},{key:"numberFormat",value:function value(){var e=this.partialField.schema.numberFormat;return e instanceof Function?e:E}},{key:"calculateDataDomain",value:function value(){throw new Error("Not yet implemented")}},{key:"formattedData",value:function value(){return this.data()}}]),t}(),Ve=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Be=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return Ve(e,[{key:"parse",value:function value(){throw new Error("Not yet implemented")}}]),e}(),Ye=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Ge=function(e){function t(){return function He(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function Je(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Be),Ye(t,[{key:"parse",value:function value(e){return T.isInvalid(e)?T.getInvalidType(e):String(e).trim()}}]),t}(),ze=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Xe=function(e){function t(){return function Ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function We(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Me),ze(t,[{key:"subtype",value:function value(){return u.CATEGORICAL}},{key:"calculateDataDomain",value:function value(){var e=this,t=new Set,n=[];return S(this.rowDiffset,function(r){var i=e.partialField.data[r];t.has(i)||(t.add(i),n.push(i))}),n}}],[{key:"parser",value:function value(){return new Ge}}]),t}(),qe=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Qe=function(e){function t(){return function Ze(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function $e(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Be),qe(t,[{key:"parse",value:function value(e,t){var n=t.format,r=void 0;if(this._dtf||(this._dtf=new h(n)),T.isInvalid(e))r=T.getInvalidType(e);else{var i=this._dtf.getNativeDate(e);r=i?i.getTime():T.NA}return r}}]),t}(),et=function et(e,t){var n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return S(t,function(t){var i=e[t];i instanceof T||(i<n&&(n=i),i>r&&(r=i))}),[n,r]},tt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),nt=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return r._cachedMinDiff=null,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Me),tt(t,[{key:"calculateDataDomain",value:function value(){return et(this.partialField.data,this.rowDiffset)}},{key:"minimumConsecutiveDifference",value:function value(){if(this._cachedMinDiff)return this._cachedMinDiff;for(var e=this.data().filter(function(e){return!(e instanceof T)}).sort(function(e,t){return e-t}),t=e.length,n=Number.POSITIVE_INFINITY,r=void 0,i=void 0,a=0,o=1;o<t;o++)r=e[o-1],(i=e[o])!==r&&(n=Math.min(n,i-e[o-1]),a++);return a||(n=null),this._cachedMinDiff=n,this._cachedMinDiff}},{key:"format",value:function value(){return this.partialField.schema.format}},{key:"formattedData",value:function value(){var e=this,t=[],n=this.format();return S(this.rowDiffset,function(r){var i=e.partialField.data[r];if(T.isInvalid(i)||!n&&Number.isFinite(i)){var a=T.getInvalidType(i)||i;t.push(a)}else t.push(h.formatAs(i,n))}),t}}],[{key:"parser",value:function value(){return new Qe}}]),t}(),rt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ot=function(e){function t(){return function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function at(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Be),rt(t,[{key:"parse",value:function value(e){e=String(e);var t=void 0;if(T.isInvalid(e))t=T.getInvalidType(e);else{var n=e.match(/^\s*([+-]?\d+(?:\.\d+)?)\s*-\s*([+-]?\d+(?:\.\d+)?)\s*$/);t=n?Number.parseFloat(n[1])+"-"+Number.parseFloat(n[2]):T.NA}return t}}]),t}(),ut=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var lt=function(e){function t(){return function ct(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function ft(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Me),ut(t,[{key:"calculateDataDomain",value:function value(){var e=this.partialField.schema.bins;return[e[0],e[e.length-1]]}},{key:"bins",value:function value(){return this.partialField.schema.bins}}],[{key:"parser",value:function value(){return new ot}}]),t}(),st=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var ht=function(e){function t(){return function pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function dt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Be),st(t,[{key:"parse",value:function value(e){var t=void 0;if(T.isInvalid(e))t=T.getInvalidType(e);else{var n=parseFloat(e,10);t=Number.isNaN(n)?T.NA:n}return t}}]),t}(),vt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var bt=function(e){function t(){return function yt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function mt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Le),vt(t,[{key:"subtype",value:function value(){return c.CONTINUOUS}},{key:"calculateDataDomain",value:function value(){return et(this.partialField.data,this.rowDiffset)}}],[{key:"parser",value:function value(){return new ht}}]),t}(),gt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function wt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Ot=function(){function e(t){wt(this,e);var n=t instanceof Array?t.map(Number):[Number(t)];return this._val=new Set(n),this._hash=n[0],this._valArr=n,this}return gt(e,[{key:"toString",value:function value(){return this._hash}},{key:"values",value:function value(){return this._valArr}}]),e}(),Et=function(e){function t(){return wt(this,t),function _t(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Be),gt(t,[{key:"parse",value:function value(e){return new Ot(e instanceof Ot?e.values():e)}}]),t}(),jt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Dt=function(e){function t(){return function At(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function kt(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Xe),jt(t,[{key:"subtype",value:function value(){return u.ID}}],[{key:"parser",value:function value(){return new Et}}]),t}(),St=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ft=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._fieldType=new Map}return St(e,[{key:"registerFieldType",value:function value(e,t){return this._fieldType.set(e,t),this}},{key:"has",value:function value(e){return this._fieldType.has(e)}},{key:"get",value:function value(e){return this._fieldType.get(e)}}]),e}(),Nt=function(){var e=null;return e||(function(e){e.registerFieldType(u.CATEGORICAL,Xe).registerFieldType(u.ID,Dt).registerFieldType(u.TEMPORAL,nt).registerFieldType(u.BINNED,lt).registerFieldType(c.CONTINUOUS,bt)}(e=new Ft),e)}();function Tt(e,t,n){var r={};return n&&n.length||(n=t.map(function(e){return e.name})),n.forEach(function(e,t){r[e]=t}),t.map(function(t){return function(e,t){return e=e||[],Nt.has(t.subtype)?Nt.get(t.subtype).BUILDER.fieldName(t.name).schema(t).data(e).rowDiffset("0-"+(e.length-1)).build():Nt.get(t.type===f.MEASURE?c.CONTINUOUS:u.CATEGORICAL).BUILDER.fieldName(t.name).schema(t).data(e).rowDiffset("0-"+(e.length-1)).build()}(e[r[t.name]],t)})}var Pt={dataFormat:o.AUTO},It=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Ct=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._type=t}return It(e,[{key:"convert",value:function value(){throw new Error("Convert method not implemented.")}},{key:"type",get:function get(){return this._type}}]),e}(),Mt={},Rt={};function xt(e){return new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function Ut(e){var t=Object.create(null),n=[];return e.forEach(function(e){for(var r in e)r in t||n.push(t[r]=r)}),n}function Lt(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}var tn,nn,Bt=function Bt(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],a=e.length,o=0,u=0,c=a<=0,f=!1;function l(){if(c)return Rt;if(f)return f=!1,Mt;var t,r,i=o;if(34===e.charCodeAt(i)){for(;o++<a&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=a?c=!0:10===(r=e.charCodeAt(o++))?f=!0:13===r&&(f=!0,10===e.charCodeAt(o)&&++o),e.slice(i+1,t-1).replace(/""/g,'"')}for(;o<a;){if(10===(r=e.charCodeAt(t=o++)))f=!0;else if(13===r)f=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(i,t)}return c=!0,e.slice(i,a)}for(10===e.charCodeAt(a-1)&&--a,13===e.charCodeAt(a-1)&&--a;(r=l())!==Rt;){for(var s=[];r!==Mt&&r!==Rt;)s.push(r),r=l();t&&null==(s=t(s,u++))||i.push(s)}return i}function i(t,n){return t.map(function(t){return n.map(function(e){return o(t[e])}).join(e)})}function a(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?function Vt(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),a=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Lt(-t,6):t>9999?"+"+Lt(t,6):Lt(t,4))+"-"+Lt(e.getUTCMonth()+1,2)+"-"+Lt(e.getUTCDate(),2)+(a?"T"+Lt(n,2)+":"+Lt(r,2)+":"+Lt(i,2)+"."+Lt(a,3)+"Z":i?"T"+Lt(n,2)+":"+Lt(r,2)+":"+Lt(i,2)+"Z":r||n?"T"+Lt(n,2)+":"+Lt(r,2)+"Z":"")}(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function parse(e,t){var n,i,a=r(e,function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=xt(e);return function(r,i){return t(n(r),i,e)}}(e,t):xt(e)});return a.columns=i||[],a},parseRows:r,format:function format(t,n){return null==n&&(n=Ut(t)),[n.map(o).join(e)].concat(i(t,n)).join("\n")},formatBody:function formatBody(e,t){return null==t&&(t=Ut(e)),i(e,t).join("\n")},formatRows:function formatRows(e){return e.map(a).join("\n")},formatRow:a,formatValue:o}},Yt=function Yt(e,t,n){if(!Array.isArray(t))throw new Error("Schema missing or is in an unsupported format");var r=t.map(function(e){return e.name});n=Object.assign({},{firstRowHeader:!0},n);var i=[],a=v(i),o=r;n.firstRowHeader&&(o=e.splice(0,1)[0]);var u=o.reduce(function(e,t,n){return Object.assign(e,(a=n,(i=t)in(r={})?Object.defineProperty(r,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[i]=a,r));var r,i,a},{});return e.forEach(function(e){var t=[];return r.forEach(function(n){var r=u[n];t.push(e[r])}),a.apply(void 0,t)}),[r,i]},Ht=function Ht(e,t,n){n=Object.assign({},{firstRowHeader:!0,fieldSeparator:","},n);var r=Bt(n.fieldSeparator);return Yt(r.parseRows(e),t,n)},Jt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Gt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.DSV_STR))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Ct),Jt(t,[{key:"convert",value:function value(e,t,n){return Ht(e,t,n)}}]),t}(),zt=function zt(e,t){if(!Array.isArray(t))throw new Error("Schema missing or is in an unsupported format");var n={},r=0,i=void 0,a=[],o=v(a),u=t.map(function(e){return e.name});return e.forEach(function(e){var t=[];u.forEach(function(a){a in n?i=n[a]:(n[a]=r++,i=r-1),t[i]=e[a]}),o.apply(void 0,t)}),[Object.keys(n),a]},Kt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Wt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.FLAT_JSON))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Ct),Kt(t,[{key:"convert",value:function value(e,t,n){return zt(e,t)}}]),t}(),Xt=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),qt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.DSV_ARR))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Ct),Xt(t,[{key:"convert",value:function value(e,t,n){return Yt(e,t,n)}}]),t}(),$t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Qt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o.AUTO))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Ct),$t(t,[{key:"convert",value:function value(e,t,n){return function Zt(e,t,n){var r={FlatJSON:zt,DSVStr:Ht,DSVArr:Yt},i=j(e);if(!i)throw new Error("Couldn't detect the data format");return r[i](e,t,n)}(e,t,n)}}]),t}(),en=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),rn=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=new Map,this.converters(this._getDefaultConverters())}return en(e,[{key:"_getDefaultConverters",value:function value(){return[new Gt,new qt,new Wt,new Qt]}},{key:"converters",value:function value(){var e=this;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(function(t){return e.store.set(t.type,t)}),this.store}},{key:"register",value:function value(e){return e instanceof Ct?(this.store.set(e.type,e),this):null}},{key:"unregister",value:function value(e){return this.store.delete(e.type),this}},{key:"get",value:function value(e){return this.store.has(e)?this.store.get(e):null}}]),e}(),an=function(){var e=null;return e||new rn}(),on=function on(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cn(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function fn(e){var t={};for(var n in e)t[n]=new D(e[n].formattedValue,e[n].rawValue,n);return t}var dn=function dn(e,t,n){(function sn(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments[3];t===M.COMPOSE?(e._derivation.length=0,(n=e._derivation).push.apply(n,cn(i))):e._derivation.push({op:t,meta:r,criteria:i})})(t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},arguments[4]),function pn(e,t){var n;(n=t._ancestorDerivation).push.apply(n,cn(e._ancestorDerivation).concat(cn(e._derivation)))}(e,t)},hn=(un(tn={},l.NORMAL,{diffIndex:["rowDiffset"],calcDiff:[!0,!1]}),un(tn,l.INVERSE,{diffIndex:["rejectRowDiffset"],calcDiff:[!1,!0]}),un(tn,l.ALL,{diffIndex:["rowDiffset","rejectRowDiffset"],calcDiff:[!0,!0]}),tn),vn=function vn(e,t,n){if(-1!==n&&t===n+1){var r=e.length-1;e[r]=e[r].split("-")[0]+"-"+t}else e.push(""+t)},yn=function yn(e,t,n){var r=[],i=[],a=on(hn[n].calcDiff,2),o=a[0],u=a[1];return S(e,function(e){var n=t(e);n&&o&&vn(r,e,-1),!n&&u&&vn(i,e,-1)}),{rowDiffset:r.join(","),rejectRowDiffset:i.join(",")}},bn=function bn(e,t,n,r,i){var a={},o=function o(){return r.detachedRoot()},u=n.mode,c=e._rowDiffset,f=e._partialFieldspace._cachedValueObjects;return i(c,function(e){return t(f[e],e,o,a)},u)},wn=function wn(e,t,n,r){var i=e[n];return i===C?r:t[i].internalValue},On=function On(e,t){return(t[0]instanceof Array?t:[t]).some(function(t){return e>=t[0]&&e<=t[1]})},En=(un(nn={},c.CONTINUOUS,On),un(nn,u.TEMPORAL,On),nn),An=function An(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],i=n.operation||"and",a=n.filterByDim,o=void 0===a||a,u=n.filterByMeasure,c=void 0!==u&&u,l=n.clone,p=void 0===l||l?function gn(e){var t=e.clone(!1),n=e.getPartialFieldspace();return t._colIdentifier=n.fields.map(function(e){return e.name()}).join(","),n._cachedFieldsObj=null,n._cachedDimension=null,n._cachedMeasure=null,t.__calculateFieldspace().calculateFieldsConfig(),t}(e):e,d=p.getFieldsConfig(),h=e.getPartialFieldspace().idField.data();return r=t.length?t.map(function(e){return function(e){var t=e.criteria,n=void 0===t?{}:t,r=n.identifiers,i=void 0===r?[[],[]]:r,a=n.range,u=on(i,2),l=u[0],s=void 0===l?[]:l,p=u[1],v=void 0===p?[]:p,y=s.reduce(function(e,t,n){return e[t]=n,e},{}),m=(s=s.filter(function(e){return e in d&&d[e].def.type===f.DIMENSION||e===C})).length,b={};if(m)for(var g=function g(e,t){var n=i[e],r=void 0;if(C in y){var a=n[y.__id__];a&&a.values().forEach(function(e){r=""+s.map(function(t){var r=y[t];return t===C?e:n[r]}),b[r]=1})}else r=""+s.map(function(e){var t=y[e];return n[t]}),b[r]=1},_=1,w=i.length;_<w;_++)g(_);var O=Object.keys(a||{}).filter(function(e){return e in d}),E=v.length||O.length;return c||(O=O.filter(function(e){return d[e].def.type!==f.MEASURE})),o||(O=O.filter(function(e){return d[e].def.type!==f.DIMENSION})),E?function(e,t){var n=!0;return o&&(n=!m||b[function _n(e,t,n,r){for(var i=n(e,t,0,r),a=1,o=e.length;a<o;a++)i=i+","+n(e,t,a,r);return i}(s,e,wn,h[t])]),O.every(function(t){return function jn(e,t,n){return En[n](e,t)}(e[t].internalValue,a[t],d[t].def.subtype)})&&n}:function(){return!1}}(e)}):[function(){return!1}],"and"===i?p.select(function(e,t){return r.every(function(n){return n(e,t)})},{saveChild:!1}):p.select(function(e,t){return r.some(function(n){return n(e,t)})},{saveChild:!1})},kn=function kn(e,t,n,r,i){e._rowDiffset=t,e.__calculateFieldspace().calculateFieldsConfig(),dn(n,e,M.SELECT,{config:r},i)},Dn=function Dn(e,t,n,r){var i=e.clone(n.saveChild),a=t;return n.mode===l.INVERSE&&(a=r.filter(function(e){return-1===t.indexOf(e)})),i._colIdentifier=a.join(","),i.__calculateFieldspace().calculateFieldsConfig(),dn(e,i,M.PROJECT,{projField:t,config:n,actualProjField:a},null),i},Fn=function Fn(e){if((e=g({},e)).type||(e.type=f.DIMENSION),!e.subtype)switch(e.type){case f.MEASURE:e.subtype=c.CONTINUOUS;break;default:case f.DIMENSION:e.subtype=u.CATEGORICAL}return e},Nn=function Nn(e){return e.map(function(e){return function(e){var t=e.type,n=e.subtype,r=e.name;if(t!==f.DIMENSION&&t!==f.MEASURE)throw new Error("DataModel doesn't support field type "+t+" used for "+r+" field");if(!Nt.has(n))throw new Error("DataModel doesn't support measure field subtype "+n+" used for "+r+" field")}(e=Fn(e)),e})},Tn=function Tn(e,t,n,r){n=Nn(n),r=Object.assign(Object.assign({},Pt),r);var i=an.get(r.dataFormat);if(!i)throw new Error("No converter function found for "+r.dataFormat+" format");var a=i.convert(t,n,r),c=on(a,2),f=c[0],l=c[1];!function(e,t){n.forEach(function(e){var n=e.as;if(n){var r=t.indexOf(e.name);t[r]=n,e.name=n,delete e.as}})}(0,f);var s=n.findIndex(function(e){return e.subtype===u.ID}),p=void 0;if(-1!==s)p=l[s]||[],l=l.filter(function(e,t){return t!==s}),f=f.filter(function(e,t){return t!==s}),n=n.filter(function(e){return e.subtype!==u.ID});else{var d=l[0]&&l[0].length||0;p=new Array(d).fill().map(function(e,t){return t})}var h=Tt(l,n,f),v=Tt([p],[{name:C,type:"dimension",subtype:u.ID}],[C])[0],y=A.createNamespace(h,r.name,v);e._partialFieldspace=y,e._rowDiffset=l.length&&l[0].length?"0-"+(l[0].length-1):"";var m=[],b=y.fields,g=b.map(function(e){return e.data()}),_=b.map(function(e){return e.formattedData()}),w=v.data();return S(e._rowDiffset,function(e){m[e]=function(e,t,n,r){var i={},a=!0,o=!1,u=void 0;try{for(var c,f=e.entries()[Symbol.iterator]();!(a=(c=f.next()).done);a=!0){var l=c.value,s=on(l,2),p=s[0],d=s[1];i[d.name()]=new D(t[p][r],n[p][r],d)}}catch(e){o=!0,u=e}finally{try{!a&&f.return&&f.return()}finally{if(o)throw u}}return i}(b,_,g,e),m[e].__id__=new D(w[e],w[e],v)}),y._cachedValueObjects=m,e._colIdentifier=n.map(function(e){return e.name}).join(),e._dataFormat=r.dataFormat===o.AUTO?j(t):r.dataFormat,e},Pn=function Pn(e,t){for(var n=0;n<e.length;++n)if(t===e[n].name)return{name:t,type:e[n].subtype||e[n].type,index:n};return null},In=function In(e,t){var r=e;return t.getDerivations().forEach(function(e){if(e){var t,n=function(e){var t=[],n=void 0;switch(n=e.op){case M.SELECT:t=[e.criteria];break;case M.PROJECT:t=[e.meta.actualProjField];break;case M.SORT:t=[e.criteria];break;case M.GROUPBY:n="groupBy",t=[e.meta.groupByString.split(","),e.criteria];break;default:n=null}return{operation:n,params:t}}(e),i=n.operation,a=n.params;i&&(r=(t=r)[i].apply(t,cn(a).concat([{saveChild:!1}])))}}),r},Cn=function Cn(e){for(;e._parent&&e._derivation.find(function(e){return e.op!==M.GROUPBY});)e=e._parent;return e},xn=function xn(e,t,n,r){var i=void 0,a=n.propagationNameSpace,o=n.propagateToSource,u=n.sourceId,c=function c(e){var t=e.config,n=e.model,r=t.criteria,i=void 0;return null!==r&&r.fields.some(function(e){return e.type===f.MEASURE})&&(i=Cn(n)),Object.assign({},t,{groupedModel:i})},l=[];if(null===e)l=[{criteria:[]}],i=[];else{var s,p=Object.values(a.mutableActions);!1!==o&&(p=p.filter(function(e){return e.config.sourceId!==u}));var d=p.filter(function(e){return(r.filterFn||function(){return!0})(e,r)}),h=[];if(!1!==o){var v=Object.values(a.mutableActions);v.forEach(function(e){var t=e.config;!1===t.applyOnSource&&t.action===r.action&&t.sourceId!==u&&(h.push(e.model),(i=v.filter(function(t){return t!==e}).map(c)).length&&l.push({criteria:i,models:e.model,path:function Rn(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e._parent;)t.push(e),e=e._parent;return t}(e.model)}))})}i=(s=[]).concat.apply(s,[].concat(cn(d.map(c)),[{criteria:e,groupedModel:null!==e&&e.fields.some(function(e){return e.type===f.MEASURE})?Cn(n.propagationSource):null}])).filter(function(e){return null!==e}),l.push({criteria:i,excludeModels:[].concat(h,cn(r.excludeModels||[]))})}var y=t.model,m=Object.assign({sourceIdentifiers:e,propagationSourceId:u},r);l.forEach(function(e){var t=e.criteria,n=An(y,t,{filterByMeasure:!!t.find(function(e){return e.groupedModel===y})}),r=e.path;if(r){var i=function(e,t){for(var n=0,r=t.length;n<r;n++){var i=t[n];e=In(e,i)}return e}(n,r.reverse());e.models.handlePropagation(i,m)}else!function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=i.excludeModels||[],o=i.criteria;(!a.length||-1===a.indexOf(t))&&t.handlePropagation(n,r),t._children.forEach(function(t){var a=o.filter(function(e){return e.groupedModel===t}),u=In(n,t);a.length&&(u=An(u,a,{filterByDim:!1,filterByMeasure:!0,clone:!1})),e(t,u,r,i)})}(y,n,m,{excludeModels:e.excludeModels,criteria:t})})},Vn=function Vn(e,t,n){var r=e.reduce(function(e,r){return"RegExp"===r.constructor.name?e.push.apply(e,cn(t.filter(function(e){return-1!==e.search(r)}))):r in n&&e.push(r),e},[]);return Array.from(new Set(r)).map(function(e){return e.trim()})},Bn=function Bn(e,t){return e.numberFormat?e.numberFormat()(t):t},Yn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var Jn=function(){function e(){!function Hn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=void 0;this._parent=null,this._derivation=[],this._ancestorDerivation=[],this._children=[];for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];1===r.length&&(t=r[0])instanceof e?(this._colIdentifier=t._colIdentifier,this._rowDiffset=t._rowDiffset,this._dataFormat=t._dataFormat,this._parent=t,this._partialFieldspace=this._parent._partialFieldspace,this._fieldStoreName=w(),this.__calculateFieldspace().calculateFieldsConfig()):(Tn.apply(void 0,[this].concat(r)),this._fieldStoreName=this._partialFieldspace.name,this.__calculateFieldspace().calculateFieldsConfig(),this._propagationNameSpace={mutableActions:{},immutableActions:{}})}return Yn(e,[{key:"getSchema",value:function value(){return this.getFieldspace().fields.map(function(e){return e.schema()})}},{key:"getName",value:function value(){return this._fieldStoreName}},{key:"getFieldspace",value:function value(){return this._fieldspace}},{key:"__calculateFieldspace",value:function value(){return this._fieldspace=function ln(e,t,n){var r=on(e,2),i=r[0],a=r[1],o=a.length?a.split(","):[],l=t.fieldsObj(),s=o.map(function(e){return function(e,t){var n=e.schema;return Nt.has(n.subtype)?Nt.get(n.subtype).BUILDER.partialField(e).rowDiffset(t).build():Nt.get(n.type===f.MEASURE?c.CONTINUOUS:u.CATEGORICAL).BUILDER.partialField(e).rowDiffset(t).build()}(l[e].partialField,i)});return A.createNamespace(s,n)}([this._rowDiffset,this._colIdentifier],this.getPartialFieldspace(),this._fieldStoreName),this}},{key:"getPartialFieldspace",value:function value(){return this._partialFieldspace}},{key:"join",value:function value(e,t){return H(this,e,t)}},{key:"naturalJoin",value:function value(e){return H(this,e,je(this,e),!0)}},{key:"union",value:function value(e){return Ae(this,e)}},{key:"difference",value:function value(e){return ne(this,e)}},{key:"select",value:function value(e,t){var n={mode:l.NORMAL,saveChild:!0};return(t=Object.assign({},n,t)).mode=t.mode||n.mode,function(e,t,n,r){var i={},a=n.mode,o=e.clone(r.saveChild),u=bn(o,t,n,e,yn),c=hn[a].diffIndex;return kn(o,u[c[0]],e,n,t),c.length>1?(i=e.clone(r.saveChild),kn(i,u[c[1]],e,n,t),[o,i]):o}(this,e,t,{saveChild:t.saveChild})}},{key:"isEmpty",value:function value(){return!this._rowDiffset.length||!this._colIdentifier.length}},{key:"clone",value:function value(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=new this.constructor(this);return e?t.setParent(this):t.setParent(null),t}},{key:"project",value:function value(e,t){var n={mode:l.NORMAL,saveChild:!0};t=Object.assign({},n,t);var r=this.getFieldsConfig(),i=Object.keys(r),a=t.mode,o=Vn(e,i,r);return a===l.ALL?[Dn(this,o,{mode:l.NORMAL,saveChild:t.saveChild},i),Dn(this,o,{mode:l.INVERSE,saveChild:t.saveChild},i)]:Dn(this,o,t,i)}},{key:"getFieldsConfig",value:function value(){return this._fieldConfig}},{key:"calculateFieldsConfig",value:function value(){return this._fieldConfig=this._fieldspace.fields.reduce(function(e,t,n){return e[t.name()]={index:n,def:t.schema()},e},{}),this}},{key:"dispose",value:function value(){this._parent&&this._parent.removeChild(this),this._parent=null,this._children.forEach(function(e){e._parent=null}),this._children=[]}},{key:"removeChild",value:function value(e){var t=this._children.findIndex(function(t){return t===e});-1===t||this._children.splice(t,1)}},{key:"setParent",value:function value(e){this._parent&&this._parent.removeChild(this),this._parent=e,e&&e._children.push(this)}},{key:"getParent",value:function value(){return this._parent}},{key:"getChildren",value:function value(){return this._children}},{key:"getDerivations",value:function value(){return this._derivation}},{key:"getAncestorDerivations",value:function value(){return this._ancestorDerivation}}]),e}(),zn=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function Kn(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var qn=function(e){function t(){var e;!function Wn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,r=Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=function Xn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=_typeof(t)&&"function"!=typeof t?e:t}(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r)));return a._onPropagation=[],a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+_typeof(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Jn),zn(t,[{key:"getData",value:function value(e){e=Object.assign({},{order:"row",formatter:null,withUid:!1,getAllFields:!1,sort:[]},e);var t=this.getPartialFieldspace(),n=t.idField,r=t.fields,i=te.call(this,{fields:r,idField:n},this._rowDiffset,e.getAllFields?r.map(function(e){return e.name()}).join():this._colIdentifier,e.sort,{columnWise:"column"===e.order,addUid:!!e.withUid});if(!e.formatter)return i;var a=e.formatter,o=i.data,u=i.schema,c=i.uids,f=u.map(function(e){return e.name}),l=Object.keys(a).reduce(function(e,t){var n=f.indexOf(t);return-1!==n&&e.push([n,a[t]]),e},[]);return"column"===e.order?l.forEach(function(e){var t=e[0],n=e[1];o[t].forEach(function(e,r){o[t][r]=n.call(void 0,e,c[r],u[t])})}):o.forEach(function(e,t){l.forEach(function(n){var r=n[0],i=n[1];e[r]=i.call(void 0,e[r],c[t],u[r])})}),i}},{key:"getUids",value:function value(){var e=this._rowDiffset,t=[],n=this.getPartialFieldspace().idField.data();return S(e,function(e){t.push(n[e])}),t}},{key:"groupBy",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{saveChild:!0},r=""+e.join(),a=function Ee(e,t,n){var r=function(e,t){var n=[],r=e.getFieldspace().getDimension();return Object.entries(r).forEach(function(e){var r=Oe(e,1)[0];t&&t.length?-1!==t.indexOf(r)&&n.push(r):n.push(r)}),n}(e,t),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={},i=e.getFieldspace().getMeasure(),a=we.defaultReducer();return Object.keys(i).forEach(function(e){"string"!=typeof t[e]&&(t[e]=i[e].defAggFn());var r=we.resolve(t[e]);r?n[e]=r:(n[e]=a,t[e]=me)}),n}(e,n),a=e.getFieldspace(),o=e.getPartialFieldspace().idField.data(),c=a.fieldsObj(),l=a.name,s=[],p=[],d=[],h={},v=[];Object.entries(c).forEach(function(e){var t=Oe(e,2),n=t[0],a=t[1];if(-1!==r.indexOf(n)||i[n])switch(d.push(g({},a.schema())),a.schema().type){case f.MEASURE:p.push(n);break;default:case f.DIMENSION:s.push(n)}});var y=0,m=[];S(e._rowDiffset,function(e){var t="";s.forEach(function(n){t=t+"-"+c[n].partialField.data[e]}),void 0===h[t]?(h[t]=y,v.push({}),m.push([]),s.forEach(function(t){v[y][t]=c[t].partialField.data[e]}),p.forEach(function(t){v[y][t]=[c[t].partialField.data[e]]}),m[y]=[""+o[e]],y+=1):(p.forEach(function(n){v[h[t]][n].push(c[n].partialField.data[e])}),m[h[t]].push(""+o[e]))});var b={},_=function _(){return e.detachedRoot()};return v.forEach(function(e,t){var n=e;p.forEach(function(t){n[t]=i[t](e[t],_,b)}),n.__id__=m[t]}),d.push({name:C,type:f.DIMENSION,subtype:u.ID}),new ur(v,d,{name:l})}.apply(void 0,[this,e,t]);return dn(this,a,M.GROUPBY,{fieldsArr:e,groupByString:r,defaultReducer:we.defaultReducer()},t),n.saveChild?a.setParent(this):a.setParent(null),a}},{key:"sort",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{saveChild:!1},n=this.getData({order:"row",sort:e,withUid:!0}),i=[n.schema.map(function(e){return e.name})].concat(n.data),a=new this.constructor(i,n.schema,{dataFormat:"DSVArr"});return dn(this,a,M.SORT,t,e),t.saveChild?a.setParent(this):a.setParent(null),a}},{key:"serialize",value:function value(e,t){e=e||this._dataFormat,t=Object.assign({},{fieldSeparator:","},t);var n=this.getFieldspace().fields,r=n.map(function(e){return e.formattedData()}),i=r[0].length,a=void 0,u=void 0,c=void 0;if(e===o.FLAT_JSON)for(a=[],u=0;u<i;u++){var f={};for(c=0;c<n.length;c++)f[n[c].name()]=r[c][u];a.push(f)}else if(e===o.DSV_STR){for(a=[n.map(function(e){return e.name()}).join(t.fieldSeparator)],u=0;u<i;u++){var l=[];for(c=0;c<n.length;c++)l.push(r[c][u]);a.push(l.join(t.fieldSeparator))}a=a.join("\n")}else{if(e!==o.DSV_ARR)throw new Error("Data type "+e+" is not supported");for(a=[n.map(function(e){return e.name()})],u=0;u<i;u++){var s=[];for(c=0;c<n.length;c++)s.push(r[c][u]);a.push(s)}}return a}},{key:"addField",value:function value(e){var t=e.name();this._colIdentifier+=","+t;var n=this._partialFieldspace,r=n._cachedValueObjects,i=e.formattedData(),a=e.partialField.data;if(n.fieldsObj()[e.name()]){var o=n.fields.findIndex(function(e){return e.name()===t});o>=0&&(n.fields[o]=e)}else n.fields.push(e),r.forEach(function(t,n){t[e.name()]=new D(i[n],a[n],e)});return n._cachedFieldsObj=null,n._cachedDimension=null,n._cachedMeasure=null,this.__calculateFieldspace().calculateFieldsConfig(),this}},{key:"calculateVariable",value:function value(e,t,n){var r=this;e=Fn(e),n=Object.assign({},{saveChild:!0,replaceVar:!1},n);var i=this.getFieldsConfig(),a=t.slice(0,t.length-1),o=t[t.length-1];if(i[e.name]&&!n.replaceVar)throw new Error(e.name+" field already exists in datamodel");var u=a.map(function(e){var t=i[e];if(!t)throw new Error(e+" is not a valid column name.");return t.index}),c=this.clone(n.saveChild),f=c.getFieldspace().fields,l=u.map(function(e){return f[e]}),s={},p=function p(){return r.detachedRoot()},d=[];S(c._rowDiffset,function(e){var t=l.map(function(t){return t.partialField.data[e]});d[e]=o.apply(void 0,Kn(t).concat([e,p,s]))});var v=function Gn(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,i=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(i)throw a}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}(Tt([d],[e],[e.name]),1)[0];return c.addField(v),dn(this,c,M.CAL_VAR,{config:e,fields:a},o),c}},{key:"propagate",value:function value(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=t.isMutableAction,a=t.sourceId,o=t.payload,u=function Mn(e){for(;e._parent;)e=e._parent;return e}(this),c=u._propagationNameSpace,l={groupByModel:Cn(this),model:u};return n&&function Ln(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2],r=void 0,i=t.isMutableAction,a=t.criteria,o=t.action+"-"+t.sourceId;r=i?e.mutableActions:e.immutableActions,null===a?delete r[o]:r[o]={model:n,config:t}}(c,t,this),xn(e,l,{propagationNameSpace:c,sourceId:a,propagationSource:this},Object.assign({payload:o},t)),i&&function Un(e,t,n){var r=e.immutableActions;for(var i in r){var a=r[i],o=a.config,u=n.config.sourceId,c=!n.propConfig.filterImmutableAction||n.propConfig.filterImmutableAction(o,n.config);if(o.sourceId!==u&&c){var f=o.criteria;xn(f,{model:t,groupByModel:Cn(a.model)},{propagationNameSpace:e,propagateToSource:!1,sourceId:u,propagationSource:a.model},o)}}}(c,u,{config:t,propConfig:r}),this}},{key:"on",value:function value(e,t){switch(e){case"propagation":this._onPropagation.push(t)}return this}},{key:"unsubscribe",value:function value(e){switch(e){case"propagation":this._onPropagation=[]}return this}},{key:"handlePropagation",value:function value(e,t){var n=this;this._onPropagation.forEach(function(r){return r.call(n,e,t)})}},{key:"bin",value:function value(e,t){var n=this.getFieldsConfig();if(!n[e])throw new Error("Field "+e+" doesn't exist");var r=t.name||e+"_binned";if(n[r])throw new Error("Field "+r+" already exists");var i=function I(e,t,n){var r=n.buckets,i=n.binsCount,a=n.binSize,o=n.start,u=n.end,c=e.domain(),f=P(c,2),l=f[0],s=f[1];r||(o=0!==o&&(!o||o>l)?l:o,u=0!==u&&(!u||u<s)?s+1:u,i&&(a=Math.ceil(Math.abs(u-o)/i)),r=function(e,t,n){for(var r=[],i=o;i<n;)r.push(i),i+=e;return r.push(i),r}(a,0,u)),r[0]>l&&r.unshift(l),r[r.length-1]<=s&&r.push(s+1);for(var p=[],d=0;d<r.length-1;d++)p.push({start:r[d],end:r[d+1]});var h=[];return S(t,function(t){var n=e.partialField.data[t];if(n instanceof T)h.push(n);else{var r=function(e,t){for(var n=0,r=e.length-1,i=void 0,a=void 0;n<=r;){if(t>=(a=e[i=n+Math.floor((r-n)/2)]).start&&t<a.end)return a;t>=a.end?n=i+1:t<a.start&&(r=i-1)}return null}(p,n);h.push(r.start+"-"+r.end)}}),{binnedData:h,bins:r}}(this.getFieldspace().fieldsObj()[e],this._rowDiffset,t),a=i.binnedData,o=i.bins,c=Tt([a],[{name:r,type:f.DIMENSION,subtype:u.BINNED,bins:o}],[r])[0],l=this.clone(t.saveChild);return l.addField(c),dn(this,l,M.BIN,{measureFieldName:e,config:t,binFieldName:r},null),l}},{key:"detachedRoot",value:function value(){return new t(this.serialize(o.FLAT_JSON),this.getSchema())}},{key:"splitByRow",value:function value(e,t,n){var r=this.getFieldsConfig();e.forEach(function(e){if(!r[e])throw new Error("Field "+e+" doesn't exist in the schema")});var i={mode:l.NORMAL,saveChild:!0};return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},r=arguments[3],i=r.saveChild,a=e.getFieldspace().fieldsObj(),o=bn(e.clone(i),n,r,e,function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function mn(e,t,n,r,i){var a={},o={},u={};return S(e,function(e){if(t(e)){var n="",c={keys:{}};r.forEach(function(t){var r=i[t].partialField.data[e];n=n+"-"+r,c.keys[t]=r}),void 0===o[n]&&(o[n]=[],a[n]=-1,u[n]=c),vn(o[n],e,a[n]),a[n]=e}}),{splitRowDiffset:o,dimensionMap:u}}.apply(void 0,n.concat([t,a]))}),u=o.splitRowDiffset,c=o.dimensionMap,f=[];return Object.keys(u).sort().forEach(function(n){if(u[n]){var a=e.clone(i),o=c[n];a._rowDiffset=u[n].join(","),a.__calculateFieldspace().calculateFieldsConfig(),i&&dn(e,a,M.SELECT,r,function(e){return t.every(function(t){return e[t].internalValue===o.keys[t]})}),a._derivation[a._derivation.length-1].meta=c[n],f.push(a)}}),f}(this,e,t,n=Object.assign({},i,n))}},{key:"splitByColumn",value:function value(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2],r={mode:l.NORMAL,saveChild:!0},i=this.getFieldsConfig(),a=Object.keys(i),o=[[t]];return n=Object.assign({},r,n),(e=e.length?e:[[]]).forEach(function(e,n){o[n]=Vn([].concat(Kn(e),Kn(t)),a,i)}),function Sn(e,t,n,r){return t.map(function(t){return Dn(e,t,n,r)})}(this,o,n,a)}}],[{key:"configureInvalidAwareTypes",value:function value(e){return T.invalidAwareVals(e)}},{key:"Reducers",get:function get(){return we}},{key:"Converters",get:function get(){return an}},{key:"FieldTypes",get:function get(){return Nt}}]),t}(),Zn=ye.sum,$n=ye.avg,Qn=ye.min,er=ye.max,tr=ye.first,nr=ye.last,rr=ye.count,ir=ye.std,ar={compose:function compose(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{saveChild:!0},r=e,i=void 0,a=[];return t.forEach(function(e){r=e(r),a.push.apply(a,function V(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(r._derivation)),i||(i=r)}),i&&i!==r&&i.dispose(),r._ancestorDerivation=[],dn(e,r,M.COMPOSE,null,a),n.saveChild?r.setParent(e):r.setParent(null),r}},bin:function bin(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.bin.apply(e,t)}},select:function select(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.select.apply(e,t)}},project:function project(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.project.apply(e,t)}},groupBy:function groupBy(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.groupBy.apply(e,t)}},calculateVariable:function calculateVariable(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.calculateVariable.apply(e,t)}},sort:function sort(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return e.sort.apply(e,t)}},crossProduct:H,difference:ne,naturalJoin:function naturalJoin(e,t){return H(e,t,je(e,t),!0)},leftOuterJoin:ke,rightOuterJoin:De,fullOuterJoin:function fullOuterJoin(e,t,n){return Ae(ke(e,t,n),De(e,t,n))},union:Ae,rowDiffsetIterator:S},or=n(0).version;Object.assign(qn,{Operators:ar,Stats:a,DM_DERIVATIVES:M,DateTimeFormatter:h,DataFormat:o,FilteringMode:l,InvalidAwareTypes:T,version:or,DataConverter:Ct,FieldsUtility:i},r);var ur=t.default=qn}])})}).call(this,__webpack_require__(7)(module))},,,,function(module,exports,__webpack_require__){},,,function(module,exports){module.exports=function(module){return module.webpackPolyfill||(module.deprecate=function(){},module.paths=[],module.children||(module.children=[]),Object.defineProperty(module,"loaded",{enumerable:!0,get:function get(){return module.l}}),Object.defineProperty(module,"id",{enumerable:!0,get:function get(){return module.i}}),module.webpackPolyfill=1),module}},function(module,exports,__webpack_require__){"use strict";function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _lib2=_interopRequireDefault(__webpack_require__(9)),_containerManager2=_interopRequireDefault(__webpack_require__(19)),slLib=_lib2.default.init("undefined"!=typeof window?window:void 0),doc=slLib.win.document,M=slLib.win.Math,max=M.max,round=M.round,htmlSplCharSpace={" ":"&nbsp;"},documentSupport=slLib.getDocumentSupport(),SVG_BBOX_CORRECTION=documentSupport.isWebKit?0:4.5;function SmartLabelManager(id,container,useEllipses,options){var wrapper,prop,max,prevInstance,isBrowserLess=!1,store=SmartLabelManager.store;if(void 0!==id&&"object"!==_typeof(id)){for(prop in(prevInstance=store[id])&&prevInstance.dispose(),store[id]=this,(options=options||{}).maxCacheLimit=isFinite(max=options.maxCacheLimit)?max:slLib.maxDefaultCacheLimit,"string"==typeof container&&(container=doc.getElementById(container)),(wrapper=slLib.createContainer(container)).innerHTML=slLib.testStrAvg,!documentSupport.isHeadLess&&(documentSupport.isIE||wrapper.offsetHeight||wrapper.offsetWidth)||(isBrowserLess=!0),wrapper.innerHTML="",slLib.parentContainerStyle)wrapper.style[prop]=slLib.parentContainerStyle[prop];this.id=id,this.parentContainer=wrapper,this._containerManager=new _containerManager2.default(wrapper,isBrowserLess,10),this._showNoEllipses=!useEllipses,this._init=!0,this.style={},this.options=options,this.setStyle()}}SmartLabelManager.textToLines=function(smartlabel){return(smartlabel=smartlabel||{}).text?"string"!=typeof smartlabel.text&&(smartlabel.text=smartlabel.text.toString()):smartlabel.text="",smartlabel.lines=smartlabel.text.split(/\n|<br\s*?\/?>/gi),smartlabel},SmartLabelManager.store={},SmartLabelManager.prototype._calCharDimWithCache=function(text,calculateDifference,length){if(!this._init)return!1;var size,csArr,tw,twi,cachedStyle,asymmetricDifference,maxAdvancedCacheLimit=this.options.maxCacheLimit,container=this._container,style=this.style||{},cache=this._advancedCache||(this._advancedCache={}),advancedCacheKey=this._advancedCacheKey||(this._advancedCacheKey=[]),cacheName=text+(style.fontSize||"")+(style.fontFamily||"")+(style.fontWeight||"")+(style.fontStyle||""),cacheInitName=text+"init"+(style.fontSize||"")+(style.fontFamily||"")+(style.fontWeight||"")+(style.fontStyle||"");return htmlSplCharSpace[text]&&(text=htmlSplCharSpace[text]),calculateDifference?void 0===(asymmetricDifference=cache[cacheInitName])&&(container.innerHTML=text.repeat?text.repeat(length):Array(length+1).join(text),tw=container.offsetWidth,container.innerHTML=text,twi=container.offsetWidth,asymmetricDifference=cache[cacheInitName]=(tw-length*twi)/(length+1),advancedCacheKey.push(cacheInitName),advancedCacheKey.length>maxAdvancedCacheLimit&&delete cache[advancedCacheKey.shift()]):asymmetricDifference=0,(cachedStyle=cache[cacheName])?(csArr=cachedStyle.split(","),{width:parseFloat(csArr[0],10),height:parseFloat(csArr[1],10)}):(container.innerHTML=text,size={height:container.offsetHeight,width:container.offsetWidth+asymmetricDifference},cache[cacheName]=size.width+","+size.height,advancedCacheKey.push(cacheName),advancedCacheKey.length>maxAdvancedCacheLimit&&delete cache[advancedCacheKey.shift()],size)},SmartLabelManager.prototype._getWidthFn=function(){var contObj=this._containerObj,container=this._container,svgText=contObj.svgText;return svgText?function(str){var bbox,width;return svgText.textContent=str,(width=(bbox=svgText.getBBox()).width-SVG_BBOX_CORRECTION)<1&&(width=bbox.width),width}:function(str){return container.innerHTML=str,container.offsetWidth}},SmartLabelManager.prototype.setStyle=function(style){return this._init?style!==this.style||this._styleNotSet?(style||(style=this.style),slLib.setLineHeight(style),this.style=style,this._containerObj=sCont=this._containerManager.get(style),this._containerObj?(this._container=sCont.node,this._context=sCont.context,this._cache=sCont.charCache,this._lineHeight=sCont.lineHeight,this._styleNotSet=!1):this._styleNotSet=!0,this):void 0:this;var sCont},SmartLabelManager.prototype.useEllipsesOnOverflow=function(useEllipses){return this._init?(this._showNoEllipses=!useEllipses,this):this},SmartLabelManager.prototype.getSmartText=function(text,maxWidth,maxHeight,noWrap){if(!this._init)return!1;void 0===text||null===text?text="":"string"!=typeof text&&(text=text.toString());var len,trimStr,tempArr,tmpText,maxWidthWithEll,toolText,oriWidth,oriHeight,newCharIndex,nearestChar,tempChar,getWidth,initialLeft,initialTop,getOriSizeImproveObj,spanArr,x,y,minWidth,elem,chr,elemRightMostPoint,elemLowestPoint,lastBR,removeFromIndex,removeFromIndexForEllipses,hasHTMLTag=!1,maxStrWidth=0,lastDash=-1,lastSpace=-1,lastIndexBroken=-1,strWidth=0,strHeight=0,oriTextArr=[],i=0,ellipsesStr=this._showNoEllipses?"":"...",lineHeight=this._lineHeight,context=this._context,container=this._container,sCont=this._containerObj,ellipsesWidth=sCont.ellipsesWidth,dotWidth=sCont.dotWidth,characterArr=[],dashIndex=-1,spaceIndex=-1,lastLineBreak=-1,fastTrim=function fastTrim(str){for(var ws=/\s/,i=(str=str.replace(/^\s\s*/,"")).length;ws.test(str.charAt(i-=1)););return str.slice(0,i+1)},smartLabel={text:text,maxWidth:maxWidth,maxHeight:maxHeight,width:null,height:null,oriTextWidth:null,oriTextHeight:null,oriText:text,isTruncated:!1};if(getWidth=this._getWidthFn(),maxHeight===lineHeight&&(maxHeight*=1.2),container){if(!documentSupport.isBrowserLess){if((hasHTMLTag=slLib.xmlTagRegEx.test(text))?(container.innerHTML=text,smartLabel.oriTextWidth=oriWidth=container.offsetWidth,smartLabel.oriTextHeight=oriHeight=container.offsetHeight):(tmpText=text.replace(slLib.ltgtRegex,function(match){return"&lt;"===match?"<":">"}),getOriSizeImproveObj=this.getOriSize(tmpText,!0),smartLabel.oriTextWidth=oriWidth=getOriSizeImproveObj.width,smartLabel.oriTextHeight=oriHeight=getOriSizeImproveObj.height),oriHeight<=maxHeight&&oriWidth<=maxWidth)return smartLabel.width=smartLabel.oriTextWidth=oriWidth,smartLabel.height=smartLabel.oriTextHeight=oriHeight,smartLabel;if(lineHeight>maxHeight)return smartLabel.text="",smartLabel.width=smartLabel.oriTextWidth=0,smartLabel.height=smartLabel.oriTextHeight=0,smartLabel}if(text=fastTrim(text).replace(/(\s+)/g," "),maxWidthWithEll=this._showNoEllipses?maxWidth:maxWidth-ellipsesWidth,!hasHTMLTag){if(len=(oriTextArr=text.split("")).length,trimStr="",tempArr=[],tempChar=oriTextArr[0],this._cache[tempChar]?minWidth=this._cache[tempChar].width:(minWidth=getWidth(tempChar),this._cache[tempChar]={width:minWidth}),maxWidthWithEll>minWidth)i=(tempArr=text.substr(0,slLib.getNearestBreakIndex(text,maxWidthWithEll,this)).split("")).length;else{if(minWidth>maxWidth)return smartLabel.text="",smartLabel.width=smartLabel.oriTextWidth=smartLabel.height=smartLabel.oriTextHeight=0,smartLabel;ellipsesStr&&((maxWidthWithEll=maxWidth-2*dotWidth)>minWidth?ellipsesStr="..":(maxWidthWithEll=maxWidth-dotWidth)>minWidth?ellipsesStr=".":(maxWidthWithEll=0,ellipsesStr=""))}if(strWidth=getWidth(tempArr.join("")),strHeight=this._lineHeight,noWrap){for(;i<len;i+=1)if(tempChar=tempArr[i]=oriTextArr[i],this._cache[tempChar]?minWidth=this._cache[tempChar].width:(getOriSizeImproveObj&&(minWidth=getOriSizeImproveObj.detailObj[tempChar])||(minWidth=getWidth(tempChar)),this._cache[tempChar]={width:minWidth}),(strWidth+=minWidth)>maxWidthWithEll&&(trimStr||(trimStr=tempArr.slice(0,-1).join("")),strWidth>maxWidth))return smartLabel.text=fastTrim(trimStr)+ellipsesStr,smartLabel.tooltext=smartLabel.oriText,smartLabel.width=getWidth(smartLabel.text),smartLabel.height=this._lineHeight,smartLabel;return smartLabel.text=tempArr.join(""),smartLabel.width=strWidth,smartLabel.height=this._lineHeight,smartLabel}for(;i<len;i+=1)if(" "!==(tempChar=tempArr[i]=oriTextArr[i])||context||(tempChar="&nbsp;"),this._cache[tempChar]?minWidth=this._cache[tempChar].width:(getOriSizeImproveObj&&(minWidth=getOriSizeImproveObj.detailObj[tempChar])||(minWidth=getWidth(tempChar)),this._cache[tempChar]={width:minWidth}),(strWidth+=minWidth)>maxWidthWithEll&&(trimStr||(trimStr=tempArr.slice(0,-1).join("")),strWidth>maxWidth)){if(lastSpace=text.substr(0,tempArr.length).lastIndexOf(" "),lastDash=text.substr(0,tempArr.length).lastIndexOf("-"),lastSpace>lastIndexBroken?(strWidth=getWidth(tempArr.slice(lastIndexBroken+1,lastSpace).join("")),tempArr.splice(lastSpace,1,"<br/>"),lastIndexBroken=lastSpace,newCharIndex=lastSpace+1):lastDash>lastIndexBroken?(lastDash===tempArr.length-1?(strWidth=getWidth(tempArr.slice(lastIndexBroken+1,lastSpace).join("")),tempArr.splice(lastDash,1,"<br/>-")):(strWidth=getWidth(tempArr.slice(lastIndexBroken+1,lastSpace).join("")),tempArr.splice(lastDash,1,"-<br/>")),lastIndexBroken=lastDash,newCharIndex=lastDash+1):(tempArr.splice(tempArr.length-1,1,"<br/>"+oriTextArr[i]),lastLineBreak=tempArr.length-2,strWidth=getWidth(tempArr.slice(lastIndexBroken+1,lastLineBreak+1).join("")),lastIndexBroken=lastLineBreak,newCharIndex=i),(strHeight+=this._lineHeight)>maxHeight)return smartLabel.text=fastTrim(trimStr)+ellipsesStr,smartLabel.tooltext=smartLabel.oriText,smartLabel.width=maxWidth,smartLabel.height=strHeight-this._lineHeight,smartLabel;maxStrWidth=max(maxStrWidth,strWidth),trimStr=null,nearestChar=slLib.getNearestBreakIndex(text.substr(newCharIndex),maxWidthWithEll,this),strWidth=getWidth(text.substr(newCharIndex,nearestChar||1)),tempArr.length<newCharIndex+nearestChar&&(i=(tempArr=tempArr.concat(text.substr(tempArr.length,newCharIndex+nearestChar-tempArr.length).split(""))).length-1)}return maxStrWidth=max(maxStrWidth,strWidth),smartLabel.text=tempArr.join(""),smartLabel.width=maxStrWidth,smartLabel.height=strHeight,smartLabel}for(toolText=text.replace(slLib.spanAdditionRegx,"$2"),text=(text=text.replace(slLib.spanAdditionRegx,slLib.spanAdditionReplacer)).replace(/(<br\s*\/*\>)/g,'<span class="'+[slLib.classNameWithTag," ",slLib.classNameWithTagBR].join("")+'">$1</span>'),container.innerHTML=text,x=0,y=(spanArr=container[documentSupport.childRetriverFn](documentSupport.childRetriverString)).length;x<y;x+=1)elem=spanArr[x],(documentSupport.noClassTesting||slLib.classNameReg.test(elem.className))&&""!==(chr=elem.innerHTML)&&(" "===chr?spaceIndex=characterArr.length:"-"===chr&&(dashIndex=characterArr.length),characterArr.push({spaceIdx:spaceIndex,dashIdx:dashIndex,elem:elem}),oriTextArr.push(chr));if(i=0,len=characterArr.length,(minWidth=characterArr[0].elem.offsetWidth)>maxWidth)return smartLabel.text="",smartLabel.width=smartLabel.oriTextWidth=smartLabel.height=smartLabel.oriTextHeight=0,smartLabel;if(minWidth>maxWidthWithEll&&!this._showNoEllipses&&((maxWidthWithEll=maxWidth-2*dotWidth)>minWidth?ellipsesStr="..":(maxWidthWithEll=maxWidth-dotWidth)>minWidth?ellipsesStr=".":(maxWidthWithEll=0,ellipsesStr="")),initialLeft=characterArr[0].elem.offsetLeft,initialTop=characterArr[0].elem.offsetTop,noWrap)for(;i<len;i+=1)(elemRightMostPoint=(elem=characterArr[i].elem).offsetLeft-initialLeft+elem.offsetWidth)>maxWidthWithEll&&(removeFromIndexForEllipses||(removeFromIndexForEllipses=i),container.offsetWidth>maxWidth&&(removeFromIndex=i,i=len));else for(;i<len;i+=1)elemLowestPoint=(elem=characterArr[i].elem).offsetHeight+(elem.offsetTop-initialTop),lastBR=null,(elemRightMostPoint=elem.offsetLeft-initialLeft+elem.offsetWidth)>maxWidthWithEll?(removeFromIndexForEllipses||(removeFromIndexForEllipses=i),elemRightMostPoint>maxWidth&&(lastSpace=characterArr[i].spaceIdx,lastDash=characterArr[i].dashIdx,lastSpace>lastIndexBroken?(characterArr[lastSpace].elem.innerHTML="<br/>",lastIndexBroken=lastSpace):lastDash>lastIndexBroken?(characterArr[lastDash].elem.innerHTML=lastDash===i?"<br/>-":"-<br/>",lastIndexBroken=lastDash):elem.parentNode.insertBefore(lastBR=doc.createElement("br"),elem),elem.offsetHeight+elem.offsetTop>maxHeight?(lastBR?lastBR.parentNode.removeChild(lastBR):lastIndexBroken===lastDash?characterArr[lastDash].elem.innerHTML="-":characterArr[lastSpace].elem.innerHTML=" ",removeFromIndex=i,i=len):removeFromIndexForEllipses=null)):elemLowestPoint>maxHeight&&(removeFromIndex=i,i=len);if(removeFromIndex<len){for(smartLabel.isTruncated=!0,removeFromIndexForEllipses=removeFromIndexForEllipses||removeFromIndex,i=len-1;i>=removeFromIndexForEllipses;i-=1)(elem=characterArr[i].elem).parentNode.removeChild(elem);for(;i>=0;i-=1)elem=characterArr[i].elem,slLib.classNameBrReg.test(elem.className)?elem.parentNode.removeChild(elem):i=0}return smartLabel.text=container.innerHTML.replace(slLib.spanRemovalRegx,"$1").replace(/\&amp\;/g,"&"),smartLabel.isTruncated&&(smartLabel.text+=ellipsesStr,smartLabel.tooltext=toolText),smartLabel.height=container.offsetHeight,smartLabel.width=container.offsetWidth,smartLabel}return smartLabel.error=new Error("Body Tag Missing!"),smartLabel},SmartLabelManager.prototype.getOriSize=function(text,detailedCalculationFlag){if(!this._init)return!1;var textArr,letter,lSize,i,l,cumulativeSize=0,height=0,indiSizeStore={};if(!detailedCalculationFlag)return this._calCharDimWithCache(text);for(i=0,l=(textArr=text.split("")).length;i<l;i++)letter=textArr[i],lSize=this._calCharDimWithCache(letter,!0,textArr.length),height=max(height,lSize.height),cumulativeSize+=lSize.width,indiSizeStore[letter]=lSize.width;return{width:round(cumulativeSize),height:height,detailObj:indiSizeStore}},SmartLabelManager.prototype.dispose=function(){return this._init?(this._containerManager&&this._containerManager.dispose&&this._containerManager.dispose(),delete this._container,delete this._context,delete this._cache,delete this._containerManager,delete this._containerObj,delete this.id,delete this.style,delete this.parentContainer,delete this._showNoEllipses,this):this},exports.default=SmartLabelManager,module.exports=exports.default},function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var lib={init:function init(win){var doc=win.document,userAgent=win.navigator.userAgent,ceil=Math.ceil,floor=Math.floor,clsNameSpace="fusioncharts-smartlabel-",containerClass=clsNameSpace+"container",classNameWithTag=clsNameSpace+"tag";return lib={win:win,containerClass:containerClass,classNameWithTag:classNameWithTag,classNameWithTagBR:"fusioncharts-smartlabel-br",maxDefaultCacheLimit:500,classNameReg:new RegExp("\b"+classNameWithTag+"\b"),classNameBrReg:new RegExp("\bfusioncharts-smartlabel-br\b"),spanAdditionRegx:/(<[^<\>]+?\>)|(&(?:[a-z]+|#[0-9]+);|.)/gi,spanAdditionReplacer:'$1<span class="'+classNameWithTag+'">$2</span>',spanRemovalRegx:new RegExp("\\<span[^\\>]+?"+classNameWithTag+"[^\\>]{0,}\\>(.*?)\\<\\/span\\>","ig"),xmlTagRegEx:new RegExp("<[^>][^<]*[^>]+>","i"),ltgtRegex:/&lt;|&gt;/g,brReplaceRegex:/<br\/>/gi,testStrAvg:"WgI",parentContainerStyle:{position:"absolute",top:"-9999em",whiteSpace:"nowrap",padding:"0px",width:"1px",height:"1px",overflow:"hidden"},supportedStyle:{font:"font",fontFamily:"font-family","font-family":"font-family",fontWeight:"font-weight","font-weight":"font-weight",fontSize:"font-size","font-size":"font-size",lineHeight:"line-height","line-height":"line-height",fontStyle:"font-style","font-style":"font-style"},getDocumentSupport:function getDocumentSupport(){var childRetriverFn,childRetriverString,noClassTesting;return doc.getElementsByClassName?(childRetriverFn="getElementsByClassName",childRetriverString=classNameWithTag,noClassTesting=!0):(childRetriverFn="getElementsByTagName",childRetriverString="span",noClassTesting=!1),{isIE:/msie/i.test(userAgent)&&!win.opera,hasSVG:Boolean(win.SVGAngle||doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")),isHeadLess:new RegExp(" HtmlUnit").test(userAgent),isWebKit:new RegExp(" AppleWebKit/").test(userAgent),childRetriverFn:childRetriverFn,childRetriverString:childRetriverString,noClassTesting:noClassTesting}},createContainer:function createContainer(containerParent){var body,container;if(containerParent&&(containerParent.offsetWidth||containerParent.offsetHeight)){if(containerParent.appendChild)return containerParent.appendChild(container=doc.createElement("DIV")),container.className=containerClass,container.setAttribute("aria-hidden","true"),container.setAttribute("role","presentation"),container}else if((body=doc.getElementsByTagName("body")[0])&&body.appendChild)return(container=doc.createElement("DIV")).className=containerClass,container.setAttribute("aria-hidden","true"),container.setAttribute("role","presentation"),1,body.appendChild(container),container},getNearestBreakIndex:function getNearestBreakIndex(text,maxWidth,sl){if(!text||!text.length)return 0;var difference,getWidth=sl._getWidthFn(),charLen=0,increment=0,oriWidth=getWidth(text),avgWidth=oriWidth/text.length;if(difference=maxWidth,charLen=ceil(maxWidth/avgWidth),oriWidth<maxWidth)return text.length-1;for(charLen>text.length&&(difference=maxWidth-oriWidth,charLen=text.length);difference>0;){if(difference=maxWidth-getWidth(text.substr(0,charLen)),!(increment=floor(difference/avgWidth)))return charLen;charLen+=increment}for(;difference<0;){if(difference=maxWidth-getWidth(text.substr(0,charLen)),!(increment=floor(difference/avgWidth)))return charLen;charLen+=increment}return charLen},setLineHeight:function setLineHeight(styleObj){var fSize=styleObj.fontSize=styleObj.fontSize||"12px";return styleObj.lineHeight=styleObj.lineHeight||styleObj["line-height"]||1.2*parseInt(fSize,10)+"px",styleObj}}}};exports.default=lib,module.exports=exports.default},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){(function(module){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}!function(e,t){"object"==_typeof(exports)&&"object"==_typeof(module)?module.exports=t():(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=t)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==_typeof(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";r.r(t);var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function i(e,t){e.forEach(function(e){void 0!==e&&null!==e&&(t[e]=1)})},o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._set={},i(t,this._set)}return n(e,[{key:"append",value:function value(e){return i(e,this._set),this}},{key:"toArray",value:function value(){return Object.keys(this._set)}}],[{key:"difference",value:function value(t,r){var n=void 0,i=[],o=t._set,u=r._set;for(n in o)({}).hasOwnProperty.call(o,n)&&(n in u||i.push(n));return new e(i)}}]),e}(),u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a="function"==typeof Symbol&&"symbol"==_typeof(Symbol.iterator)?function(e){return _typeof(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":_typeof(e)};function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var l=function l(e){if("object"===(void 0===e?"undefined":a(e))){if(null===e)return!1;if("[object Object]"===Object.prototype.toString.call(e))return"Object"===(e.constructor.toString().match(/^function (.*)\(\)/m)||[])[1]}return!1},c="undefined"==typeof window?{}:window,f=c.requestAnimationFrame||c.webkitRequestAnimationFrame||c.mozRequestAnimationFrame||c.oRequestAnimationFrame||c.msRequestAnimationFrame||function(e){setTimeout(e,16)},h=function e(){return e.__lastTime===(new Date).getTime()?e.__lastTime.toString()+(e.__id++).toString():(e.__id=0,(e.__lastTime=(new Date).getTime()).toString()+(e.__id++).toString())},d=function d(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=[];return t.forEach(function(e){return n.push.apply(n,s(e))}),n},p=function p(e){var t=[],r=null;return e=e&&"function"==typeof e&&e||function(){},function(n,i){[].push.apply(t,n),null===r&&(r=f(function(){var n=t.slice(0);t.length=0,r=null,n.reduce(function(e,t){return t.__id in e.map?e:(e.map[t.__id]=1,e.unique.push(t),e)},{map:{},unique:[]}).unique.forEach(function(e){return e()}),e(i)}))}},v=function v(e){return function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return r.map(function(t){var r=e[t];return{name:r.name,qualifiedName:r.qualifiedName,value:r.seed}})}},y=function y(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return{dependencies:t.slice(0,t.length-1),fn:t[t.length-1]}},g=function g(e){var t=[],r={};return e.forEach(function(e){return r[e.qualifiedName]=-1}),function e(n){n.forEach(function(n){var i,o=void 0,u=void 0,a=void 0;(i=n.qualifiedName)in r?-1!==(o=r[i])&&o!==t.length-1&&(u=t.slice(0,o),a=t.slice(o+1),t=u.concat(a),a.forEach(function(e,t){return r[e.qualifiedName]=t+u.length}),r[i]=t.push(n)-1):r[i]=t.push(n)-1,e(n.outgoingEdges)})}(e),t},m={accumulate:function accumulate(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n={};return t.forEach(function(e){Object.assign(n,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},e.name,e.value))}),n},identity:function identity(e){return e.value}},_=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fn=t,this.dep=[]}return u(e,[{key:"addDependencies",value:function value(){var e;return(e=this.dep).push.apply(e,arguments),this}},{key:"getDependencies",value:function value(){return this.dep}},{key:"get",value:function value(){return this.fn}}]),e}(),b=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function k(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var w=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n=n||{},this.name=t,this.qualifiedName=r,this.edges=[],this.outgoingEdges=[],this._seed=null,this.requireResolve=!0,this.retriever=n.retriever,this.history=[],this.resolver=null,this.electricEdges=[]}return b(e,[{key:"addDependencies",value:function value(){for(var e,t=this,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return(e=this.edges).push.apply(e,n),n.forEach(function(e){return e.outgoingEdges.push(t)}),this}},{key:"addElectricNode",value:function value(e){return this.electricEdges.push(e),this}},{key:"resolve",value:function value(){return this.seed=this.resolver.apply(this,k(this.retrieveDetails())),this.history.push(this.seed),this.requireResolve=!1,this}},{key:"retrieveDetails",value:function value(){return 0===this.edges.length?[{name:this.name,qualifiedName:this.qualifiedName,value:this.seed}]:this.retriever.apply(this,k(this.edges.map(function(e){return e.qualifiedName})))}},{key:"repeatHead",value:function value(){var e=this.history,t=e[e.length-1];return 0===e.length?this:(e.push(t),this)}},{key:"flush",value:function value(){var e=this.history,t=e[e.length-1];return e.length=0,e.push(t),this}},{key:"isRoot",value:function value(){return null===this.name}},{key:"seed",get:function get(){return this._seed},set:function set(e){return this._seed=e,this.requireResolve=!0,this}}]),e}(),q=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),E=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.edges=[],this.listeners={nextFrame:[],currentFrame:[]}}return q(e,[{key:"addEdges",value:function value(){var e;return(e=this.edges).push.apply(e,arguments),this}},{key:"regListenerForCurrFrame",value:function value(e){var t=this,r=this.listeners.currentFrame,n=r.push(function(e,t){var r=function r(){t.apply(void 0,s(e.map(function(e){var t=e.history,r=t.length-1;return[t[r-1<0?0:r-1],t[r]]})))};return r.__id=h(),r}(this.edges,e))-1;return function(){t.listeners.currentFrame=r.filter(function(e,t){return t!==n})}}},{key:"regListenerForNextFrame",value:function value(e){var t=this,r=this.listeners.nextFrame,n=r.push(function(e,t){var r=function r(){t.apply(void 0,s(e.map(function(e){var t=e.history;return[t[0],t[t.length-1]]})))};return r.__id=h(),r}(this.edges,e))-1;return function(){t.listeners.nextFrame=r.filter(function(e,t){return t!==n})}}},{key:"hasNextFrameListener",value:function value(){return!!this.listeners.nextFrame.length}}]),e}(),N=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function F(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var O=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.qualifiedNodeMap={},this.retriever=v(this.qualifiedNodeMap),this.root=new w(null,null,{retriever:this.retriever}),this.root.resolver=m.accumulate,this._wholeSet=null,this._propagate=!0,this.propagationOverride={currentFrameListeners:!1,nextFrameListeners:!1},this._schedule=p(function(e){var r=void 0;for(r in e.flushTarget){if(!{}.hasOwnProperty.call(t.qualifiedNodeMap,r))return;t.qualifiedNodeMap[r].flush()}})}return N(e,[{key:"createNodesFrom",value:function value(e,t){var n,r=void 0,i=this.qualifiedNodeMap,u=this.root,a=this.retriever;return function e(t,n,o){var s=void 0,c=void 0,f=void 0,h=void 0;for(s in t)if({}.hasOwnProperty.call(t,s))if(h=new w(s,c=""+n+s,{retriever:a}),i[c]=h,void 0!==(f=o.perv)?f.addDependencies(h):u.addDependencies(h),l(r=t[s]))e(r,""+n+s+".",{perv:h}),h.resolver=m.accumulate;else if(r instanceof _){var d;h.resolver=r.get(),(d=h).addDependencies.apply(d,F(r.getDependencies().map(function(e){return i[e]})))}else h.resolver=m.identity,h.seed=r}(e,null===t?"":t+".",{perv:i[t]}),this._wholeSet=new o(Object.keys(this.qualifiedNodeMap)),(n=this.constructor.getResolvedList(u).concat(u).filter(function(e){return e.requireResolve})).forEach(function(e){return e.resolve()}),g(n).forEach(function(e){return e.resolve()}),this}},{key:"getNodeValue",value:function value(e){if(e in this.qualifiedNodeMap)return this.qualifiedNodeMap[e].seed}},{key:"createElectricNodeOf",value:function value(e,t){var r,n=this,i=e.map(function(e){return n.qualifiedNodeMap[e]}),o=(r=new E).addEdges.apply(r,F(i));return i.forEach(function(e){return e.addElectricNode(o)}),o["regListenerFor"+t.type](t.fn)}},{key:"update",value:function value(){for(var e=void 0,t=void 0,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];var u=[],a=n.map(function(e){return e[0].seed=e[1],e[0]});return a.forEach(function(e){return e.resolve()}),u.push.apply(u,F(d.apply(void 0,F(a.map(function(e){return e.electricEdges}))))),e=new o(a.map(function(e){return e.qualifiedName})),this._propagate?((t=g(a)).forEach(function(e){return e.resolve()}),e.append(t.map(function(e){return e.qualifiedName})),u.push.apply(u,F(d.apply(void 0,F(t.map(function(e){return e.electricEdges}))))),this.__execUniqueElectricEdges(Array.from(new Set(u)),e),this):(this.__execUniqueElectricEdges(u),this._propagate=!0,this)}},{key:"__execUniqueElectricEdges",value:function value(e,t){var r=this,n=[],i=[];return t&&o.difference(this._wholeSet,t).toArray().forEach(function(e){return r.qualifiedNodeMap[e].repeatHead()}),e.forEach(function(e){n.push.apply(n,F(e.listeners.currentFrame))}),e.forEach(function(e){i.push.apply(i,F(e.listeners.nextFrame))}),!this.propagationOverride.currentFrameListeners&&n.forEach(function(e){return e()}),!this.propagationOverride.nextFrameListeners&&this._schedule(i,{flushTarget:t}),this.resetPropagationOverride(),this}},{key:"resetNodeValue",value:function value(){for(var e=this,t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.map(function(t){return e.qualifiedNodeMap[t]}).map(function(e){return[e,e.seed]});return this.update.apply(this,F(i)),this}},{key:"stopPropagation",value:function value(){return this._propagate=!1,this}},{key:"resetPropagationOverride",value:function value(){return this.propagationOverride.currentFrameListeners=!1,this.propagationOverride.nextFrameListeners=!1,this}},{key:"setPropagationOverride",value:function value(e){return this.propagationOverride[e+"Listeners"]=!0,this}},{key:"getNodeFromQualifiedName",value:function value(e){return this.qualifiedNodeMap[e]}}],[{key:"getResolvedList",value:function value(e){var t=[];return function e(t,r,n){var i=void 0;t.edges.forEach(function(t){e(t,r,n)}),t.isRoot()||(i=t.qualifiedName)in n||(r.push(t),n[i]=1)}(e,t,{}),t}}]),e}(),A=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function P(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var j=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._graph=new O,this._lockFlag=!1,this._reqQ=[]}return A(e,[{key:"append",value:function value(){var e=void 0,t=void 0;return 1===arguments.length?(e=null,t=arguments.length<=0?void 0:arguments[0]):(e=arguments.length<=0?void 0:arguments[0],t=arguments.length<=1?void 0:arguments[1]),this._addPropInModel(e,t),this}},{key:"calculatedProp",value:function value(){var e,t,r,n=void 0,i=void 0,o=void 0;return arguments.length>2?(i=arguments.length<=0?void 0:arguments[0],n=arguments.length<=1?void 0:arguments[1],o=arguments.length<=2?void 0:arguments[2]):(i=null,n=arguments.length<=0?void 0:arguments[0],o=arguments.length<=1?void 0:arguments[1]),t=o(y),(e=r=new _(t.fn)).addDependencies.apply(e,P(t.dependencies)),this._addPropInModel(i,function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},n,r)),this}},{key:"_addPropInModel",value:function value(e,t){return this._graph.createNodesFrom(t,e),this}},{key:"on",value:function value(e,t,r){var n,i=e instanceof Array?e:[e],o=this._graph.createElectricNodeOf(i,{type:"CurrFrame",fn:t});return r&&(n=this._graph.stopPropagation().setPropagationOverride("nextFrame")).resetNodeValue.apply(n,P(e)),o}},{key:"next",value:function value(e,t,r){var n,i=e instanceof Array?e:[e],o=this._graph.createElectricNodeOf(i,{type:"NextFrame",fn:t});return r&&(n=this._graph.stopPropagation().setPropagationOverride("currentFrame")).resetNodeValue.apply(n,P(e)),o}},{key:"lock",value:function value(){return this._lockFlag=!0,this._reqQ.length=0,this}},{key:"unlock",value:function value(){return this._lockFlag=!1,this.setProp.apply(this,P(this._reqQ)),this._reqQ.length=0,this}},{key:"prop",value:function value(){var e,t=void 0,r=void 0;switch(e=arguments.length){case 1:t=arguments.length<=0?void 0:arguments[0];break;case 2:t=arguments.length<=0?void 0:arguments[0],r=arguments.length<=1?void 0:arguments[1];break;default:return this}return 2===e?(this._lockFlag?this._reqQ.push([t,r]):this.setProp([t,r]),this):this._graph.getNodeValue(t)}},{key:"setProp",value:function value(){for(var e,t=this,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];return 0===n.length?this:((e=this._graph).update.apply(e,P(n.map(function(e){return[t._graph.getNodeFromQualifiedName(e[0]),e[1]]}))),this)}},{key:"graph",value:function value(){return this._graph}},{key:"serialize",value:function value(){return this._graph.root.seed}}],[{key:"create",value:function value(t){return(new e)._addPropInModel(null,t)}}]),e}();t.default=j}])})}).call(this,__webpack_require__(7)(module))},function(module){module.exports=JSON.parse('{"name":"muze","private":true,"version":"1.3.2","description":"Composable visualisation library for web with a data-first approach","homepage":"https://muzejs.org","author":"Muzejs.org (https://muzejs.org/)","license":"MIT","contributors":[{"name":"Akash Ghoswami","email":"akashgoswami90s@gmail.com"},{"name":"Ranajit Banerjee","email":"ranajit.113124@gmail.com","url":"https://github.com/ranajitbanerjee"},{"name":"Mridul Meharia","email":"mehariamridul@gmail.com","url":"https://github.com/mridulmeh"},{"name":"Subhash Haldar"},{"name":"Sandeep Acharya"},{"name":"Rousan Ali","email":"hello@rousan.io","url":"https://rousan.io"},{"name":"Ujjal Kumar Dutta","email":"duttaujjal143@gmail.com"},{"name":"Adarsh Lilha","email":"adarshlilha@gmail.com","url":"https://adarshlilha.com"},{"name":"Swati Mukherjee","email":"swati@charts.com"}],"main":"src/index.js","keywords":["muze","svg","vector","graphics","data-visualization","visualization","renderer","fusioncharts","relational","algebra","relation"],"repository":{"type":"git","url":"https://github.com/chartshq/muze"},"dependencies":{"@chartshq/layout":"^1.0.0","@chartshq/muze-firebolt":"^1.0.0","@chartshq/muze-legend":"^1.0.0","muze-utils":"^1.0.0","@chartshq/visual-cell":"^1.0.0","@chartshq/visual-group":"^1.0.0","@chartshq/visual-layer":"^1.0.0","@chartshq/visual-unit":"^1.0.0"}}')},,,,,,function(module,exports,__webpack_require__){var Muze=__webpack_require__(40);module.exports=Muze.default?Muze.default:Muze},function(module,exports,__webpack_require__){"use strict";var slLib=function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}(__webpack_require__(9)).default.init("undefined"!=typeof window?window:void 0),doc=slLib.win.document,documentSupport=slLib.getDocumentSupport(),SVG_BBOX_CORRECTION=documentSupport.isWebKit?0:4.5;function ContainerManager(parentContainer,isBrowserLess,maxContainers){var svg;maxContainers=(maxContainers=maxContainers>5?maxContainers:5)<20?maxContainers:20,this.maxContainers=maxContainers,this.first=null,this.last=null,this.containers={},this.length=0,this.rootNode=parentContainer,isBrowserLess&&((svg=doc.createElementNS("http://www.w3.org/2000/svg","svg")).setAttributeNS("http://www.w3.org/2000/svg","xlink","http://www.w3.org/1999/xlink"),svg.setAttributeNS("http://www.w3.org/2000/svg","height","0"),svg.setAttributeNS("http://www.w3.org/2000/svg","width","0"),this.svgRoot=svg,this.rootNode.appendChild(svg))}ContainerManager.prototype.get=function(style){var diff,key,containerObj,containers=this.containers,len=this.length,max=this.maxContainers,keyStr="";for(key in slLib.supportedStyle)void 0!==style[key]&&(keyStr+=slLib.supportedStyle[key]+":"+style[key]+";");if(!keyStr)return!1;if(containerObj=containers[keyStr])this.first!==containerObj&&(containerObj.prev&&(containerObj.prev.next=containerObj.next),containerObj.next&&(containerObj.next.prev=containerObj.prev),containerObj.next=this.first,containerObj.next.prev=containerObj,this.last===containerObj&&(this.last=containerObj.prev),containerObj.prev=null,this.first=containerObj);else{if(len>=max)for(diff=len-max+1;diff--;)this.removeContainer(this.last);containerObj=this.addContainer(keyStr)}return containerObj},ContainerManager.prototype.addContainer=function(keyStr){var node,container;return this.containers[keyStr]=container={next:null,prev:null,node:null,ellipsesWidth:0,lineHeight:0,dotWidth:0,avgCharWidth:4,keyStr:keyStr,charCache:{}},container.next=this.first,container.next&&(container.next.prev=container),this.first=container,this.last||(this.last=container),this.length+=1,node=container.node=doc.createElement("div"),this.rootNode.appendChild(node),documentSupport.isIE&&!documentSupport.hasSVG?node.style.setAttribute("cssText",keyStr):node.setAttribute("style",keyStr),node.setAttribute("aria-hidden","true"),node.setAttribute("role","presentation"),node.style.display="inline-block",node.innerHTML=slLib.testStrAvg,container.lineHeight=node.offsetHeight,container.avgCharWidth=node.offsetWidth/3,documentSupport.isBrowserLess?((node=container.svgText=doc.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("style",keyStr),this.svgRoot.appendChild(node),node.textContent=slLib.testStrAvg,container.lineHeight=node.getBBox().height,container.avgCharWidth=(node.getBBox().width-SVG_BBOX_CORRECTION)/3,node.textContent="...",container.ellipsesWidth=node.getBBox().width-SVG_BBOX_CORRECTION,node.textContent=".",container.dotWidth=node.getBBox().width-SVG_BBOX_CORRECTION):(node.innerHTML="...",container.ellipsesWidth=node.offsetWidth,node.innerHTML=".",container.dotWidth=node.offsetWidth,node.innerHTML=""),container},ContainerManager.prototype.removeContainer=function(cObj){var keyStr=cObj.keyStr;keyStr&&this.length&&cObj&&(this.length-=1,cObj.prev&&(cObj.prev.next=cObj.next),cObj.next&&(cObj.next.prev=cObj.prev),this.first===cObj&&(this.first=cObj.next),this.last===cObj&&(this.last=cObj.prev),cObj.node.parentNode.removeChild(cObj.node),delete this.containers[keyStr])},ContainerManager.prototype.dispose=function(){var key,containers=this.containers;for(key in this.maxContainers=null,containers)this.removeContainer(containers[key]);this.rootNode.parentNode.removeChild(this.rootNode),this.rootNode=null,this.first=null,this.last=null},module.exports=ContainerManager},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,exports,__webpack_require__){},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var scales_namespaceObject={};__webpack_require__.r(scales_namespaceObject),__webpack_require__.d(scales_namespaceObject,"scaleLinear",function(){return linear_linear}),__webpack_require__.d(scales_namespaceObject,"scaleThreshold",function(){return threshold_threshold}),__webpack_require__.d(scales_namespaceObject,"scaleLog",function(){return log}),__webpack_require__.d(scales_namespaceObject,"scalePow",function(){return pow}),__webpack_require__.d(scales_namespaceObject,"scaleIdentity",function(){return identity_identity}),__webpack_require__.d(scales_namespaceObject,"scaleOrdinal",function(){return ordinal}),__webpack_require__.d(scales_namespaceObject,"scaleSequential",function(){return sequential}),__webpack_require__.d(scales_namespaceObject,"scaleQuantize",function(){return quantize}),__webpack_require__.d(scales_namespaceObject,"scaleQuantile",function(){return quantile_quantile}),__webpack_require__.d(scales_namespaceObject,"schemeCategory10",function(){return category10}),__webpack_require__.d(scales_namespaceObject,"schemeCategory20",function(){return category20}),__webpack_require__.d(scales_namespaceObject,"schemeCategory20b",function(){return category20b}),__webpack_require__.d(scales_namespaceObject,"scaleBand",function(){return band}),__webpack_require__.d(scales_namespaceObject,"scaleTime",function(){return src_time});var color_schemes_namespaceObject={};__webpack_require__.r(color_schemes_namespaceObject),__webpack_require__.d(color_schemes_namespaceObject,"schemeDark2",function(){return Dark2}),__webpack_require__.d(color_schemes_namespaceObject,"schemePaired",function(){return Paired}),__webpack_require__.d(color_schemes_namespaceObject,"schemeAccent",function(){return Accent}),__webpack_require__.d(color_schemes_namespaceObject,"schemePastel1",function(){return Pastel1}),__webpack_require__.d(color_schemes_namespaceObject,"schemePastel2",function(){return Pastel2}),__webpack_require__.d(color_schemes_namespaceObject,"schemeSet1",function(){return Set1}),__webpack_require__.d(color_schemes_namespaceObject,"schemeSet2",function(){return Set2}),__webpack_require__.d(color_schemes_namespaceObject,"schemeSet3",function(){return Set3}),__webpack_require__.d(color_schemes_namespaceObject,"schemeBlues",function(){return Blues_scheme}),__webpack_require__.d(color_schemes_namespaceObject,"schemeBrBG",function(){return BrBG_scheme}),__webpack_require__.d(color_schemes_namespaceObject,"schemePRGn",function(){return PRGn_scheme}),__webpack_require__.d(color_schemes_namespaceObject,"schemePiYG",function(){return PiYG_scheme}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateBrBG",function(){return BrBG}),__webpack_require__.d(color_schemes_namespaceObject,"interpolatePRGn",function(){return PRGn}),__webpack_require__.d(color_schemes_namespaceObject,"interpolatePiYG",function(){return PiYG}),__webpack_require__.d(color_schemes_namespaceObject,"interpolatePuOr",function(){return PuOr}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateRdBu",function(){return RdBu}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateRdGy",function(){return RdGy}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateRdYlBu",function(){return RdYlBu}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateRdYlGn",function(){return RdYlGn}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateSpectral",function(){return Spectral}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateBlues",function(){return Blues}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateGreens",function(){return Greens}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateGreys",function(){return Greys}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateOranges",function(){return Oranges}),__webpack_require__.d(color_schemes_namespaceObject,"interpolatePurples",function(){return Purples}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateReds",function(){return Reds}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateViridis",function(){return sequential_multi_viridis}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateInferno",function(){return viridis_inferno}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateMagma",function(){return viridis_magma}),__webpack_require__.d(color_schemes_namespaceObject,"interpolatePlasma",function(){return viridis_plasma}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateWarm",function(){return rainbow_warm}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateCool",function(){return rainbow_cool}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateCubehelixDefault",function(){return sequential_multi_cubehelix}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateBuGn",function(){return BuGn}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateBuPu",function(){return BuPu}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateGnBu",function(){return GnBu}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateOrRd",function(){return OrRd}),__webpack_require__.d(color_schemes_namespaceObject,"interpolatePuBuGn",function(){return PuBuGn}),__webpack_require__.d(color_schemes_namespaceObject,"interpolatePuBu",function(){return PuBu}),__webpack_require__.d(color_schemes_namespaceObject,"interpolatePuRd",function(){return PuRd}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateRdPu",function(){return RdPu}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateYlGnBu",function(){return YlGnBu}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateYlGn",function(){return YlGn}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateYlOrBr",function(){return YlOrBr}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateYlOrRd",function(){return YlOrRd}),__webpack_require__.d(color_schemes_namespaceObject,"interpolateRainbow",function(){return sequential_multi_rainbow});var namespace_namespaceObject={};__webpack_require__.r(namespace_namespaceObject),__webpack_require__.d(namespace_namespaceObject,"UNIT_GLOBAL_NAMESPACE",function(){return UNIT_GLOBAL_NAMESPACE}),__webpack_require__.d(namespace_namespaceObject,"UNIT_LOCAL_NAMESPACE",function(){return UNIT_LOCAL_NAMESPACE}),__webpack_require__.d(namespace_namespaceObject,"LAYER_LOCAL_NAMESPACE",function(){return LAYER_LOCAL_NAMESPACE}),__webpack_require__.d(namespace_namespaceObject,"LAYER_GLOBAL_NAMESPACE",function(){return LAYER_GLOBAL_NAMESPACE}),__webpack_require__.d(namespace_namespaceObject,"GROUP_GLOBAL_NAMESPACE",function(){return GROUP_GLOBAL_NAMESPACE}),__webpack_require__.d(namespace_namespaceObject,"GROUP_LOCAL_NAMESPACE",function(){return GROUP_LOCAL_NAMESPACE}),__webpack_require__.d(namespace_namespaceObject,"CANVAS_LOCAL_NAMESPACE",function(){return CANVAS_LOCAL_NAMESPACE}),__webpack_require__.d(namespace_namespaceObject,"CANVAS_GLOBAL_NAMESPACE",function(){return CANVAS_GLOBAL_NAMESPACE});var muze_utils_src_namespaceObject={};__webpack_require__.r(muze_utils_src_namespaceObject),__webpack_require__.d(muze_utils_src_namespaceObject,"InvalidAwareTypes",function(){return src_InvalidAwareTypes}),__webpack_require__.d(muze_utils_src_namespaceObject,"DataModel",function(){return datamodel_default.a}),__webpack_require__.d(muze_utils_src_namespaceObject,"ReservedFields",function(){return reserved_fields}),__webpack_require__.d(muze_utils_src_namespaceObject,"CommonProps",function(){return common_props}),__webpack_require__.d(muze_utils_src_namespaceObject,"COORD_TYPES",function(){return COORD_TYPES}),__webpack_require__.d(muze_utils_src_namespaceObject,"STATE_NAMESPACES",function(){return namespace_namespaceObject}),__webpack_require__.d(muze_utils_src_namespaceObject,"scales",function(){return scales_namespaceObject}),__webpack_require__.d(muze_utils_src_namespaceObject,"colorSchemes",function(){return color_schemes_namespaceObject}),__webpack_require__.d(muze_utils_src_namespaceObject,"getNearestValue",function(){return getNearestValue}),__webpack_require__.d(muze_utils_src_namespaceObject,"getValueParser",function(){return getValueParser}),__webpack_require__.d(muze_utils_src_namespaceObject,"transformColor",function(){return common_utils_transformColor}),__webpack_require__.d(muze_utils_src_namespaceObject,"transformColors",function(){return common_utils_transformColors}),__webpack_require__.d(muze_utils_src_namespaceObject,"detectColor",function(){return detectColor}),__webpack_require__.d(muze_utils_src_namespaceObject,"hslToRgb",function(){return hslToRgb}),__webpack_require__.d(muze_utils_src_namespaceObject,"rgbToHsv",function(){return rgbToHsv}),__webpack_require__.d(muze_utils_src_namespaceObject,"hexToHsv",function(){return hexToHsv}),__webpack_require__.d(muze_utils_src_namespaceObject,"hsvToRgb",function(){return hsvToRgb}),__webpack_require__.d(muze_utils_src_namespaceObject,"hslaToRgb",function(){return hslaToRgb}),__webpack_require__.d(muze_utils_src_namespaceObject,"escapeHTML",function(){return escapeHTML}),__webpack_require__.d(muze_utils_src_namespaceObject,"angleToRadian",function(){return angleToRadian}),__webpack_require__.d(muze_utils_src_namespaceObject,"generateGetterSetters",function(){return generateGetterSetters}),__webpack_require__.d(muze_utils_src_namespaceObject,"getArraySum",function(){return getArraySum}),__webpack_require__.d(muze_utils_src_namespaceObject,"ERROR_MSG",function(){return ERROR_MSG}),__webpack_require__.d(muze_utils_src_namespaceObject,"interpolator",function(){return common_utils_interpolator}),__webpack_require__.d(muze_utils_src_namespaceObject,"colorInterpolator",function(){return common_utils_colorInterpolator}),__webpack_require__.d(muze_utils_src_namespaceObject,"numberInterpolator",function(){return common_utils_numberInterpolator}),__webpack_require__.d(muze_utils_src_namespaceObject,"piecewiseInterpolator",function(){return common_utils_piecewiseInterpolator}),__webpack_require__.d(muze_utils_src_namespaceObject,"reqAnimFrame",function(){return reqAnimFrame}),__webpack_require__.d(muze_utils_src_namespaceObject,"cancelAnimFrame",function(){return cancelAnimFrame}),__webpack_require__.d(muze_utils_src_namespaceObject,"nextAnimFrame",function(){return nextAnimFrame}),__webpack_require__.d(muze_utils_src_namespaceObject,"getMax",function(){return getMax}),__webpack_require__.d(muze_utils_src_namespaceObject,"getMin",function(){return getMin}),__webpack_require__.d(muze_utils_src_namespaceObject,"getDomainFromData",function(){return getDomainFromData}),__webpack_require__.d(muze_utils_src_namespaceObject,"getUniqueId",function(){return getUniqueId}),__webpack_require__.d(muze_utils_src_namespaceObject,"mergeRecursive",function(){return mergeRecursive}),__webpack_require__.d(muze_utils_src_namespaceObject,"unionDomain",function(){return unionDomain}),__webpack_require__.d(muze_utils_src_namespaceObject,"replaceCSSPrefix",function(){return replaceCSSPrefix}),__webpack_require__.d(muze_utils_src_namespaceObject,"symbolFns",function(){return symbolFns}),__webpack_require__.d(muze_utils_src_namespaceObject,"defaultValue",function(){return defaultValue}),__webpack_require__.d(muze_utils_src_namespaceObject,"easeFns",function(){return easeFns}),__webpack_require__.d(muze_utils_src_namespaceObject,"clone",function(){return clone}),__webpack_require__.d(muze_utils_src_namespaceObject,"interpolateArray",function(){return interpolateArray}),__webpack_require__.d(muze_utils_src_namespaceObject,"getMinPoint",function(){return getMinPoint}),__webpack_require__.d(muze_utils_src_namespaceObject,"getMaxPoint",function(){return getMaxPoint}),__webpack_require__.d(muze_utils_src_namespaceObject,"getClosestIndexOf",function(){return common_utils_getClosestIndexOf}),__webpack_require__.d(muze_utils_src_namespaceObject,"registerListeners",function(){return common_utils_registerListeners}),__webpack_require__.d(muze_utils_src_namespaceObject,"Voronoi",function(){return common_utils_Voronoi}),__webpack_require__.d(muze_utils_src_namespaceObject,"checkExistence",function(){return checkExistence}),__webpack_require__.d(muze_utils_src_namespaceObject,"sanitizeIP",function(){return sanitizeIP}),__webpack_require__.d(muze_utils_src_namespaceObject,"getMinDiff",function(){return getMinDiff}),__webpack_require__.d(muze_utils_src_namespaceObject,"capitalizeFirst",function(){return capitalizeFirst}),__webpack_require__.d(muze_utils_src_namespaceObject,"getWindow",function(){return getWindow}),__webpack_require__.d(muze_utils_src_namespaceObject,"getQualifiedClassName",function(){return getQualifiedClassName}),__webpack_require__.d(muze_utils_src_namespaceObject,"getDependencyOrder",function(){return getDependencyOrder}),__webpack_require__.d(muze_utils_src_namespaceObject,"objectIterator",function(){return objectIterator}),__webpack_require__.d(muze_utils_src_namespaceObject,"intSanitizer",function(){return intSanitizer}),__webpack_require__.d(muze_utils_src_namespaceObject,"enableChainedTransaction",function(){return enableChainedTransaction}),__webpack_require__.d(muze_utils_src_namespaceObject,"isHTMLElem",function(){return isHTMLElem}),__webpack_require__.d(muze_utils_src_namespaceObject,"isEqual",function(){return common_utils_isEqual}),__webpack_require__.d(muze_utils_src_namespaceObject,"isSimpleObject",function(){return isSimpleObject}),__webpack_require__.d(muze_utils_src_namespaceObject,"nextFrame",function(){return nextFrame}),__webpack_require__.d(muze_utils_src_namespaceObject,"getObjProp",function(){return getObjProp}),__webpack_require__.d(muze_utils_src_namespaceObject,"getDataModelFromIdentifiers",function(){return common_utils_getDataModelFromIdentifiers}),__webpack_require__.d(muze_utils_src_namespaceObject,"getDataModelFromRange",function(){return getDataModelFromRange}),__webpack_require__.d(muze_utils_src_namespaceObject,"transposeArray",function(){return transposeArray}),__webpack_require__.d(muze_utils_src_namespaceObject,"toArray",function(){return toArray}),__webpack_require__.d(muze_utils_src_namespaceObject,"extendsClass",function(){return extendsClass}),__webpack_require__.d(muze_utils_src_namespaceObject,"concatModels",function(){return common_utils_concatModels}),__webpack_require__.d(muze_utils_src_namespaceObject,"assembleModelFromIdentifiers",function(){return assembleModelFromIdentifiers}),__webpack_require__.d(muze_utils_src_namespaceObject,"isValidValue",function(){return isValidValue}),__webpack_require__.d(muze_utils_src_namespaceObject,"nestCollection",function(){return common_utils_nestCollection}),__webpack_require__.d(muze_utils_src_namespaceObject,"stack",function(){return common_utils_stack}),__webpack_require__.d(muze_utils_src_namespaceObject,"getSymbol",function(){return common_utils_getSymbol}),__webpack_require__.d(muze_utils_src_namespaceObject,"Scales",function(){return Scales}),__webpack_require__.d(muze_utils_src_namespaceObject,"Symbols",function(){return Symbols}),__webpack_require__.d(muze_utils_src_namespaceObject,"pathInterpolators",function(){return pathInterpolators}),__webpack_require__.d(muze_utils_src_namespaceObject,"hslInterpolator",function(){return common_utils_hslInterpolator}),__webpack_require__.d(muze_utils_src_namespaceObject,"getSmallestDiff",function(){return getSmallestDiff}),__webpack_require__.d(muze_utils_src_namespaceObject,"require",function(){return require}),__webpack_require__.d(muze_utils_src_namespaceObject,"formatTemporal",function(){return common_utils_formatTemporal}),__webpack_require__.d(muze_utils_src_namespaceObject,"nearestSortingDetails",function(){return common_utils_nearestSortingDetails}),__webpack_require__.d(muze_utils_src_namespaceObject,"createSelection",function(){return common_utils_createSelection}),__webpack_require__.d(muze_utils_src_namespaceObject,"temporalFields",function(){return common_utils_temporalFields}),__webpack_require__.d(muze_utils_src_namespaceObject,"retrieveNearestGroupByReducers",function(){return common_utils_retrieveNearestGroupByReducers}),__webpack_require__.d(muze_utils_src_namespaceObject,"retrieveFieldDisplayName",function(){return retrieveFieldDisplayName}),__webpack_require__.d(muze_utils_src_namespaceObject,"sanitizeDomainWhenEqual",function(){return sanitizeDomainWhenEqual}),__webpack_require__.d(muze_utils_src_namespaceObject,"sortCategoricalField",function(){return sortCategoricalField}),__webpack_require__.d(muze_utils_src_namespaceObject,"intersect",function(){return common_utils_intersect}),__webpack_require__.d(muze_utils_src_namespaceObject,"partition",function(){return partition}),__webpack_require__.d(muze_utils_src_namespaceObject,"mix",function(){return mix}),__webpack_require__.d(muze_utils_src_namespaceObject,"componentRegistry",function(){return common_utils_componentRegistry}),__webpack_require__.d(muze_utils_src_namespaceObject,"getArrayDiff",function(){return getArrayDiff}),__webpack_require__.d(muze_utils_src_namespaceObject,"difference",function(){return difference}),__webpack_require__.d(muze_utils_src_namespaceObject,"getArrayIndexMap",function(){return getArrayIndexMap}),__webpack_require__.d(muze_utils_src_namespaceObject,"arraysEqual",function(){return arraysEqual}),__webpack_require__.d(muze_utils_src_namespaceObject,"getReadableTicks",function(){return common_utils_getReadableTicks}),__webpack_require__.d(muze_utils_src_namespaceObject,"unique",function(){return unique}),__webpack_require__.d(muze_utils_src_namespaceObject,"dmMultipleSelection",function(){return common_utils_dmMultipleSelection}),__webpack_require__.d(muze_utils_src_namespaceObject,"pointWithinCircle",function(){return pointWithinCircle}),__webpack_require__.d(muze_utils_src_namespaceObject,"getIndexMap",function(){return getIndexMap}),__webpack_require__.d(muze_utils_src_namespaceObject,"selectElement",function(){return renderer_utils_selectElement}),__webpack_require__.d(muze_utils_src_namespaceObject,"makeElement",function(){return makeElement}),__webpack_require__.d(muze_utils_src_namespaceObject,"applyStyle",function(){return renderer_utils_applyStyle}),__webpack_require__.d(muze_utils_src_namespaceObject,"addClass",function(){return renderer_utils_addClass}),__webpack_require__.d(muze_utils_src_namespaceObject,"removeClass",function(){return renderer_utils_removeClass}),__webpack_require__.d(muze_utils_src_namespaceObject,"appendElement",function(){return appendElement}),__webpack_require__.d(muze_utils_src_namespaceObject,"setAttrs",function(){return renderer_utils_setAttrs}),__webpack_require__.d(muze_utils_src_namespaceObject,"setStyles",function(){return renderer_utils_setStyles}),__webpack_require__.d(muze_utils_src_namespaceObject,"createElement",function(){return renderer_utils_createElement}),__webpack_require__.d(muze_utils_src_namespaceObject,"createElements",function(){return renderer_utils_createElements}),__webpack_require__.d(muze_utils_src_namespaceObject,"clipElement",function(){return renderer_utils_clipElement}),__webpack_require__.d(muze_utils_src_namespaceObject,"getElementsByClassName",function(){return renderer_utils_getElementsByClassName}),__webpack_require__.d(muze_utils_src_namespaceObject,"getMousePos",function(){return getMousePos}),__webpack_require__.d(muze_utils_src_namespaceObject,"getEvent",function(){return renderer_utils_getEvent}),__webpack_require__.d(muze_utils_src_namespaceObject,"getD3Drag",function(){return renderer_utils_getD3Drag}),__webpack_require__.d(muze_utils_src_namespaceObject,"getSmartComputedStyle",function(){return renderer_utils_getSmartComputedStyle}),__webpack_require__.d(muze_utils_src_namespaceObject,"getClientPoint",function(){return renderer_utils_getClientPoint}),__webpack_require__.d(muze_utils_src_namespaceObject,"hasTouch",function(){return hasTouch}),__webpack_require__.d(muze_utils_src_namespaceObject,"Store",function(){return store_Store}),__webpack_require__.d(muze_utils_src_namespaceObject,"transactor",function(){return store_transactor}),__webpack_require__.d(muze_utils_src_namespaceObject,"timeMillisecond",function(){return src_millisecond}),__webpack_require__.d(muze_utils_src_namespaceObject,"timeSecond",function(){return src_second}),__webpack_require__.d(muze_utils_src_namespaceObject,"timeMinute",function(){return src_minute}),__webpack_require__.d(muze_utils_src_namespaceObject,"timeHour",function(){return src_hour}),__webpack_require__.d(muze_utils_src_namespaceObject,"timeDay",function(){return src_day}),__webpack_require__.d(muze_utils_src_namespaceObject,"timeWeek",function(){return sunday}),__webpack_require__.d(muze_utils_src_namespaceObject,"timeMonth",function(){return src_month}),__webpack_require__.d(muze_utils_src_namespaceObject,"timeYear",function(){return src_year}),__webpack_require__.d(muze_utils_src_namespaceObject,"Smartlabel",function(){return SmartlabelManager_default.a}),__webpack_require__.d(muze_utils_src_namespaceObject,"dataSelect",function(){return dataSelect}),__webpack_require__.d(muze_utils_src_namespaceObject,"LifeCycleManager",function(){return lifecycle_manager}),__webpack_require__.d(muze_utils_src_namespaceObject,"DimensionSubtype",function(){return dist_datamodel.DimensionSubtype}),__webpack_require__.d(muze_utils_src_namespaceObject,"FieldType",function(){return dist_datamodel.FieldType}),__webpack_require__.d(muze_utils_src_namespaceObject,"MeasureSubtype",function(){return dist_datamodel.MeasureSubtype}),__webpack_require__.d(muze_utils_src_namespaceObject,"DateTimeFormatter",function(){return dist_datamodel.DateTimeFormatter}),__webpack_require__.d(muze_utils_src_namespaceObject,"DM_DERIVATIVES",function(){return dist_datamodel.DM_DERIVATIVES}),__webpack_require__.d(muze_utils_src_namespaceObject,"GROUP_BY_FUNCTIONS",function(){return dist_datamodel.GROUP_BY_FUNCTIONS}),__webpack_require__.d(muze_utils_src_namespaceObject,"RTree",function(){return RTree});var enums_constants_namespaceObject={};__webpack_require__.r(enums_constants_namespaceObject),__webpack_require__.d(enums_constants_namespaceObject,"CLASSPREFIX",function(){return CLASSPREFIX}),__webpack_require__.d(enums_constants_namespaceObject,"STACK",function(){return STACK}),__webpack_require__.d(enums_constants_namespaceObject,"GROUP",function(){return GROUP}),__webpack_require__.d(enums_constants_namespaceObject,"IDENTITY",function(){return IDENTITY}),__webpack_require__.d(enums_constants_namespaceObject,"ANGLE",function(){return constants_ANGLE}),__webpack_require__.d(enums_constants_namespaceObject,"RADIUS",function(){return constants_RADIUS}),__webpack_require__.d(enums_constants_namespaceObject,"SIZE",function(){return SIZE}),__webpack_require__.d(enums_constants_namespaceObject,"COLOR",function(){return COLOR}),__webpack_require__.d(enums_constants_namespaceObject,"SHAPE",function(){return SHAPE}),__webpack_require__.d(enums_constants_namespaceObject,"TEXT",function(){return TEXT}),__webpack_require__.d(enums_constants_namespaceObject,"OUTER_RADIUS_VALUE",function(){return OUTER_RADIUS_VALUE}),__webpack_require__.d(enums_constants_namespaceObject,"TEXT_ANCHOR_MIDDLE",function(){return TEXT_ANCHOR_MIDDLE}),__webpack_require__.d(enums_constants_namespaceObject,"ENCODING",function(){return ENCODING}),__webpack_require__.d(enums_constants_namespaceObject,"STROKE_DASHARRAY",function(){return STROKE_DASHARRAY}),__webpack_require__.d(enums_constants_namespaceObject,"ASCENDING",function(){return ASCENDING}),__webpack_require__.d(enums_constants_namespaceObject,"AGG_FN_SUM",function(){return AGG_FN_SUM}),__webpack_require__.d(enums_constants_namespaceObject,"AREA_LAYER",function(){return AREA_LAYER}),__webpack_require__.d(enums_constants_namespaceObject,"ARC_LAYER",function(){return ARC_LAYER}),__webpack_require__.d(enums_constants_namespaceObject,"LINE_LAYER",function(){return LINE_LAYER}),__webpack_require__.d(enums_constants_namespaceObject,"TEXT_LAYER",function(){return TEXT_LAYER}),__webpack_require__.d(enums_constants_namespaceObject,"POINT_LAYER",function(){return POINT_LAYER}),__webpack_require__.d(enums_constants_namespaceObject,"BAR_LAYER",function(){return BAR_LAYER}),__webpack_require__.d(enums_constants_namespaceObject,"TICK_LAYER",function(){return TICK_LAYER}),__webpack_require__.d(enums_constants_namespaceObject,"SIMPLE_LAYER",function(){return SIMPLE_LAYER}),__webpack_require__.d(enums_constants_namespaceObject,"BASE_LAYER",function(){return BASE_LAYER});var props_namespaceObject={};__webpack_require__.r(props_namespaceObject),__webpack_require__.d(props_namespaceObject,"DATA",function(){return DATA}),__webpack_require__.d(props_namespaceObject,"CONFIG",function(){return CONFIG}),__webpack_require__.d(props_namespaceObject,"MEASUREMENT",function(){return MEASUREMENT}),__webpack_require__.d(props_namespaceObject,"DOMAIN",function(){return DOMAIN}),__webpack_require__.d(props_namespaceObject,"MOUNT",function(){return MOUNT});var axis_orientation_namespaceObject={};__webpack_require__.r(axis_orientation_namespaceObject),__webpack_require__.d(axis_orientation_namespaceObject,"BOTTOM",function(){return axis_orientation_BOTTOM}),__webpack_require__.d(axis_orientation_namespaceObject,"TOP",function(){return axis_orientation_TOP}),__webpack_require__.d(axis_orientation_namespaceObject,"LEFT",function(){return axis_orientation_LEFT}),__webpack_require__.d(axis_orientation_namespaceObject,"RIGHT",function(){return axis_orientation_RIGHT}),__webpack_require__.d(axis_orientation_namespaceObject,"axisOrientationMap",function(){return axisOrientationMap});var scale_type_namespaceObject={};__webpack_require__.r(scale_type_namespaceObject),__webpack_require__.d(scale_type_namespaceObject,"LINEAR",function(){return LINEAR}),__webpack_require__.d(scale_type_namespaceObject,"BAND",function(){return BAND}),__webpack_require__.d(scale_type_namespaceObject,"TIME",function(){return TIME}),__webpack_require__.d(scale_type_namespaceObject,"COLOR",function(){return scale_type_COLOR}),__webpack_require__.d(scale_type_namespaceObject,"ORDINAL",function(){return ORDINAL}),__webpack_require__.d(scale_type_namespaceObject,"QUANTIZE",function(){return QUANTIZE}),__webpack_require__.d(scale_type_namespaceObject,"QUANTILE",function(){return QUANTILE}),__webpack_require__.d(scale_type_namespaceObject,"LOG",function(){return LOG}),__webpack_require__.d(scale_type_namespaceObject,"POW",function(){return POW}),__webpack_require__.d(scale_type_namespaceObject,"IDENTITY",function(){return scale_type_IDENTITY}),__webpack_require__.d(scale_type_namespaceObject,"SEQUENTIAL",function(){return SEQUENTIAL}),__webpack_require__.d(scale_type_namespaceObject,"THRESHOLD",function(){return THRESHOLD});var visual_group_src_enums_constants_namespaceObject={};__webpack_require__.r(visual_group_src_enums_constants_namespaceObject),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"X",function(){return X}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"Y",function(){return Y}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"WIDTH",function(){return WIDTH}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"HEIGHT",function(){return HEIGHT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"MEASUREMENT",function(){return constants_MEASUREMENT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"CONFIG",function(){return constants_CONFIG}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"MIN_UNIT_WIDTH",function(){return MIN_UNIT_WIDTH}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"MIN_UNIT_HEIGHT",function(){return MIN_UNIT_HEIGHT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"DIMENSIONS",function(){return DIMENSIONS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"MEASURES",function(){return MEASURES}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"DIMENSION",function(){return DIMENSION}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"MEASURE",function(){return MEASURE}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"PIVOT",function(){return PIVOT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"FORMAT",function(){return FORMAT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"MOUNT",function(){return constants_MOUNT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"HAS_DATA_UPDATED",function(){return HAS_DATA_UPDATED}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"ROWS",function(){return ROWS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"COLUMNS",function(){return COLUMNS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"DATA",function(){return constants_DATA}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"COL",function(){return COL}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"ROW",function(){return ROW}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"COLUMN",function(){return COLUMN}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"COLOR",function(){return enums_constants_COLOR}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"SHAPE",function(){return enums_constants_SHAPE}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"SIZE",function(){return enums_constants_SIZE}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"DETAIL",function(){return DETAIL}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"LAYERS",function(){return LAYERS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"TRANSFORM",function(){return TRANSFORM}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"ORDINAL",function(){return enums_constants_ORDINAL}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"LINEAR",function(){return enums_constants_LINEAR}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"LEFT",function(){return constants_LEFT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"RIGHT",function(){return constants_RIGHT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"TOP",function(){return enums_constants_TOP}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"BOTTOM",function(){return enums_constants_BOTTOM}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"RETINAL",function(){return RETINAL}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"CELL",function(){return CELL}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"X_AXES",function(){return X_AXES}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"Y_AXES",function(){return Y_AXES}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"ENTRY_CELLS",function(){return ENTRY_CELLS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"INITIALIZED",function(){return INITIALIZED}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"EXIT_CELLS",function(){return EXIT_CELLS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"AXIS",function(){return AXIS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"UNIT",function(){return UNIT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"UPDATED",function(){return UPDATED}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"BEFORE_UPDATE",function(){return BEFORE_UPDATE}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"VALUE_MATRIX",function(){return VALUE_MATRIX}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"FACET_HEADERS",function(){return FACET_HEADERS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"RADIUS",function(){return enums_constants_RADIUS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"ANGLE",function(){return enums_constants_ANGLE}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"ANGLE0",function(){return ANGLE0}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"ARC",function(){return ARC}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"CATEGORICAL",function(){return constants_CATEGORICAL}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"TEMPORAL",function(){return constants_TEMPORAL}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"BAR",function(){return BAR}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"LINE",function(){return LINE}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"POINT",function(){return POINT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"PRIMARY",function(){return PRIMARY}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"SECONDARY",function(){return SECONDARY}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"BOTH",function(){return BOTH}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"INTERACTION",function(){return INTERACTION}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"GRID_LINES",function(){return GRID_LINES}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"GRID_BANDS",function(){return GRID_BANDS}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"HEADER",function(){return HEADER}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"FACET",function(){return FACET}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"DEFAULT",function(){return DEFAULT}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"ASCENDING",function(){return constants_ASCENDING}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"DESCENDING",function(){return DESCENDING}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"DARK",function(){return DARK}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"NONE",function(){return NONE}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"NORMAL",function(){return NORMAL}),__webpack_require__.d(visual_group_src_enums_constants_namespaceObject,"DARKER",function(){return DARKER});var helpers_namespaceObject={};__webpack_require__.r(helpers_namespaceObject),__webpack_require__.d(helpers_namespaceObject,"transformColor",function(){return helpers_transformColor}),__webpack_require__.d(helpers_namespaceObject,"applyInteractionStyle",function(){return helpers_applyInteractionStyle}),__webpack_require__.d(helpers_namespaceObject,"retrieveEncodingInf",function(){return helpers_retrieveEncodingInf}),__webpack_require__.d(helpers_namespaceObject,"encodingFieldInfRetriever",function(){return encodingFieldInfRetriever}),__webpack_require__.d(helpers_namespaceObject,"setNullsInStack",function(){return helpers_setNullsInStack}),__webpack_require__.d(helpers_namespaceObject,"transformData",function(){return helpers_transformData}),__webpack_require__.d(helpers_namespaceObject,"getIndividualClassName",function(){return getIndividualClassName}),__webpack_require__.d(helpers_namespaceObject,"dataNormalizers",function(){return dataNormalizers}),__webpack_require__.d(helpers_namespaceObject,"getNormalizedData",function(){return helpers_getNormalizedData}),__webpack_require__.d(helpers_namespaceObject,"domainCalculator",function(){return domainCalculator}),__webpack_require__.d(helpers_namespaceObject,"attachDataToVoronoi",function(){return helpers_attachDataToVoronoi}),__webpack_require__.d(helpers_namespaceObject,"updateStyle",function(){return helpers_updateStyle}),__webpack_require__.d(helpers_namespaceObject,"animateGroup",function(){return helpers_animateGroup}),__webpack_require__.d(helpers_namespaceObject,"positionPoints",function(){return positionPoints}),__webpack_require__.d(helpers_namespaceObject,"getGroupSpan",function(){return getGroupSpan}),__webpack_require__.d(helpers_namespaceObject,"getPlotMeasurement",function(){return helpers_getPlotMeasurement}),__webpack_require__.d(helpers_namespaceObject,"renderLayer",function(){return helpers_renderLayer}),__webpack_require__.d(helpers_namespaceObject,"resolveInvalidTransformType",function(){return helpers_resolveInvalidTransformType}),__webpack_require__.d(helpers_namespaceObject,"getValidTransform",function(){return getValidTransform}),__webpack_require__.d(helpers_namespaceObject,"getValidTransformForAggFn",function(){return helpers_getValidTransformForAggFn}),__webpack_require__.d(helpers_namespaceObject,"getMarkId",function(){return helpers_getMarkId}),__webpack_require__.d(helpers_namespaceObject,"resolveEncodingValues",function(){return helpers_resolveEncodingValues}),__webpack_require__.d(helpers_namespaceObject,"getColorMetaInf",function(){return getColorMetaInf}),__webpack_require__.d(helpers_namespaceObject,"toCartesianCoordinates",function(){return toCartesianCoordinates}),__webpack_require__.d(helpers_namespaceObject,"sortData",function(){return sortData}),__webpack_require__.d(helpers_namespaceObject,"getBoundBoxes",function(){return helpers_getBoundBoxes}),__webpack_require__.d(helpers_namespaceObject,"getDataFromEvent",function(){return helpers_getDataFromEvent});var point_helper_namespaceObject={};__webpack_require__.r(point_helper_namespaceObject),__webpack_require__.d(point_helper_namespaceObject,"prepareDrawingInf",function(){return helper_prepareDrawingInf}),__webpack_require__.d(point_helper_namespaceObject,"pointTranslators",function(){return helper_pointTranslators}),__webpack_require__.d(point_helper_namespaceObject,"getStrokeWidthByPosition",function(){return getStrokeWidthByPosition});var layer_types_namespaceObject={};__webpack_require__.r(layer_types_namespaceObject),__webpack_require__.d(layer_types_namespaceObject,"AREA_LAYER",function(){return layer_types_AREA_LAYER}),__webpack_require__.d(layer_types_namespaceObject,"ARC_LAYER",function(){return layer_types_ARC_LAYER}),__webpack_require__.d(layer_types_namespaceObject,"LINE_LAYER",function(){return layer_types_LINE_LAYER}),__webpack_require__.d(layer_types_namespaceObject,"TEXT_LAYER",function(){return layer_types_TEXT_LAYER}),__webpack_require__.d(layer_types_namespaceObject,"POINT_LAYER",function(){return layer_types_POINT_LAYER}),__webpack_require__.d(layer_types_namespaceObject,"BAR_LAYER",function(){return layer_types_BAR_LAYER}),__webpack_require__.d(layer_types_namespaceObject,"TICK_LAYER",function(){return layer_types_TICK_LAYER}),__webpack_require__.d(layer_types_namespaceObject,"SIMPLE_LAYER",function(){return layer_types_SIMPLE_LAYER}),__webpack_require__.d(layer_types_namespaceObject,"BASE_LAYER",function(){return layer_types_BASE_LAYER});var src_enums_namespaceObject={};__webpack_require__.r(src_enums_namespaceObject),__webpack_require__.d(src_enums_namespaceObject,"PROPS",function(){return props_namespaceObject}),__webpack_require__.d(src_enums_namespaceObject,"LAYER_TYPES",function(){return layer_types_namespaceObject}),__webpack_require__.d(src_enums_namespaceObject,"CONSTANTS",function(){return enums_constants_namespaceObject});var visual_unit_src_helper_namespaceObject={};__webpack_require__.r(visual_unit_src_helper_namespaceObject),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"getDimensionMeasureMap",function(){return helper_getDimensionMeasureMap}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"transformDataModels",function(){return transformDataModels}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"getLayerFromDef",function(){return helper_getLayerFromDef}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"resolveEncodingTransform",function(){return resolveEncodingTransform}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"sanitizeLayerDef",function(){return helper_sanitizeLayerDef}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"attachDataToLayers",function(){return attachDataToLayers}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"attachAxisToLayers",function(){return helper_attachAxisToLayers}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"getLayerAxisIndex",function(){return helper_getLayerAxisIndex}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"unionDomainFromLayers",function(){return helper_unionDomainFromLayers}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"renderLayers",function(){return helper_renderLayers}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"getNearestDimensionalValue",function(){return helper_getNearestDimensionalValue}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"getLayersBy",function(){return getLayersBy}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"removeLayersBy",function(){return removeLayersBy}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"createSideEffectGroup",function(){return helper_createSideEffectGroup}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"createRenderPromise",function(){return createRenderPromise}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"getRadiusRange",function(){return getRadiusRange}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"setAxisRange",function(){return helper_setAxisRange}),__webpack_require__.d(visual_unit_src_helper_namespaceObject,"createRTree",function(){return helper_createRTree});var reactive_props_namespaceObject={};__webpack_require__.r(reactive_props_namespaceObject),__webpack_require__.d(reactive_props_namespaceObject,"CONFIG",function(){return reactive_props_CONFIG}),__webpack_require__.d(reactive_props_namespaceObject,"DATA",function(){return reactive_props_DATA}),__webpack_require__.d(reactive_props_namespaceObject,"AXES",function(){return AXES}),__webpack_require__.d(reactive_props_namespaceObject,"LAYERDEFS",function(){return LAYERDEFS}),__webpack_require__.d(reactive_props_namespaceObject,"WIDTH",function(){return reactive_props_WIDTH}),__webpack_require__.d(reactive_props_namespaceObject,"HEIGHT",function(){return reactive_props_HEIGHT}),__webpack_require__.d(reactive_props_namespaceObject,"MOUNT",function(){return reactive_props_MOUNT}),__webpack_require__.d(reactive_props_namespaceObject,"TRANSFORM",function(){return reactive_props_TRANSFORM}),__webpack_require__.d(reactive_props_namespaceObject,"TRANSFORMEDDATA",function(){return TRANSFORMEDDATA}),__webpack_require__.d(reactive_props_namespaceObject,"DATADOMAIN",function(){return DATADOMAIN}),__webpack_require__.d(reactive_props_namespaceObject,"FIELDS",function(){return FIELDS}),__webpack_require__.d(reactive_props_namespaceObject,"LAYERAXISINDEX",function(){return LAYERAXISINDEX}),__webpack_require__.d(reactive_props_namespaceObject,"LAYERS",function(){return reactive_props_LAYERS}),__webpack_require__.d(reactive_props_namespaceObject,"DOMAIN",function(){return reactive_props_DOMAIN});var visual_unit_src_enums_constants_namespaceObject={};__webpack_require__.r(visual_unit_src_enums_constants_namespaceObject),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"CLASSPREFIX",function(){return enums_constants_CLASSPREFIX}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"IDFIELD",function(){return IDFIELD}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"GRID_LINE_PARENT_GROUP_CLASS",function(){return GRID_LINE_PARENT_GROUP_CLASS}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"GRID_BAND_PARENT_GROUP_CLASS",function(){return GRID_BAND_PARENT_GROUP_CLASS}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"GRID_PARENT_GROUP",function(){return GRID_PARENT_GROUP}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"BAND",function(){return enums_constants_BAND}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"TICK",function(){return TICK}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"GRID_BAND",function(){return GRID_BAND}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"GRID_LINE",function(){return GRID_LINE}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"CONSOLIDATED",function(){return CONSOLIDATED}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"FRAGMENTED",function(){return FRAGMENTED}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"FACET_BY_FIELDS",function(){return FACET_BY_FIELDS}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"RETINAL_FIELDS",function(){return RETINAL_FIELDS}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"PARENT_ALIAS",function(){return PARENT_ALIAS}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"LAYERS",function(){return constants_LAYERS}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"CACHED_DATA",function(){return CACHED_DATA}),__webpack_require__.d(visual_unit_src_enums_constants_namespaceObject,"STORE",function(){return STORE});var visual_unit_src_enums_namespaceObject={};__webpack_require__.r(visual_unit_src_enums_namespaceObject),__webpack_require__.d(visual_unit_src_enums_namespaceObject,"REACTIVE_PROPS",function(){return reactive_props_namespaceObject}),__webpack_require__.d(visual_unit_src_enums_namespaceObject,"CONSTANTS",function(){return visual_unit_src_enums_constants_namespaceObject});var actions_namespaceObject={};__webpack_require__.r(actions_namespaceObject),__webpack_require__.d(actions_namespaceObject,"DRAG",function(){return DRAG}),__webpack_require__.d(actions_namespaceObject,"HOVER",function(){return HOVER}),__webpack_require__.d(actions_namespaceObject,"SELECTIONDRAG",function(){return SELECTIONDRAG}),__webpack_require__.d(actions_namespaceObject,"CLICK",function(){return CLICK}),__webpack_require__.d(actions_namespaceObject,"LONGTOUCH",function(){return LONGTOUCH}),__webpack_require__.d(actions_namespaceObject,"TOUCHDRAG",function(){return TOUCHDRAG}),__webpack_require__.d(actions_namespaceObject,"ALL_ACTIONS",function(){return ALL_ACTIONS});var enums_selection_namespaceObject={};__webpack_require__.r(enums_selection_namespaceObject),__webpack_require__.d(enums_selection_namespaceObject,"SELECTION_NEW_ENTRY",function(){return SELECTION_NEW_ENTRY}),__webpack_require__.d(enums_selection_namespaceObject,"SELECTION_NEW_EXIT",function(){return SELECTION_NEW_EXIT}),__webpack_require__.d(enums_selection_namespaceObject,"SELECTION_NULL",function(){return SELECTION_NULL}),__webpack_require__.d(enums_selection_namespaceObject,"SELECTION_OLD_ENTRY",function(){return SELECTION_OLD_ENTRY}),__webpack_require__.d(enums_selection_namespaceObject,"SELECTION_OLD_EXIT",function(){return SELECTION_OLD_EXIT});var behaviours_namespaceObject={};__webpack_require__.r(behaviours_namespaceObject),__webpack_require__.d(behaviours_namespaceObject,"BRUSH",function(){return BRUSH}),__webpack_require__.d(behaviours_namespaceObject,"HIGHLIGHT",function(){return HIGHLIGHT}),__webpack_require__.d(behaviours_namespaceObject,"TOOLTIP",function(){return behaviours_TOOLTIP}),__webpack_require__.d(behaviours_namespaceObject,"FILTER",function(){return FILTER}),__webpack_require__.d(behaviours_namespaceObject,"SELECT",function(){return SELECT});var behavioural_namespaceObject={};__webpack_require__.r(behavioural_namespaceObject),__webpack_require__.d(behavioural_namespaceObject,"HighlightBeahviour",function(){return highlight_HighlightBehaviour}),__webpack_require__.d(behavioural_namespaceObject,"BrushBehaviour",function(){return brush_BrushBehaviour}),__webpack_require__.d(behavioural_namespaceObject,"FilterBehaviour",function(){return filter_FilterBehaviour}),__webpack_require__.d(behavioural_namespaceObject,"SelectBehaviour",function(){return select_SelectBehaviour});var side_effects_namespaceObject={};__webpack_require__.r(side_effects_namespaceObject),__webpack_require__.d(side_effects_namespaceObject,"ANCHORS",function(){return side_effects_ANCHORS}),__webpack_require__.d(side_effects_namespaceObject,"BRUSH_ANCHORS",function(){return side_effects_BRUSH_ANCHORS}),__webpack_require__.d(side_effects_namespaceObject,"PERSISTENT_ANCHORS",function(){return side_effects_PERSISTENT_ANCHORS}),__webpack_require__.d(side_effects_namespaceObject,"FILTER",function(){return side_effects_FILTER}),__webpack_require__.d(side_effects_namespaceObject,"HIGHLIGHTER",function(){return side_effects_HIGHLIGHTER}),__webpack_require__.d(side_effects_namespaceObject,"CROSSLINE",function(){return CROSSLINE}),__webpack_require__.d(side_effects_namespaceObject,"TOOLTIP",function(){return side_effects_TOOLTIP}),__webpack_require__.d(side_effects_namespaceObject,"FRAGMENTED_TOOLTIP",function(){return FRAGMENTED_TOOLTIP}),__webpack_require__.d(side_effects_namespaceObject,"AXIS_LABEL_HIGHLIGHTER",function(){return AXIS_LABEL_HIGHLIGHTER});var src_side_effects_namespaceObject={};__webpack_require__.r(src_side_effects_namespaceObject),__webpack_require__.d(src_side_effects_namespaceObject,"SelectionBox",function(){return selection_box}),__webpack_require__.d(src_side_effects_namespaceObject,"Tooltip",function(){return side_effects_tooltip_Tooltip}),__webpack_require__.d(src_side_effects_namespaceObject,"FragmentedTooltip",function(){return fragmented_tooltip_FragmentedTooltip}),__webpack_require__.d(src_side_effects_namespaceObject,"Crossline",function(){return crossline_Crossline}),__webpack_require__.d(src_side_effects_namespaceObject,"PlotHighlighter",function(){return plot_highlighter_PlotHighlighter}),__webpack_require__.d(src_side_effects_namespaceObject,"FilterEffect",function(){return FilterEffect}),__webpack_require__.d(src_side_effects_namespaceObject,"PersistentAnchors",function(){return persistent_anchors_PersistentAnchors}),__webpack_require__.d(src_side_effects_namespaceObject,"BrushAnchors",function(){return brush_anchors_BrushAnchors}),__webpack_require__.d(src_side_effects_namespaceObject,"AnchorEffect",function(){return anchors_AnchorEffect}),__webpack_require__.d(src_side_effects_namespaceObject,"AxisLabelHighLighter",function(){return axis_labels_highlighter_AxisLabelHighLighter});var group_utils_namespaceObject={};__webpack_require__.r(group_utils_namespaceObject),__webpack_require__.d(group_utils_namespaceObject,"initStore",function(){return group_utils_initStore}),__webpack_require__.d(group_utils_namespaceObject,"isDistributionEqual",function(){return group_utils_isDistributionEqual}),__webpack_require__.d(group_utils_namespaceObject,"initializeCacheMaps",function(){return initializeCacheMaps}),__webpack_require__.d(group_utils_namespaceObject,"getAxisKey",function(){return getAxisKey}),__webpack_require__.d(group_utils_namespaceObject,"getCellKey",function(){return getCellKey}),__webpack_require__.d(group_utils_namespaceObject,"extractUnitConfig",function(){return group_utils_extractUnitConfig}),__webpack_require__.d(group_utils_namespaceObject,"hasOneField",function(){return hasOneField}),__webpack_require__.d(group_utils_namespaceObject,"getHeaderText",function(){return getHeaderText}),__webpack_require__.d(group_utils_namespaceObject,"headerCreator",function(){return group_utils_headerCreator}),__webpack_require__.d(group_utils_namespaceObject,"sanitizeCheck",function(){return group_utils_sanitizeCheck}),__webpack_require__.d(group_utils_namespaceObject,"findInGroup",function(){return group_utils_findInGroup}),__webpack_require__.d(group_utils_namespaceObject,"getAxisType",function(){return group_utils_getAxisType}),__webpack_require__.d(group_utils_namespaceObject,"retriveDomainFromData",function(){return retriveDomainFromData}),__webpack_require__.d(group_utils_namespaceObject,"mutateAxesFromMap",function(){return mutateAxesFromMap}),__webpack_require__.d(group_utils_namespaceObject,"getEncoder",function(){return group_utils_getEncoder}),__webpack_require__.d(group_utils_namespaceObject,"getHeaderAxisFrom",function(){return group_utils_getHeaderAxisFrom}),__webpack_require__.d(group_utils_namespaceObject,"setFacetsAndProjections",function(){return setFacetsAndProjections}),__webpack_require__.d(group_utils_namespaceObject,"getBorders",function(){return getBorders}),__webpack_require__.d(group_utils_namespaceObject,"getFieldsFromSuppliedLayers",function(){return getFieldsFromSuppliedLayers}),__webpack_require__.d(group_utils_namespaceObject,"extractFields",function(){return group_utils_extractFields}),__webpack_require__.d(group_utils_namespaceObject,"sortFacetFields",function(){return group_utils_sortFacetFields}),__webpack_require__.d(group_utils_namespaceObject,"removeExitCells",function(){return group_utils_removeExitCells});var encoder_helper_namespaceObject={};__webpack_require__.r(encoder_helper_namespaceObject),__webpack_require__.d(encoder_helper_namespaceObject,"getAdjustedDomain",function(){return getAdjustedDomain}),__webpack_require__.d(encoder_helper_namespaceObject,"generateAxisFromMap",function(){return encoder_helper_generateAxisFromMap}),__webpack_require__.d(encoder_helper_namespaceObject,"sanitizeIndividualLayerConfig",function(){return encoder_helper_sanitizeIndividualLayerConfig}),__webpack_require__.d(encoder_helper_namespaceObject,"mutateAxesFromMap",function(){return encoder_helper_mutateAxesFromMap}),__webpack_require__.d(encoder_helper_namespaceObject,"getDefaultMark",function(){return encoder_helper_getDefaultMark}),__webpack_require__.d(encoder_helper_namespaceObject,"createRetinalAxis",function(){return encoder_helper_createRetinalAxis}),__webpack_require__.d(encoder_helper_namespaceObject,"getIndex",function(){return getIndex}),__webpack_require__.d(encoder_helper_namespaceObject,"getLayerConfFromFields",function(){return getLayerConfFromFields}),__webpack_require__.d(encoder_helper_namespaceObject,"resolveAxisConfig",function(){return encoder_helper_resolveAxisConfig}),__webpack_require__.d(encoder_helper_namespaceObject,"getSortingConfig",function(){return getSortingConfig});var encoder_namespaceObject={};__webpack_require__.r(encoder_namespaceObject),__webpack_require__.d(encoder_namespaceObject,"VisualEncoder",function(){return visual_encoder_VisualEncoder}),__webpack_require__.d(encoder_namespaceObject,"CartesianEncoder",function(){return cartesian_encoder_CartesianEncoder}),__webpack_require__.d(encoder_namespaceObject,"PolarEncoder",function(){return polar_encoder_PolarEncoder}),__webpack_require__.d(encoder_namespaceObject,"RetinalEncoder",function(){return retinal_encoder_RetinalEncoder});var firebolt_behavioural_namespaceObject={};__webpack_require__.r(firebolt_behavioural_namespaceObject),__webpack_require__.d(firebolt_behavioural_namespaceObject,"SelectBehaviour",function(){return behavioural_select_SelectBehaviour});var firebolt_side_effects_namespaceObject={};__webpack_require__.r(firebolt_side_effects_namespaceObject),__webpack_require__.d(firebolt_side_effects_namespaceObject,"SelectionBox",function(){return side_effects_selection_box}),__webpack_require__.d(firebolt_side_effects_namespaceObject,"LegendHighlighter",function(){return legend_highlighter_LegendHighlighter}),__webpack_require__.d(firebolt_side_effects_namespaceObject,"LegendMarker",function(){return legend_marker_LegendMarker});var operators_namespaceObject={};__webpack_require__.r(operators_namespaceObject),__webpack_require__.d(operators_namespaceObject,"share",function(){return operators_share}),__webpack_require__.d(operators_namespaceObject,"html",function(){return operators_html});var dist_datamodel=__webpack_require__(0),datamodel_default=__webpack_require__.n(dist_datamodel),ascending=function(a,b){return a<b?-1:a>b?1:a>=b?0:NaN},bisector=function(compare){return 1===compare.length&&(compare=function ascendingComparator(f){return function(d,x){return ascending(f(d),x)}}(compare)),{left:function left(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)<0?lo=mid+1:hi=mid}return lo},right:function right(a,x,lo,hi){for(null==lo&&(lo=0),null==hi&&(hi=a.length);lo<hi;){var mid=lo+hi>>>1;compare(a[mid],x)>0?hi=mid:lo=mid+1}return lo}}};var ascendingBisect=bisector(ascending),bisectRight=ascendingBisect.right,bisect=(ascendingBisect.left,bisectRight);var number=function(x){return null===x?NaN:+x},array_array=Array.prototype,src_range=(array_array.slice,array_array.map,function(start,stop,step){start=+start,stop=+stop,step=(n=arguments.length)<2?(stop=start,start=0,1):n<3?1:+step;for(var i=-1,n=0|Math.max(0,Math.ceil((stop-start)/step)),range=new Array(n);++i<n;)range[i]=start+i*step;return range}),e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2),src_ticks=function(start,stop,count){var reverse,n,ticks,step,i=-1;if(count=+count,(start=+start)===(stop=+stop)&&count>0)return[start];if((reverse=stop<start)&&(n=start,start=stop,stop=n),0===(step=tickIncrement(start,stop,count))||!isFinite(step))return[];if(step>0)for(start=Math.ceil(start/step),stop=Math.floor(stop/step),ticks=new Array(n=Math.ceil(stop-start+1));++i<n;)ticks[i]=(start+i)*step;else for(start=Math.floor(start*step),stop=Math.ceil(stop*step),ticks=new Array(n=Math.ceil(start-stop+1));++i<n;)ticks[i]=(start-i)/step;return reverse&&ticks.reverse(),ticks};function tickIncrement(start,stop,count){var step=(stop-start)/Math.max(0,count),power=Math.floor(Math.log(step)/Math.LN10),error=step/Math.pow(10,power);return power>=0?(error>=e10?10:error>=e5?5:error>=e2?2:1)*Math.pow(10,power):-Math.pow(10,-power)/(error>=e10?10:error>=e5?5:error>=e2?2:1)}function tickStep(start,stop,count){var step0=Math.abs(stop-start)/Math.max(0,count),step1=Math.pow(10,Math.floor(Math.log(step0)/Math.LN10)),error=step0/step1;return error>=e10?step1*=10:error>=e5?step1*=5:error>=e2&&(step1*=2),stop<start?-step1:step1}var quantile=function(values,p,valueof){if(null==valueof&&(valueof=number),n=values.length){if((p=+p)<=0||n<2)return+valueof(values[0],0,values);if(p>=1)return+valueof(values[n-1],n-1,values);var n,i=(n-1)*p,i0=Math.floor(i),value0=+valueof(values[i0],i0,values);return value0+(+valueof(values[i0+1],i0+1,values)-value0)*(i-i0)}};function map_Map(){}function map_map(object,f){var map=new map_Map;if(object instanceof map_Map)object.each(function(value,key){map.set(key,value)});else if(Array.isArray(object)){var o,i=-1,n=object.length;if(null==f)for(;++i<n;)map.set(i,object[i]);else for(;++i<n;)map.set(f(o=object[i],i,object),o)}else if(object)for(var key in object)map.set(key,object[key]);return map}map_Map.prototype=map_map.prototype={constructor:map_Map,has:function has(key){return"$"+key in this},get:function get(key){return this["$"+key]},set:function set(key,value){return this["$"+key]=value,this},remove:function remove(key){var property="$"+key;return property in this&&delete this[property]},clear:function clear(){for(var property in this)"$"===property[0]&&delete this[property]},keys:function keys(){var keys=[];for(var property in this)"$"===property[0]&&keys.push(property.slice(1));return keys},values:function values(){var values=[];for(var property in this)"$"===property[0]&&values.push(this[property]);return values},entries:function entries(){var entries=[];for(var property in this)"$"===property[0]&&entries.push({key:property.slice(1),value:this[property]});return entries},size:function size(){var size=0;for(var property in this)"$"===property[0]&&++size;return size},empty:function empty(){for(var property in this)if("$"===property[0])return!1;return!0},each:function each(f){for(var property in this)"$"===property[0]&&f(this[property],property.slice(1),this)}};var src_map=map_map,src_nest=function(){var _sortValues,_rollup,nest,keys=[],_sortKeys=[];function apply(array,depth,createResult,setResult){if(depth>=keys.length)return null!=_sortValues&&array.sort(_sortValues),null!=_rollup?_rollup(array):array;for(var keyValue,value,values,i=-1,n=array.length,key=keys[depth++],valuesByKey=src_map(),result=createResult();++i<n;)(values=valuesByKey.get(keyValue=key(value=array[i])+""))?values.push(value):valuesByKey.set(keyValue,[value]);return valuesByKey.each(function(values,key){setResult(result,key,apply(values,depth,createResult,setResult))}),result}return nest={object:function object(array){return apply(array,0,createObject,setObject)},map:function map(array){return apply(array,0,createMap,setMap)},entries:function entries(array){return function _entries(map,depth){if(++depth>keys.length)return map;var array,sortKey=_sortKeys[depth-1];return null!=_rollup&&depth>=keys.length?array=map.entries():(array=[],map.each(function(v,k){array.push({key:k,values:_entries(v,depth)})})),null!=sortKey?array.sort(function(a,b){return sortKey(a.key,b.key)}):array}(apply(array,0,createMap,setMap),0)},key:function key(d){return keys.push(d),nest},sortKeys:function sortKeys(order){return _sortKeys[keys.length-1]=order,nest},sortValues:function sortValues(order){return _sortValues=order,nest},rollup:function rollup(f){return _rollup=f,nest}}};function createObject(){return{}}function setObject(object,key,value){object[key]=value}function createMap(){return src_map()}function setMap(map,key,value){map.set(key,value)}function set_Set(){}var proto=src_map.prototype;function set_set(object,f){var set=new set_Set;if(object instanceof set_Set)object.each(function(value){set.add(value)});else if(object){var i=-1,n=object.length;if(null==f)for(;++i<n;)set.add(object[i]);else for(;++i<n;)set.add(f(object[i],i,object))}return set}set_Set.prototype=set_set.prototype={constructor:set_Set,has:proto.has,add:function add(value){return this["$"+(value+="")]=value,this},remove:proto.remove,clear:proto.clear,values:proto.keys,size:proto.size,empty:proto.empty,each:proto.each};var src_array_array=Array.prototype,src_array_map=src_array_array.map,array_slice=src_array_array.slice,implicit={name:"implicit"};function ordinal(range){var index=src_map(),domain=[],unknown=implicit;function scale(d){var key=d+"",i=index.get(key);if(!i){if(unknown!==implicit)return unknown;index.set(key,i=domain.push(d))}return range[(i-1)%range.length]}return range=null==range?[]:array_slice.call(range),scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[],index=src_map();for(var d,key,i=-1,n=_.length;++i<n;)index.has(key=(d=_[i])+"")||index.set(key,domain.push(d));return scale},scale.range=function(_){return arguments.length?(range=array_slice.call(_),scale):range.slice()},scale.unknown=function(_){return arguments.length?(unknown=_,scale):unknown},scale.copy=function(){return ordinal().domain(domain).range(range).unknown(unknown)},scale}function band(){var step,bandwidth,scale=ordinal().unknown(void 0),domain=scale.domain,ordinalRange=scale.range,range=[0,1],round=!1,paddingInner=0,paddingOuter=0,align=.5;function rescale(){var n=domain().length,reverse=range[1]<range[0],start=range[reverse-0],stop=range[1-reverse];step=(stop-start)/Math.max(1,n-paddingInner+2*paddingOuter),round&&(step=Math.floor(step)),start+=(stop-start-step*(n-paddingInner))*align,bandwidth=step*(1-paddingInner),round&&(start=Math.round(start),bandwidth=Math.round(bandwidth));var values=src_range(n).map(function(i){return start+step*i});return ordinalRange(reverse?values.reverse():values)}return delete scale.unknown,scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.range=function(_){return arguments.length?(range=[+_[0],+_[1]],rescale()):range.slice()},scale.rangeRound=function(_){return range=[+_[0],+_[1]],round=!0,rescale()},scale.bandwidth=function(){return bandwidth},scale.step=function(){return step},scale.round=function(_){return arguments.length?(round=!!_,rescale()):round},scale.padding=function(_){return arguments.length?(paddingInner=paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingInner},scale.paddingInner=function(_){return arguments.length?(paddingInner=Math.max(0,Math.min(1,_)),rescale()):paddingInner},scale.paddingOuter=function(_){return arguments.length?(paddingOuter=Math.max(0,Math.min(1,_)),rescale()):paddingOuter},scale.align=function(_){return arguments.length?(align=Math.max(0,Math.min(1,_)),rescale()):align},scale.copy=function(){return band().domain(domain()).range(range).round(round).paddingInner(paddingInner).paddingOuter(paddingOuter).align(align)},scale.invertExtent=function(r0,r1){var a,b,t,hiIndex,lo=+r0,hi=arguments.length>1?+r1:lo,reverse=range[1]<range[0],values=reverse?ordinalRange().reverse():ordinalRange(),n=values.length-1;if(values.push(values[n]+this.step()),hi<lo&&(t=lo,lo=hi,hi=t),!(hi<values[0]||lo>range[1-reverse]))return a=Math.max(0,getClosestIndexOf(values,lo)),hiIndex=getClosestIndexOf(values,hi),b=lo===hi?a:Math.max(a,hiIndex-1),reverse&&(t=a,a=n-b,b=n-t),a>b?void 0:domain().slice(a,b+1)},scale.invert=function(r0,r1){var a,t,lo=+r0,hi=arguments.length>1?+r1:lo,reverse=range[1]<range[0],values=reverse?ordinalRange().reverse():ordinalRange(),n=values.length-1;if(hi<lo&&(t=lo,lo=hi,hi=t),!(hi<values[0]||lo>range[1-reverse]))return a=Math.max(0,getClosestIndexOf(values,lo,"left")),domain()[reverse?n-a:a]},rescale()}function getClosestIndexOf(arr,value,side){for(var highVal,mid,d1,low=0,high=arr.length-1;low<high;)mid=Math.floor((low+high)/2),d1=Math.abs(arr[mid]-value),Math.abs(arr[mid+1]-value)<=d1?low=mid+1:high=mid;return side?(highVal=arr[high])===value?high:highVal>value?0===high?high:"left"===side?high-1:high:high===arr.length-1?high:"left"===side?high:high+1:high}var src_number=function(a,b){return a=+a,b=+b,function(t){return a*(1-t)+b*t}},define=function(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype,prototype.constructor=constructor};function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}function Color(){}var reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp("^rgb\\("+[reI,reI,reI]+"\\)$"),reRgbPercent=new RegExp("^rgb\\("+[reP,reP,reP]+"\\)$"),reRgbaInteger=new RegExp("^rgba\\("+[reI,reI,reI,reN]+"\\)$"),reRgbaPercent=new RegExp("^rgba\\("+[reP,reP,reP,reN]+"\\)$"),reHslPercent=new RegExp("^hsl\\("+[reN,reP,reP]+"\\)$"),reHslaPercent=new RegExp("^hsla\\("+[reN,reP,reP,reN]+"\\)$"),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatRgb(){return this.rgb().formatRgb()}function color_color(format){var m,l;return format=(format+"").trim().toLowerCase(),(m=reHex.exec(format))?(l=m[1].length,m=parseInt(m[1],16),6===l?rgbn(m):3===l?new Rgb(m>>8&15|m>>4&240,m>>4&15|240&m,(15&m)<<4|15&m,1):8===l?new Rgb(m>>24&255,m>>16&255,m>>8&255,(255&m)/255):4===l?new Rgb(m>>12&15|m>>8&240,m>>8&15|m>>4&240,m>>4&15|240&m,((15&m)<<4|15&m)/255):null):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(255*m[1]/100,255*m[2]/100,255*m[3]/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(255*m[1]/100,255*m[2]/100,255*m[3]/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):"transparent"===format?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,255&n,1)}function rgba(r,g,b,a){return a<=0&&(r=g=b=NaN),new Rgb(r,g,b,a)}function rgbConvert(o){return o instanceof Color||(o=color_color(o)),o?new Rgb((o=o.rgb()).r,o.g,o.b,o.opacity):new Rgb}function color_rgb(r,g,b,opacity){return 1===arguments.length?rgbConvert(r):new Rgb(r,g,b,null==opacity?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r,this.g=+g,this.b=+b,this.opacity=+opacity}function rgb_formatHex(){return"#"+hex(this.r)+hex(this.g)+hex(this.b)}function rgb_formatRgb(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===a?")":", "+a+")")}function hex(value){return((value=Math.max(0,Math.min(255,Math.round(value)||0)))<16?"0":"")+value.toString(16)}function hsla(h,s,l,a){return a<=0?h=s=l=NaN:l<=0||l>=1?h=s=NaN:s<=0&&(h=NaN),new Hsl(h,s,l,a)}function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color_color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;var r=(o=o.rgb()).r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;return s?(h=r===max?(g-b)/s+6*(g<b):g===max?(b-r)/s+2:(r-g)/s+4,s/=l<.5?max+min:2-max-min,h*=60):s=l>0&&l<1?0:h,new Hsl(h,s,l,o.opacity)}function hsl(h,s,l,opacity){return 1===arguments.length?hslConvert(h):new Hsl(h,s,l,null==opacity?1:opacity)}function Hsl(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function hsl2rgb(h,m1,m2){return 255*(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)}function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}define(Color,color_color,{copy:function copy(channels){return Object.assign(new this.constructor,this,channels)},displayable:function displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHsl:function color_formatHsl(){return hslConvert(this).formatHsl()},formatRgb:color_formatRgb,toString:color_formatRgb}),define(Rgb,color_rgb,extend(Color,{brighter:function brighter(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker:function darker(k){return k=null==k?.7:Math.pow(.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb:function rgb(){return this},displayable:function displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),define(Hsl,hsl,extend(Color,{brighter:function brighter(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},darker:function darker(k){return k=null==k?.7:Math.pow(.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb:function rgb(){var h=this.h%360+360*(this.h<0),s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},displayable:function displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function formatHsl(){var a=this.opacity;return(1===(a=isNaN(a)?1:Math.max(0,Math.min(1,a)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===a?")":", "+a+")")}}));var src_constant=function(x){return function(){return x}};function linear(a,d){return function(t){return a+t*d}}function color_hue(a,b){var d=b-a;return d?linear(a,d>180||d<-180?d-360*Math.round(d/360):d):src_constant(isNaN(a)?b:a)}function gamma(y){return 1==(y=+y)?nogamma:function(a,b){return b-a?function exponential(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}(a,b,y):src_constant(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):src_constant(isNaN(a)?b:a)}var src_rgb=function rgbGamma(y){var color=gamma(y);function rgb(start,end){var r=color((start=color_rgb(start)).r,(end=color_rgb(end)).r),g=color(start.g,end.g),b=color(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.r=r(t),start.g=g(t),start.b=b(t),start.opacity=opacity(t),start+""}}return rgb.gamma=rgbGamma,rgb}(1);function rgbSpline(spline){return function(colors){var i,color,n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n);for(i=0;i<n;++i)color=color_rgb(colors[i]),r[i]=color.r||0,g[i]=color.g||0,b[i]=color.b||0;return r=spline(r),g=spline(g),b=spline(b),color.opacity=1,function(t){return color.r=r(t),color.g=g(t),color.b=b(t),color+""}}}var rgbBasis=rgbSpline(function(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}}),numberArray=(rgbSpline(function(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return basis((t-i/n)*n,v0,v1,v2,v3)}}),function(a,b){b||(b=[]);var i,n=a?Math.min(b.length,a.length):0,c=b.slice();return function(t){for(i=0;i<n;++i)c[i]=a[i]*(1-t)+b[i]*t;return c}});function isNumberArray(x){return ArrayBuffer.isView(x)&&!(x instanceof DataView)}function genericArray(a,b){var i,nb=b?b.length:0,na=a?Math.min(nb,a.length):0,x=new Array(na),c=new Array(nb);for(i=0;i<na;++i)x[i]=src_value(a[i],b[i]);for(;i<nb;++i)c[i]=b[i];return function(t){for(i=0;i<na;++i)c[i]=x[i](t);return c}}function _typeof(obj){"@babel/helpers - typeof";return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");var src_string=function(a,b){var am,bm,bs,bi=reA.lastIndex=reB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=reA.exec(a))&&(bm=reB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i:i,x:src_number(am,bm)})),bi=reB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?function one(b){return function(t){return b(t)+""}}(q[0].x):function string_zero(b){return function(){return b}}(b):(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})};function value_typeof(obj){"@babel/helpers - typeof";return(value_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var src_value=function(a,b){var c,t=value_typeof(b);return null==b||"boolean"===t?src_constant(b):("number"===t?src_number:"string"===t?(c=color_color(b))?(b=c,src_rgb):src_string:b instanceof color_color?src_rgb:b instanceof Date?function(a,b){var d=new Date;return a=+a,b=+b,function(t){return d.setTime(a*(1-t)+b*t),d}}:isNumberArray(b)?numberArray:Array.isArray(b)?genericArray:"function"!=typeof b.valueOf&&"function"!=typeof b.toString||isNaN(b)?function(a,b){var k,i={},c={};for(k in null!==a&&"object"===_typeof(a)||(a={}),null!==b&&"object"===_typeof(b)||(b={}),b)k in a?i[k]=src_value(a[k],b[k]):c[k]=b[k];return function(t){for(k in i)c[k]=i[k](t);return c}}:src_number)(a,b)},src_round=function(a,b){return a=+a,b=+b,function(t){return Math.round(a*(1-t)+b*t)}},d3_scale_src_constant=function(x){return function(){return x}},d3_scale_src_number=function(x){return+x},continuous_unit=[0,1];function deinterpolateLinear(a,b){return(b-=a=+a)?function(x){return(x-a)/b}:d3_scale_src_constant(b)}function bimap(domain,range,deinterpolate,reinterpolate){var d0=domain[0],d1=domain[1],r0=range[0],r1=range[1];return d1<d0?(d0=deinterpolate(d1,d0),r0=reinterpolate(r1,r0)):(d0=deinterpolate(d0,d1),r0=reinterpolate(r0,r1)),function(x){return r0(d0(x))}}function polymap(domain,range,deinterpolate,reinterpolate){var j=Math.min(domain.length,range.length)-1,d=new Array(j),r=new Array(j),i=-1;for(domain[j]<domain[0]&&(domain=domain.slice().reverse(),range=range.slice().reverse());++i<j;)d[i]=deinterpolate(domain[i],domain[i+1]),r[i]=reinterpolate(range[i],range[i+1]);return function(x){var i=bisect(domain,x,1,j)-1;return r[i](d[i](x))}}function copy(source,target){return target.domain(source.domain()).range(source.range()).interpolate(source.interpolate()).clamp(source.clamp())}function continuous(deinterpolate,reinterpolate){var piecewise,output,input,domain=continuous_unit,range=continuous_unit,interpolate=src_value,clamp=!1;function rescale(){return piecewise=Math.min(domain.length,range.length)>2?polymap:bimap,output=input=null,scale}function scale(x){return(output||(output=piecewise(domain,range,clamp?function deinterpolateClamp(deinterpolate){return function(a,b){var d=deinterpolate(a=+a,b=+b);return function(x){return x<=a?0:x>=b?1:d(x)}}}(deinterpolate):deinterpolate,interpolate)))(+x)}return scale.invert=function(y){return(input||(input=piecewise(range,domain,deinterpolateLinear,clamp?function reinterpolateClamp(reinterpolate){return function(a,b){var r=reinterpolate(a=+a,b=+b);return function(t){return t<=0?a:t>=1?b:r(t)}}}(reinterpolate):reinterpolate)))(+y)},scale.domain=function(_){return arguments.length?(domain=src_array_map.call(_,d3_scale_src_number),rescale()):domain.slice()},scale.range=function(_){return arguments.length?(range=array_slice.call(_),rescale()):range.slice()},scale.rangeRound=function(_){return range=array_slice.call(_),interpolate=src_round,rescale()},scale.clamp=function(_){return arguments.length?(clamp=!!_,rescale()):clamp},scale.interpolate=function(_){return arguments.length?(interpolate=_,rescale()):interpolate},rescale()}var re=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(specifier){if(!(match=re.exec(specifier)))throw new Error("invalid format: "+specifier);var match;return new FormatSpecifier({fill:match[1],align:match[2],sign:match[3],symbol:match[4],zero:match[5],width:match[6],comma:match[7],precision:match[8]&&match[8].slice(1),trim:match[9],type:match[10]})}function FormatSpecifier(specifier){this.fill=void 0===specifier.fill?" ":specifier.fill+"",this.align=void 0===specifier.align?">":specifier.align+"",this.sign=void 0===specifier.sign?"-":specifier.sign+"",this.symbol=void 0===specifier.symbol?"":specifier.symbol+"",this.zero=!!specifier.zero,this.width=void 0===specifier.width?void 0:+specifier.width,this.comma=!!specifier.comma,this.precision=void 0===specifier.precision?void 0:+specifier.precision,this.trim=!!specifier.trim,this.type=void 0===specifier.type?"":specifier.type+""}formatSpecifier.prototype=FormatSpecifier.prototype,FormatSpecifier.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var prefixExponent,defaultLocale_locale,defaultLocale_format,defaultLocale_formatPrefix,formatDecimal=function(x,p){if((i=(x=p?x.toExponential(p-1):x.toExponential()).indexOf("e"))<0)return null;var i,coefficient=x.slice(0,i);return[coefficient.length>1?coefficient[0]+coefficient.slice(2):coefficient,+x.slice(i+1)]},src_exponent=function(x){return(x=formatDecimal(Math.abs(x)))?x[1]:NaN},formatTrim=function(s){out:for(var i1,n=s.length,i=1,i0=-1;i<n;++i)switch(s[i]){case".":i0=i1=i;break;case"0":0===i0&&(i0=i),i1=i;break;default:if(!+s[i])break out;i0>0&&(i0=0)}return i0>0?s.slice(0,i0)+s.slice(i1+1):s},formatRounded=function(x,p){var d=formatDecimal(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1];return exponent<0?"0."+new Array(-exponent).join("0")+coefficient:coefficient.length>exponent+1?coefficient.slice(0,exponent+1)+"."+coefficient.slice(exponent+1):coefficient+new Array(exponent-coefficient.length+2).join("0")},formatTypes={"%":function _(x,p){return(100*x).toFixed(p)},b:function b(x){return Math.round(x).toString(2)},c:function c(x){return x+""},d:function d(x){return Math.round(x).toString(10)},e:function e(x,p){return x.toExponential(p)},f:function f(x,p){return x.toFixed(p)},g:function g(x,p){return x.toPrecision(p)},o:function o(x){return Math.round(x).toString(8)},p:function p(x,_p){return formatRounded(100*x,_p)},r:formatRounded,s:function(x,p){var d=formatDecimal(x,p);if(!d)return x+"";var coefficient=d[0],exponent=d[1],i=exponent-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(exponent/3))))+1,n=coefficient.length;return i===n?coefficient:i>n?coefficient+new Array(i-n+1).join("0"):i>0?coefficient.slice(0,i)+"."+coefficient.slice(i):"0."+new Array(1-i).join("0")+formatDecimal(x,Math.max(0,p+i-1))[0]},X:function X(x){return Math.round(x).toString(16).toUpperCase()},x:function x(_x){return Math.round(_x).toString(16)}},src_identity=function(x){return x},locale_map=Array.prototype.map,prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],src_locale=function(locale){var group=void 0===locale.grouping||void 0===locale.thousands?src_identity:function(grouping,thousands){return function(value,width){for(var i=value.length,t=[],j=0,g=grouping[0],length=0;i>0&&g>0&&(length+g+1>width&&(g=Math.max(1,width-length)),t.push(value.substring(i-=g,i+g)),!((length+=g+1)>width));)g=grouping[j=(j+1)%grouping.length];return t.reverse().join(thousands)}}(locale_map.call(locale.grouping,Number),locale.thousands+""),currencyPrefix=void 0===locale.currency?"":locale.currency[0]+"",currencySuffix=void 0===locale.currency?"":locale.currency[1]+"",decimal=void 0===locale.decimal?".":locale.decimal+"",numerals=void 0===locale.numerals?src_identity:function(numerals){return function(value){return value.replace(/[0-9]/g,function(i){return numerals[+i]})}}(locale_map.call(locale.numerals,String)),percent=void 0===locale.percent?"%":locale.percent+"",minus=void 0===locale.minus?"-":locale.minus+"",nan=void 0===locale.nan?"NaN":locale.nan+"";function newFormat(specifier){var fill=(specifier=formatSpecifier(specifier)).fill,align=specifier.align,sign=specifier.sign,symbol=specifier.symbol,zero=specifier.zero,width=specifier.width,comma=specifier.comma,precision=specifier.precision,trim=specifier.trim,type=specifier.type;"n"===type?(comma=!0,type="g"):formatTypes[type]||(void 0===precision&&(precision=12),trim=!0,type="g"),(zero||"0"===fill&&"="===align)&&(zero=!0,fill="0",align="=");var prefix="$"===symbol?currencyPrefix:"#"===symbol&&/[boxX]/.test(type)?"0"+type.toLowerCase():"",suffix="$"===symbol?currencySuffix:/[%p]/.test(type)?percent:"",formatType=formatTypes[type],maybeSuffix=/[defgprs%]/.test(type);function format(value){var i,n,c,valuePrefix=prefix,valueSuffix=suffix;if("c"===type)valueSuffix=formatType(value)+valueSuffix,value="";else{var valueNegative=(value=+value)<0;if(value=isNaN(value)?nan:formatType(Math.abs(value),precision),trim&&(value=formatTrim(value)),valueNegative&&0==+value&&(valueNegative=!1),valuePrefix=(valueNegative?"("===sign?sign:minus:"-"===sign||"("===sign?"":sign)+valuePrefix,valueSuffix=("s"===type?prefixes[8+prefixExponent/3]:"")+valueSuffix+(valueNegative&&"("===sign?")":""),maybeSuffix)for(i=-1,n=value.length;++i<n;)if(48>(c=value.charCodeAt(i))||c>57){valueSuffix=(46===c?decimal+value.slice(i+1):value.slice(i))+valueSuffix,value=value.slice(0,i);break}}comma&&!zero&&(value=group(value,1/0));var length=valuePrefix.length+value.length+valueSuffix.length,padding=length<width?new Array(width-length+1).join(fill):"";switch(comma&&zero&&(value=group(padding+value,padding.length?width-valueSuffix.length:1/0),padding=""),align){case"<":value=valuePrefix+value+valueSuffix+padding;break;case"=":value=valuePrefix+padding+value+valueSuffix;break;case"^":value=padding.slice(0,length=padding.length>>1)+valuePrefix+value+valueSuffix+padding.slice(length);break;default:value=padding+valuePrefix+value+valueSuffix}return numerals(value)}return precision=void 0===precision?6:/[gprs]/.test(type)?Math.max(1,Math.min(21,precision)):Math.max(0,Math.min(20,precision)),format.toString=function(){return specifier+""},format}return{format:newFormat,formatPrefix:function formatPrefix(specifier,value){var f=newFormat(((specifier=formatSpecifier(specifier)).type="f",specifier)),e=3*Math.max(-8,Math.min(8,Math.floor(src_exponent(value)/3))),k=Math.pow(10,-e),prefix=prefixes[8+e/3];return function(value){return f(k*value)+prefix}}}};!function defaultLocale(definition){return defaultLocale_locale=src_locale(definition),defaultLocale_format=defaultLocale_locale.format,defaultLocale_formatPrefix=defaultLocale_locale.formatPrefix,defaultLocale_locale}({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var src_tickFormat=function(domain,count,specifier){var precision,start=domain[0],stop=domain[domain.length-1],step=tickStep(start,stop,null==count?10:count);switch((specifier=formatSpecifier(null==specifier?",f":specifier)).type){case"s":var value=Math.max(Math.abs(start),Math.abs(stop));return null!=specifier.precision||isNaN(precision=function(step,value){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(src_exponent(value)/3)))-src_exponent(Math.abs(step)))}(step,value))||(specifier.precision=precision),defaultLocale_formatPrefix(specifier,value);case"":case"e":case"g":case"p":case"r":null!=specifier.precision||isNaN(precision=function(step,max){return step=Math.abs(step),max=Math.abs(max)-step,Math.max(0,src_exponent(max)-src_exponent(step))+1}(step,Math.max(Math.abs(start),Math.abs(stop))))||(specifier.precision=precision-("e"===specifier.type));break;case"f":case"%":null!=specifier.precision||isNaN(precision=function(step){return Math.max(0,-src_exponent(Math.abs(step)))}(step))||(specifier.precision=precision-2*("%"===specifier.type))}return defaultLocale_format(specifier)};function linearish(scale){var domain=scale.domain;return scale.ticks=function(count){var d=domain();return src_ticks(d[0],d[d.length-1],null==count?10:count)},scale.tickFormat=function(count,specifier){return src_tickFormat(domain(),count,specifier)},scale.nice=function(count){null==count&&(count=10);var step,d=domain(),i0=0,i1=d.length-1,start=d[i0],stop=d[i1];return stop<start&&(step=start,start=stop,stop=step,step=i0,i0=i1,i1=step),(step=tickIncrement(start,stop,count))>0?step=tickIncrement(start=Math.floor(start/step)*step,stop=Math.ceil(stop/step)*step,count):step<0&&(step=tickIncrement(start=Math.ceil(start*step)/step,stop=Math.floor(stop*step)/step,count)),step>0?(d[i0]=Math.floor(start/step)*step,d[i1]=Math.ceil(stop/step)*step,domain(d)):step<0&&(d[i0]=Math.ceil(start*step)/step,d[i1]=Math.floor(stop*step)/step,domain(d)),scale},scale}function linear_linear(){var scale=continuous(deinterpolateLinear,src_number);return scale.copy=function(){return copy(scale,linear_linear())},linearish(scale)}function identity_identity(){var domain=[0,1];function scale(x){return+x}return scale.invert=scale,scale.domain=scale.range=function(_){return arguments.length?(domain=src_array_map.call(_,d3_scale_src_number),scale):domain.slice()},scale.copy=function(){return identity_identity().domain(domain)},linearish(scale)}var nice=function(domain,interval){var t,i0=0,i1=(domain=domain.slice()).length-1,x0=domain[i0],x1=domain[i1];return x1<x0&&(t=i0,i0=i1,i1=t,t=x0,x0=x1,x1=t),domain[i0]=interval.floor(x0),domain[i1]=interval.ceil(x1),domain};function log_deinterpolate(a,b){return(b=Math.log(b/a))?function(x){return Math.log(x/a)/b}:d3_scale_src_constant(b)}function log_reinterpolate(a,b){return a<0?function(t){return-Math.pow(-b,t)*Math.pow(-a,1-t)}:function(t){return Math.pow(b,t)*Math.pow(a,1-t)}}function pow10(x){return isFinite(x)?+("1e"+x):x<0?0:x}function powp(base){return 10===base?pow10:base===Math.E?Math.exp:function(x){return Math.pow(base,x)}}function logp(base){return base===Math.E?Math.log:10===base&&Math.log10||2===base&&Math.log2||(base=Math.log(base),function(x){return Math.log(x)/base})}function reflect(f){return function(x){return-f(-x)}}function log(){var scale=continuous(log_deinterpolate,log_reinterpolate).domain([1,10]),domain=scale.domain,base=10,logs=logp(10),pows=powp(10);function rescale(){return logs=logp(base),pows=powp(base),domain()[0]<0&&(logs=reflect(logs),pows=reflect(pows)),scale}return scale.base=function(_){return arguments.length?(base=+_,rescale()):base},scale.domain=function(_){return arguments.length?(domain(_),rescale()):domain()},scale.ticks=function(count){var r,d=domain(),u=d[0],v=d[d.length-1];(r=v<u)&&(i=u,u=v,v=i);var p,k,t,i=logs(u),j=logs(v),n=null==count?10:+count,z=[];if(!(base%1)&&j-i<n){if(i=Math.round(i)-1,j=Math.round(j)+1,u>0){for(;i<j;++i)for(k=1,p=pows(i);k<base;++k)if(!((t=p*k)<u)){if(t>v)break;z.push(t)}}else for(;i<j;++i)for(k=base-1,p=pows(i);k>=1;--k)if(!((t=p*k)<u)){if(t>v)break;z.push(t)}}else z=src_ticks(i,j,Math.min(j-i,n)).map(pows);return r?z.reverse():z},scale.tickFormat=function(count,specifier){if(null==specifier&&(specifier=10===base?".0e":","),"function"!=typeof specifier&&(specifier=defaultLocale_format(specifier)),count===1/0)return specifier;null==count&&(count=10);var k=Math.max(1,base*count/scale.ticks().length);return function(d){var i=d/pows(Math.round(logs(d)));return i*base<base-.5&&(i*=base),i<=k?specifier(d):""}},scale.nice=function(){return domain(nice(domain(),{floor:function floor(x){return pows(Math.floor(logs(x)))},ceil:function ceil(x){return pows(Math.ceil(logs(x)))}}))},scale.copy=function(){return copy(scale,log().base(base))},scale}function raise(x,exponent){return x<0?-Math.pow(-x,exponent):Math.pow(x,exponent)}function pow(){var exponent=1,scale=continuous(function deinterpolate(a,b){return(b=raise(b,exponent)-(a=raise(a,exponent)))?function(x){return(raise(x,exponent)-a)/b}:d3_scale_src_constant(b)},function reinterpolate(a,b){return b=raise(b,exponent)-(a=raise(a,exponent)),function(t){return raise(a+b*t,1/exponent)}}),domain=scale.domain;return scale.exponent=function(_){return arguments.length?(exponent=+_,domain(domain())):exponent},scale.copy=function(){return copy(scale,pow().exponent(exponent))},linearish(scale)}function quantile_quantile(){var domain=[],range=[],thresholds=[];function rescale(){var i=0,n=Math.max(1,range.length);for(thresholds=new Array(n-1);++i<n;)thresholds[i-1]=quantile(domain,i/n);return scale}function scale(x){if(!isNaN(x=+x))return range[bisect(thresholds,x)]}return scale.invertExtent=function(y){var i=range.indexOf(y);return i<0?[NaN,NaN]:[i>0?thresholds[i-1]:domain[0],i<thresholds.length?thresholds[i]:domain[domain.length-1]]},scale.domain=function(_){if(!arguments.length)return domain.slice();domain=[];for(var d,i=0,n=_.length;i<n;++i)null==(d=_[i])||isNaN(d=+d)||domain.push(d);return domain.sort(ascending),rescale()},scale.range=function(_){return arguments.length?(range=array_slice.call(_),rescale()):range.slice()},scale.quantiles=function(){return thresholds.slice()},scale.copy=function(){return quantile_quantile().domain(domain).range(range)},scale}function quantize(){var x0=0,x1=1,n=1,domain=[.5],range=[0,1];function scale(x){if(x<=x)return range[bisect(domain,x,0,n)]}function rescale(){var i=-1;for(domain=new Array(n);++i<n;)domain[i]=((i+1)*x1-(i-n)*x0)/(n+1);return scale}return scale.domain=function(_){return arguments.length?(x0=+_[0],x1=+_[1],rescale()):[x0,x1]},scale.range=function(_){return arguments.length?(n=(range=array_slice.call(_)).length-1,rescale()):range.slice()},scale.invertExtent=function(y){var i=range.indexOf(y);return i<0?[NaN,NaN]:i<1?[x0,domain[0]]:i>=n?[domain[n-1],x1]:[domain[i-1],domain[i]]},scale.copy=function(){return quantize().domain([x0,x1]).range(range)},linearish(scale)}function threshold_threshold(){var domain=[.5],range=[0,1],n=1;function scale(x){if(x<=x)return range[bisect(domain,x,0,n)]}return scale.domain=function(_){return arguments.length?(domain=array_slice.call(_),n=Math.min(domain.length,range.length-1),scale):domain.slice()},scale.range=function(_){return arguments.length?(range=array_slice.call(_),n=Math.min(domain.length,range.length-1),scale):range.slice()},scale.invertExtent=function(y){var i=range.indexOf(y);return[domain[i-1],domain[i]]},scale.copy=function(){return threshold_threshold().domain(domain).range(range)},scale}var interval_t0=new Date,interval_t1=new Date;function newInterval(floori,offseti,count,field){function interval(date){return floori(date=0===arguments.length?new Date:new Date(+date)),date}return interval.floor=function(date){return floori(date=new Date(+date)),date},interval.ceil=function(date){return floori(date=new Date(date-1)),offseti(date,1),floori(date),date},interval.round=function(date){var d0=interval(date),d1=interval.ceil(date);return date-d0<d1-date?d0:d1},interval.offset=function(date,step){return offseti(date=new Date(+date),null==step?1:Math.floor(step)),date},interval.range=function(start,stop,step){var previous,range=[];if(start=interval.ceil(start),step=null==step?1:Math.floor(step),!(start<stop&&step>0))return range;do{range.push(previous=new Date(+start)),offseti(start,step),floori(start)}while(previous<start&&start<stop);return range},interval.filter=function(test){return newInterval(function(date){if(date>=date)for(;floori(date),!test(date);)date.setTime(date-1)},function(date,step){if(date>=date)if(step<0)for(;++step<=0;)for(;offseti(date,-1),!test(date););else for(;--step>=0;)for(;offseti(date,1),!test(date););})},count&&(interval.count=function(start,end){return interval_t0.setTime(+start),interval_t1.setTime(+end),floori(interval_t0),floori(interval_t1),Math.floor(count(interval_t0,interval_t1))},interval.every=function(step){return step=Math.floor(step),isFinite(step)&&step>0?step>1?interval.filter(field?function(d){return field(d)%step==0}:function(d){return interval.count(0,d)%step==0}):interval:null}),interval}var year_year=newInterval(function(date){date.setMonth(0,1),date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step)},function(start,end){return end.getFullYear()-start.getFullYear()},function(date){return date.getFullYear()});year_year.every=function(k){return isFinite(k=Math.floor(k))&&k>0?newInterval(function(date){date.setFullYear(Math.floor(date.getFullYear()/k)*k),date.setMonth(0,1),date.setHours(0,0,0,0)},function(date,step){date.setFullYear(date.getFullYear()+step*k)}):null};var src_year=year_year,month_month=(year_year.range,newInterval(function(date){date.setDate(1),date.setHours(0,0,0,0)},function(date,step){date.setMonth(date.getMonth()+step)},function(start,end){return end.getMonth()-start.getMonth()+12*(end.getFullYear()-start.getFullYear())},function(date){return date.getMonth()})),src_month=month_month,durationMinute=(month_month.range,6e4),durationWeek=6048e5;function weekday(i){return newInterval(function(date){date.setDate(date.getDate()-(date.getDay()+7-i)%7),date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+7*step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*durationMinute)/durationWeek})}var sunday=weekday(0),monday=weekday(1),tuesday=weekday(2),wednesday=weekday(3),thursday=weekday(4),friday=weekday(5),saturday=weekday(6),day_day=(sunday.range,monday.range,tuesday.range,wednesday.range,thursday.range,friday.range,saturday.range,newInterval(function(date){date.setHours(0,0,0,0)},function(date,step){date.setDate(date.getDate()+step)},function(start,end){return(end-start-(end.getTimezoneOffset()-start.getTimezoneOffset())*durationMinute)/864e5},function(date){return date.getDate()-1})),src_day=day_day,hour_hour=(day_day.range,newInterval(function(date){date.setTime(date-date.getMilliseconds()-1e3*date.getSeconds()-date.getMinutes()*durationMinute)},function(date,step){date.setTime(+date+36e5*step)},function(start,end){return(end-start)/36e5},function(date){return date.getHours()})),src_hour=hour_hour,minute_minute=(hour_hour.range,newInterval(function(date){date.setTime(date-date.getMilliseconds()-1e3*date.getSeconds())},function(date,step){date.setTime(+date+step*durationMinute)},function(start,end){return(end-start)/durationMinute},function(date){return date.getMinutes()})),src_minute=minute_minute,second_second=(minute_minute.range,newInterval(function(date){date.setTime(date-date.getMilliseconds())},function(date,step){date.setTime(+date+1e3*step)},function(start,end){return(end-start)/1e3},function(date){return date.getUTCSeconds()})),src_second=second_second,millisecond_millisecond=(second_second.range,newInterval(function(){},function(date,step){date.setTime(+date+step)},function(start,end){return end-start}));millisecond_millisecond.every=function(k){return k=Math.floor(k),isFinite(k)&&k>0?k>1?newInterval(function(date){date.setTime(Math.floor(date/k)*k)},function(date,step){date.setTime(+date+step*k)},function(start,end){return(end-start)/k}):millisecond_millisecond:null};var src_millisecond=millisecond_millisecond;millisecond_millisecond.range;function utcWeekday(i){return newInterval(function(date){date.setUTCDate(date.getUTCDate()-(date.getUTCDay()+7-i)%7),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+7*step)},function(start,end){return(end-start)/durationWeek})}var utcSunday=utcWeekday(0),utcMonday=utcWeekday(1),utcTuesday=utcWeekday(2),utcWednesday=utcWeekday(3),utcThursday=utcWeekday(4),utcFriday=utcWeekday(5),utcSaturday=utcWeekday(6),utcDay=(utcSunday.range,utcMonday.range,utcTuesday.range,utcWednesday.range,utcThursday.range,utcFriday.range,utcSaturday.range,newInterval(function(date){date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCDate(date.getUTCDate()+step)},function(start,end){return(end-start)/864e5},function(date){return date.getUTCDate()-1})),src_utcDay=utcDay,utcYear=(utcDay.range,newInterval(function(date){date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step)},function(start,end){return end.getUTCFullYear()-start.getUTCFullYear()},function(date){return date.getUTCFullYear()}));utcYear.every=function(k){return isFinite(k=Math.floor(k))&&k>0?newInterval(function(date){date.setUTCFullYear(Math.floor(date.getUTCFullYear()/k)*k),date.setUTCMonth(0,1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCFullYear(date.getUTCFullYear()+step*k)}):null};var src_utcYear=utcYear;utcYear.range;function localDate(d){if(0<=d.y&&d.y<100){var date=new Date(-1,d.m,d.d,d.H,d.M,d.S,d.L);return date.setFullYear(d.y),date}return new Date(d.y,d.m,d.d,d.H,d.M,d.S,d.L)}function utcDate(d){if(0<=d.y&&d.y<100){var date=new Date(Date.UTC(-1,d.m,d.d,d.H,d.M,d.S,d.L));return date.setUTCFullYear(d.y),date}return new Date(Date.UTC(d.y,d.m,d.d,d.H,d.M,d.S,d.L))}function newDate(y,m,d){return{y:y,m:m,d:d,H:0,M:0,S:0,L:0}}var src_defaultLocale_locale,timeFormat,pads={"-":"",_:" ",0:"0"},numberRe=/^\s*\d+/,percentRe=/^%/,requoteRe=/[\\^$*+?|[\]().{}]/g;function locale_pad(value,fill,width){var sign=value<0?"-":"",string=(sign?-value:value)+"",length=string.length;return sign+(length<width?new Array(width-length+1).join(fill)+string:string)}function requote(s){return s.replace(requoteRe,"\\$&")}function formatRe(names){return new RegExp("^(?:"+names.map(requote).join("|")+")","i")}function formatLookup(names){for(var map={},i=-1,n=names.length;++i<n;)map[names[i].toLowerCase()]=i;return map}function parseWeekdayNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.w=+n[0],i+n[0].length):-1}function parseWeekdayNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.u=+n[0],i+n[0].length):-1}function parseWeekNumberSunday(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.U=+n[0],i+n[0].length):-1}function parseWeekNumberISO(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.V=+n[0],i+n[0].length):-1}function parseWeekNumberMonday(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.W=+n[0],i+n[0].length):-1}function parseFullYear(d,string,i){var n=numberRe.exec(string.slice(i,i+4));return n?(d.y=+n[0],i+n[0].length):-1}function parseYear(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.y=+n[0]+(+n[0]>68?1900:2e3),i+n[0].length):-1}function parseZone(d,string,i){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(string.slice(i,i+6));return n?(d.Z=n[1]?0:-(n[2]+(n[3]||"00")),i+n[0].length):-1}function parseQuarter(d,string,i){var n=numberRe.exec(string.slice(i,i+1));return n?(d.q=3*n[0]-3,i+n[0].length):-1}function parseMonthNumber(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.m=n[0]-1,i+n[0].length):-1}function parseDayOfMonth(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.d=+n[0],i+n[0].length):-1}function parseDayOfYear(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.m=0,d.d=+n[0],i+n[0].length):-1}function parseHour24(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.H=+n[0],i+n[0].length):-1}function parseMinutes(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.M=+n[0],i+n[0].length):-1}function parseSeconds(d,string,i){var n=numberRe.exec(string.slice(i,i+2));return n?(d.S=+n[0],i+n[0].length):-1}function parseMilliseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+3));return n?(d.L=+n[0],i+n[0].length):-1}function parseMicroseconds(d,string,i){var n=numberRe.exec(string.slice(i,i+6));return n?(d.L=Math.floor(n[0]/1e3),i+n[0].length):-1}function parseLiteralPercent(d,string,i){var n=percentRe.exec(string.slice(i,i+1));return n?i+n[0].length:-1}function parseUnixTimestamp(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.Q=+n[0],i+n[0].length):-1}function parseUnixTimestampSeconds(d,string,i){var n=numberRe.exec(string.slice(i));return n?(d.s=+n[0],i+n[0].length):-1}function formatDayOfMonth(d,p){return locale_pad(d.getDate(),p,2)}function formatHour24(d,p){return locale_pad(d.getHours(),p,2)}function formatHour12(d,p){return locale_pad(d.getHours()%12||12,p,2)}function formatDayOfYear(d,p){return locale_pad(1+src_day.count(src_year(d),d),p,3)}function formatMilliseconds(d,p){return locale_pad(d.getMilliseconds(),p,3)}function formatMicroseconds(d,p){return formatMilliseconds(d,p)+"000"}function formatMonthNumber(d,p){return locale_pad(d.getMonth()+1,p,2)}function formatMinutes(d,p){return locale_pad(d.getMinutes(),p,2)}function formatSeconds(d,p){return locale_pad(d.getSeconds(),p,2)}function formatWeekdayNumberMonday(d){var day=d.getDay();return 0===day?7:day}function formatWeekNumberSunday(d,p){return locale_pad(sunday.count(src_year(d)-1,d),p,2)}function formatWeekNumberISO(d,p){var day=d.getDay();return d=day>=4||0===day?thursday(d):thursday.ceil(d),locale_pad(thursday.count(src_year(d),d)+(4===src_year(d).getDay()),p,2)}function formatWeekdayNumberSunday(d){return d.getDay()}function formatWeekNumberMonday(d,p){return locale_pad(monday.count(src_year(d)-1,d),p,2)}function locale_formatYear(d,p){return locale_pad(d.getFullYear()%100,p,2)}function formatFullYear(d,p){return locale_pad(d.getFullYear()%1e4,p,4)}function formatZone(d){var z=d.getTimezoneOffset();return(z>0?"-":(z*=-1,"+"))+locale_pad(z/60|0,"0",2)+locale_pad(z%60,"0",2)}function formatUTCDayOfMonth(d,p){return locale_pad(d.getUTCDate(),p,2)}function formatUTCHour24(d,p){return locale_pad(d.getUTCHours(),p,2)}function formatUTCHour12(d,p){return locale_pad(d.getUTCHours()%12||12,p,2)}function formatUTCDayOfYear(d,p){return locale_pad(1+src_utcDay.count(src_utcYear(d),d),p,3)}function formatUTCMilliseconds(d,p){return locale_pad(d.getUTCMilliseconds(),p,3)}function formatUTCMicroseconds(d,p){return formatUTCMilliseconds(d,p)+"000"}function formatUTCMonthNumber(d,p){return locale_pad(d.getUTCMonth()+1,p,2)}function formatUTCMinutes(d,p){return locale_pad(d.getUTCMinutes(),p,2)}function formatUTCSeconds(d,p){return locale_pad(d.getUTCSeconds(),p,2)}function formatUTCWeekdayNumberMonday(d){var dow=d.getUTCDay();return 0===dow?7:dow}function formatUTCWeekNumberSunday(d,p){return locale_pad(utcSunday.count(src_utcYear(d)-1,d),p,2)}function formatUTCWeekNumberISO(d,p){var day=d.getUTCDay();return d=day>=4||0===day?utcThursday(d):utcThursday.ceil(d),locale_pad(utcThursday.count(src_utcYear(d),d)+(4===src_utcYear(d).getUTCDay()),p,2)}function formatUTCWeekdayNumberSunday(d){return d.getUTCDay()}function formatUTCWeekNumberMonday(d,p){return locale_pad(utcMonday.count(src_utcYear(d)-1,d),p,2)}function formatUTCYear(d,p){return locale_pad(d.getUTCFullYear()%100,p,2)}function formatUTCFullYear(d,p){return locale_pad(d.getUTCFullYear()%1e4,p,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(d){return+d}function formatUnixTimestampSeconds(d){return Math.floor(+d/1e3)}!function defaultLocale_defaultLocale(definition){return src_defaultLocale_locale=function formatLocale(locale){var locale_dateTime=locale.dateTime,locale_date=locale.date,locale_time=locale.time,locale_periods=locale.periods,locale_weekdays=locale.days,locale_shortWeekdays=locale.shortDays,locale_months=locale.months,locale_shortMonths=locale.shortMonths,periodRe=formatRe(locale_periods),periodLookup=formatLookup(locale_periods),weekdayRe=formatRe(locale_weekdays),weekdayLookup=formatLookup(locale_weekdays),shortWeekdayRe=formatRe(locale_shortWeekdays),shortWeekdayLookup=formatLookup(locale_shortWeekdays),monthRe=formatRe(locale_months),monthLookup=formatLookup(locale_months),shortMonthRe=formatRe(locale_shortMonths),shortMonthLookup=formatLookup(locale_shortMonths),formats={a:function formatShortWeekday(d){return locale_shortWeekdays[d.getDay()]},A:function formatWeekday(d){return locale_weekdays[d.getDay()]},b:function formatShortMonth(d){return locale_shortMonths[d.getMonth()]},B:function formatMonth(d){return locale_months[d.getMonth()]},c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:function formatPeriod(d){return locale_periods[+(d.getHours()>=12)]},q:function formatQuarter(d){return 1+~~(d.getMonth()/3)},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:locale_formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},utcFormats={a:function formatUTCShortWeekday(d){return locale_shortWeekdays[d.getUTCDay()]},A:function formatUTCWeekday(d){return locale_weekdays[d.getUTCDay()]},b:function formatUTCShortMonth(d){return locale_shortMonths[d.getUTCMonth()]},B:function formatUTCMonth(d){return locale_months[d.getUTCMonth()]},c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:function formatUTCPeriod(d){return locale_periods[+(d.getUTCHours()>=12)]},q:function formatUTCQuarter(d){return 1+~~(d.getUTCMonth()/3)},Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},parses={a:function parseShortWeekday(d,string,i){var n=shortWeekdayRe.exec(string.slice(i));return n?(d.w=shortWeekdayLookup[n[0].toLowerCase()],i+n[0].length):-1},A:function parseWeekday(d,string,i){var n=weekdayRe.exec(string.slice(i));return n?(d.w=weekdayLookup[n[0].toLowerCase()],i+n[0].length):-1},b:function parseShortMonth(d,string,i){var n=shortMonthRe.exec(string.slice(i));return n?(d.m=shortMonthLookup[n[0].toLowerCase()],i+n[0].length):-1},B:function parseMonth(d,string,i){var n=monthRe.exec(string.slice(i));return n?(d.m=monthLookup[n[0].toLowerCase()],i+n[0].length):-1},c:function parseLocaleDateTime(d,string,i){return parseSpecifier(d,locale_dateTime,string,i)},d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:function parsePeriod(d,string,i){var n=periodRe.exec(string.slice(i));return n?(d.p=periodLookup[n[0].toLowerCase()],i+n[0].length):-1},q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:function parseLocaleDate(d,string,i){return parseSpecifier(d,locale_date,string,i)},X:function parseLocaleTime(d,string,i){return parseSpecifier(d,locale_time,string,i)},y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};function newFormat(specifier,formats){return function(date){var c,pad,format,string=[],i=-1,j=0,n=specifier.length;for(date instanceof Date||(date=new Date(+date));++i<n;)37===specifier.charCodeAt(i)&&(string.push(specifier.slice(j,i)),null!=(pad=pads[c=specifier.charAt(++i)])?c=specifier.charAt(++i):pad="e"===c?" ":"0",(format=formats[c])&&(c=format(date,pad)),string.push(c),j=i+1);return string.push(specifier.slice(j,i)),string.join("")}}function newParse(specifier,Z){return function(string){var week,day,d=newDate(1900,void 0,1);if(parseSpecifier(d,specifier,string+="",0)!=string.length)return null;if("Q"in d)return new Date(d.Q);if("s"in d)return new Date(1e3*d.s+("L"in d?d.L:0));if(!Z||"Z"in d||(d.Z=0),"p"in d&&(d.H=d.H%12+12*d.p),void 0===d.m&&(d.m="q"in d?d.q:0),"V"in d){if(d.V<1||d.V>53)return null;"w"in d||(d.w=1),"Z"in d?(week=(day=(week=utcDate(newDate(d.y,0,1))).getUTCDay())>4||0===day?utcMonday.ceil(week):utcMonday(week),week=src_utcDay.offset(week,7*(d.V-1)),d.y=week.getUTCFullYear(),d.m=week.getUTCMonth(),d.d=week.getUTCDate()+(d.w+6)%7):(week=(day=(week=localDate(newDate(d.y,0,1))).getDay())>4||0===day?monday.ceil(week):monday(week),week=src_day.offset(week,7*(d.V-1)),d.y=week.getFullYear(),d.m=week.getMonth(),d.d=week.getDate()+(d.w+6)%7)}else("W"in d||"U"in d)&&("w"in d||(d.w="u"in d?d.u%7:"W"in d?1:0),day="Z"in d?utcDate(newDate(d.y,0,1)).getUTCDay():localDate(newDate(d.y,0,1)).getDay(),d.m=0,d.d="W"in d?(d.w+6)%7+7*d.W-(day+5)%7:d.w+7*d.U-(day+6)%7);return"Z"in d?(d.H+=d.Z/100|0,d.M+=d.Z%100,utcDate(d)):localDate(d)}}function parseSpecifier(d,specifier,string,j){for(var c,parse,i=0,n=specifier.length,m=string.length;i<n;){if(j>=m)return-1;if(37===(c=specifier.charCodeAt(i++))){if(c=specifier.charAt(i++),!(parse=parses[c in pads?specifier.charAt(i++):c])||(j=parse(d,string,j))<0)return-1}else if(c!=string.charCodeAt(j++))return-1}return j}return formats.x=newFormat(locale_date,formats),formats.X=newFormat(locale_time,formats),formats.c=newFormat(locale_dateTime,formats),utcFormats.x=newFormat(locale_date,utcFormats),utcFormats.X=newFormat(locale_time,utcFormats),utcFormats.c=newFormat(locale_dateTime,utcFormats),{format:function format(specifier){var f=newFormat(specifier+="",formats);return f.toString=function(){return specifier},f},parse:function parse(specifier){var p=newParse(specifier+="",!1);return p.toString=function(){return specifier},p},utcFormat:function utcFormat(specifier){var f=newFormat(specifier+="",utcFormats);return f.toString=function(){return specifier},f},utcParse:function utcParse(specifier){var p=newParse(specifier+="",!0);return p.toString=function(){return specifier},p}}}(definition),timeFormat=src_defaultLocale_locale.format,src_defaultLocale_locale.parse,src_defaultLocale_locale.utcFormat,src_defaultLocale_locale.utcParse,src_defaultLocale_locale}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var time_durationSecond=1e3,time_durationMinute=60*time_durationSecond,time_durationHour=60*time_durationMinute,time_durationDay=24*time_durationHour,time_durationWeek=7*time_durationDay,durationMonth=30*time_durationDay,durationYear=365*time_durationDay;function time_date(t){return new Date(t)}function time_number(t){return t instanceof Date?+t:+new Date(+t)}function calendar(year,month,week,day,hour,minute,second,millisecond,format){var scale=continuous(deinterpolateLinear,src_number),invert=scale.invert,domain=scale.domain,formatMillisecond=format(".%L"),formatSecond=format(":%S"),formatMinute=format("%I:%M"),formatHour=format("%I %p"),formatDay=format("%a %d"),formatWeek=format("%b %d"),formatMonth=format("%B"),formatYear=format("%Y"),tickIntervals=[[second,1,time_durationSecond],[second,5,5*time_durationSecond],[second,15,15*time_durationSecond],[second,30,30*time_durationSecond],[minute,1,time_durationMinute],[minute,5,5*time_durationMinute],[minute,15,15*time_durationMinute],[minute,30,30*time_durationMinute],[hour,1,time_durationHour],[hour,3,3*time_durationHour],[hour,6,6*time_durationHour],[hour,12,12*time_durationHour],[day,1,time_durationDay],[day,2,2*time_durationDay],[week,1,time_durationWeek],[month,1,durationMonth],[month,3,3*durationMonth],[year,1,durationYear]];function tickFormat(date){return(second(date)<date?formatMillisecond:minute(date)<date?formatSecond:hour(date)<date?formatMinute:day(date)<date?formatHour:month(date)<date?week(date)<date?formatDay:formatWeek:year(date)<date?formatMonth:formatYear)(date)}function tickInterval(interval,start,stop,step){if(null==interval&&(interval=10),"number"==typeof interval){var target=Math.abs(stop-start)/interval,i=bisector(function(i){return i[2]}).right(tickIntervals,target);i===tickIntervals.length?(step=tickStep(start/durationYear,stop/durationYear,interval),interval=year):i?(step=(i=tickIntervals[target/tickIntervals[i-1][2]<tickIntervals[i][2]/target?i-1:i])[1],interval=i[0]):(step=Math.max(tickStep(start,stop,interval),1),interval=millisecond)}return null==step?interval:interval.every(step)}return scale.invert=function(y){return new Date(invert(y))},scale.domain=function(_){return arguments.length?domain(src_array_map.call(_,time_number)):domain().map(time_date)},scale.ticks=function(interval,step){var t,d=domain(),t0=d[0],t1=d[d.length-1],r=t1<t0;return r&&(t=t0,t0=t1,t1=t),t=(t=tickInterval(interval,t0,t1,step))?t.range(t0,t1+1):[],r?t.reverse():t},scale.tickFormat=function(count,specifier){return null==specifier?tickFormat:format(specifier)},scale.nice=function(interval,step){var d=domain();return(interval=tickInterval(interval,d[0],d[d.length-1],step))?domain(nice(d,interval)):scale},scale.copy=function(){return copy(scale,calendar(year,month,week,day,hour,minute,second,millisecond,format))},scale}var src_time=function(){return calendar(src_year,src_month,sunday,src_day,src_hour,src_minute,src_second,src_millisecond,timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},utcMonth=newInterval(function(date){date.setUTCDate(1),date.setUTCHours(0,0,0,0)},function(date,step){date.setUTCMonth(date.getUTCMonth()+step)},function(start,end){return end.getUTCMonth()-start.getUTCMonth()+12*(end.getUTCFullYear()-start.getUTCFullYear())},function(date){return date.getUTCMonth()}),utcHour=(utcMonth.range,newInterval(function(date){date.setUTCMinutes(0,0,0)},function(date,step){date.setTime(+date+36e5*step)},function(start,end){return(end-start)/36e5},function(date){return date.getUTCHours()})),utcMinute=(utcHour.range,newInterval(function(date){date.setUTCSeconds(0,0)},function(date,step){date.setTime(+date+step*durationMinute)},function(start,end){return(end-start)/durationMinute},function(date){return date.getUTCMinutes()})),src_colors=(utcMinute.range,function(s){return s.match(/.{6}/g).map(function(x){return"#"+x})}),category10=src_colors("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),category20b=src_colors("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),category20=(src_colors("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),src_colors("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5")),deg2rad=Math.PI/180,rad2deg=180/Math.PI,A=-.14861,B=1.78277,C=-.29227,cubehelix_D=-.90649,E=1.97294,ED=E*cubehelix_D,EB=E*B,BC_DA=B*C-cubehelix_D*A;function cubehelix_cubehelix(h,s,l,opacity){return 1===arguments.length?function cubehelixConvert(o){if(o instanceof Cubehelix)return new Cubehelix(o.h,o.s,o.l,o.opacity);o instanceof Rgb||(o=rgbConvert(o));var r=o.r/255,g=o.g/255,b=o.b/255,l=(BC_DA*b+ED*r-EB*g)/(BC_DA+ED-EB),bl=b-l,k=(E*(g-l)-C*bl)/cubehelix_D,s=Math.sqrt(k*k+bl*bl)/(E*l*(1-l)),h=s?Math.atan2(k,bl)*rad2deg-120:NaN;return new Cubehelix(h<0?h+360:h,s,l,o.opacity)}(h):new Cubehelix(h,s,l,null==opacity?1:opacity)}function Cubehelix(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function src_cubehelix_cubehelix(hue){return function cubehelixGamma(y){function cubehelix(start,end){var h=hue((start=cubehelix_cubehelix(start)).h,(end=cubehelix_cubehelix(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(Math.pow(t,y)),start.opacity=opacity(t),start+""}}return y=+y,cubehelix.gamma=cubehelixGamma,cubehelix}(1)}define(Cubehelix,cubehelix_cubehelix,extend(Color,{brighter:function brighter(k){return k=null==k?1/.7:Math.pow(1/.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},darker:function darker(k){return k=null==k?.7:Math.pow(.7,k),new Cubehelix(this.h,this.s,this.l*k,this.opacity)},rgb:function rgb(){var h=isNaN(this.h)?0:(this.h+120)*deg2rad,l=+this.l,a=isNaN(this.s)?0:this.s*l*(1-l),cosh=Math.cos(h),sinh=Math.sin(h);return new Rgb(255*(l+a*(A*cosh+B*sinh)),255*(l+a*(C*cosh+cubehelix_D*sinh)),255*(l+a*(E*cosh)),this.opacity)}}));src_cubehelix_cubehelix(color_hue);var cubehelixLong=src_cubehelix_cubehelix(nogamma);cubehelixLong(cubehelix_cubehelix(300,.5,0),cubehelix_cubehelix(-240,.5,1)),cubehelixLong(cubehelix_cubehelix(-100,.75,.35),cubehelix_cubehelix(80,1.5,.8)),cubehelixLong(cubehelix_cubehelix(260,.75,.35),cubehelix_cubehelix(80,1.5,.8)),cubehelix_cubehelix();function ramp(range){var n=range.length;return function(t){return range[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}ramp(src_colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),ramp(src_colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),ramp(src_colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),ramp(src_colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function sequential(interpolator){var x0=0,x1=1,clamp=!1;function scale(x){var t=(x-x0)/(x1-x0);return interpolator(clamp?Math.max(0,Math.min(1,t)):t)}return scale.domain=function(_){return arguments.length?(x0=+_[0],x1=+_[1],scale):[x0,x1]},scale.clamp=function(_){return arguments.length?(clamp=!!_,scale):clamp},scale.interpolator=function(_){return arguments.length?(interpolator=_,scale):interpolator},scale.copy=function(){return sequential(interpolator).domain([x0,x1]).clamp(clamp)},linearish(scale)}var d3_scale_chromatic_src_colors=function(specifier){for(var n=specifier.length/6|0,colors=new Array(n),i=0;i<n;)colors[i]="#"+specifier.slice(6*i,6*++i);return colors},Dark2=d3_scale_chromatic_src_colors("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Paired=d3_scale_chromatic_src_colors("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Accent=d3_scale_chromatic_src_colors("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Pastel1=d3_scale_chromatic_src_colors("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Pastel2=d3_scale_chromatic_src_colors("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Set1=d3_scale_chromatic_src_colors("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Set2=d3_scale_chromatic_src_colors("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Set3=d3_scale_chromatic_src_colors("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),src_ramp=function(scheme){return rgbBasis(scheme[scheme.length-1])},Blues_scheme=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(d3_scale_chromatic_src_colors),Blues=src_ramp(Blues_scheme),BrBG_scheme=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(d3_scale_chromatic_src_colors),BrBG=src_ramp(BrBG_scheme),PRGn_scheme=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(d3_scale_chromatic_src_colors),PRGn=src_ramp(PRGn_scheme),PiYG_scheme=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(d3_scale_chromatic_src_colors),PiYG=src_ramp(PiYG_scheme),PuOr=src_ramp(new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(d3_scale_chromatic_src_colors)),RdBu=src_ramp(new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(d3_scale_chromatic_src_colors)),RdGy=src_ramp(new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(d3_scale_chromatic_src_colors)),RdYlBu=src_ramp(new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(d3_scale_chromatic_src_colors)),RdYlGn=src_ramp(new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(d3_scale_chromatic_src_colors)),Spectral=src_ramp(new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(d3_scale_chromatic_src_colors)),Greens=src_ramp(new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(d3_scale_chromatic_src_colors)),Greys=src_ramp(new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(d3_scale_chromatic_src_colors)),Oranges=src_ramp(new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(d3_scale_chromatic_src_colors)),Purples=src_ramp(new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(d3_scale_chromatic_src_colors)),Reds=src_ramp(new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(d3_scale_chromatic_src_colors));function viridis_ramp(range){var n=range.length;return function(t){return range[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}var sequential_multi_viridis=viridis_ramp(d3_scale_chromatic_src_colors("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),viridis_magma=viridis_ramp(d3_scale_chromatic_src_colors("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),viridis_inferno=viridis_ramp(d3_scale_chromatic_src_colors("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),viridis_plasma=viridis_ramp(d3_scale_chromatic_src_colors("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),rainbow_warm=cubehelixLong(cubehelix_cubehelix(-100,.75,.35),cubehelix_cubehelix(80,1.5,.8)),rainbow_cool=cubehelixLong(cubehelix_cubehelix(260,.75,.35),cubehelix_cubehelix(80,1.5,.8)),rainbow_c=cubehelix_cubehelix(),sequential_multi_rainbow=function(t){(t<0||t>1)&&(t-=Math.floor(t));var ts=Math.abs(t-.5);return rainbow_c.h=360*t-100,rainbow_c.s=1.5-1.5*ts,rainbow_c.l=.8-.9*ts,rainbow_c+""},sequential_multi_cubehelix=cubehelixLong(cubehelix_cubehelix(300,.5,0),cubehelix_cubehelix(-240,.5,1)),BuGn=src_ramp(new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(d3_scale_chromatic_src_colors)),BuPu=src_ramp(new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(d3_scale_chromatic_src_colors)),GnBu=src_ramp(new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(d3_scale_chromatic_src_colors)),OrRd=src_ramp(new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(d3_scale_chromatic_src_colors)),PuBuGn=src_ramp(new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(d3_scale_chromatic_src_colors)),PuBu=src_ramp(new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(d3_scale_chromatic_src_colors)),PuRd=src_ramp(new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(d3_scale_chromatic_src_colors)),RdPu=src_ramp(new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(d3_scale_chromatic_src_colors)),YlGnBu=src_ramp(new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(d3_scale_chromatic_src_colors)),YlGn=src_ramp(new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(d3_scale_chromatic_src_colors)),YlOrBr=src_ramp(new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(d3_scale_chromatic_src_colors)),YlOrRd=src_ramp(new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(d3_scale_chromatic_src_colors)),UNIT_GLOBAL_NAMESPACE="app.units",UNIT_LOCAL_NAMESPACE="local.units",LAYER_LOCAL_NAMESPACE="local.layers",LAYER_GLOBAL_NAMESPACE="app.layers",GROUP_GLOBAL_NAMESPACE="app.group",GROUP_LOCAL_NAMESPACE="local.group",CANVAS_LOCAL_NAMESPACE="local.canvas",CANVAS_GLOBAL_NAMESPACE="app.canvas",swap=function swap(arr,i,j){var tmp=arr[i];arr[i]=arr[j],arr[j]=tmp},defaultCompare=function defaultCompare(a,b){return a>b?-1:a>b?1:0},quick_select=function quickselect(arr,k,left,right,compare){!function quickselectStep(arr,k,left,right,compare){for(;right>left;){if(right-left>600){var n=right-left+1,m=k-left+1,z=Math.log(n),s=.5*Math.exp(2*z/3),sd=.5*Math.sqrt(z*s*(n-s)/n)*(m-n/2<0?-1:1);quickselectStep(arr,k,Math.max(left,Math.floor(k-m*s/n+sd)),Math.min(right,Math.floor(k+(n-m)*s/n+sd)),compare)}var t=arr[k],i=left,j=right;for(swap(arr,left,k),compare(arr[right],t)>0&&swap(arr,left,right);i<j;){for(swap(arr,i,j),i++,j--;compare(arr[i],t)<0;)i++;for(;compare(arr[j],t)>0;)j--}0===compare(arr[left],t)?swap(arr,left,j):swap(arr,++j,right),j<=k&&(left=j+1),k<=j&&(right=j-1)}}(arr,k,left||0,right||arr.length-1,compare||defaultCompare)};function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var createNode=function createNode(children){return{children:children,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},r_tree_extend=function extend(a,b){return a.minX=Math.min(a.minX,b.minX),a.minY=Math.min(a.minY,b.minY),a.maxX=Math.max(a.maxX,b.maxX),a.maxY=Math.max(a.maxY,b.maxY),a},distBBox=function distBBox(node,k,p,toBBox,destNode){destNode||(destNode=createNode(null)),destNode.minX=1/0,destNode.minY=1/0,destNode.maxX=-1/0,destNode.maxY=-1/0;for(var i=k;i<p;i++){var child=node.children[i];r_tree_extend(destNode,node.leaf?toBBox(child):child)}return destNode},calcBBox=function calcBBox(node,toBBox){distBBox(node,0,node.children.length,toBBox,node)},compareNodeMinX=function compareNodeMinX(a,b){return a.minX-b.minX},compareNodeMinY=function compareNodeMinY(a,b){return a.minY-b.minY},bboxArea=function bboxArea(a){return(a.maxX-a.minX)*(a.maxY-a.minY)},bboxMargin=function bboxMargin(a){return a.maxX-a.minX+(a.maxY-a.minY)},enlargedArea=function enlargedArea(a,b){return(Math.max(b.maxX,a.maxX)-Math.min(b.minX,a.minX))*(Math.max(b.maxY,a.maxY)-Math.min(b.minY,a.minY))},intersectionArea=function intersectionArea(a,b){var minX=Math.max(a.minX,b.minX),minY=Math.max(a.minY,b.minY),maxX=Math.min(a.maxX,b.maxX),maxY=Math.min(a.maxY,b.maxY);return Math.max(0,maxX-minX)*Math.max(0,maxY-minY)},contains=function contains(a,b){return a.minX<=b.minX&&a.minY<=b.minY&&b.maxX<=a.maxX&&b.maxY<=a.maxY},intersects=function intersects(a,b){return b.minX<=a.maxX&&b.minY<=a.maxY&&b.maxX>=a.minX&&b.maxY>=a.minY},findItem=function findItem(item,items,equalsFn){if(!equalsFn)return items.indexOf(item);for(var i=0;i<items.length;i++)if(equalsFn(item,items[i]))return i;return-1},r_tree_multiSelect=function multiSelect(arr,left,right,n,compare){for(var stack=[left,right];stack.length;)if(!((right=stack.pop())-(left=stack.pop())<=n)){var mid=left+Math.ceil((right-left)/n/2)*n;quick_select(arr,mid,left,right,compare),stack.push(left,mid,mid,right)}},_all=function all(node,result){for(var nodesToSearch=[];node;)node.leaf?result.push.apply(result,_toConsumableArray(node.children)):nodesToSearch.push.apply(nodesToSearch,_toConsumableArray(node.children)),node=nodesToSearch.pop();return result},RTree=function(){function RTree(){var maxEntries=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9;!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RTree),this._maxEntries=Math.max(4,maxEntries),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(RTree,[{key:"all",value:function all(){return _all(this.data,[])}},{key:"search",value:function search(bbox){var node=this.data,result=[];if(!intersects(bbox,node))return result;for(var toBBox=this.toBBox,nodesToSearch=[];node;){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=node.children[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var child=_step.value,childBBox=node.leaf?toBBox(child):child;intersects(bbox,childBBox)&&(node.leaf?result.push(child):contains(bbox,childBBox)?_all(child,result):nodesToSearch.push(child))}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}node=nodesToSearch.pop()}return result}},{key:"load",value:function load(data){if(!data||!data.length)return this;if(data.length<this._minEntries){for(var i=0;i<data.length;i++)this.insert(data[i]);return this}var node=this.build(data.slice(),0,data.length-1,0);if(this.data.children.length)if(this.data.height===node.height)this.splitRoot(this.data,node);else{if(this.data.height<node.height){var tmpNode=this.data;this.data=node,node=tmpNode}this.insertSingleItem(node,this.data.height-node.height-1,!0)}else this.data=node;return this}},{key:"insert",value:function insert(item){return item&&this.insertSingleItem(item,this.data.height-1),this}},{key:"clear",value:function clear(){return this.data=createNode([]),this}},{key:"remove",value:function remove(item,equalsFn){if(!item)return this;for(var i,parent,goingUp,node=this.data,bbox=this.toBBox(item),path=[],indexes=[];node||path.length;){if(node||(node=path.pop(),parent=path[path.length-1],i=indexes.pop(),goingUp=!0),node.leaf){var index=findItem(item,node.children,equalsFn);if(-1!==index)return node.children.splice(index,1),path.push(node),this.condense(path),this}goingUp||node.leaf||!contains(node,bbox)?parent?(i++,node=parent.children[i],goingUp=!1):node=null:(path.push(node),indexes.push(i),i=0,parent=node,node=node.children[0])}return this}},{key:"toJSON",value:function toJSON(){return this.data}},{key:"fromJSON",value:function fromJSON(data){return this.data=data,this}},{key:"toBBox",value:function toBBox(item){return item}},{key:"compareMinX",value:function compareMinX(a,b){return a.minX-b.minX}},{key:"compareMinY",value:function compareMinY(a,b){return a.minY-b.minY}},{key:"build",value:function build(items,left,right,height){var node,N=right-left+1,M=this._maxEntries;if(N<=M)return node=createNode(items.slice(left,right+1)),calcBBox(node,this.toBBox),node;height||(height=Math.ceil(Math.log(N)/Math.log(M)),M=Math.ceil(N/Math.pow(M,height-1))),(node=createNode([])).leaf=!1,node.height=height;var N2=Math.ceil(N/M),N1=N2*Math.ceil(Math.sqrt(M));r_tree_multiSelect(items,left,right,N1,this.compareMinX);for(var i=left;i<=right;i+=N1){var right2=Math.min(i+N1-1,right);r_tree_multiSelect(items,i,right2,N2,this.compareMinY);for(var j=i;j<=right2;j+=N2){var right3=Math.min(j+N2-1,right2);node.children.push(this.build(items,j,right3,height-1))}}return calcBBox(node,this.toBBox),node}},{key:"chooseSubtree",value:function chooseSubtree(bbox,node,level,path){for(;path.push(node),!node.leaf&&path.length-1!==level;){var minArea=1/0,minEnlargement=1/0,targetNode=void 0,_iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=node.children[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var child=_step2.value,area=bboxArea(child),enlargement=enlargedArea(bbox,child)-area;enlargement<minEnlargement?(minEnlargement=enlargement,minArea=area<minArea?area:minArea,targetNode=child):enlargement===minEnlargement&&area<minArea&&(minArea=area,targetNode=child)}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}node=targetNode||node.children[0]}return node}},{key:"insertSingleItem",value:function insertSingleItem(item,level,isNode){var bbox=isNode?item:this.toBBox(item),insertPath=[],node=this.chooseSubtree(bbox,this.data,level,insertPath);for(node.children.push(item),r_tree_extend(node,bbox);level>=0&&insertPath[level].children.length>this._maxEntries;)this.split(insertPath,level),level--;this.adjustParentBoxes(bbox,insertPath,level)}},{key:"split",value:function split(insertPath,level){var node=insertPath[level],M=node.children.length,m=this._minEntries;this.chooseSplitAxis(node,m,M);var splitIndex=this.chooseSplitIndex(node,m,M),newNode=createNode(node.children.splice(splitIndex,node.children.length-splitIndex));newNode.height=node.height,newNode.leaf=node.leaf,calcBBox(node,this.toBBox),calcBBox(newNode,this.toBBox),level?insertPath[level-1].children.push(newNode):this.splitRoot(node,newNode)}},{key:"splitRoot",value:function splitRoot(node,newNode){this.data=createNode([node,newNode]),this.data.height=node.height+1,this.data.leaf=!1,calcBBox(this.data,this.toBBox)}},{key:"chooseSplitIndex",value:function chooseSplitIndex(node,m,M){for(var index,minOverlap=1/0,minArea=1/0,i=m;i<=M-m;i++){var bbox1=distBBox(node,0,i,this.toBBox),bbox2=distBBox(node,i,M,this.toBBox),overlap=intersectionArea(bbox1,bbox2),area=bboxArea(bbox1)+bboxArea(bbox2);overlap<minOverlap?(minOverlap=overlap,index=i,minArea=area<minArea?area:minArea):overlap===minOverlap&&area<minArea&&(minArea=area,index=i)}return index||M-m}},{key:"chooseSplitAxis",value:function chooseSplitAxis(node,m,M){var compareMinX=node.leaf?this.compareMinX:compareNodeMinX,compareMinY=node.leaf?this.compareMinY:compareNodeMinY;this.allDistMargin(node,m,M,compareMinX)<this.allDistMargin(node,m,M,compareMinY)&&node.children.sort(compareMinX)}},{key:"allDistMargin",value:function allDistMargin(node,m,M,compare){node.children.sort(compare);for(var toBBox=this.toBBox,leftBBox=distBBox(node,0,m,toBBox),rightBBox=distBBox(node,M-m,M,toBBox),margin=bboxMargin(leftBBox)+bboxMargin(rightBBox),i=m;i<M-m;i++){var child=node.children[i];r_tree_extend(leftBBox,node.leaf?toBBox(child):child),margin+=bboxMargin(leftBBox)}for(var _i=M-m-1;_i>=m;_i--){var _child=node.children[_i];r_tree_extend(rightBBox,node.leaf?toBBox(_child):_child),margin+=bboxMargin(rightBBox)}return margin}},{key:"adjustParentBoxes",value:function adjustParentBoxes(bbox,path,level){for(var i=level;i>=0;i--)r_tree_extend(path[i],bbox)}},{key:"condense",value:function condense(path){for(var siblings,i=path.length-1;i>=0;i--)0===path[i].children.length?i>0?(siblings=path[i-1].children).splice(siblings.indexOf(path[i]),1):this.clear():calcBBox(path[i],this.toBBox)}}]),RTree}(),reserved_fields={ROW_ID:"__id__",MEASURE_NAMES:"__measure_names__"},common_props={ACTION_INF:"actionInf",ON_LAYER_DRAW:"onLayerDraw",MATRIX_CREATED:"matrixCreated"},COORD_TYPES={POLAR:"polar",CARTESIAN:"cartesian"},DATA_TYPE_FUNCTION="function",DATA_TYPE_STRING="string",src_array_slice=Array.prototype.slice,d3_axis_src_identity=function(x){return x},axis_top=1,axis_right=2,axis_bottom=3,axis_left=4,epsilon=1e-6;function translateX(x){return"translate("+(x+.5)+",0)"}function translateY(y){return"translate(0,"+(y+.5)+")"}function entering(){return!this.__axis}function axis_axis(orient,scale){var tickArguments=[],tickValues=null,tickFormat=null,tickTransform=null,tickSizeInner=6,tickSizeOuter=6,tickPadding=3,k=orient===axis_top||orient===axis_left?-1:1,x=orient===axis_left||orient===axis_right?"x":"y",transform=orient===axis_top||orient===axis_bottom?translateX:translateY;function axis(context){var values=null==tickValues?scale.ticks?scale.ticks.apply(scale,tickArguments):scale.domain():tickValues,format=null==tickFormat?scale.tickFormat?scale.tickFormat.apply(scale,tickArguments):d3_axis_src_identity:tickFormat,spacing=Math.max(tickSizeInner,0)+tickPadding,range=scale.range(),range0=+range[0]+.5,range1=+range[range.length-1]+.5,position=(scale.bandwidth?function axis_center(scale){var offset=Math.max(0,scale.bandwidth()-1)/2;return scale.round()&&(offset=Math.round(offset)),function(d){return+scale(d)+offset}}:function axis_number(scale){return function(d){return+scale(d)}})(scale.copy()),selection=context.selection?context.selection():context,path=selection.selectAll(".domain").data([null]),tick=selection.selectAll(".tick").data(values,scale).order(),tickExit=tick.exit(),tickEnter=tick.enter().append("g").attr("class","tick"),line=tick.select("line"),text=tick.select("text");path=path.merge(path.enter().insert("path",".tick").attr("class","domain").attr("stroke","#000")),tick=tick.merge(tickEnter),line=line.merge(tickEnter.append("line").attr("stroke","#000").attr(x+"2",k*tickSizeInner)),text=text.merge(tickEnter.append("text").attr("fill","#000").attr(x,k*spacing).attr("dy",orient===axis_top?"0em":orient===axis_bottom?"0.71em":"0.32em")).style("transform",tickTransform),context!==selection&&(path=path.transition(context),tick=tick.transition(context),line=line.transition(context),text=text.transition(context),tickExit=tickExit.transition(context).attr("opacity",epsilon).attr("transform",function(d){return isFinite(d=position(d))?transform(d):this.getAttribute("transform")}),tickEnter.attr("opacity",epsilon).attr("transform",function(d){var p=this.parentNode.__axis;return transform(p&&isFinite(p=p(d))?p:position(d))})),tickExit.remove(),path.attr("d",orient===axis_left||orient==axis_right?"M"+k*tickSizeOuter+","+range0+"H0.5V"+range1+"H"+k*tickSizeOuter:"M"+range0+","+k*tickSizeOuter+"V0.5H"+range1+"V"+k*tickSizeOuter),tick.attr("opacity",1).attr("transform",function(d){return transform(position(d))}),line.attr(x+"2",k*tickSizeInner),text.attr(x,k*spacing).text(format),selection.filter(entering).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",orient===axis_right?"start":orient===axis_left?"end":"middle"),selection.each(function(){this.__axis=position})}return axis.scale=function(_){return arguments.length?(scale=_,axis):scale},axis.tickTransform=function(_){return arguments.length?(tickTransform=_,axis):tickTransform},axis.ticks=function(){return tickArguments=src_array_slice.call(arguments),axis},axis.tickArguments=function(_){return arguments.length?(tickArguments=null==_?[]:src_array_slice.call(_),axis):tickArguments.slice()},axis.tickValues=function(_){return arguments.length?(tickValues=null==_?null:src_array_slice.call(_),axis):tickValues&&tickValues.slice()},axis.tickFormat=function(_){return arguments.length?(tickFormat=_,axis):tickFormat},axis.tickSize=function(_){return arguments.length?(tickSizeInner=tickSizeOuter=+_,axis):tickSizeInner},axis.tickSizeInner=function(_){return arguments.length?(tickSizeInner=+_,axis):tickSizeInner},axis.tickSizeOuter=function(_){return arguments.length?(tickSizeOuter=+_,axis):tickSizeOuter},axis.tickPadding=function(_){return arguments.length?(tickPadding=+_,axis):tickPadding},axis}var abs=Math.abs,atan2=Math.atan2,cos=Math.cos,math_max=Math.max,math_min=Math.min,sin=Math.sin,math_sqrt=Math.sqrt,math_epsilon=1e-12,pi=Math.PI,halfPi=pi/2,tau=2*pi;function asin(x){return x>=1?halfPi:x<=-1?-halfPi:Math.asin(x)}var symbol_circle={draw:function draw(context,size){var r=Math.sqrt(size/pi);context.moveTo(r,0),context.arc(0,0,r,0,tau)}},symbol_cross={draw:function draw(context,size){var r=Math.sqrt(size/5)/2;context.moveTo(-3*r,-r),context.lineTo(-r,-r),context.lineTo(-r,-3*r),context.lineTo(r,-3*r),context.lineTo(r,-r),context.lineTo(3*r,-r),context.lineTo(3*r,r),context.lineTo(r,r),context.lineTo(r,3*r),context.lineTo(-r,3*r),context.lineTo(-r,r),context.lineTo(-3*r,r),context.closePath()}},tan30=Math.sqrt(1/3),tan30_2=2*tan30,diamond={draw:function draw(context,size){var y=Math.sqrt(size/tan30_2),x=y*tan30;context.moveTo(0,-y),context.lineTo(x,0),context.lineTo(0,y),context.lineTo(-x,0),context.closePath()}},square={draw:function draw(context,size){var w=Math.sqrt(size),x=-w/2;context.rect(x,x,w,w)}},kr=Math.sin(pi/10)/Math.sin(7*pi/10),kx=Math.sin(tau/10)*kr,ky=-Math.cos(tau/10)*kr,star={draw:function draw(context,size){var r=Math.sqrt(.8908130915292852*size),x=kx*r,y=ky*r;context.moveTo(0,-r),context.lineTo(x,y);for(var i=1;i<5;++i){var a=tau*i/5,c=Math.cos(a),s=Math.sin(a);context.lineTo(s*r,-c*r),context.lineTo(c*x-s*y,s*x+c*y)}context.closePath()}},wye_s=Math.sqrt(3)/2,wye_k=1/Math.sqrt(12),wye_a=3*(wye_k/2+1),wye={draw:function draw(context,size){var r=Math.sqrt(size/wye_a),x0=r/2,y0=r*wye_k,x1=x0,y1=r*wye_k+r,x2=-x1,y2=y1;context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2),context.lineTo(-.5*x0-wye_s*y0,wye_s*x0+-.5*y0),context.lineTo(-.5*x1-wye_s*y1,wye_s*x1+-.5*y1),context.lineTo(-.5*x2-wye_s*y2,wye_s*x2+-.5*y2),context.lineTo(-.5*x0+wye_s*y0,-.5*y0-wye_s*x0),context.lineTo(-.5*x1+wye_s*y1,-.5*y1-wye_s*x1),context.lineTo(-.5*x2+wye_s*y2,-.5*y2-wye_s*x2),context.closePath()}},sqrt3=Math.sqrt(3),triangle={draw:function draw(context,size){var y=-Math.sqrt(size/(3*sqrt3));context.moveTo(0,2*y),context.lineTo(-sqrt3*y,-y),context.lineTo(sqrt3*y,-y),context.closePath()}},path_pi=Math.PI,path_tau=2*path_pi,tauEpsilon=path_tau-1e-6;function Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function path_path(){return new Path}Path.prototype=path_path.prototype={constructor:Path,moveTo:function moveTo(x,y){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)},closePath:function closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function lineTo(x,y){this._+="L"+(this._x1=+x)+","+(this._y1=+y)},quadraticCurveTo:function quadraticCurveTo(x1,y1,x,y){this._+="Q"+ +x1+","+ +y1+","+(this._x1=+x)+","+(this._y1=+y)},bezierCurveTo:function bezierCurveTo(x1,y1,x2,y2,x,y){this._+="C"+ +x1+","+ +y1+","+ +x2+","+ +y2+","+(this._x1=+x)+","+(this._y1=+y)},arcTo:function arcTo(x1,y1,x2,y2,r){x1=+x1,y1=+y1,x2=+x2,y2=+y2,r=+r;var x0=this._x1,y0=this._y1,x21=x2-x1,y21=y2-y1,x01=x0-x1,y01=y0-y1,l01_2=x01*x01+y01*y01;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=x1)+","+(this._y1=y1);else if(l01_2>1e-6)if(Math.abs(y01*x21-y21*x01)>1e-6&&r){var x20=x2-x0,y20=y2-y0,l21_2=x21*x21+y21*y21,l20_2=x20*x20+y20*y20,l21=Math.sqrt(l21_2),l01=Math.sqrt(l01_2),l=r*Math.tan((path_pi-Math.acos((l21_2+l01_2-l20_2)/(2*l21*l01)))/2),t01=l/l01,t21=l/l21;Math.abs(t01-1)>1e-6&&(this._+="L"+(x1+t01*x01)+","+(y1+t01*y01)),this._+="A"+r+","+r+",0,0,"+ +(y01*x20>x01*y20)+","+(this._x1=x1+t21*x21)+","+(this._y1=y1+t21*y21)}else this._+="L"+(this._x1=x1)+","+(this._y1=y1);else;},arc:function arc(x,y,r,a0,a1,ccw){x=+x,y=+y,ccw=!!ccw;var dx=(r=+r)*Math.cos(a0),dy=r*Math.sin(a0),x0=x+dx,y0=y+dy,cw=1^ccw,da=ccw?a0-a1:a1-a0;if(r<0)throw new Error("negative radius: "+r);null===this._x1?this._+="M"+x0+","+y0:(Math.abs(this._x1-x0)>1e-6||Math.abs(this._y1-y0)>1e-6)&&(this._+="L"+x0+","+y0),r&&(da<0&&(da=da%path_tau+path_tau),da>tauEpsilon?this._+="A"+r+","+r+",0,1,"+cw+","+(x-dx)+","+(y-dy)+"A"+r+","+r+",0,1,"+cw+","+(this._x1=x0)+","+(this._y1=y0):da>1e-6&&(this._+="A"+r+","+r+",0,"+ +(da>=path_pi)+","+cw+","+(this._x1=x+r*Math.cos(a1))+","+(this._y1=y+r*Math.sin(a1))))},rect:function rect(x,y,w,h){this._+="M"+(this._x0=this._x1=+x)+","+(this._y0=this._y1=+y)+"h"+ +w+"v"+ +h+"h"+-w+"Z"},toString:function toString(){return this._}};var src_path=path_path,d3_shape_src_constant=function(x){return function constant(){return x}},none=function(series){for(var n=series.length,o=new Array(n);--n>=0;)o[n]=n;return o},order_ascending=function(series){var sums=series.map(ascending_sum);return none(series).sort(function(a,b){return sums[a]-sums[b]})};function ascending_sum(series){for(var v,s=0,i=-1,n=series.length;++i<n;)(v=+series[i][1])&&(s+=v);return s}var offset_none=function(series,order){if((n=series.length)>1)for(var j,s0,n,i=1,s1=series[order[0]],m=s1.length;i<n;++i)for(s0=s1,s1=series[order[i]],j=0;j<m;++j)s1[j][1]+=s1[j][0]=isNaN(s0[j][1])?s0[j][0]:s0[j][1]},d3_shape_src_array_slice=Array.prototype.slice;function stackValue(d,key){return d[key]}function Linear(context){this._context=context}Linear.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._point=0},lineEnd:function lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:this._context.lineTo(x,y)}}};var curve_linear=function(context){return new Linear(context)};function Step(context,t){this._context=context,this._t=t}Step.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x=this._y=NaN,this._point=0},lineEnd:function lineEnd(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function point(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,y),this._context.lineTo(x,y);else{var x1=this._x*(1-this._t)+x*this._t;this._context.lineTo(x1,this._y),this._context.lineTo(x1,y)}}this._x=x,this._y=y}};var curve_step=function(context){return new Step(context,.5)};function stepBefore(context){return new Step(context,0)}function stepAfter(context){return new Step(context,1)}function _point(that,x,y){that._context.bezierCurveTo(that._x1+that._k*(that._x2-that._x0),that._y1+that._k*(that._y2-that._y0),that._x2+that._k*(that._x1-x),that._y2+that._k*(that._y1-y),that._x2,that._y2)}function Cardinal(context,tension){this._context=context,this._k=(1-tension)/6}Cardinal.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:_point(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(x,y){switch(x=+x,y=+y,this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2,this._x1=x,this._y1=y;break;case 2:this._point=3;default:_point(this,x,y)}this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};(function custom(tension){function cardinal(context){return new Cardinal(context,tension)}return cardinal.tension=function(tension){return custom(+tension)},cardinal})(0);function CatmullRom(context,alpha){this._context=context,this._alpha=alpha}CatmullRom.prototype={areaStart:function areaStart(){this._line=0},areaEnd:function areaEnd(){this._line=NaN},lineStart:function lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function point(x,y){if(x=+x,y=+y,this._point){var x23=this._x2-x,y23=this._y2-y;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(x23*x23+y23*y23,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(x,y):this._context.moveTo(x,y);break;case 1:this._point=2;break;case 2:this._point=3;default:!function catmullRom_point(that,x,y){var x1=that._x1,y1=that._y1,x2=that._x2,y2=that._y2;if(that._l01_a>math_epsilon){var a=2*that._l01_2a+3*that._l01_a*that._l12_a+that._l12_2a,n=3*that._l01_a*(that._l01_a+that._l12_a);x1=(x1*a-that._x0*that._l12_2a+that._x2*that._l01_2a)/n,y1=(y1*a-that._y0*that._l12_2a+that._y2*that._l01_2a)/n}if(that._l23_a>math_epsilon){var b=2*that._l23_2a+3*that._l23_a*that._l12_a+that._l12_2a,m=3*that._l23_a*(that._l23_a+that._l12_a);x2=(x2*b+that._x1*that._l23_2a-x*that._l12_2a)/m,y2=(y2*b+that._y1*that._l23_2a-y*that._l12_2a)/m}that._context.bezierCurveTo(x1,y1,x2,y2,that._x2,that._y2)}(this,x,y)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=x,this._y0=this._y1,this._y1=this._y2,this._y2=y}};var curve_catmullRom=function custom(alpha){function catmullRom(context){return alpha?new CatmullRom(context,alpha):new Cardinal(context,0)}return catmullRom.alpha=function(alpha){return custom(+alpha)},catmullRom}(.5);function point_x(p){return p[0]}function point_y(p){return p[1]}var src_line=function(){var x=point_x,y=point_y,defined=d3_shape_src_constant(!0),context=null,curve=curve_linear,output=null;function line(data){var i,d,buffer,n=data.length,defined0=!1;for(null==context&&(output=curve(buffer=src_path())),i=0;i<=n;++i)!(i<n&&defined(d=data[i],i,data))===defined0&&((defined0=!defined0)?output.lineStart():output.lineEnd()),defined0&&output.point(+x(d,i,data),+y(d,i,data));if(buffer)return output=null,buffer+""||null}return line.x=function(_){return arguments.length?(x="function"==typeof _?_:d3_shape_src_constant(+_),line):x},line.y=function(_){return arguments.length?(y="function"==typeof _?_:d3_shape_src_constant(+_),line):y},line.defined=function(_){return arguments.length?(defined="function"==typeof _?_:d3_shape_src_constant(!!_),line):defined},line.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),line):curve},line.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),line):context},line},src_descending=function(a,b){return b<a?-1:b>a?1:b>=a?0:NaN},d3_shape_src_identity=function(d){return d};function arcInnerRadius(d){return d.innerRadius}function arcOuterRadius(d){return d.outerRadius}function arcStartAngle(d){return d.startAngle}function arcEndAngle(d){return d.endAngle}function arcPadAngle(d){return d&&d.padAngle}function cornerTangents(x0,y0,x1,y1,r1,rc,cw){var x01=x0-x1,y01=y0-y1,lo=(cw?rc:-rc)/math_sqrt(x01*x01+y01*y01),ox=lo*y01,oy=-lo*x01,x11=x0+ox,y11=y0+oy,x10=x1+ox,y10=y1+oy,x00=(x11+x10)/2,y00=(y11+y10)/2,dx=x10-x11,dy=y10-y11,d2=dx*dx+dy*dy,r=r1-rc,D=x11*y10-x10*y11,d=(dy<0?-1:1)*math_sqrt(math_max(0,r*r*d2-D*D)),cx0=(D*dy-dx*d)/d2,cy0=(-D*dx-dy*d)/d2,cx1=(D*dy+dx*d)/d2,cy1=(-D*dx+dy*d)/d2,dx0=cx0-x00,dy0=cy0-y00,dx1=cx1-x00,dy1=cy1-y00;return dx0*dx0+dy0*dy0>dx1*dx1+dy1*dy1&&(cx0=cx1,cy0=cy1),{cx:cx0,cy:cy0,x01:-ox,y01:-oy,x11:cx0*(r1/r-1),y11:cy0*(r1/r-1)}}function hsl_hsl(hue){return function(start,end){var h=hue((start=hsl(start)).h,(end=hsl(end)).h),s=nogamma(start.s,end.s),l=nogamma(start.l,end.l),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.h=h(t),start.s=s(t),start.l=l(t),start.opacity=opacity(t),start+""}}}hsl_hsl(color_hue);var hslLong=hsl_hsl(nogamma);function piecewise_piecewise(interpolate,values){for(var i=0,n=values.length-1,v=values[0],I=new Array(n<0?0:n);i<n;)I[i]=interpolate(v,v=values[++i]);return function(t){var i=Math.max(0,Math.min(n-1,Math.floor(t*=n)));return I[i](t-i)}}function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var b1=4/11,b2=6/11,b3=8/11,b4=.75,b5=9/11,b6=10/11,b7=.9375,b8=21/22,b9=63/64,b0=1/b1/b1;function bounceOut(t){return(t=+t)<b1?b0*t*t:t<b3?b0*(t-=b2)*t+b4:t<b6?b0*(t-=b5)*t+b7:b0*(t-=b8)*t+b9}var elastic_tau=2*Math.PI,elasticOut=(function custom(a,p){var s=Math.asin(1/(a=Math.max(1,a)))*(p/=elastic_tau);function elasticIn(t){return a*Math.pow(2,10*--t)*Math.sin((s-t)/p)}return elasticIn.amplitude=function(a){return custom(a,p*elastic_tau)},elasticIn.period=function(p){return custom(a,p)},elasticIn}(1,.3),function custom(a,p){var s=Math.asin(1/(a=Math.max(1,a)))*(p/=elastic_tau);function elasticOut(t){return 1-a*Math.pow(2,-10*(t=+t))*Math.sin((t+s)/p)}return elasticOut.amplitude=function(a){return custom(a,p*elastic_tau)},elasticOut.period=function(p){return custom(a,p)},elasticOut}(1,.3)),backInOut=(function custom(a,p){var s=Math.asin(1/(a=Math.max(1,a)))*(p/=elastic_tau);function elasticInOut(t){return((t=2*t-1)<0?a*Math.pow(2,10*t)*Math.sin((s-t)/p):2-a*Math.pow(2,-10*t)*Math.sin((s+t)/p))/2}return elasticInOut.amplitude=function(a){return custom(a,p*elastic_tau)},elasticInOut.period=function(p){return custom(a,p)},elasticInOut}(1,.3),function custom(s){function backIn(t){return t*t*((s+1)*t-s)}return s=+s,backIn.overshoot=custom,backIn}(1.70158),function custom(s){function backOut(t){return--t*t*((s+1)*t+s)+1}return s=+s,backOut.overshoot=custom,backOut}(1.70158),function custom(s){function backInOut(t){return((t*=2)<1?t*t*((s+1)*t-s):(t-=2)*t*((s+1)*t+s)+2)/2}return s=+s,backInOut.overshoot=custom,backInOut}(1.70158)),polyInOut=(function custom(e){function polyIn(t){return Math.pow(t,e)}return e=+e,polyIn.exponent=custom,polyIn}(3),function custom(e){function polyOut(t){return 1-Math.pow(1-t,e)}return e=+e,polyOut.exponent=custom,polyOut}(3),function custom(e){function polyInOut(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,polyInOut.exponent=custom,polyInOut}(3));var d3_voronoi_src_constant=function(x){return function(){return x}};function src_point_x(d){return d[0]}function src_point_y(d){return d[1]}function RedBlackTree(){this._=null}function RedBlackNode(node){node.U=node.C=node.L=node.R=node.P=node.N=null}function RedBlackRotateLeft(tree,node){var p=node,q=node.R,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.R=q.L,p.R&&(p.R.U=p),q.L=p}function RedBlackRotateRight(tree,node){var p=node,q=node.L,parent=p.U;parent?parent.L===p?parent.L=q:parent.R=q:tree._=q,q.U=parent,p.U=q,p.L=q.R,p.L&&(p.L.U=p),q.R=p}function RedBlackFirst(node){for(;node.L;)node=node.L;return node}RedBlackTree.prototype={constructor:RedBlackTree,insert:function insert(after,node){var parent,grandpa,uncle;if(after){if(node.P=after,node.N=after.N,after.N&&(after.N.P=node),after.N=node,after.R){for(after=after.R;after.L;)after=after.L;after.L=node}else after.R=node;parent=after}else this._?(after=RedBlackFirst(this._),node.P=null,node.N=after,after.P=after.L=node,parent=after):(node.P=node.N=null,this._=node,parent=null);for(node.L=node.R=null,node.U=parent,node.C=!0,after=node;parent&&parent.C;)parent===(grandpa=parent.U).L?(uncle=grandpa.R)&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.R&&(RedBlackRotateLeft(this,parent),parent=(after=parent).U),parent.C=!1,grandpa.C=!0,RedBlackRotateRight(this,grandpa)):(uncle=grandpa.L)&&uncle.C?(parent.C=uncle.C=!1,grandpa.C=!0,after=grandpa):(after===parent.L&&(RedBlackRotateRight(this,parent),parent=(after=parent).U),parent.C=!1,grandpa.C=!0,RedBlackRotateLeft(this,grandpa)),parent=after.U;this._.C=!1},remove:function remove(node){node.N&&(node.N.P=node.P),node.P&&(node.P.N=node.N),node.N=node.P=null;var sibling,next,red,parent=node.U,left=node.L,right=node.R;if(next=left?right?RedBlackFirst(right):left:right,parent?parent.L===node?parent.L=next:parent.R=next:this._=next,left&&right?(red=next.C,next.C=node.C,next.L=left,left.U=next,next!==right?(parent=next.U,next.U=node.U,node=next.R,parent.L=node,next.R=right,right.U=next):(next.U=parent,parent=next,node=next.R)):(red=node.C,node=next),node&&(node.U=parent),!red)if(node&&node.C)node.C=!1;else{do{if(node===this._)break;if(node===parent.L){if((sibling=parent.R).C&&(sibling.C=!1,parent.C=!0,RedBlackRotateLeft(this,parent),sibling=parent.R),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.R&&sibling.R.C||(sibling.L.C=!1,sibling.C=!0,RedBlackRotateRight(this,sibling),sibling=parent.R),sibling.C=parent.C,parent.C=sibling.R.C=!1,RedBlackRotateLeft(this,parent),node=this._;break}}else if((sibling=parent.L).C&&(sibling.C=!1,parent.C=!0,RedBlackRotateRight(this,parent),sibling=parent.L),sibling.L&&sibling.L.C||sibling.R&&sibling.R.C){sibling.L&&sibling.L.C||(sibling.R.C=!1,sibling.C=!0,RedBlackRotateLeft(this,sibling),sibling=parent.L),sibling.C=parent.C,parent.C=sibling.L.C=!1,RedBlackRotateRight(this,parent),node=this._;break}sibling.C=!0,node=parent,parent=parent.U}while(!node.C);node&&(node.C=!1)}}};var src_RedBlackTree=RedBlackTree;function createEdge(left,right,v0,v1){var edge=[null,null],index=Diagram_edges.push(edge)-1;return edge.left=left,edge.right=right,v0&&setEdgeEnd(edge,left,right,v0),v1&&setEdgeEnd(edge,right,left,v1),Diagram_cells[left.index].halfedges.push(index),Diagram_cells[right.index].halfedges.push(index),edge}function createBorderEdge(left,v0,v1){var edge=[v0,v1];return edge.left=left,edge}function setEdgeEnd(edge,left,right,vertex){edge[0]||edge[1]?edge.left===right?edge[1]=vertex:edge[0]=vertex:(edge[0]=vertex,edge.left=left,edge.right=right)}function clipEdge(edge,x0,y0,x1,y1){var r,a=edge[0],b=edge[1],ax=a[0],ay=a[1],t0=0,t1=1,dx=b[0]-ax,dy=b[1]-ay;if(r=x0-ax,dx||!(r>0)){if(r/=dx,dx<0){if(r<t0)return;r<t1&&(t1=r)}else if(dx>0){if(r>t1)return;r>t0&&(t0=r)}if(r=x1-ax,dx||!(r<0)){if(r/=dx,dx<0){if(r>t1)return;r>t0&&(t0=r)}else if(dx>0){if(r<t0)return;r<t1&&(t1=r)}if(r=y0-ay,dy||!(r>0)){if(r/=dy,dy<0){if(r<t0)return;r<t1&&(t1=r)}else if(dy>0){if(r>t1)return;r>t0&&(t0=r)}if(r=y1-ay,dy||!(r<0)){if(r/=dy,dy<0){if(r>t1)return;r>t0&&(t0=r)}else if(dy>0){if(r<t0)return;r<t1&&(t1=r)}return!(t0>0||t1<1)||(t0>0&&(edge[0]=[ax+t0*dx,ay+t0*dy]),t1<1&&(edge[1]=[ax+t1*dx,ay+t1*dy]),!0)}}}}}function connectEdge(edge,x0,y0,x1,y1){var v1=edge[1];if(v1)return!0;var fm,fb,v0=edge[0],left=edge.left,right=edge.right,lx=left[0],ly=left[1],rx=right[0],ry=right[1],fx=(lx+rx)/2,fy=(ly+ry)/2;if(ry===ly){if(fx<x0||fx>=x1)return;if(lx>rx){if(v0){if(v0[1]>=y1)return}else v0=[fx,y0];v1=[fx,y1]}else{if(v0){if(v0[1]<y0)return}else v0=[fx,y1];v1=[fx,y0]}}else if(fb=fy-(fm=(lx-rx)/(ry-ly))*fx,fm<-1||fm>1)if(lx>rx){if(v0){if(v0[1]>=y1)return}else v0=[(y0-fb)/fm,y0];v1=[(y1-fb)/fm,y1]}else{if(v0){if(v0[1]<y0)return}else v0=[(y1-fb)/fm,y1];v1=[(y0-fb)/fm,y0]}else if(ly<ry){if(v0){if(v0[0]>=x1)return}else v0=[x0,fm*x0+fb];v1=[x1,fm*x1+fb]}else{if(v0){if(v0[0]<x0)return}else v0=[x1,fm*x1+fb];v1=[x0,fm*x0+fb]}return edge[0]=v0,edge[1]=v1,!0}function cellHalfedgeAngle(cell,edge){var site=cell.site,va=edge.left,vb=edge.right;return site===vb&&(vb=va,va=site),vb?Math.atan2(vb[1]-va[1],vb[0]-va[0]):(site===va?(va=edge[1],vb=edge[0]):(va=edge[0],vb=edge[1]),Math.atan2(va[0]-vb[0],vb[1]-va[1]))}function cellHalfedgeStart(cell,edge){return edge[+(edge.left!==cell.site)]}function cellHalfedgeEnd(cell,edge){return edge[+(edge.left===cell.site)]}var firstCircle,circlePool=[];function attachCircle(arc){var lArc=arc.P,rArc=arc.N;if(lArc&&rArc){var lSite=lArc.site,cSite=arc.site,rSite=rArc.site;if(lSite!==rSite){var bx=cSite[0],by=cSite[1],ax=lSite[0]-bx,ay=lSite[1]-by,cx=rSite[0]-bx,cy=rSite[1]-by,d=2*(ax*cy-ay*cx);if(!(d>=-epsilon2)){var ha=ax*ax+ay*ay,hc=cx*cx+cy*cy,x=(cy*ha-ay*hc)/d,y=(ax*hc-cx*ha)/d,circle=circlePool.pop()||new function Circle(){RedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null};circle.arc=arc,circle.site=cSite,circle.x=x+bx,circle.y=(circle.cy=y+by)+Math.sqrt(x*x+y*y),arc.circle=circle;for(var before=null,node=circles._;node;)if(circle.y<node.y||circle.y===node.y&&circle.x<=node.x){if(!node.L){before=node.P;break}node=node.L}else{if(!node.R){before=node;break}node=node.R}circles.insert(before,circle),before||(firstCircle=circle)}}}}function detachCircle(arc){var circle=arc.circle;circle&&(circle.P||(firstCircle=circle.N),circles.remove(circle),circlePool.push(circle),RedBlackNode(circle),arc.circle=null)}var beachPool=[];function createBeach(site){var beach=beachPool.pop()||new function Beach(){RedBlackNode(this),this.edge=this.site=this.circle=null};return beach.site=site,beach}function detachBeach(beach){detachCircle(beach),beaches.remove(beach),beachPool.push(beach),RedBlackNode(beach)}function removeBeach(beach){var circle=beach.circle,x=circle.x,y=circle.cy,vertex=[x,y],previous=beach.P,next=beach.N,disappearing=[beach];detachBeach(beach);for(var lArc=previous;lArc.circle&&Math.abs(x-lArc.circle.x)<Diagram_epsilon&&Math.abs(y-lArc.circle.cy)<Diagram_epsilon;)previous=lArc.P,disappearing.unshift(lArc),detachBeach(lArc),lArc=previous;disappearing.unshift(lArc),detachCircle(lArc);for(var rArc=next;rArc.circle&&Math.abs(x-rArc.circle.x)<Diagram_epsilon&&Math.abs(y-rArc.circle.cy)<Diagram_epsilon;)next=rArc.N,disappearing.push(rArc),detachBeach(rArc),rArc=next;disappearing.push(rArc),detachCircle(rArc);var iArc,nArcs=disappearing.length;for(iArc=1;iArc<nArcs;++iArc)rArc=disappearing[iArc],lArc=disappearing[iArc-1],setEdgeEnd(rArc.edge,lArc.site,rArc.site,vertex);lArc=disappearing[0],(rArc=disappearing[nArcs-1]).edge=createEdge(lArc.site,rArc.site,null,vertex),attachCircle(lArc),attachCircle(rArc)}function addBeach(site){for(var lArc,rArc,dxl,dxr,x=site[0],directrix=site[1],node=beaches._;node;)if((dxl=leftBreakPoint(node,directrix)-x)>Diagram_epsilon)node=node.L;else{if(!((dxr=x-rightBreakPoint(node,directrix))>Diagram_epsilon)){dxl>-Diagram_epsilon?(lArc=node.P,rArc=node):dxr>-Diagram_epsilon?(lArc=node,rArc=node.N):lArc=rArc=node;break}if(!node.R){lArc=node;break}node=node.R}!function createCell(site){return Diagram_cells[site.index]={site:site,halfedges:[]}}(site);var newArc=createBeach(site);if(beaches.insert(lArc,newArc),lArc||rArc){if(lArc===rArc)return detachCircle(lArc),rArc=createBeach(lArc.site),beaches.insert(newArc,rArc),newArc.edge=rArc.edge=createEdge(lArc.site,newArc.site),attachCircle(lArc),void attachCircle(rArc);if(rArc){detachCircle(lArc),detachCircle(rArc);var lSite=lArc.site,ax=lSite[0],ay=lSite[1],bx=site[0]-ax,by=site[1]-ay,rSite=rArc.site,cx=rSite[0]-ax,cy=rSite[1]-ay,d=2*(bx*cy-by*cx),hb=bx*bx+by*by,hc=cx*cx+cy*cy,vertex=[(cy*hb-by*hc)/d+ax,(bx*hc-cx*hb)/d+ay];setEdgeEnd(rArc.edge,lSite,rSite,vertex),newArc.edge=createEdge(lSite,site,null,vertex),rArc.edge=createEdge(site,rSite,null,vertex),attachCircle(lArc),attachCircle(rArc)}else newArc.edge=createEdge(lArc.site,newArc.site)}}function leftBreakPoint(arc,directrix){var site=arc.site,rfocx=site[0],rfocy=site[1],pby2=rfocy-directrix;if(!pby2)return rfocx;var lArc=arc.P;if(!lArc)return-1/0;var lfocx=(site=lArc.site)[0],lfocy=site[1],plby2=lfocy-directrix;if(!plby2)return lfocx;var hl=lfocx-rfocx,aby2=1/pby2-1/plby2,b=hl/plby2;return aby2?(-b+Math.sqrt(b*b-2*aby2*(hl*hl/(-2*plby2)-lfocy+plby2/2+rfocy-pby2/2)))/aby2+rfocx:(rfocx+lfocx)/2}function rightBreakPoint(arc,directrix){var rArc=arc.N;if(rArc)return leftBreakPoint(rArc,directrix);var site=arc.site;return site[1]===directrix?site[0]:1/0}var beaches,Diagram_cells,circles,Diagram_edges,Diagram_epsilon=1e-6,epsilon2=1e-12;function triangleArea(a,b,c){return(a[0]-c[0])*(b[1]-a[1])-(a[0]-b[0])*(c[1]-a[1])}function lexicographic(a,b){return b[1]-a[1]||b[0]-a[0]}function Diagram(sites,extent){var x,y,circle,site=sites.sort(lexicographic).pop();for(Diagram_edges=[],Diagram_cells=new Array(sites.length),beaches=new src_RedBlackTree,circles=new src_RedBlackTree;;)if(circle=firstCircle,site&&(!circle||site[1]<circle.y||site[1]===circle.y&&site[0]<circle.x))site[0]===x&&site[1]===y||(addBeach(site),x=site[0],y=site[1]),site=sites.pop();else{if(!circle)break;removeBeach(circle.arc)}if(function sortCellHalfedges(){for(var cell,halfedges,j,m,i=0,n=Diagram_cells.length;i<n;++i)if((cell=Diagram_cells[i])&&(m=(halfedges=cell.halfedges).length)){var index=new Array(m),array=new Array(m);for(j=0;j<m;++j)index[j]=j,array[j]=cellHalfedgeAngle(cell,Diagram_edges[halfedges[j]]);for(index.sort(function(i,j){return array[j]-array[i]}),j=0;j<m;++j)array[j]=halfedges[index[j]];for(j=0;j<m;++j)halfedges[j]=array[j]}}(),extent){var x0=+extent[0][0],y0=+extent[0][1],x1=+extent[1][0],y1=+extent[1][1];!function clipEdges(x0,y0,x1,y1){for(var edge,i=Diagram_edges.length;i--;)connectEdge(edge=Diagram_edges[i],x0,y0,x1,y1)&&clipEdge(edge,x0,y0,x1,y1)&&(Math.abs(edge[0][0]-edge[1][0])>Diagram_epsilon||Math.abs(edge[0][1]-edge[1][1])>Diagram_epsilon)||delete Diagram_edges[i]}(x0,y0,x1,y1),function clipCells(x0,y0,x1,y1){var iCell,cell,site,iHalfedge,halfedges,nHalfedges,start,startX,startY,end,endX,endY,nCells=Diagram_cells.length,cover=!0;for(iCell=0;iCell<nCells;++iCell)if(cell=Diagram_cells[iCell]){for(site=cell.site,iHalfedge=(halfedges=cell.halfedges).length;iHalfedge--;)Diagram_edges[halfedges[iHalfedge]]||halfedges.splice(iHalfedge,1);for(iHalfedge=0,nHalfedges=halfedges.length;iHalfedge<nHalfedges;)endX=(end=cellHalfedgeEnd(cell,Diagram_edges[halfedges[iHalfedge]]))[0],endY=end[1],startX=(start=cellHalfedgeStart(cell,Diagram_edges[halfedges[++iHalfedge%nHalfedges]]))[0],startY=start[1],(Math.abs(endX-startX)>Diagram_epsilon||Math.abs(endY-startY)>Diagram_epsilon)&&(halfedges.splice(iHalfedge,0,Diagram_edges.push(createBorderEdge(site,end,Math.abs(endX-x0)<Diagram_epsilon&&y1-endY>Diagram_epsilon?[x0,Math.abs(startX-x0)<Diagram_epsilon?startY:y1]:Math.abs(endY-y1)<Diagram_epsilon&&x1-endX>Diagram_epsilon?[Math.abs(startY-y1)<Diagram_epsilon?startX:x1,y1]:Math.abs(endX-x1)<Diagram_epsilon&&endY-y0>Diagram_epsilon?[x1,Math.abs(startX-x1)<Diagram_epsilon?startY:y0]:Math.abs(endY-y0)<Diagram_epsilon&&endX-x0>Diagram_epsilon?[Math.abs(startY-y0)<Diagram_epsilon?startX:x0,y0]:null))-1),++nHalfedges);nHalfedges&&(cover=!1)}if(cover){var dx,dy,d2,dc=1/0;for(iCell=0,cover=null;iCell<nCells;++iCell)(cell=Diagram_cells[iCell])&&(d2=(dx=(site=cell.site)[0]-x0)*dx+(dy=site[1]-y0)*dy)<dc&&(dc=d2,cover=cell);if(cover){var v00=[x0,y0],v01=[x0,y1],v11=[x1,y1],v10=[x1,y0];cover.halfedges.push(Diagram_edges.push(createBorderEdge(site=cover.site,v00,v01))-1,Diagram_edges.push(createBorderEdge(site,v01,v11))-1,Diagram_edges.push(createBorderEdge(site,v11,v10))-1,Diagram_edges.push(createBorderEdge(site,v10,v00))-1)}}for(iCell=0;iCell<nCells;++iCell)(cell=Diagram_cells[iCell])&&(cell.halfedges.length||delete Diagram_cells[iCell])}(x0,y0,x1,y1)}this.edges=Diagram_edges,this.cells=Diagram_cells,beaches=circles=Diagram_edges=Diagram_cells=null}Diagram.prototype={constructor:Diagram,polygons:function polygons(){var edges=this.edges;return this.cells.map(function(cell){var polygon=cell.halfedges.map(function(i){return cellHalfedgeStart(cell,edges[i])});return polygon.data=cell.site.data,polygon})},triangles:function triangles(){var triangles=[],edges=this.edges;return this.cells.forEach(function(cell,i){if(m=(halfedges=cell.halfedges).length)for(var halfedges,m,s0,site=cell.site,j=-1,e1=edges[halfedges[m-1]],s1=e1.left===site?e1.right:e1.left;++j<m;)s0=s1,s1=(e1=edges[halfedges[j]]).left===site?e1.right:e1.left,s0&&s1&&i<s0.index&&i<s1.index&&triangleArea(site,s0,s1)<0&&triangles.push([site.data,s0.data,s1.data])}),triangles},links:function links(){return this.edges.filter(function(edge){return edge.right}).map(function(edge){return{source:edge.left.data,target:edge.right.data}})},find:function find(x,y,radius){for(var i0,cell,that=this,i1=that._found||0,n=that.cells.length;!(cell=that.cells[i1]);)if(++i1>=n)return null;var dx=x-cell.site[0],dy=y-cell.site[1],d2=dx*dx+dy*dy;do{cell=that.cells[i0=i1],i1=null,cell.halfedges.forEach(function(e){var edge=that.edges[e],v=edge.left;if(v!==cell.site&&v||(v=edge.right)){var vx=x-v[0],vy=y-v[1],v2=vx*vx+vy*vy;v2<d2&&(d2=v2,i1=v.index)}})}while(null!==i1);return that._found=i0,null==radius||d2<=radius*radius?cell.site:null}};var src_voronoi=function(){var x=src_point_x,y=src_point_y,extent=null;function voronoi(data){return new Diagram(data.map(function(d,i){var s=[Math.round(x(d,i,data)/Diagram_epsilon)*Diagram_epsilon,Math.round(y(d,i,data)/Diagram_epsilon)*Diagram_epsilon];return s.index=i,s.data=d,s}),extent)}return voronoi.polygons=function(data){return voronoi(data).polygons()},voronoi.links=function(data){return voronoi(data).links()},voronoi.triangles=function(data){return voronoi(data).triangles()},voronoi.x=function(_){return arguments.length?(x="function"==typeof _?_:d3_voronoi_src_constant(+_),voronoi):x},voronoi.y=function(_){return arguments.length?(y="function"==typeof _?_:d3_voronoi_src_constant(+_),voronoi):y},voronoi.extent=function(_){return arguments.length?(extent=null==_?null:[[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]],voronoi):extent&&[[extent[0][0],extent[0][1]],[extent[1][0],extent[1][1]]]},voronoi.size=function(_){return arguments.length?(extent=null==_?null:[[0,0],[+_[0],+_[1]]],voronoi):extent&&[extent[1][0]-extent[0][0],extent[1][1]-extent[0][1]]},voronoi};function selection_toConsumableArray(arr){return function selection_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function selection_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function selection_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function selection_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var DataSystem_selection=function(){function Selection(idGetter){!function selection_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Selection),this._dataObjects=new Map,this._updateData=new Map,this._enterData=new Map,this._exitData=new Map,this._idGetter=idGetter}return function selection_createClass(Constructor,protoProps,staticProps){return protoProps&&selection_defineProperties(Constructor.prototype,protoProps),staticProps&&selection_defineProperties(Constructor,staticProps),Constructor}(Selection,[{key:"data",value:function data(newData){var val,entryData=new Map,exitdata=new Map,tempMap=new Map,duplicateData=new Map,updatedData=this._updateData,idGetter=this._idGetter;newData.forEach(function(){var key=idGetter?idGetter.apply(void 0,arguments):arguments.length<=1?void 0:arguments[1];tempMap.has(key)?duplicateData.push(key,arguments.length<=0?void 0:arguments[0]):tempMap.set(key,arguments.length<=0?void 0:arguments[0])});for(var entries=tempMap.entries();val=entries.next().value;)updatedData.has(val[0])?updatedData.set(val[0],val[1]):entryData.set(val[0],val[1]);for(entries=updatedData.entries();val=entries.next().value;)tempMap.has(val[0])||exitdata.set(val[0],val[1]);for(entries=duplicateData.entries();val=entries.next().value;)exitdata.set(val[0],val[1]);var newSelection=new Selection(this._idGetter);return newSelection._updateData=updatedData,newSelection._dataObjects=this._dataObjects,newSelection._enterData=entryData,newSelection._exitData=exitdata,newSelection}},{key:"append",value:function append(callback){for(var val,dataObjects=new Map,data=new Map,mode=defaultValue(this._mode,"update"),entries=this["_".concat(mode,"Data")].entries();val=entries.next().value;)dataObjects.set(val[0],callback(val[1])),data.set(val[0],val[1]);var newSelection=new Selection(this._idGetter);return newSelection._updateData=data,newSelection._dataObjects=dataObjects,newSelection}},{key:"enter",value:function enter(){return this._mode="enter",this}},{key:"exit",value:function exit(){return this._mode="exit",this}},{key:"merge",value:function merge(target){var val,entries,mergedObjects=new Map,mergedData=new Map;for(entries=this._updateData.entries();val=entries.next().value;)this._exitData.has(val[0])||(mergedData.set(val[0],val[1]),mergedObjects.set(val[0],this._dataObjects.get(val[0])));for(entries=target._updateData.entries();val=entries.next().value;)mergedData.has(val[0])||target._exitData.has(val[0])||(mergedData.set(val[0],val[1]),mergedObjects.set(val[0],target._dataObjects.get(val[0])));var newSelection=new Selection(this._idGetter);return newSelection._updateData=mergedData,newSelection._dataObjects=mergedObjects,newSelection}},{key:"each",value:function each(fn){for(var val,entries=this._dataObjects.entries();val=entries.next().value;)fn(val[1],this._updateData.get(val[0]),val[0])}},{key:"map",value:function map(fn){for(var val,newdata=new Map,entries=this._dataObjects.entries();val=entries.next().value;)newdata.set(val[0],fn(val[1],this._updateData.get(val[0]),val[0]));var newSelection=new Selection(this._idGetter);return newSelection._updateData=this._updateData,newSelection._dataObjects=newdata,newSelection}},{key:"remove",value:function remove(){var mode=defaultValue(this._mode,"update");return this["_".concat(mode,"Data")].clear(),this}},{key:"sort",value:function sort(sortFn){var updateData=this._updateData,dataObjects=this._dataObjects,sortSel=function sortSelection(dataObjects,updateData,sortFn){return function(a,b){var kA=a[0],kB=b[0];return sortFn([a[0],dataObjects.get(kA),updateData.get(kA)],[kB,dataObjects.get(kB),updateData.get(kB)])}}(dataObjects,updateData,sortFn);return this._updateData=new Map(selection_toConsumableArray(updateData.entries()).sort(sortSel)),this._dataObjects=new Map(selection_toConsumableArray(dataObjects.entries()).sort(sortSel)),this}},{key:"getObjects",value:function getObjects(){for(var val,objects=[],dataObjects=this._dataObjects,mode=defaultValue(this._mode,"update"),entries=this["_".concat(mode,"Data")].entries();val=entries.next().value;)dataObjects.has(val[0])&&objects.push(dataObjects.get(val[0]));return objects}}]),Selection}();function dataSelect(idFn){return new DataSystem_selection(idFn)}var _stackOrders,_stackOffsets,_sortOrderMap;function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function common_utils_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function common_utils_toConsumableArray(arr){return function common_utils_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function common_utils_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function common_utils_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function common_utils_typeof(obj){"@babel/helpers - typeof";return(common_utils_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var CATEGORICAL=dist_datamodel.DimensionSubtype.CATEGORICAL,TEMPORAL=dist_datamodel.DimensionSubtype.TEMPORAL,STRING=DATA_TYPE_STRING,FUNCTION=DATA_TYPE_FUNCTION,InvalidAwareTypes=datamodel_default.a.InvalidAwareTypes,common_utils_HTMLElement=window.HTMLElement,isSimpleObject=function isSimpleObject(obj){if("object"===common_utils_typeof(obj)){if(null===obj)return!1;if("[object Object]"===Object.prototype.toString.call(obj))return"Object"===(obj.constructor.toString().match(/^function (.*)\(\)/m)||[])[1]}return!1},getUniqueId=function getUniqueId(){return"id-".concat((new Date).getTime()).concat(Math.round(1e4*Math.random()))},clone=function clone(o){var v,output={};for(var key in o)({}).hasOwnProperty.call(o,key)&&(v=o[key],output[key]=isSimpleObject(v)?clone(v):v);return output},checkExistence=function checkExistence(keys,obj){var nonExistentKeys=[];return keys.forEach(function(key){key in obj||nonExistentKeys.push(key)}),nonExistentKeys},sanitizeIP={typeObj:function typeObj(keys,obj){if("object"!==common_utils_typeof(obj))return Error("Argument type object expected");var nonExistentKeys=checkExistence(keys,obj);return nonExistentKeys.length?Error("Missing keys from parameter ".concat(nonExistentKeys.join(", "))):obj},htmlElem:function htmlElem(elem){return elem instanceof common_utils_HTMLElement?elem:Error("HTMLElement required")}},getMax=function getMax(data,field){return Math.max.apply(Math,common_utils_toConsumableArray(data.map(function(d){return d[field]})))},getMin=function getMin(data,field){return Math.min.apply(Math,common_utils_toConsumableArray(data.map(function(d){return d[field]})))},getDomainFromData=function getDomainFromData(data,fields,fieldType){var _ref,domain,domArr=[];switch(data=data[0]instanceof Array?data:[data],fieldType){case CATEGORICAL:domain=(_ref=[]).concat.apply(_ref,common_utils_toConsumableArray(data.map(function(arr){return arr.map(function(d){return d[fields[0]]}).filter(function(d){return void 0!==d})})));break;default:for(var _loop=function _loop(i,len){var arr=data[i],_fields=_slicedToArray(fields,2),field0=_fields[0],field1=_fields[1],arr0=arr.filter(function(d){return!isNaN(d[field0])}),arr1=arr.filter(function(d){return!isNaN(d[field1])});if(arr0.length||arr1.length){var firstMin=getMin(arr0,field0),secondMin=getMin(arr1,field1),firstMax=getMax(arr0,field0),secondMax=getMax(arr1,field1);domArr.push([Math.min(firstMin,secondMin),Math.max(firstMax,secondMax)])}},i=0,len=data.length;i<len;i++)_loop(i);domain=domArr.length?[Math.min.apply(Math,common_utils_toConsumableArray(domArr.map(function(d){return d[0]}))),Math.max.apply(Math,common_utils_toConsumableArray(domArr.map(function(d){return d[1]})))]:[]}return domain},sanitizeDomainWhenEqual=function sanitizeDomainWhenEqual(domain){return domain[0]===domain[1]&&(domain[0]=domain[0]>0?0:domain[0],domain[1]=domain[1]>0?domain[1]:0),domain},unionDomain=function unionDomain(domains,fieldType){var _ref2,domain=[];(domains=domains.filter(function(dom){return dom&&dom.length})).length&&(domain=fieldType===CATEGORICAL?(_ref2=[]).concat.apply(_ref2,common_utils_toConsumableArray(domains)):[Math.min.apply(Math,common_utils_toConsumableArray(domains.map(function(d){return d[0]}))),Math.max.apply(Math,common_utils_toConsumableArray(domains.map(function(d){return d[1]})))]);return domain},symbolFns={circle:symbol_circle,cross:symbol_cross,diamond:diamond,square:square,star:star,wye:wye,triangle:triangle},easeFns={cubic:cubicInOut,bounce:bounceOut,linear:function src_linear_linear(t){return+t},elastic:elasticOut,back:backInOut,poly:polyInOut,circle:function circleInOut(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}},getExtremePoint=function getExtremePoint(points,compareValue,minOrMax){for(var extremePoint,point,val,len=points.length,minOrMaxVal="max"===minOrMax?-1/0:1/0,i=0;i<len;i++)val=(point=points[i])[compareValue],("min"===minOrMax?val<minOrMaxVal:val>minOrMaxVal)&&(minOrMaxVal=val,extremePoint=point);return extremePoint},getMinPoint=function getMinPoint(points,compareValue){return getExtremePoint(points,compareValue,"min")},getMaxPoint=function getMaxPoint(points,compareValue){return getExtremePoint(points,compareValue,"max")},common_utils_getClosestIndexOf=function getClosestIndexOf(arr,value,side){for(var mid,d1,low=0,high=arr.length-1;low<high;)mid=Math.floor((low+high)/2),d1=Math.abs(arr[mid]-value),Math.abs(arr[mid+1]-value)<=d1?low=mid+1:high=mid;if(!side)return high;var highVal=arr[high];return highVal===value?high:highVal>value?0===high?high:"left"===side?high-1:high:high===arr.length-1?high:"left"===side?high:high+1},getNearestValue=function getNearestValue(data,key){var filterData=data.filter(function(d){return"number"==typeof d});return filterData[common_utils_getClosestIndexOf(filterData,key)]},getWindow=function getWindow(){return window},reqAnimFrame=requestAnimationFrame,cancelAnimFrame=cancelAnimationFrame,capitalizeFirst=function capitalizeFirst(text){return(text=text.toLowerCase()).replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1)})},unique=function unique(arr){var fn=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(d){return d},vals=arr.reduce(function(acc,v){return acc[fn(v)]=v,acc},{});return Object.values(vals)},getMinDiff=function getMinDiff(arr,index){var diff,uniqueVals;if((uniqueVals=unique(void 0!==index?arr.map(function(d){return d[index]}):arr)).length>1){diff=Math.abs(uniqueVals[1]-uniqueVals[0]);for(var i=2,len=uniqueVals.length;i<len;i++)diff=Math.min(diff,Math.abs(uniqueVals[i]-uniqueVals[i-1]))}else diff=uniqueVals[0];return diff},getQualifiedClassName=function getQualifiedClassName(cls,id,prefix){return cls=cls.replace(/^\.*/,""),["".concat(prefix,"-").concat(cls),"".concat(prefix,"-").concat(cls,"-").concat(id)]},defaultValue=function defaultValue(param,value){return void 0===param||"object"===common_utils_typeof(param)&&!param?value:param},getDependencyOrder=function getDependencyOrder(graph){for(var dependencyOrder=[],visited={},keys=Object.keys(graph),visit=function visit(name){if(dependencyOrder.length===keys.length)return!0;visited[name]=!0;for(var edges=graph[name],e=0;e<edges.length;e++){var dep=edges[e];visited[dep]||visit(dep)}return dependencyOrder.push(name),!1},i=0;i<keys.length&&!visit(keys[i]);i++);return dependencyOrder},objectIterator=function objectIterator(obj,fn){for(var key in obj)Object.hasOwnProperty.call(obj,key)&&fn(key,obj)},common_utils_Voronoi=function(){function Voronoi(){var data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function common_utils_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Voronoi),this._voronoi=src_voronoi().x(function(d){return d.x}).y(function(d){return d.y}),this.data(data)}return function common_utils_createClass(Constructor,protoProps,staticProps){return protoProps&&common_utils_defineProperties(Constructor.prototype,protoProps),staticProps&&common_utils_defineProperties(Constructor,staticProps),Constructor}(Voronoi,[{key:"data",value:function data(_data){return _data&&(this._voronoiFn=this._voronoi(_data)),this}},{key:"find",value:function find(x,y,radius){return this._voronoiFn.find(x,y,radius)}}]),Voronoi}(),getObjProp=function getObjProp(obj){if(void 0===obj||null===obj)return obj;for(var retObj=obj,_len=arguments.length,fields=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)fields[_key-1]=arguments[_key];for(var i=0,len=fields.length;i<len&&(void 0!==(retObj=retObj[fields[i]])&&null!==retObj);i++);return retObj},intSanitizer=function intSanitizer(val){var arr=val.toString().match(/(\d+)(px)*/g);return arr?parseInt(arr[0],10):null},generateGetterSetters=function generateGetterSetters(context,props){Object.entries(props).forEach(function(propInfo){var prop=propInfo[0],_propInfo$=propInfo[1],sanitization=_propInfo$.sanitization,preset=_propInfo$.preset,onset=_propInfo$.onset,typeChecker=_propInfo$.typeChecker,defVal=_propInfo$.defaultValue,prototype=context.constructor.prototype;Object.hasOwnProperty.call(prototype,prop)||(defVal&&(context["_".concat(prop)]=defVal),context[prop]=function(){if(arguments.length){var value=arguments.length<=0?void 0:arguments[0];return sanitization&&(value=sanitization(context,arguments.length<=0?void 0:arguments[0],context["_".concat(prop)])),preset&&preset(context,value),typeChecker&&!typeChecker(value)?context["_".concat(prop)]:(context["_".concat(prop)]=value,onset&&onset(context,value),context)}return context["_".concat(prop)]})})},getArraySum=function getArraySum(arr,prop){return arr.reduce(function(total,elem){return total+=prop?elem[prop]:elem},0)},arraysEqual=function arraysEqual(arr1,arr2){if(arr1.length!==arr2.length)return!1;for(var i=arr1.length;i>=0;i--)if(arr1[i]!==arr2[i])return!1;return!0},common_utils_isEqual=function isEqual(type){return function(oldVal,newVal){return"Array"===type?!!oldVal&&arraysEqual(oldVal,newVal):"Object"===type?Object.is(oldVal,newVal):oldVal===newVal}},enableChainedTransaction=function enableChainedTransaction(transactionModel,transactionEndpoint,transactionItems){return transactionItems.forEach(function(item){return transactionModel.registerImmediateListener(item,function(_ref3){var newVal=_slicedToArray(_ref3,2)[1];return transactionEndpoint[item](newVal)})})},isHTMLElem=function isHTMLElem(elem){return elem instanceof common_utils_HTMLElement},ERROR_MSG={INTERFACE_IMPL:"Method not implemented"},mergeRecursive=function mergeRecursive(source,sink){for(var prop in sink)isSimpleObject(source[prop])&&isSimpleObject(sink[prop])?mergeRecursive(source[prop],sink[prop]):sink[prop]instanceof Object&&sink[prop].constructor===Object?(source[prop]={},mergeRecursive(source[prop],sink[prop])):source[prop]=sink[prop];return source},common_utils_createSelection=function createSelection(sel,appendObj,data,idFn){var selection=sel||dataSelect(idFn),mergedSelection=(selection=selection.data(data)).enter().append(appendObj).merge(selection),exitSelection=selection.exit();return exitSelection.getObjects().forEach(function(inst){return inst.remove()}),exitSelection.remove(),mergedSelection},interpolateArray=function interpolateArray(data,fitCount){var linearInterpolate=function linearInterpolate(before,after,atPoint){return before+(after-before)*atPoint},newData=[],springFactor=(data.length-1)/(fitCount-1);newData[0]=data[0];for(var i=1;i<fitCount-1;i++){var tmp=i*springFactor,before=Math.floor(tmp).toFixed(),after=Math.ceil(tmp).toFixed(),atPoint=tmp-before;newData[i]=linearInterpolate(data[before],data[after],atPoint)}return newData[fitCount-1]=data[data.length-1],newData},nextFrame=function nextFrame(fn){setTimeout(function(){fn()},0)},angleToRadian=function angleToRadian(angle){return angle*Math.PI/180},replaceCSSPrefix=function replaceCSSPrefix(){},common_utils_interpolator=function interpolator(){return src_value},common_utils_numberInterpolator=function numberInterpolator(){return src_number},common_utils_colorInterpolator=function colorInterpolator(){return src_rgb},common_utils_hslInterpolator=function hslInterpolator(){return hslLong},common_utils_transformColors=function transformColors(){return{color:color_color,rgb:color_rgb,hsl:hsl}},common_utils_piecewiseInterpolator=function piecewiseInterpolator(){return piecewise_piecewise};function hue2rgb(p,q,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?p+6*(q-p)*t:t<.5?q:t<2/3?p+(q-p)*(2/3-t)*6:p}var hslToRgb=function hslToRgb(h,s,l){var r,g,b,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(0===s)r=g=b=l;else{var q=l<.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3),g=hue2rgb(p,q,h),b=hue2rgb(p,q,h-1/3)}return[255*r,255*g,255*b,a]},rgbToHsv=function rgbToHsv(r,g,b){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r=+r,g=+g,b=+b,a=+a,r/=255,g/=255,b/=255;var h,s,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2;if(max===min)h=s=0;else{var d=max-min;switch(s=l>.5?d/(2-max-min):d/(max+min),max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4}h/=6}return[h,s,l,a]},hsvToRgb=function hsvToRgb(h,s,v){var r,g,b,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=Math.floor(6*h),f=6*h-i,p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s);switch(i%6){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q}return[255*r,255*g,255*b,a]},hexToHsv=function hexToHsv(hex){hex=hex.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(m,r,g,b){return r+r+g+g+b+b});var result=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);return result?rgbToHsv(parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)):""},hslaToRgb=function hslaToRgb(h,s,l,a){var _hslToRgb2=_slicedToArray(hslToRgb(h,s,l,a),4);return function RGBAtoRGB(r,g,b,a){var r2=arguments.length>4&&void 0!==arguments[4]?arguments[4]:255,g2=arguments.length>5&&void 0!==arguments[5]?arguments[5]:255,b2=arguments.length>6&&void 0!==arguments[6]?arguments[6]:255,r3=Math.round((1-a)*r2+a*r),g3=Math.round((1-a)*g2+a*g),b3=Math.round((1-a)*b2+a*b);return"rgb(".concat(r3,",").concat(g3,",").concat(b3,")")}(_hslToRgb2[0],_hslToRgb2[1],_hslToRgb2[2],_hslToRgb2[3])},detectColor=function detectColor(col){return/rgb\((\d{1,3}), (\d{1,3}), (\d{1,3})\)/.test(col)||/rgba?\(((25[0-5]|2[0-4]\d|1\d{1,2}|\d\d?)\s*,\s*?){2}(25[0-5]|2[0-4]\d|1\d{1,2}|\d\d?)\s*,?\s*([01]\.?\d*?)?\)/.test(col)?"rgb":/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(col)||/^hsla\(([\d.]+),\s*([\d.]+)%,\s*([\d.]+)%,\s*(\d*(?:\.\d+)?)\)$/.test(col)?"hsl":/^#([0-9a-f]{3}){1,2}$/i.test(col)?"hex":col};var assembleModelFromIdentifiers=function assembleModelFromIdentifiers(model,identifiers){var data,schema=[],fieldMap=model.getFieldsConfig();return identifiers.length?function(){for(var fields=identifiers[0],len=fields.length,i=0;i<len;i++){var field=fields[i],fieldObj=fieldMap[field]&&Object.assign({},fieldMap[field].def);fieldObj&&schema.push(Object.assign(fieldObj))}data=[];for(var header=identifiers[0],_loop2=function _loop2(_i2){var temp={};identifiers[_i2].forEach(function(fieldVal,cIdx){temp[header[cIdx]]=fieldVal}),data.push(temp)},_i2=1;_i2<identifiers.length;_i2+=1)_loop2(_i2)}():(data=[],schema=[]),new model.constructor(data,schema)},getDataModelFromRange=function getDataModelFromRange(dataModel,criteria,mode,criteriaFields){if(null===criteria)return null;var fieldsConfig=dataModel.getFieldsConfig(),selFields=criteriaFields||Object.keys(criteria).filter(function(d){return d in fieldsConfig});return dataModel.select(function selFn(fields){return selFields.every(function(field){var fieldValue=fields[field].internalValue,range=criteria[field][0]instanceof Array?criteria[field][0]:criteria[field];return common_utils_typeof(range[0])===STRING?void 0!==range.find(function(d){return d===fieldValue}):!!range&&fieldValue>=range[0]&&fieldValue<=range[1]})},{saveChild:!1,mode:mode})},getArrayIndexMap=function getArrayIndexMap(arr){return arr.reduce(function(acc,value,i){return acc[value]=i,acc},{})},common_utils_getDataModelFromIdentifiers=function getDataModelFromIdentifiers(dataModel,identifiers,mode,hasBarLayer){var filteredDataModel;if(identifiers instanceof Array){var fieldsConfig=dataModel.getFieldsConfig(),dataArr=identifiers.slice(1,identifiers.length);if(identifiers instanceof Function)filteredDataModel=identifiers(dataModel,{},!1);else if(identifiers instanceof Array&&identifiers[0].length){var filteredSchema=identifiers[0].filter(function(d){return d in fieldsConfig||d===reserved_fields.ROW_ID});filteredDataModel=dataModel.select(function(fields,rowId){var include=!0;return filteredSchema.forEach(function(propField,idx){var value=propField===reserved_fields.ROW_ID?rowId:fields[propField].internalValue,index=dataArr.findIndex(function(d){return d[idx]===value});include=include&&-1!==index}),include},{saveChild:!1,mode:mode})}else filteredDataModel=dataModel.select(function(){return!1},{saveChild:!1,mode:mode})}else filteredDataModel=getDataModelFromRange(dataModel,identifiers,mode,hasBarLayer);return filteredDataModel},common_utils_registerListeners=function registerListeners(context,listenerMap){for(var _len2=arguments.length,params=new Array(_len2>2?_len2-2:0),_key2=2;_key2<_len2;_key2++)params[_key2-2]=arguments[_key2];var propListenerMap=listenerMap.apply(void 0,[context].concat(params));for(var key in propListenerMap)if({}.hasOwnProperty.call(propListenerMap,key)){var namespace=params[1].namespace,ns=null;namespace&&(ns=namespace);var mapObj=propListenerMap[key],propType=mapObj.type,props=mapObj.props,listenerFn=mapObj.listener;context.store()[propType](props,listenerFn,!1,{namespace:ns})}},isValidValue=function isValidValue(value){return!isNaN(value)&&value!==-1/0&&value!==1/0},escapeHTML=function escapeHTML(str){var htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return"".concat(str).replace(/[&<>"'/]/g,function(match){return htmlEscapes[match]})},transposeArray=function transposeArray(arr){return arr[0].map(function(col,i){return arr.map(function(row){return row[i]})})},toArray=function toArray(arr){return arr instanceof Array?arr:[arr]},extendsClass=function extendsClass(cls,extendsFrom,found){if(!cls)return!1;var prototype=cls.prototype;return found=prototype instanceof extendsFrom||extendsClass(prototype,extendsFrom,found)},common_utils_concatModels=function concatModels(dm1,dm2){for(var dataObj1=dm1.getData(),dataObj2=dm2.getData(),data1=dataObj1.data,data2=dataObj2.data,schema1=dataObj1.schema,schema2=dataObj2.schema,commonTuples={},i=0;i<data1.length;i++)for(var _loop3=function _loop3(ii){var row1=data1[i],row2=data2[ii],dim1Values=row1.filter(function(d,idx){return schema1[idx].type===dist_datamodel.FieldType.DIMENSION}),dim2Values=row2.filter(function(d,idx){return schema2[idx].type===dist_datamodel.FieldType.DIMENSION});if(dim1Values.every(function(value){return-1!==dim2Values.indexOf(value)})){var key=dim1Values.join();!commonTuples[key]&&(commonTuples[key]={}),row1.forEach(function(value,idx){commonTuples[key][schema1[idx].name]=value}),row2.forEach(function(value,idx){commonTuples[key][schema2[idx].name]=value})}else{var dm1Key=dim1Values.join(),dm2Key=dim2Values.join();commonTuples[dm1Key]||(!commonTuples[dm1Key]&&(commonTuples[dm1Key]={}),row1.forEach(function(value,idx){commonTuples[dm1Key][schema1[idx].name]=value})),commonTuples[dm2Key]||(!commonTuples[dm2Key]&&(commonTuples[dm2Key]={}),row2.forEach(function(value,idx){commonTuples[dm2Key][schema2[idx].name]=value}))}},ii=0;ii<data2.length;ii++)_loop3(ii);var commonSchema=[].concat(common_utils_toConsumableArray(schema1),common_utils_toConsumableArray(schema2.filter(function(s2){return-1===schema1.findIndex(function(s1){return s1.name===s2.name})})));return[[].concat(common_utils_toConsumableArray(Object.values({})),common_utils_toConsumableArray(Object.values({})),common_utils_toConsumableArray(Object.values(commonTuples))),commonSchema]},common_utils_getSymbol=function getSymbol(type){return function(){var type=d3_shape_src_constant(symbol_circle),size=d3_shape_src_constant(64),context=null;function symbol(){var buffer;if(context||(context=buffer=src_path()),type.apply(this,arguments).draw(context,+size.apply(this,arguments)),buffer)return context=null,buffer+""||null}return symbol.type=function(_){return arguments.length?(type="function"==typeof _?_:d3_shape_src_constant(_),symbol):type},symbol.size=function(_){return arguments.length?(size="function"==typeof _?_:d3_shape_src_constant(+_),symbol):size},symbol.context=function(_){return arguments.length?(context=null==_?null:_,symbol):context},symbol}().type(symbolFns[type])},stackOrders=(_defineProperty(_stackOrders={},"none",none),_defineProperty(_stackOrders,"ascending",order_ascending),_defineProperty(_stackOrders,"descending",function(series){return order_ascending(series).reverse()}),_stackOrders),stackOffsets=(_defineProperty(_stackOffsets={},"diverging",function(series,order){if((n=series.length)>0)for(var i,d,dy,yp,yn,n,j=0,m=series[order[0]].length;j<m;++j)for(yp=yn=0,i=0;i<n;++i)(dy=(d=series[order[i]][j])[1]-d[0])>0?(d[0]=yp,d[1]=yp+=dy):dy<0?(d[1]=yn,d[0]=yn+=dy):(d[0]=0,d[1]=dy)}),_defineProperty(_stackOffsets,"none",offset_none),_defineProperty(_stackOffsets,"expand",function(series,order){if((n=series.length)>0){for(var i,n,y,j=0,m=series[0].length;j<m;++j){for(y=i=0;i<n;++i)y+=series[i][j][1]||0;if(y)for(i=0;i<n;++i)series[i][j][1]/=y}offset_none(series,order)}}),_defineProperty(_stackOffsets,"wiggle",function(series,order){if((n=series.length)>0&&(m=(s0=series[order[0]]).length)>0){for(var s0,m,n,y=0,j=1;j<m;++j){for(var i=0,s1=0,s2=0;i<n;++i){for(var si=series[order[i]],sij0=si[j][1]||0,s3=(sij0-(si[j-1][1]||0))/2,k=0;k<i;++k){var sk=series[order[k]];s3+=(sk[j][1]||0)-(sk[j-1][1]||0)}s1+=sij0,s2+=s3*sij0}s0[j-1][1]+=s0[j-1][0]=y,s1&&(y-=s2/s1)}s0[j-1][1]+=s0[j-1][0]=y,offset_none(series,order)}}),_stackOffsets),common_utils_stack=function stack(params){return function(){var keys=d3_shape_src_constant([]),order=none,offset=offset_none,value=stackValue;function stack(data){var i,oz,kz=keys.apply(this,arguments),m=data.length,n=kz.length,sz=new Array(n);for(i=0;i<n;++i){for(var sij,ki=kz[i],si=sz[i]=new Array(m),j=0;j<m;++j)si[j]=sij=[0,+value(data[j],ki,j,data)],sij.data=data[j];si.key=ki}for(i=0,oz=order(sz);i<n;++i)sz[oz[i]].index=i;return offset(sz,oz),sz}return stack.keys=function(_){return arguments.length?(keys="function"==typeof _?_:d3_shape_src_constant(d3_shape_src_array_slice.call(_)),stack):keys},stack.value=function(_){return arguments.length?(value="function"==typeof _?_:d3_shape_src_constant(+_),stack):value},stack.order=function(_){return arguments.length?(order=null==_?none:"function"==typeof _?_:d3_shape_src_constant(d3_shape_src_array_slice.call(_)),stack):order},stack.offset=function(_){return arguments.length?(offset=null==_?offset_none:_,stack):offset},stack}().keys(params.keys).offset(stackOffsets[params.offset]).order(stackOrders[params.order])(params.data)},common_utils_nestCollection=function nestCollection(params){var nestFn=src_nest();return params.keys.forEach(function(key){return nestFn.key(function(d){return d[key]})}),nestFn.entries(params.data)},getArrayDiff=function getArrayDiff(arr,arr1){return arr.filter(function(el){return arr1.indexOf(el)<0})},pathInterpolators={curveLinear:curve_linear,curveStepAfter:stepAfter,curveStepBefore:stepBefore,curveStep:curve_step,curveCatmullRom:curve_catmullRom,stepAfter:stepAfter,catmullRom:curve_catmullRom,step:curve_step,stepBefore:stepBefore,linear:curve_linear},Symbols={axisLeft:function axisLeft(scale){return axis_axis(axis_left,scale)},axisRight:function axisRight(scale){return axis_axis(axis_right,scale)},axisTop:function axisTop(scale){return axis_axis(axis_top,scale)},axisBottom:function axisBottom(scale){return axis_axis(axis_bottom,scale)},line:src_line,area:function(){var x0=point_x,x1=null,y0=d3_shape_src_constant(0),y1=point_y,defined=d3_shape_src_constant(!0),context=null,curve=curve_linear,output=null;function area(data){var i,j,k,d,buffer,n=data.length,defined0=!1,x0z=new Array(n),y0z=new Array(n);for(null==context&&(output=curve(buffer=src_path())),i=0;i<=n;++i){if(!(i<n&&defined(d=data[i],i,data))===defined0)if(defined0=!defined0)j=i,output.areaStart(),output.lineStart();else{for(output.lineEnd(),output.lineStart(),k=i-1;k>=j;--k)output.point(x0z[k],y0z[k]);output.lineEnd(),output.areaEnd()}defined0&&(x0z[i]=+x0(d,i,data),y0z[i]=+y0(d,i,data),output.point(x1?+x1(d,i,data):x0z[i],y1?+y1(d,i,data):y0z[i]))}if(buffer)return output=null,buffer+""||null}function arealine(){return src_line().defined(defined).curve(curve).context(context)}return area.x=function(_){return arguments.length?(x0="function"==typeof _?_:d3_shape_src_constant(+_),x1=null,area):x0},area.x0=function(_){return arguments.length?(x0="function"==typeof _?_:d3_shape_src_constant(+_),area):x0},area.x1=function(_){return arguments.length?(x1=null==_?null:"function"==typeof _?_:d3_shape_src_constant(+_),area):x1},area.y=function(_){return arguments.length?(y0="function"==typeof _?_:d3_shape_src_constant(+_),y1=null,area):y0},area.y0=function(_){return arguments.length?(y0="function"==typeof _?_:d3_shape_src_constant(+_),area):y0},area.y1=function(_){return arguments.length?(y1=null==_?null:"function"==typeof _?_:d3_shape_src_constant(+_),area):y1},area.lineX0=area.lineY0=function(){return arealine().x(x0).y(y0)},area.lineY1=function(){return arealine().x(x0).y(y1)},area.lineX1=function(){return arealine().x(x1).y(y0)},area.defined=function(_){return arguments.length?(defined="function"==typeof _?_:d3_shape_src_constant(!!_),area):defined},area.curve=function(_){return arguments.length?(curve=_,null!=context&&(output=curve(context)),area):curve},area.context=function(_){return arguments.length?(null==_?context=output=null:output=curve(context=_),area):context},area},pie:function(){var value=d3_shape_src_identity,sortValues=src_descending,sort=null,startAngle=d3_shape_src_constant(0),endAngle=d3_shape_src_constant(tau),padAngle=d3_shape_src_constant(0);function pie(data){var i,j,k,a1,v,n=data.length,sum=0,index=new Array(n),arcs=new Array(n),a0=+startAngle.apply(this,arguments),da=Math.min(tau,Math.max(-tau,endAngle.apply(this,arguments)-a0)),p=Math.min(Math.abs(da)/n,padAngle.apply(this,arguments)),pa=p*(da<0?-1:1);for(i=0;i<n;++i)(v=arcs[index[i]=i]=+value(data[i],i,data))>0&&(sum+=v);for(null!=sortValues?index.sort(function(i,j){return sortValues(arcs[i],arcs[j])}):null!=sort&&index.sort(function(i,j){return sort(data[i],data[j])}),i=0,k=sum?(da-n*pa)/sum:0;i<n;++i,a0=a1)j=index[i],a1=a0+((v=arcs[j])>0?v*k:0)+pa,arcs[j]={data:data[j],index:i,value:v,startAngle:a0,endAngle:a1,padAngle:p};return arcs}return pie.value=function(_){return arguments.length?(value="function"==typeof _?_:d3_shape_src_constant(+_),pie):value},pie.sortValues=function(_){return arguments.length?(sortValues=_,sort=null,pie):sortValues},pie.sort=function(_){return arguments.length?(sort=_,sortValues=null,pie):sort},pie.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:d3_shape_src_constant(+_),pie):startAngle},pie.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:d3_shape_src_constant(+_),pie):endAngle},pie.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:d3_shape_src_constant(+_),pie):padAngle},pie},arc:function(){var innerRadius=arcInnerRadius,outerRadius=arcOuterRadius,cornerRadius=d3_shape_src_constant(0),padRadius=null,startAngle=arcStartAngle,endAngle=arcEndAngle,padAngle=arcPadAngle,context=null;function arc(){var buffer,r,r0=+innerRadius.apply(this,arguments),r1=+outerRadius.apply(this,arguments),a0=startAngle.apply(this,arguments)-halfPi,a1=endAngle.apply(this,arguments)-halfPi,da=abs(a1-a0),cw=a1>a0;if(context||(context=buffer=src_path()),r1<r0&&(r=r1,r1=r0,r0=r),r1>math_epsilon)if(da>tau-math_epsilon)context.moveTo(r1*cos(a0),r1*sin(a0)),context.arc(0,0,r1,a0,a1,!cw),r0>math_epsilon&&(context.moveTo(r0*cos(a1),r0*sin(a1)),context.arc(0,0,r0,a1,a0,cw));else{var t0,t1,a01=a0,a11=a1,a00=a0,a10=a1,da0=da,da1=da,ap=padAngle.apply(this,arguments)/2,rp=ap>math_epsilon&&(padRadius?+padRadius.apply(this,arguments):math_sqrt(r0*r0+r1*r1)),rc=math_min(abs(r1-r0)/2,+cornerRadius.apply(this,arguments)),rc0=rc,rc1=rc;if(rp>math_epsilon){var p0=asin(rp/r0*sin(ap)),p1=asin(rp/r1*sin(ap));(da0-=2*p0)>math_epsilon?(a00+=p0*=cw?1:-1,a10-=p0):(da0=0,a00=a10=(a0+a1)/2),(da1-=2*p1)>math_epsilon?(a01+=p1*=cw?1:-1,a11-=p1):(da1=0,a01=a11=(a0+a1)/2)}var x01=r1*cos(a01),y01=r1*sin(a01),x10=r0*cos(a10),y10=r0*sin(a10);if(rc>math_epsilon){var oc,x11=r1*cos(a11),y11=r1*sin(a11),x00=r0*cos(a00),y00=r0*sin(a00);if(da<pi&&(oc=function intersect(x0,y0,x1,y1,x2,y2,x3,y3){var x10=x1-x0,y10=y1-y0,x32=x3-x2,y32=y3-y2,t=y32*x10-x32*y10;if(!(t*t<math_epsilon))return[x0+(t=(x32*(y0-y2)-y32*(x0-x2))/t)*x10,y0+t*y10]}(x01,y01,x00,y00,x11,y11,x10,y10))){var ax=x01-oc[0],ay=y01-oc[1],bx=x11-oc[0],by=y11-oc[1],kc=1/sin(function acos(x){return x>1?0:x<-1?pi:Math.acos(x)}((ax*bx+ay*by)/(math_sqrt(ax*ax+ay*ay)*math_sqrt(bx*bx+by*by)))/2),lc=math_sqrt(oc[0]*oc[0]+oc[1]*oc[1]);rc0=math_min(rc,(r0-lc)/(kc-1)),rc1=math_min(rc,(r1-lc)/(kc+1))}}da1>math_epsilon?rc1>math_epsilon?(t0=cornerTangents(x00,y00,x01,y01,r1,rc1,cw),t1=cornerTangents(x11,y11,x10,y10,r1,rc1,cw),context.moveTo(t0.cx+t0.x01,t0.cy+t0.y01),rc1<rc?context.arc(t0.cx,t0.cy,rc1,atan2(t0.y01,t0.x01),atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc1,atan2(t0.y01,t0.x01),atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r1,atan2(t0.cy+t0.y11,t0.cx+t0.x11),atan2(t1.cy+t1.y11,t1.cx+t1.x11),!cw),context.arc(t1.cx,t1.cy,rc1,atan2(t1.y11,t1.x11),atan2(t1.y01,t1.x01),!cw))):(context.moveTo(x01,y01),context.arc(0,0,r1,a01,a11,!cw)):context.moveTo(x01,y01),r0>math_epsilon&&da0>math_epsilon?rc0>math_epsilon?(t0=cornerTangents(x10,y10,x11,y11,r0,-rc0,cw),t1=cornerTangents(x01,y01,x00,y00,r0,-rc0,cw),context.lineTo(t0.cx+t0.x01,t0.cy+t0.y01),rc0<rc?context.arc(t0.cx,t0.cy,rc0,atan2(t0.y01,t0.x01),atan2(t1.y01,t1.x01),!cw):(context.arc(t0.cx,t0.cy,rc0,atan2(t0.y01,t0.x01),atan2(t0.y11,t0.x11),!cw),context.arc(0,0,r0,atan2(t0.cy+t0.y11,t0.cx+t0.x11),atan2(t1.cy+t1.y11,t1.cx+t1.x11),cw),context.arc(t1.cx,t1.cy,rc0,atan2(t1.y11,t1.x11),atan2(t1.y01,t1.x01),!cw))):context.arc(0,0,r0,a10,a00,cw):context.lineTo(x10,y10)}else context.moveTo(0,0);if(context.closePath(),buffer)return context=null,buffer+""||null}return arc.centroid=function(){var r=(+innerRadius.apply(this,arguments)+ +outerRadius.apply(this,arguments))/2,a=(+startAngle.apply(this,arguments)+ +endAngle.apply(this,arguments))/2-pi/2;return[cos(a)*r,sin(a)*r]},arc.innerRadius=function(_){return arguments.length?(innerRadius="function"==typeof _?_:d3_shape_src_constant(+_),arc):innerRadius},arc.outerRadius=function(_){return arguments.length?(outerRadius="function"==typeof _?_:d3_shape_src_constant(+_),arc):outerRadius},arc.cornerRadius=function(_){return arguments.length?(cornerRadius="function"==typeof _?_:d3_shape_src_constant(+_),arc):cornerRadius},arc.padRadius=function(_){return arguments.length?(padRadius=null==_?null:"function"==typeof _?_:d3_shape_src_constant(+_),arc):padRadius},arc.startAngle=function(_){return arguments.length?(startAngle="function"==typeof _?_:d3_shape_src_constant(+_),arc):startAngle},arc.endAngle=function(_){return arguments.length?(endAngle="function"==typeof _?_:d3_shape_src_constant(+_),arc):endAngle},arc.padAngle=function(_){return arguments.length?(padAngle="function"==typeof _?_:d3_shape_src_constant(+_),arc):padAngle},arc.context=function(_){return arguments.length?(context=null==_?null:_,arc):context},arc},nest:src_nest},Scales={band:band},getSmallestDiff=function getSmallestDiff(points){for(var minDiff=(points=points.sort(function(a,b){return a-b}))[1]-points[0],i=2;i<points.length;i++)minDiff=Math.min(minDiff,points[i]-points[i-1]);return minDiff},timeFormats={millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",month:"%B %Y",year:"%Y"},timeDurations=[["millisecond","second","minute","hour","day","month","year"],[1,1e3,6e4,36e5,864e5,2592e6,31536e6]],common_utils_formatTemporal=function formatTemporal(value,interval){var nearestInterval=function getNearestInterval(interval){var index=common_utils_getClosestIndexOf(timeDurations[1],interval);return timeDurations[0][index]}(interval);return dist_datamodel.DateTimeFormatter.formatAs(value,timeFormats[nearestInterval])},common_utils_temporalFields=function temporalFields(dataModel){var filteredFields={};return Object.entries(dataModel.getFieldspace().getDimension()).forEach(function(_ref5){var _ref6=_slicedToArray(_ref5,2),fieldName=_ref6[0],fieldObj=_ref6[1];fieldObj.subtype()===TEMPORAL&&(filteredFields[fieldName]=fieldObj)}),filteredFields},require=function require(lookupWhat,lookupDetails){return{resolvable:function resolvable(store){var lookupTarget=store[lookupWhat],depArr=lookupDetails.slice(0,lookupDetails.length-1),fn=lookupDetails[lookupDetails.length-1],deps=depArr.map(function(str){return lookupTarget[str]});return{fn:fn.apply(void 0,common_utils_toConsumableArray(deps)),depArr:depArr}}}},nextAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){setTimeout(callback,16)},getValueParser=function getValueParser(config){return function(val){return InvalidAwareTypes.getInvalidType(val)?val in config?config[val]:"".concat(val):val}},common_utils_retrieveNearestGroupByReducers=function retrieveNearestGroupByReducers(dataModel){for(var _len3=arguments.length,measureFieldNames=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)measureFieldNames[_key3-1]=arguments[_key3];var filteredReducers={};if(dataModel instanceof datamodel_default.a){var derivations=[].concat(common_utils_toConsumableArray(dataModel.getDerivations().reverse()),common_utils_toConsumableArray(dataModel.getAncestorDerivations().reverse())),nearestReducers=defaultValue(getObjProp(derivations.find(function(derv){return derv.op===dist_datamodel.DM_DERIVATIVES.GROUPBY}),"criteria"),{}),measures=dataModel.getFieldspace().getMeasure();(measureFieldNames=measureFieldNames.length?measureFieldNames:Object.keys(measures)).forEach(function(measureName){if(nearestReducers[measureName])filteredReducers[measureName]=nearestReducers[measureName];else{var measureField=measures[measureName];measureField&&(filteredReducers[measureName]=measureField.defAggFn())}})}return filteredReducers},retrieveFieldDisplayName=function retrieveFieldDisplayName(dm,fieldName){return dm.getFieldspace().fieldsObj()[fieldName].displayName()},common_utils_nearestSortingDetails=function nearestSortingDetails(dataModel){var nearestSortDerivation=[].concat(common_utils_toConsumableArray(dataModel.getAncestorDerivations()),common_utils_toConsumableArray(dataModel.getDerivations())).reverse().find(function(derivation){return derivation.op===dist_datamodel.DM_DERIVATIVES.SORT});return nearestSortDerivation?nearestSortDerivation.criteria:null},common_utils_sortingOrder=function sortingOrder(a,b){return a instanceof InvalidAwareTypes||b instanceof InvalidAwareTypes?1:a.localeCompare(b)},sortOrderMap=(_defineProperty(_sortOrderMap={},"asc",function(firstVal,secondVal){return common_utils_sortingOrder(firstVal,secondVal)}),_defineProperty(_sortOrderMap,"desc",function(firstVal,secondVal){return common_utils_sortingOrder(secondVal,firstVal)}),_sortOrderMap),sortCategoricalField=function sortCategoricalField(sortOrder,firstVal,secondVal){var sortOrderType=common_utils_typeof(sortOrder);return sortOrderType===FUNCTION?sortOrder(firstVal,secondVal):sortOrderType===STRING&&sortOrderMap[sortOrder]?sortOrderMap[sortOrder](firstVal,secondVal):null},common_utils_intersect=function intersect(arr1,arr2){var _accessors=_slicedToArray(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[function(v){return v},function(v){return v}],2),fn1=_accessors[0],fn2=_accessors[1],set=new Set(arr2.map(function(v){return fn2(v)}));return arr1.filter(function(value){return set.has(fn1(value))})},difference=function difference(arr1,arr2){var _accessors2=_slicedToArray(arguments.length>2&&void 0!==arguments[2]?arguments[2]:[function(v){return v},function(v){return v}],2),fn1=_accessors2[0],fn2=_accessors2[1],set=new Set(arr2.map(function(v){return fn2(v)}));return arr1.filter(function(value){return!set.has(fn1(value))})},partition=function partition(array,filterFn){return array.reduce(function(acc,v,i){return filterFn(v,i,array)?acc[0].push(v):acc[1].push(v),acc},[[],[]])},mix=function mix(superclass){return{with:function _with(){for(var _len4=arguments.length,mixins=new Array(_len4),_key4=0;_key4<_len4;_key4++)mixins[_key4]=arguments[_key4];return mixins.reduce(function(cls,mixin){return mixin(cls)},superclass)}}},common_utils_componentRegistry=function componentRegistry(comps){var reg=Object.assign({},comps),regObj={register:function register(def,customKey){var key=customKey||def.formalName();return reg[key]=def,regObj},get:function get(){return reg}};return regObj},common_utils_getReadableTicks=function getReadableTicks(domain,steps){var orderedDomain=[Math.min.apply(Math,common_utils_toConsumableArray(domain)),Math.max.apply(Math,common_utils_toConsumableArray(domain))];if(steps<3)return orderedDomain;var tempScale=quantize().domain(orderedDomain).nice(),legendTicks=null;return legendTicks=Symbols.axisBottom().scale(tempScale).scale().ticks(steps),Math.max.apply(Math,common_utils_toConsumableArray(legendTicks))<orderedDomain[1]&&legendTicks.push(orderedDomain[1]),Math.min.apply(Math,common_utils_toConsumableArray(legendTicks))>orderedDomain[0]&&legendTicks.unshift(orderedDomain[0]),legendTicks},common_utils_transformColor=function transformColor(rgbaValues,_ref7,datum,apply){var _ref7$h=_ref7.h,h=void 0===_ref7$h?0:_ref7$h,_ref7$s=_ref7.s,s=void 0===_ref7$s?0:_ref7$s,_ref7$l=_ref7.l,l=void 0===_ref7$l?0:_ref7$l,a=_ref7.a,_RGBAToHSLA$code=_slicedToArray(function RGBAToHSLA(r,g,b){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r/=255,g/=255,b/=255;var cmin=Math.min(r,g,b),cmax=Math.max(r,g,b),delta=cmax-cmin,h=0,s=0,l=0;return h=0===delta?0:cmax===r?(g-b)/delta%6:cmax===g?(b-r)/delta+2:(r-g)/delta+4,(h=Math.round(60*h))<0&&(h+=360),l=(cmax+cmin)/2,s=+(100*(s=0===delta?0:delta/(1-Math.abs(2*l-1)))).toFixed(1),l=+(100*l).toFixed(1),{color:"hsla(".concat(h,",").concat(s,"%,").concat(l,"%,").concat(a,")"),code:[h,s,l,a]}}.apply(void 0,common_utils_toConsumableArray(rgbaValues)).code,4),origH=_RGBAToHSLA$code[0],origS=_RGBAToHSLA$code[1],origL=_RGBAToHSLA$code[2],origA=_RGBAToHSLA$code[3],sanitizedA=parseFloat(a||origA,10),newH=origH+h,newS=origS+s,newL=origL+l,newA=sanitizedA+1;return apply||(newA=sanitizedA-1),{color:"hsla(".concat(newH,",").concat(newS,"%,").concat(newL,"%,").concat(newA,")"),hsla:[newH,newS,newL,newA]}},pointWithinCircle=function pointWithinCircle(c,point){var cx=c.x,cy=c.y,r=c.r,x=point.x,y=point.y;return Math.sqrt(Math.pow(cx-x,2)+Math.pow(cy-y,2))<=r},common_utils_dmMultipleSelection=function dmMultipleSelection(targetData,dm){var targetFields=targetData[0],payloadMap=targetData.slice(1,targetData.length).reduce(function(acc,v){return acc[v]=v,acc},{}),measures=Object.keys(dm.getFieldspace().getMeasure());return function filterFn(fields,i){return"".concat(targetFields.map(function(field){var val;if(field===reserved_fields.MEASURE_NAMES)val=measures;else if(field===reserved_fields.ROW_ID)val=i;else{var currentField=fields[field];val=currentField instanceof InvalidAwareTypes?currentField.value():(currentField||{}).internalValue}return val}))in payloadMap}},getIndexMap=function getIndexMap(arr,prop){return arr.reduce(function(acc,v,i){return acc[prop?v[prop]:v]=i,acc},{})};function selector_none(){}var src_selector=function(selector){return null==selector?selector_none:function(){return this.querySelector(selector)}};function selectorAll_empty(){return[]}var selectorAll=function(selector){return null==selector?selectorAll_empty:function(){return this.querySelectorAll(selector)}},matcher=function(selector){return function(){return this.matches(selector)}},sparse=function(update){return new Array(update.length)};function EnterNode(parent,datum){this.ownerDocument=parent.ownerDocument,this.namespaceURI=parent.namespaceURI,this._next=null,this._parent=parent,this.__data__=datum}EnterNode.prototype={constructor:EnterNode,appendChild:function appendChild(child){return this._parent.insertBefore(child,this._next)},insertBefore:function insertBefore(child,next){return this._parent.insertBefore(child,next)},querySelector:function querySelector(selector){return this._parent.querySelector(selector)},querySelectorAll:function querySelectorAll(selector){return this._parent.querySelectorAll(selector)}};var keyPrefix="$";function bindIndex(parent,group,enter,update,exit,data){for(var node,i=0,groupLength=group.length,dataLength=data.length;i<dataLength;++i)(node=group[i])?(node.__data__=data[i],update[i]=node):enter[i]=new EnterNode(parent,data[i]);for(;i<groupLength;++i)(node=group[i])&&(exit[i]=node)}function bindKey(parent,group,enter,update,exit,data,key){var i,node,keyValue,nodeByKeyValue={},groupLength=group.length,dataLength=data.length,keyValues=new Array(groupLength);for(i=0;i<groupLength;++i)(node=group[i])&&(keyValues[i]=keyValue=keyPrefix+key.call(node,node.__data__,i,group),keyValue in nodeByKeyValue?exit[i]=node:nodeByKeyValue[keyValue]=node);for(i=0;i<dataLength;++i)(node=nodeByKeyValue[keyValue=keyPrefix+key.call(parent,data[i],i,data)])?(update[i]=node,node.__data__=data[i],nodeByKeyValue[keyValue]=null):enter[i]=new EnterNode(parent,data[i]);for(i=0;i<groupLength;++i)(node=group[i])&&nodeByKeyValue[keyValues[i]]===node&&(exit[i]=node)}function sort_ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}var xhtml="http://www.w3.org/1999/xhtml",src_namespaces={svg:"http://www.w3.org/2000/svg",xhtml:xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},src_namespace=function(name){var prefix=name+="",i=prefix.indexOf(":");return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),src_namespaces.hasOwnProperty(prefix)?{space:src_namespaces[prefix],local:name}:name};var src_window=function(node){return node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView};function styleValue(node,name){return node.style.getPropertyValue(name)||src_window(node).getComputedStyle(node,null).getPropertyValue(name)}function classArray(string){return string.trim().split(/^|\s+/)}function classList(node){return node.classList||new ClassList(node)}function ClassList(node){this._node=node,this._names=classArray(node.getAttribute("class")||"")}function classedAdd(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.add(names[i])}function classedRemove(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.remove(names[i])}ClassList.prototype={add:function add(name){this._names.indexOf(name)<0&&(this._names.push(name),this._node.setAttribute("class",this._names.join(" ")))},remove:function remove(name){var i=this._names.indexOf(name);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function contains(name){return this._names.indexOf(name)>=0}};function textRemove(){this.textContent=""}function htmlRemove(){this.innerHTML=""}function raise_raise(){this.nextSibling&&this.parentNode.appendChild(this)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}var creator=function(name){var fullname=src_namespace(name);return(fullname.local?function creatorFixed(fullname){return function(){return this.ownerDocument.createElementNS(fullname.space,fullname.local)}}:function creatorInherit(name){return function(){var document=this.ownerDocument,uri=this.namespaceURI;return uri===xhtml&&document.documentElement.namespaceURI===xhtml?document.createElement(name):document.createElementNS(uri,name)}})(fullname)};function constantNull(){return null}function remove_remove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function selection_cloneShallow(){var clone=this.cloneNode(!1),parent=this.parentNode;return parent?parent.insertBefore(clone,this.nextSibling):clone}function selection_cloneDeep(){var clone=this.cloneNode(!0),parent=this.parentNode;return parent?parent.insertBefore(clone,this.nextSibling):clone}var filterEvents={},on_event=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(filterEvents={mouseenter:"mouseover",mouseleave:"mouseout"}));function filterContextListener(listener,index,group){return listener=contextListener(listener,index,group),function(event){var related=event.relatedTarget;related&&(related===this||8&related.compareDocumentPosition(this))||listener.call(this,event)}}function contextListener(listener,index,group){return function(event1){var event0=on_event;on_event=event1;try{listener.call(this,this.__data__,index,group)}finally{on_event=event0}}}function onRemove(typename){return function(){var on=this.__on;if(on){for(var o,j=0,i=-1,m=on.length;j<m;++j)o=on[j],typename.type&&o.type!==typename.type||o.name!==typename.name?on[++i]=o:this.removeEventListener(o.type,o.listener,o.capture);++i?on.length=i:delete this.__on}}}function onAdd(typename,value,capture){var wrap=filterEvents.hasOwnProperty(typename.type)?filterContextListener:contextListener;return function(d,i,group){var o,on=this.__on,listener=wrap(value,i,group);if(on)for(var j=0,m=on.length;j<m;++j)if((o=on[j]).type===typename.type&&o.name===typename.name)return this.removeEventListener(o.type,o.listener,o.capture),this.addEventListener(o.type,o.listener=listener,o.capture=capture),void(o.value=value);this.addEventListener(typename.type,listener,capture),o={type:typename.type,name:typename.name,value:value,listener:listener,capture:capture},on?on.push(o):this.__on=[o]}}function customEvent(event1,listener,that,args){var event0=on_event;event1.sourceEvent=on_event,on_event=event1;try{return listener.apply(that,args)}finally{on_event=event0}}function dispatchEvent(node,type,params){var window=src_window(node),event=window.CustomEvent;"function"==typeof event?event=new event(type,params):(event=window.document.createEvent("Event"),params?(event.initEvent(type,params.bubbles,params.cancelable),event.detail=params.detail):event.initEvent(type,!1,!1)),node.dispatchEvent(event)}var selection_root=[null];function src_selection_Selection(groups,parents){this._groups=groups,this._parents=parents}function selection_selection(){return new src_selection_Selection([[document.documentElement]],selection_root)}src_selection_Selection.prototype=selection_selection.prototype={constructor:src_selection_Selection,select:function(select){"function"!=typeof select&&(select=src_selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode);return new src_selection_Selection(subgroups,this._parents)},selectAll:function(select){"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&(subgroups.push(select.call(node,node.__data__,i,group)),parents.push(node));return new src_selection_Selection(subgroups,parents)},filter:function(match){"function"!=typeof match&&(match=matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new src_selection_Selection(subgroups,this._parents)},data:function(value,key){if(!value)return data=new Array(this.size()),j=-1,this.each(function(d){data[++j]=d}),data;var bind=key?bindKey:bindIndex,parents=this._parents,groups=this._groups;"function"!=typeof value&&(value=function(x){return function(){return x}}(value));for(var m=groups.length,update=new Array(m),enter=new Array(m),exit=new Array(m),j=0;j<m;++j){var parent=parents[j],group=groups[j],groupLength=group.length,data=value.call(parent,parent&&parent.__data__,j,parents),dataLength=data.length,enterGroup=enter[j]=new Array(dataLength),updateGroup=update[j]=new Array(dataLength);bind(parent,group,enterGroup,updateGroup,exit[j]=new Array(groupLength),data,key);for(var previous,next,i0=0,i1=0;i0<dataLength;++i0)if(previous=enterGroup[i0]){for(i0>=i1&&(i1=i0+1);!(next=updateGroup[i1])&&++i1<dataLength;);previous._next=next||null}}return(update=new src_selection_Selection(update,parents))._enter=enter,update._exit=exit,update},enter:function(){return new src_selection_Selection(this._enter||this._groups.map(sparse),this._parents)},exit:function(){return new src_selection_Selection(this._exit||this._groups.map(sparse),this._parents)},join:function(onenter,onupdate,onexit){var enter=this.enter(),update=this,exit=this.exit();return enter="function"==typeof onenter?onenter(enter):enter.append(onenter+""),null!=onupdate&&(update=onupdate(update)),null==onexit?exit.remove():onexit(exit),enter&&update?enter.merge(update).order():update},merge:function(selection){for(var groups0=this._groups,groups1=selection._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new src_selection_Selection(merges,this._parents)},order:function(){for(var groups=this._groups,j=-1,m=groups.length;++j<m;)for(var node,group=groups[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&4^node.compareDocumentPosition(next)&&next.parentNode.insertBefore(node,next),next=node);return this},sort:function(compare){function compareNode(a,b){return a&&b?compare(a.__data__,b.__data__):!a-!b}compare||(compare=sort_ascending);for(var groups=this._groups,m=groups.length,sortgroups=new Array(m),j=0;j<m;++j){for(var node,group=groups[j],n=group.length,sortgroup=sortgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(sortgroup[i]=node);sortgroup.sort(compareNode)}return new src_selection_Selection(sortgroups,this._parents).order()},call:function(){var callback=arguments[0];return arguments[0]=this,callback.apply(null,arguments),this},nodes:function(){var nodes=new Array(this.size()),i=-1;return this.each(function(){nodes[++i]=this}),nodes},node:function(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var group=groups[j],i=0,n=group.length;i<n;++i){var node=group[i];if(node)return node}return null},size:function(){var size=0;return this.each(function(){++size}),size},empty:function(){return!this.node()},each:function(callback){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&callback.call(node,node.__data__,i,group);return this},attr:function(name,value){var fullname=src_namespace(name);if(arguments.length<2){var node=this.node();return fullname.local?node.getAttributeNS(fullname.space,fullname.local):node.getAttribute(fullname)}return this.each((null==value?fullname.local?function attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}:function attrRemove(name){return function(){this.removeAttribute(name)}}:"function"==typeof value?fullname.local?function attrFunctionNS(fullname,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttributeNS(fullname.space,fullname.local):this.setAttributeNS(fullname.space,fullname.local,v)}}:function attrFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttribute(name):this.setAttribute(name,v)}}:fullname.local?function attrConstantNS(fullname,value){return function(){this.setAttributeNS(fullname.space,fullname.local,value)}}:function attrConstant(name,value){return function(){this.setAttribute(name,value)}})(fullname,value))},style:function(name,value,priority){return arguments.length>1?this.each((null==value?function styleRemove(name){return function(){this.style.removeProperty(name)}}:"function"==typeof value?function styleFunction(name,value,priority){return function(){var v=value.apply(this,arguments);null==v?this.style.removeProperty(name):this.style.setProperty(name,v,priority)}}:function styleConstant(name,value,priority){return function(){this.style.setProperty(name,value,priority)}})(name,value,null==priority?"":priority)):styleValue(this.node(),name)},property:function(name,value){return arguments.length>1?this.each((null==value?function propertyRemove(name){return function(){delete this[name]}}:"function"==typeof value?function propertyFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?delete this[name]:this[name]=v}}:function propertyConstant(name,value){return function(){this[name]=value}})(name,value)):this.node()[name]},classed:function(name,value){var names=classArray(name+"");if(arguments.length<2){for(var list=classList(this.node()),i=-1,n=names.length;++i<n;)if(!list.contains(names[i]))return!1;return!0}return this.each(("function"==typeof value?function classedFunction(names,value){return function(){(value.apply(this,arguments)?classedAdd:classedRemove)(this,names)}}:value?function classedTrue(names){return function(){classedAdd(this,names)}}:function classedFalse(names){return function(){classedRemove(this,names)}})(names,value))},text:function(value){return arguments.length?this.each(null==value?textRemove:("function"==typeof value?function textFunction(value){return function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}}:function textConstant(value){return function(){this.textContent=value}})(value)):this.node().textContent},html:function(value){return arguments.length?this.each(null==value?htmlRemove:("function"==typeof value?function htmlFunction(value){return function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}}:function htmlConstant(value){return function(){this.innerHTML=value}})(value)):this.node().innerHTML},raise:function(){return this.each(raise_raise)},lower:function(){return this.each(lower)},append:function(name){var create="function"==typeof name?name:creator(name);return this.select(function(){return this.appendChild(create.apply(this,arguments))})},insert:function(name,before){var create="function"==typeof name?name:creator(name),select=null==before?constantNull:"function"==typeof before?before:src_selector(before);return this.select(function(){return this.insertBefore(create.apply(this,arguments),select.apply(this,arguments)||null)})},remove:function(){return this.each(remove_remove)},clone:function(deep){return this.select(deep?selection_cloneDeep:selection_cloneShallow)},datum:function(value){return arguments.length?this.property("__data__",value):this.node().__data__},on:function(typename,value,capture){var i,t,typenames=function parseTypenames(typenames){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");return i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),{type:t,name:name}})}(typename+""),n=typenames.length;if(!(arguments.length<2)){for(on=value?onAdd:onRemove,null==capture&&(capture=!1),i=0;i<n;++i)this.each(on(typenames[i],value,capture));return this}var on=this.node().__on;if(on)for(var o,j=0,m=on.length;j<m;++j)for(i=0,o=on[j];i<n;++i)if((t=typenames[i]).type===o.type&&t.name===o.name)return o.value},dispatch:function(type,params){return this.each(("function"==typeof params?function dispatchFunction(type,params){return function(){return dispatchEvent(this,type,params.apply(this,arguments))}}:function dispatchConstant(type,params){return function(){return dispatchEvent(this,type,params)}})(type,params))}};var src_selection=selection_selection,src_select=function(selector){return"string"==typeof selector?new src_selection_Selection([[document.querySelector(selector)]],[document.documentElement]):new src_selection_Selection([[selector]],selection_root)},src_point=function(node,event){var svg=node.ownerSVGElement||node;if(svg.createSVGPoint){var point=svg.createSVGPoint();return point.x=event.clientX,point.y=event.clientY,[(point=point.matrixTransform(node.getScreenCTM().inverse())).x,point.y]}var rect=node.getBoundingClientRect();return[event.clientX-rect.left-node.clientLeft,event.clientY-rect.top-node.clientTop]},noop={value:function value(){}};function dispatch_dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _||/[\s.]/.test(t))throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function dispatch_get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function dispatch_set(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name:name,value:callback}),type}Dispatch.prototype=dispatch_dispatch.prototype={constructor:Dispatch,on:function on(typename,callback){var t,_=this._,T=function dispatch_parseTypenames(typenames,types){return typenames.trim().split(/^|\s+/).map(function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:name}})}(typename+"",_),i=-1,n=T.length;if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=dispatch_set(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=dispatch_set(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=dispatch_get(_[t],typename.name)))return t},copy:function copy(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function call(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(i=0,n=(t=this._[type]).length;i<n;++i)t[i].value.apply(that,args)},apply:function apply(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}};var src_dispatch=dispatch_dispatch,sourceEvent=function(){for(var source,current=on_event;source=current.sourceEvent;)current=source;return current},mouse=function(node){var event=sourceEvent();return event.changedTouches&&(event=event.changedTouches[0]),src_point(node,event)},src_touch=function(node,touches,identifier){arguments.length<3&&(identifier=touches,touches=sourceEvent().changedTouches);for(var touch,i=0,n=touches?touches.length:0;i<n;++i)if((touch=touches[i]).identifier===identifier)return src_point(node,touch);return null};function nopropagation(){on_event.stopImmediatePropagation()}var noevent=function(){on_event.preventDefault(),on_event.stopImmediatePropagation()},nodrag=function(view){var root=view.document.documentElement,selection=src_select(view).on("dragstart.drag",noevent,!0);"onselectstart"in root?selection.on("selectstart.drag",noevent,!0):(root.__noselect=root.style.MozUserSelect,root.style.MozUserSelect="none")};var d3_drag_src_constant=function(x){return function(){return x}};function DragEvent(target,type,subject,id,active,x,y,dx,dy,dispatch){this.target=target,this.type=type,this.subject=subject,this.identifier=id,this.active=active,this.x=x,this.y=y,this.dx=dx,this.dy=dy,this._=dispatch}function defaultFilter(){return!on_event.ctrlKey&&!on_event.button}function defaultContainer(){return this.parentNode}function defaultSubject(d){return null==d?{x:on_event.x,y:on_event.y}:d}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}DragEvent.prototype.on=function(){var value=this._.on.apply(this._,arguments);return value===this._?this:value};var src_drag=function(){var mousedownx,mousedowny,mousemoving,touchending,filter=defaultFilter,container=defaultContainer,subject=defaultSubject,touchable=defaultTouchable,gestures={},listeners=src_dispatch("start","drag","end"),active=0,clickDistance2=0;function drag(selection){selection.on("mousedown.drag",mousedowned).filter(touchable).on("touchstart.drag",touchstarted).on("touchmove.drag",touchmoved).on("touchend.drag touchcancel.drag",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function mousedowned(){if(!touchending&&filter.apply(this,arguments)){var gesture=beforestart("mouse",container.apply(this,arguments),mouse,this,arguments);gesture&&(src_select(on_event.view).on("mousemove.drag",mousemoved,!0).on("mouseup.drag",mouseupped,!0),nodrag(on_event.view),nopropagation(),mousemoving=!1,mousedownx=on_event.clientX,mousedowny=on_event.clientY,gesture("start"))}}function mousemoved(){if(noevent(),!mousemoving){var dx=on_event.clientX-mousedownx,dy=on_event.clientY-mousedowny;mousemoving=dx*dx+dy*dy>clickDistance2}gestures.mouse("drag")}function mouseupped(){src_select(on_event.view).on("mousemove.drag mouseup.drag",null),function yesdrag(view,noclick){var root=view.document.documentElement,selection=src_select(view).on("dragstart.drag",null);noclick&&(selection.on("click.drag",noevent,!0),setTimeout(function(){selection.on("click.drag",null)},0)),"onselectstart"in root?selection.on("selectstart.drag",null):(root.style.MozUserSelect=root.__noselect,delete root.__noselect)}(on_event.view,mousemoving),noevent(),gestures.mouse("end")}function touchstarted(){if(filter.apply(this,arguments)){var i,gesture,touches=on_event.changedTouches,c=container.apply(this,arguments),n=touches.length;for(i=0;i<n;++i)(gesture=beforestart(touches[i].identifier,c,src_touch,this,arguments))&&(nopropagation(),gesture("start"))}}function touchmoved(){var i,gesture,touches=on_event.changedTouches,n=touches.length;for(i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(noevent(),gesture("drag"))}function touchended(){var i,gesture,touches=on_event.changedTouches,n=touches.length;for(touchending&&clearTimeout(touchending),touchending=setTimeout(function(){touchending=null},500),i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(nopropagation(),gesture("end"))}function beforestart(id,container,point,that,args){var s,dx,dy,p=point(container,id),sublisteners=listeners.copy();if(customEvent(new DragEvent(drag,"beforestart",s,id,active,p[0],p[1],0,0,sublisteners),function(){return null!=(on_event.subject=s=subject.apply(that,args))&&(dx=s.x-p[0]||0,dy=s.y-p[1]||0,!0)}))return function gesture(type){var n,p0=p;switch(type){case"start":gestures[id]=gesture,n=active++;break;case"end":delete gestures[id],--active;case"drag":p=point(container,id),n=active}customEvent(new DragEvent(drag,type,s,id,n,p[0]+dx,p[1]+dy,p[0]-p0[0],p[1]-p0[1],sublisteners),sublisteners.apply,sublisteners,[type,that,args])}}return drag.filter=function(_){return arguments.length?(filter="function"==typeof _?_:d3_drag_src_constant(!!_),drag):filter},drag.container=function(_){return arguments.length?(container="function"==typeof _?_:d3_drag_src_constant(_),drag):container},drag.subject=function(_){return arguments.length?(subject="function"==typeof _?_:d3_drag_src_constant(_),drag):subject},drag.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:d3_drag_src_constant(!!_),drag):touchable},drag.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?drag:value},drag.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,drag):Math.sqrt(clickDistance2)},drag};function timer_typeof(obj){"@babel/helpers - typeof";return(timer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var taskHead,taskTail,timer_frame=0,timeout=0,timer_interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"===("undefined"==typeof performance?"undefined":timer_typeof(performance))&&performance.now?performance:Date,setFrame="object"===("undefined"==typeof window?"undefined":timer_typeof(window))&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer_timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function wake(){clockNow=(clockLast=clock.now())+clockSkew,timer_frame=timeout=0;try{!function timerFlush(){now(),++timer_frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(null,e),t=t._next;--timer_frame}()}finally{timer_frame=0,function nap(){var t0,t2,t1=taskHead,time=1/0;for(;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>pokeDelay&&(clockSkew-=delay,clockLast=now)}function sleep(time){timer_frame||(timeout&&(timeout=clearTimeout(timeout)),time-clockNow>24?(time<1/0&&(timeout=setTimeout(wake,time-clock.now()-clockSkew)),timer_interval&&(timer_interval=clearInterval(timer_interval))):(timer_interval||(clockLast=clock.now(),timer_interval=setInterval(poke,pokeDelay)),timer_frame=1,setFrame(wake)))}Timer.prototype=timer_timer.prototype={constructor:Timer,restart:function restart(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function stop(){this._call&&(this._call=null,this._time=1/0,sleep())}};var src_timeout=function(callback,delay,time){var t=new Timer;return delay=null==delay?0:+delay,t.restart(function(elapsed){t.stop(),callback(elapsed+delay)},delay,time),t},emptyOn=src_dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6,transition_schedule=function(node,name,id,index,group,timing){var schedules=node.__transition;if(schedules){if(id in schedules)return}else node.__transition={};!function schedule_create(node,id,self){var tween,schedules=node.__transition;function start(elapsed){var i,j,n,o;if(self.state!==SCHEDULED)return stop();for(i in schedules)if((o=schedules[i]).name===self.name){if(o.state===STARTED)return src_timeout(start);o.state===RUNNING?(o.state=ENDED,o.timer.stop(),o.on.call("interrupt",node,node.__data__,o.index,o.group),delete schedules[i]):+i<id&&(o.state=ENDED,o.timer.stop(),o.on.call("cancel",node,node.__data__,o.index,o.group),delete schedules[i])}if(src_timeout(function(){self.state===STARTED&&(self.state=RUNNING,self.timer.restart(tick,self.delay,self.time),tick(elapsed))}),self.state=STARTING,self.on.call("start",node,node.__data__,self.index,self.group),self.state===STARTING){for(self.state=STARTED,tween=new Array(n=self.tween.length),i=0,j=-1;i<n;++i)(o=self.tween[i].value.call(node,node.__data__,self.index,self.group))&&(tween[++j]=o);tween.length=j+1}}function tick(elapsed){for(var t=elapsed<self.duration?self.ease.call(null,elapsed/self.duration):(self.timer.restart(stop),self.state=ENDING,1),i=-1,n=tween.length;++i<n;)tween[i].call(node,t);self.state===ENDING&&(self.on.call("end",node,node.__data__,self.index,self.group),stop())}function stop(){for(var i in self.state=ENDED,self.timer.stop(),delete schedules[id],schedules)return;delete node.__transition}schedules[id]=self,self.timer=timer_timer(function schedule(elapsed){self.state=SCHEDULED,self.timer.restart(start,self.delay,self.time),self.delay<=elapsed&&start(elapsed-self.delay)},0,self.time)}(node,id,{name:name,index:index,group:group,on:emptyOn,tween:emptyTween,time:timing.time,delay:timing.delay,duration:timing.duration,ease:timing.ease,timer:null,state:CREATED})};function init(node,id){var schedule=schedule_get(node,id);if(schedule.state>CREATED)throw new Error("too late; already scheduled");return schedule}function schedule_set(node,id){var schedule=schedule_get(node,id);if(schedule.state>STARTED)throw new Error("too late; already running");return schedule}function schedule_get(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id]))throw new Error("transition not found");return schedule}var cssNode,cssRoot,cssView,svgNode,degrees=180/Math.PI,decompose_identity={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},decompose=function(a,b,c,d,e,f){var scaleX,scaleY,skewX;return(scaleX=Math.sqrt(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=Math.sqrt(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX:scaleX,scaleY:scaleY}};function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}return function(a,b){var s=[],q=[];return a=parse(a),b=parse(b),function translate(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:src_number(xa,xb)},{i:i-2,x:src_number(ya,yb)})}else(xb||yb)&&s.push("translate("+xb+pxComma+yb+pxParen)}(a.translateX,a.translateY,b.translateX,b.translateY,s,q),function rotate(a,b,s,q){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),q.push({i:s.push(pop(s)+"rotate(",null,degParen)-2,x:src_number(a,b)})):b&&s.push(pop(s)+"rotate("+b+degParen)}(a.rotate,b.rotate,s,q),function skewX(a,b,s,q){a!==b?q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:src_number(a,b)}):b&&s.push(pop(s)+"skewX("+b+degParen)}(a.skewX,b.skewX,s,q),function scale(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:src_number(xa,xb)},{i:i-2,x:src_number(ya,yb)})}else 1===xb&&1===yb||s.push(pop(s)+"scale("+xb+","+yb+")")}(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}}var interpolateTransformCss=interpolateTransform(function parseCss(value){return"none"===value?decompose_identity:(cssNode||(cssNode=document.createElement("DIV"),cssRoot=document.documentElement,cssView=document.defaultView),cssNode.style.transform=value,value=cssView.getComputedStyle(cssRoot.appendChild(cssNode),null).getPropertyValue("transform"),cssRoot.removeChild(cssNode),value=value.slice(7,-1).split(","),decompose(+value[0],+value[1],+value[2],+value[3],+value[4],+value[5]))},"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform(function parseSvg(value){return null==value?decompose_identity:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",value),(value=svgNode.transform.baseVal.consolidate())?(value=value.matrix,decompose(value.a,value.b,value.c,value.d,value.e,value.f)):decompose_identity)},", ",")",")");function tweenValue(transition,name,value){var id=transition._id;return transition.each(function(){var schedule=schedule_set(this,id);(schedule.value||(schedule.value={}))[name]=value.apply(this,arguments)}),function(node){return schedule_get(node,id).value[name]}}var transition_interpolate=function(a,b){var c;return("number"==typeof b?src_number:b instanceof color_color?src_rgb:(c=color_color(b))?(b=c,src_rgb):src_string)(a,b)};var transition_selection_Selection=src_selection.prototype.constructor;function style_styleRemove(name){return function(){this.style.removeProperty(name)}}var transition_id=0;function Transition(groups,parents,name,id){this._groups=groups,this._parents=parents,this._name=name,this._id=id}function newId(){return++transition_id}var selection_prototype=src_selection.prototype;Transition.prototype=function src_transition_transition(name){return src_selection().transition(name)}.prototype={constructor:Transition,select:function(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=src_selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode,transition_schedule(subgroup[i],name,id,i,subgroup,schedule_get(node,id)));return new Transition(subgroups,this._parents,name,id)},selectAll:function(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){for(var child,children=select.call(node,node.__data__,i,group),inherit=schedule_get(node,id),k=0,l=children.length;k<l;++k)(child=children[k])&&transition_schedule(child,name,id,k,children,inherit);subgroups.push(children),parents.push(node)}return new Transition(subgroups,parents,name,id)},filter:function(match){"function"!=typeof match&&(match=matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Transition(subgroups,this._parents,this._name,this._id)},merge:function(transition){if(transition._id!==this._id)throw new Error;for(var groups0=this._groups,groups1=transition._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Transition(merges,this._parents,this._name,this._id)},selection:function(){return new transition_selection_Selection(this._groups,this._parents)},transition:function(){for(var name=this._name,id0=this._id,id1=newId(),groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){var inherit=schedule_get(node,id0);transition_schedule(node,name,id1,i,group,{time:inherit.time+inherit.delay+inherit.duration,delay:0,duration:inherit.duration,ease:inherit.ease})}return new Transition(groups,this._parents,name,id1)},call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:function(name,listener){var id=this._id;return arguments.length<2?schedule_get(this.node(),id).on.on(name):this.each(function onFunction(id,name,listener){var on0,on1,sit=function on_start(name){return(name+"").trim().split(/^|\s+/).every(function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||"start"===t})}(name)?init:schedule_set;return function(){var schedule=sit(this,id),on=schedule.on;on!==on0&&(on1=(on0=on).copy()).on(name,listener),schedule.on=on1}}(id,name,listener))},attr:function(name,value){var fullname=src_namespace(name),i="transform"===fullname?interpolateTransformSvg:transition_interpolate;return this.attrTween(name,"function"==typeof value?(fullname.local?function attr_attrFunctionNS(fullname,interpolate,value){var string00,string10,interpolate0;return function(){var string0,string1,value1=value(this);if(null!=value1)return(string0=this.getAttributeNS(fullname.space,fullname.local))===(string1=value1+"")?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1));this.removeAttributeNS(fullname.space,fullname.local)}}:function attr_attrFunction(name,interpolate,value){var string00,string10,interpolate0;return function(){var string0,string1,value1=value(this);if(null!=value1)return(string0=this.getAttribute(name))===(string1=value1+"")?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1));this.removeAttribute(name)}})(fullname,i,tweenValue(this,"attr."+name,value)):null==value?(fullname.local?function attr_attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}:function attr_attrRemove(name){return function(){this.removeAttribute(name)}})(fullname):(fullname.local?function attr_attrConstantNS(fullname,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=this.getAttributeNS(fullname.space,fullname.local);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}:function attr_attrConstant(name,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=this.getAttribute(name);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}})(fullname,i,value))},attrTween:function(name,value){var key="attr."+name;if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;var fullname=src_namespace(name);return this.tween(key,(fullname.local?function attrTweenNS(fullname,value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function attrInterpolateNS(fullname,i){return function(t){this.setAttributeNS(fullname.space,fullname.local,i.call(this,t))}}(fullname,i)),t0}return tween._value=value,tween}:function attrTween(name,value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function attrInterpolate(name,i){return function(t){this.setAttribute(name,i.call(this,t))}}(name,i)),t0}return tween._value=value,tween})(fullname,value))},style:function(name,value,priority){var i="transform"==(name+="")?interpolateTransformCss:transition_interpolate;return null==value?this.styleTween(name,function styleNull(name,interpolate){var string00,string10,interpolate0;return function(){var string0=styleValue(this,name),string1=(this.style.removeProperty(name),styleValue(this,name));return string0===string1?null:string0===string00&&string1===string10?interpolate0:interpolate0=interpolate(string00=string0,string10=string1)}}(name,i)).on("end.style."+name,style_styleRemove(name)):"function"==typeof value?this.styleTween(name,function style_styleFunction(name,interpolate,value){var string00,string10,interpolate0;return function(){var string0=styleValue(this,name),value1=value(this),string1=value1+"";return null==value1&&(this.style.removeProperty(name),string1=value1=styleValue(this,name)),string0===string1?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1))}}(name,i,tweenValue(this,"style."+name,value))).each(function styleMaybeRemove(id,name){var on0,on1,listener0,remove,key="style."+name,event="end."+key;return function(){var schedule=schedule_set(this,id),on=schedule.on,listener=null==schedule.value[key]?remove||(remove=style_styleRemove(name)):void 0;on===on0&&listener0===listener||(on1=(on0=on).copy()).on(event,listener0=listener),schedule.on=on1}}(this._id,name)):this.styleTween(name,function style_styleConstant(name,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=styleValue(this,name);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}(name,i,value),priority).on("end.style."+name,null)},styleTween:function(name,value,priority){var key="style."+(name+="");if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function styleTween(name,value,priority){var t,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t=(i0=i)&&function styleInterpolate(name,i,priority){return function(t){this.style.setProperty(name,i.call(this,t),priority)}}(name,i,priority)),t}return tween._value=value,tween}(name,value,null==priority?"":priority))},text:function(value){return this.tween("text","function"==typeof value?function text_textFunction(value){return function(){var value1=value(this);this.textContent=null==value1?"":value1}}(tweenValue(this,"text",value)):function text_textConstant(value){return function(){this.textContent=value}}(null==value?"":value+""))},textTween:function(value){var key="text";if(arguments.length<1)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function textTween(value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function textInterpolate(i){return function(t){this.textContent=i.call(this,t)}}(i)),t0}return tween._value=value,tween}(value))},remove:function(){return this.on("end.remove",function removeFunction(id){return function(){var parent=this.parentNode;for(var i in this.__transition)if(+i!==id)return;parent&&parent.removeChild(this)}}(this._id))},tween:function(name,value){var id=this._id;if(name+="",arguments.length<2){for(var t,tween=schedule_get(this.node(),id).tween,i=0,n=tween.length;i<n;++i)if((t=tween[i]).name===name)return t.value;return null}return this.each((null==value?function tweenRemove(id,name){var tween0,tween1;return function(){var schedule=schedule_set(this,id),tween=schedule.tween;if(tween!==tween0)for(var i=0,n=(tween1=tween0=tween).length;i<n;++i)if(tween1[i].name===name){(tween1=tween1.slice()).splice(i,1);break}schedule.tween=tween1}}:function tweenFunction(id,name,value){var tween0,tween1;if("function"!=typeof value)throw new Error;return function(){var schedule=schedule_set(this,id),tween=schedule.tween;if(tween!==tween0){tween1=(tween0=tween).slice();for(var t={name:name,value:value},i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1[i]=t;break}i===n&&tween1.push(t)}schedule.tween=tween1}})(id,name,value))},delay:function(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?function delayFunction(id,value){return function(){init(this,id).delay=+value.apply(this,arguments)}}:function delayConstant(id,value){return value=+value,function(){init(this,id).delay=value}})(id,value)):schedule_get(this.node(),id).delay},duration:function(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?function durationFunction(id,value){return function(){schedule_set(this,id).duration=+value.apply(this,arguments)}}:function durationConstant(id,value){return value=+value,function(){schedule_set(this,id).duration=value}})(id,value)):schedule_get(this.node(),id).duration},ease:function(value){var id=this._id;return arguments.length?this.each(function easeConstant(id,value){if("function"!=typeof value)throw new Error;return function(){schedule_set(this,id).ease=value}}(id,value)):schedule_get(this.node(),id).ease},end:function(){var on0,on1,that=this,id=that._id,size=that.size();return new Promise(function(resolve,reject){var cancel={value:reject},end={value:function value(){0==--size&&resolve()}};that.each(function(){var schedule=schedule_set(this,id),on=schedule.on;on!==on0&&((on1=(on0=on).copy())._.cancel.push(cancel),on1._.interrupt.push(cancel),on1._.end.push(end)),schedule.on=on1})})}};var defaultTiming={time:null,delay:0,duration:250,ease:cubicInOut};function transition_inherit(node,id){for(var timing;!(timing=node.__transition)||!(timing=timing[id]);)if(!(node=node.parentNode))return defaultTiming.time=now(),defaultTiming;return timing}src_selection.prototype.interrupt=function(name){return this.each(function(){!function(node,name){var schedule,active,i,schedules=node.__transition,empty=!0;if(schedules){for(i in name=null==name?null:name+"",schedules)(schedule=schedules[i]).name===name?(active=schedule.state>STARTING&&schedule.state<ENDING,schedule.state=ENDED,schedule.timer.stop(),schedule.on.call(active?"interrupt":"cancel",node,node.__data__,schedule.index,schedule.group),delete schedules[i]):empty=!1;empty&&delete node.__transition}}(this,name)})},src_selection.prototype.transition=function(name){var id,timing;name instanceof Transition?(id=name._id,name=name._name):(id=newId(),(timing=defaultTiming).time=now(),name=null==name?null:name+"");for(var groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&transition_schedule(node,name,id,i,group,timing||transition_inherit(node,id));return new Transition(groups,this._parents,name,id)};function renderer_utils_typeof(obj){"@babel/helpers - typeof";return(renderer_utils_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}var renderer_utils_selectElement=function selectElement(element){return src_select(element)},makeElement=function makeElement(parent,elemType,data,selector){var callbacks=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},keyFn=arguments.length>5?arguments[5]:void 0;(parent instanceof HTMLElement||parent instanceof SVGElement)&&(parent=renderer_utils_selectElement(parent));var filter,selectorVal=selector?selector[0]:null,selectorType=null,actualSelector=null,element=null,enterSel=null,mergeSel=null;selectorVal?"#"===selectorVal?(selectorType="id",actualSelector=selector):(selectorType="class",actualSelector="."===selector[0]?selector:".".concat(selector)):(actualSelector=elemType,filter=!0),element=parent.selectAll(actualSelector),filter&&(element=element.filter(function(){return this.parentNode===parent.node()})),enterSel=(element=element.data(data,keyFn)).enter().append(elemType||"div"),callbacks.enter&&enterSel.each(function(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];callbacks.enter.apply(callbacks,[renderer_utils_selectElement(this)].concat(params))}),mergeSel=enterSel.merge(element),callbacks.update&&mergeSel.each(function(){for(var _len2=arguments.length,params=new Array(_len2),_key2=0;_key2<_len2;_key2++)params[_key2]=arguments[_key2];callbacks.update.apply(callbacks,[renderer_utils_selectElement(this)].concat(params))}),"class"===selectorType?mergeSel.classed("."===selectorVal?selector.substring(1,selector.length):selector,!0):"id"===selectorType&&mergeSel.attr("id",selector.substring(1,selector.length));var exitSel=element.exit();return callbacks.exit?exitSel.each(function(){for(var _len3=arguments.length,params=new Array(_len3),_key3=0;_key3<_len3;_key3++)params[_key3]=arguments[_key3];callbacks.exit.apply(callbacks,[renderer_utils_selectElement(this)].concat(params))}):exitSel.remove(),mergeSel},renderer_utils_applyStyle=function applyStyle(elem,styleObj){return Object.entries(styleObj).forEach(function(d){elem.style(d[0],d[1])},void 0),elem},appendElement=function appendElement(element1,element2){element1.appendChild(element2)},setElementAttrs=function setElementAttrs(element,attrs){for(var key in attrs)({}).hasOwnProperty.call(attrs,key)&&element.attr(key,attrs[key])},renderer_utils_setAttrs=function setAttrs(element,attrs,className){return element instanceof src_selection||(element=renderer_utils_selectElement(element)),void 0!==className?element.selectAll(".".concat(className)).each(function(){setElementAttrs(src_select(this),attrs)}):setElementAttrs(element,attrs),element},renderer_utils_addClass=function addClass(element,className,selector,filterFn){src_select(element).selectAll(selector).each(function(data){var elem=src_select(this);filterFn?filterFn(data)&&elem.classed(className,!0):elem.classed(className,!0)})},renderer_utils_removeClass=function removeClass(element,className,selector,filterFn){src_select(element).selectAll(selector).each(function(data){var elem=src_select(this);filterFn?filterFn(data)&&elem.classed(className,!1):elem.classed(className,!1)})},renderer_utils_setStyles=function setStyles(element,styles){for(var key in element instanceof src_selection||(element=renderer_utils_selectElement(element)),styles)({}).hasOwnProperty.call(styles,key)&&element.style(key,styles[key]);return element},renderer_utils_createElements=function createElements(params){var data,container=src_select(params.container);"number"==typeof(data=params.data)&&(data=Array(data).fill().map(function(d,i){return i}));var sel=container.selectAll(params.selector).filter(function(){return this.parentNode===container.node()}).data(data);sel.enter().append(params.append).merge(sel).each(function(d,i){params.each(d,src_select(this),i)}).attr("class",params.className||""),sel.exit().remove()},renderer_utils_clipElement=function clipElement(container,measurement,id){var clipPathElement=makeElement(src_select(container),"clipPath",[1],"#".concat(id));makeElement(clipPathElement,"rect",[1]).attr("x",measurement.x).attr("y",measurement.x).attr("width",measurement.width).attr("height",measurement.height),clipPathElement.attr("clip-path","url(#".concat(id,")"))},renderer_utils_getElementsByClassName=function getElementsByClassName(node,className){return src_select(node).selectAll(className).nodes()},getMousePos=function getMousePos(element,event){var boundingClientRect=element.getBoundingClientRect();return{x:event.x-boundingClientRect.x,y:event.y-boundingClientRect.y}},renderer_utils_getClientPoint=function getClientPoint(){var pos=src_point.apply(void 0,arguments);return{x:pos[0],y:pos[1]}},renderer_utils_createElement=function createElement(tag,mount){return src_select(mount).append(tag).node()},renderer_utils_getEvent=function getEvent(){return on_event},renderer_utils_getD3Drag=function getD3Drag(){return src_drag},renderer_utils_getSmartComputedStyle=function getSmartComputedStyle(group,css){var textEl,mandatoryStyle={"fill-opacity":0},className="string"==typeof css?css:css instanceof Array?css.join(" "):void 0;textEl=group.node()instanceof HTMLElement?group.append("div").html("W"):group.append("text").text("W"),className?textEl.attr("class",className):"object"===renderer_utils_typeof(css)&&(delete css["fill-opacity"],mergeRecursive(mandatoryStyle,css)),textEl.style(mandatoryStyle);var computedStyle=window.getComputedStyle(textEl.node()),styleForSmartLabel={fontSize:computedStyle.fontSize,fontFamily:computedStyle.fontFamily,fontWeight:computedStyle.fontWeight,fontStyle:computedStyle.fontStyle};return textEl.remove(),styleForSmartLabel},hasTouch=function hasTouch(){return"ontouchstart"in document.documentElement},hyperdis=__webpack_require__(11),hyperdis_default=__webpack_require__.n(hyperdis);function store_slicedToArray(arr,i){return function store_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function store_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function store_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function store_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function store_toConsumableArray(arr){return function store_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function store_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function store_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var initProp=function initProp(obj,props){var val=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return{}};return props.forEach(function(prop){obj[prop]||(obj[prop]=val()),obj=obj[prop]}),obj},fetchPropValues=function fetchPropValues(propNames,params,deps){return params.map(function(param,i){var prop=propNames[i];return param.map(function(val){return void 0===val||null===val?val:val[deps[prop]]})})},setContexts=function setContexts(contexts,propObj,contextMap){var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=propObj.keys()[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var key=_step.value;contexts[key]={context:contextMap[key],deps:propObj.get(key).depProps}}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return contexts},store_registerListener=function registerListener(context,type){for(var _len=arguments.length,options=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++)options[_key-2]=arguments[_key];var propList=options[0],callBack=options[1],instantCall=options[2],_options$=options[3],namespaceInf=void 0===_options$?{}:_options$,props=propList;Array.isArray(propList)||(props=[propList]);var ns=namespaceInf.namespace,callbackFn=function(propNames,namespaceVal){return function(){var commits=context._savedCommits,propListenerMap=context._propListenerMap;if(!propNames.some(function(prop){return getObjProp(propListenerMap,prop,"disabled")})){for(var _len2=arguments.length,params=new Array(_len2),_key2=0;_key2<_len2;_key2++)params[_key2]=arguments[_key2];if(namespaceVal){var listenersObj=context._registeredListeners[namespaceVal],contextMap=context._contextMap[namespaceVal],contextsObj={};for(var key in propNames.forEach(function(prop){var commitsObj=defaultValue(getObjProp(commits,prop,type),{}),listeners=listenersObj[prop].subNamespaces,propDeps=propListenerMap[prop][type];for(var nm in commitsObj){var fnInf=defaultValue(propDeps[nm],{fns:0}),fns=fnInf.fns;fns>0&&(setContexts(contextsObj,listeners[nm],contextMap),fns--),fns<=0&&delete commitsObj[nm],fnInf.fns=fns}}),contextsObj){var obj=contextsObj[key];callBack.apply(void 0,[obj.context].concat(store_toConsumableArray(fetchPropValues(propNames,params,obj.deps))))}}else callBack.apply(void 0,params)}}}(props,ns),fn=context.model[type](props,callbackFn,instantCall);ns&&function registerPropInMaps(store,props,namespaceInf,type){var registeredListeners=store._registeredListeners,propListenerMap=store._propListenerMap,subNamespace=namespaceInf.subNamespace,ns=namespaceInf.namespace;initProp(registeredListeners,[ns]),props.forEach(function(prop){var subNamespaces=defaultValue(getObjProp(registeredListeners,ns,prop,"subNamespace"),[]),fns=defaultValue(getObjProp(propListenerMap,prop,type,"fns"),0);fns++,subNamespace&&subNamespaces.push(subNamespace),registeredListeners[ns][prop]={subNamespace:subNamespaces,allProps:props,subNamespaces:{}},initProp(propListenerMap,[prop,type]),propListenerMap[prop][type]={fns:fns,_fnCount:fns}})}(context,props,namespaceInf,type),function addListenerToNamespace(namespaceInf,fn,context){var key=namespaceInf.key,namespace=namespaceInf.id,listeners=context._listeners;if(namespace){!listeners.get(namespace)&&listeners.set(namespace,new Map);var namespaceListeners=listeners.get(namespace);key||(key=namespaceListeners.size),namespaceListeners.set(key,fn)}else key=key||listeners.size,listeners.set(key,fn)}(namespaceInf,fn,context)},store_createMap=function createMap(){return new Map},listenerTypes=["next","on"],removePropValue=function removePropValue(context,map,propInf){var sns=propInf.subNamespace,prop=propInf.prop,propObj=propInf.propListenerMap[prop];if(listenerTypes.forEach(function(type){type in propObj&&delete propObj[type][sns]}),map.has(sns)){var value=context.get(prop);value instanceof Object&&sns in value&&delete value[sns],map.delete(sns)}},store_Store=function(){function Store(config){!function store_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Store),this.model=hyperdis_default.a.create(config),this._listeners=new Map,this._registeredListeners={},this._contextMap={},this._commits={},this._savedCommits={},this._queuedProps={},this._propListenerMap={},this._locked=!1}return function store_createClass(Constructor,protoProps,staticProps){return protoProps&&store_defineProperties(Constructor.prototype,protoProps),staticProps&&store_defineProperties(Constructor,staticProps),Constructor}(Store,[{key:"lockModel",value:function lockModel(){return this.model.lock(),this._locked=!0,this}},{key:"unlockModel",value:function unlockModel(){return this._locked=!1,this.model.unlock(),this}},{key:"serialize",value:function serialize(){return this.model.serialize()}},{key:"lockCommits",value:function lockCommits(props){var _this=this;return props.forEach(function(prop){_this._commits[prop]={locked:!0,queue:[]}}),this}},{key:"unlockCommits",value:function unlockCommits(props){var _this2=this,commitsObj=this._commits;return this.lockModel(),props.forEach(function(prop){commitsObj[prop].locked=!1;var queuedProps={},queue=commitsObj[prop].queue;queue.forEach(function(params){var _params=store_slicedToArray(params,3),propName=_params[0],value=_params[1],namespace=_params[2];if(namespace){var propObj=initProp(queuedProps,[propName,namespace]);Object.assign(propObj,value)}}),queue.forEach(function(params){var _params2=store_slicedToArray(params,3),propName=_params2[0],value=_params2[1],namespace=_params2[2];_this2.commit(propName,propName in queuedProps?queuedProps[propName][namespace]:value,namespace)}),delete commitsObj[prop]}),this.unlockModel(),this}},{key:"addSubNamespace",value:function addSubNamespace(sns,namespace,context){var listeners=this._registeredListeners[namespace],propListenerMap=this._propListenerMap;initProp(this._contextMap,[namespace]),this._contextMap[namespace][sns]=context;var _loop=function _loop(key){var obj=listeners[key],propObj=propListenerMap[key],propFns=listenerTypes.reduce(function(acc,type){var val=defaultValue(getObjProp(propObj,type,"fns"),0);return val&&(acc[type]=val),acc},{}),allProps=obj.allProps,subNamespaces=obj.subNamespaces,subNamespace=obj.subNamespace;(subNamespace.length?subNamespace:[sns]).forEach(function(ns){var nsObj=ns instanceof Function?ns(context):ns,names=function retrieveNamespaces(names,key){return names instanceof Object?[names[key]]:names instanceof Array?names:[names]}(nsObj,key),depProps=allProps.reduce(function(acc,prop){return acc[prop]=ns instanceof Function?nsObj[prop]:ns,acc},{});names.forEach(function(nm){for(var type in initProp(subNamespaces,[nm],store_createMap).set(sns,{depProps:depProps}),propFns){initProp(propObj,[type,nm]);var fns=propFns[type];propObj[type][nm]={fns:fns,_fnCount:fns}}})})};for(var key in listeners)_loop(key);return this}},{key:"commit",value:function commit(propName,value,namespace){var disableListener=arguments.length>3&&void 0!==arguments[3]&&arguments[3],sanitizedVal=value,commits=this._commits,savedCommits=this._savedCommits,locked=getObjProp(commits,propName,"locked"),propListenerMap=this._propListenerMap[propName]||{};if(propListenerMap.disabled=disableListener,locked)return commits[propName].queue.push([propName,value,namespace]),this;if(namespace){if(this._locked){var queuedProps=initProp(this._queuedProps,[propName]);queuedProps[namespace]=value,sanitizedVal=queuedProps}else(sanitizedVal=defaultValue(this.get(propName),{}))[namespace]=value;listenerTypes.forEach(function(type){initProp(savedCommits,[propName,type]),savedCommits[propName][type][namespace]=!0,getObjProp(propListenerMap,type,namespace)&&(propListenerMap[type][namespace].fns=propListenerMap[type][namespace]._fnCount)})}return this.model.prop(propName,sanitizedVal),this}},{key:"registerChangeListener",value:function registerChangeListener(){for(var _len3=arguments.length,params=new Array(_len3),_key3=0;_key3<_len3;_key3++)params[_key3]=arguments[_key3];return store_registerListener.apply(void 0,[this,"next"].concat(params)),this}},{key:"registerImmediateListener",value:function registerImmediateListener(){for(var _len4=arguments.length,params=new Array(_len4),_key4=0;_key4<_len4;_key4++)params[_key4]=arguments[_key4];store_registerListener.apply(void 0,[this,"on"].concat(params))}},{key:"get",value:function get(propName,subNamespace){var value=this.model.prop(propName);return subNamespace?value&&value[subNamespace]:value}},{key:"computed",value:function computed(propName,callBack){return this.model.calculatedProp(propName,callBack)}},{key:"append",value:function append(){var _this$model;return(_this$model=this.model).append.apply(_this$model,arguments),this}},{key:"unsubscribeAll",value:function unsubscribeAll(){return Object.values(this._listeners).forEach(function(fn){return fn()}),this}},{key:"unsubscribe",value:function unsubscribe(){var namespaceInf=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},id=namespaceInf.id,key=namespaceInf.key,listenersMap=this._listeners,listeners=listenersMap.get(id);if(key){var fn=listenersMap.get(key);fn&&fn()}else{var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=listeners.values()[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){(0,_step2.value)()}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{_iteratorNormalCompletion2||null==_iterator2.return||_iterator2.return()}finally{if(_didIteratorError2)throw _iteratorError2}}listenersMap.set(id,[])}return this}},{key:"removeSubNamespace",value:function removeSubNamespace(subNamespace,namespace){var listenerMap=this._registeredListeners,contextMap=this._contextMap,propListenerMap=this._propListenerMap,listenersObj=listenerMap[namespace];for(var prop in listenersObj){var subNamespaces=listenersObj[prop].subNamespaces,propInf={subNamespace:subNamespace,prop:prop,propListenerMap:propListenerMap};if(subNamespaces[subNamespace])removePropValue(this,subNamespaces[subNamespace],propInf),delete subNamespaces[subNamespace];else for(var ns in subNamespaces){var snsMap=subNamespaces[ns];removePropValue(this,snsMap,propInf),snsMap.size||delete subNamespaces[ns]}}return delete contextMap[namespace][subNamespace],this}}]),Store}(),store_transactor=function transactor(holder,options,model){var conf,namespaceInf=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},store=model instanceof store_Store?model:new store_Store({}),stateProps={},namespace=namespaceInf.namespace,subNamespace=namespaceInf.subNamespace;for(var prop in options)if({}.hasOwnProperty.call(options,prop)){conf=options[prop];var nameSpaceProp=namespace?"".concat(namespace,".").concat(prop):prop;if(subNamespace){var value=defaultValue(store.get(nameSpaceProp),{});value[subNamespace]=conf.value,stateProps[nameSpaceProp]=value}else stateProps[prop]=conf.value;holder[prop]=function(context,meta,nsProp){return function(){for(var _len5=arguments.length,params=new Array(_len5),_key5=0;_key5<_len5;_key5++)params[_key5]=arguments[_key5];if(params.length){var _ref$takesMultiplePar=(meta||{}).takesMultipleParams,takesMultipleParams=void 0!==_ref$takesMultiplePar&&_ref$takesMultiplePar,val=takesMultipleParams?params:params[0];if(meta){var values,prevVal=context.get(nsProp,subNamespace),sanitization=meta.sanitization,typeCheck=meta.typeCheck,typeExpected=meta.typeExpected;if("function"==typeof sanitization&&(val=sanitization(val,prevVal,holder)),"function"==typeof typeCheck)typeCheck(val)&&(values=val);else"string"==typeof typeCheck&&"constructor"===typeCheck?val&&val.constructor.name===typeExpected&&(values=val):values=val;var preset=meta.preset,oldValues=toArray(context.get(nsProp,subNamespace));preset&&preset(values,holder),takesMultipleParams&&oldValues.forEach(function(value,i){void 0===values[i]&&(values[i]=value)}),values&&context.commit(nsProp,values,subNamespace)}else context.commit(nsProp,val,subNamespace);return holder}return context.get(nsProp,subNamespace)}}(store,conf.meta,nameSpaceProp,Array.isArray(conf.value))}if(subNamespace)for(var key in stateProps)store.commit(key,stateProps[key][subNamespace],subNamespace);else void 0===namespace?store.append(stateProps):store.append(namespace,stateProps);return[holder,store]},SmartlabelManager=__webpack_require__(8),SmartlabelManager_default=__webpack_require__.n(SmartlabelManager),events=["initialized","beforeupdate","updated","beforedraw","drawn","beforeremove","removed","animationend"],EVENT_LIST=[];["canvas","unit","layer","axis","facet-headers","legend","caption"].forEach(function(composition){events.forEach(function(event){EVENT_LIST.push("".concat(composition,".").concat(event))})});var event_list=EVENT_LIST;function lifecycle_manager_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var lifecycle_manager_resolver=function resolver(resolveFn){return function(notification){return resolveFn(notification)}},hasOwn=function hasOwn(source,property){return Object.prototype.hasOwnProperty.call(source,property)},lifecycle_manager=function(){function LifeCycleManager(){!function lifecycle_manager_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LifeCycleManager),this._eventList=event_list,this._promises=new Map,this._notifiers={},this._lifeCycles={},this._unreleasedLifeCycles={},this._boot()}return function lifecycle_manager_createClass(Constructor,protoProps,staticProps){return protoProps&&lifecycle_manager_defineProperties(Constructor.prototype,protoProps),staticProps&&lifecycle_manager_defineProperties(Constructor,staticProps),Constructor}(LifeCycleManager,[{key:"_boot",value:function _boot(){this._notifiers=this._eventList.reduce(function(acc,name){return acc[name]=lifecycle_manager_resolver,acc},{}),this._preparePromises()}},{key:"retrieve",value:function retrieve(eventName){return this._promises.get(eventName)}},{key:"_makeNotifierPromise",value:function _makeNotifierPromise(eventName){var _this=this;return new Promise(function(resolve){_this._notifiers[eventName]=lifecycle_manager_resolver(resolve)})}},{key:"_preparePromises",value:function _preparePromises(){var _this2=this;this._eventList.forEach(function(eventName){var promise=_this2._makeNotifierPromise(eventName);_this2._promises.set(eventName,promise),function createPromise(promise,eventName,context){promise.then(function(){var prm=context._makeNotifierPromise(eventName);context._promises.set(eventName,prm),createPromise(prm,eventName,context)})}(promise,eventName,_this2)})}},{key:"_resolvePromise",value:function _resolvePromise(eventName,notification){this._notifiers[eventName](notification)}},{key:"notify",value:function notify(notification){var composition=notification.formalName||notification.client.constructor.formalName();notification.formalName=composition,this._releasePromisesFromCache(),this._notify(composition,notification)}},{key:"_notify",value:function _notify(composition,notification){var stage=notification.action,eventName="".concat(composition,".").concat(stage);this._resolvePromise(eventName,notification);var promise=this.retrieve(eventName);this._lifeCycles[composition]&&this._lifeCycles[composition][stage]?this._callLifeCycleCallback(composition,stage,promise):this._cachePromise(composition,stage,promise)}},{key:"_callLifeCycleCallback",value:function _callLifeCycleCallback(composition,stage,promise){var eventName="".concat(composition,".").concat(stage);this._lifeCycles[composition][stage](promise),this._resetTargetPromise(eventName)}},{key:"_releasePromisesFromCache",value:function _releasePromisesFromCache(){var _this3=this;Object.keys(this._unreleasedLifeCycles).forEach(function(composition){Object.keys(_this3._unreleasedLifeCycles[composition]).forEach(function(stage){if(_this3._lifeCycles[composition]&&_this3._lifeCycles[composition][stage]){var promise=_this3._unreleasedLifeCycles[composition][stage];_this3._callLifeCycleCallback(composition,stage,promise),delete _this3._unreleasedLifeCycles[composition][stage]}})})}},{key:"_cachePromise",value:function _cachePromise(composition,stage,promise){hasOwn(this._unreleasedLifeCycles,composition)||(this._unreleasedLifeCycles[composition]={}),hasOwn(this._unreleasedLifeCycles[composition],stage)||(this._unreleasedLifeCycles[composition][stage]={}),this._unreleasedLifeCycles[composition][stage]=promise}},{key:"register",value:function register(){var lifeCycles=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._lifeCycles=lifeCycles,this._releasePromisesFromCache()}},{key:"_resetTargetPromise",value:function _resetTargetPromise(eventName){var _this4=this;setTimeout(function(){_this4._notifiers[eventName]=lifecycle_manager_resolver,_this4._promises.set(eventName,_this4._makeNotifierPromise(eventName))},0)}}]),LifeCycleManager}(),src_InvalidAwareTypes=datamodel_default.a.InvalidAwareTypes,CLASSPREFIX="muze",STACK="stack",GROUP="group",IDENTITY="identity",constants_ANGLE="angle",constants_RADIUS="radius",SIZE="size",COLOR="color",SHAPE="shape",TEXT="text",OUTER_RADIUS_VALUE="outerRadiusValue",TEXT_ANCHOR_MIDDLE="middle",ENCODING={X:"x",Y:"y",X0:"x0",Y0:"y0",RADIUS:"radius",RADIUS0:"radius0",ANGLE:"angle",ANGLE0:"angle0",COLOR:"color",SHAPE:"shape",SIZE:"size",TEXT:"text"},STROKE_DASHARRAY="stroke-dasharray",ASCENDING="asc",AGG_FN_SUM="sum",AREA_LAYER="area",ARC_LAYER="arc",LINE_LAYER="line",TEXT_LAYER="text",POINT_LAYER="point",BAR_LAYER="bar",TICK_LAYER="tick",SIMPLE_LAYER="simple",BASE_LAYER="base";function simple_layer_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _props,simple_layer_SimpleLayer=function(){function SimpleLayer(){!function simple_layer_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SimpleLayer)}return function simple_layer_createClass(Constructor,protoProps,staticProps){return protoProps&&simple_layer_defineProperties(Constructor.prototype,protoProps),staticProps&&simple_layer_defineProperties(Constructor,staticProps),Constructor}(SimpleLayer,[{key:"formalName",value:function formalName(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"dependencies",value:function dependencies(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"config",value:function config(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"data",value:function data(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"serialize",value:function serialize(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"id",value:function id(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"normalizeTransformedData",value:function normalizeTransformedData(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"getTransformedData",value:function getTransformedData(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"_calculateDomainFromData",value:function _calculateDomainFromData(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"getDomain",value:function getDomain(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"getNearestPoint",value:function getNearestPoint(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"highlightPoint",value:function highlightPoint(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"dehighlightPoint",value:function dehighlightPoint(){return this}},{key:"linkLayerStore",value:function linkLayerStore(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"mount",value:function mount(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"render",value:function render(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}}]),SimpleLayer}(),DATA="data",CONFIG="config",MEASUREMENT="measurement",DOMAIN="domain",MOUNT="mount";function props_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _axisOrientationMap,props_props=(props_defineProperty(_props={axes:{},mount:{},measurement:{},metaInf:{},valueParser:{defaultValue:function defaultValue(val){return val}},coord:{defaultValue:COORD_TYPES.CARTESIAN}},CONFIG,{value:null,sanitization:function sanitization(context,config){context._customConfig=config;var constructor=context.constructor,newConf=mergeRecursive({},constructor.defaultConfig());return constructor.defaultPolicy(newConf,config)}}),props_defineProperty(_props,"encodingTransform",{}),props_defineProperty(_props,"encodingFieldsInf",{}),props_defineProperty(_props,"dependencies",{}),props_defineProperty(_props,"dataProps",{}),_props);function axis_orientation_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _scaleMap,axis_orientation_BOTTOM="bottom",axis_orientation_TOP="top",axis_orientation_LEFT="left",axis_orientation_RIGHT="right",axisOrientationMap=(axis_orientation_defineProperty(_axisOrientationMap={},axis_orientation_LEFT,Symbols.axisLeft),axis_orientation_defineProperty(_axisOrientationMap,axis_orientation_BOTTOM,Symbols.axisBottom),axis_orientation_defineProperty(_axisOrientationMap,axis_orientation_RIGHT,Symbols.axisRight),axis_orientation_defineProperty(_axisOrientationMap,axis_orientation_TOP,Symbols.axisTop),_axisOrientationMap),LINEAR="linear",BAND="band",TIME="temporal",scale_type_COLOR="color",ORDINAL="ordinal",QUANTIZE="quantize",QUANTILE="quantile",LOG="log",POW="pow",scale_type_IDENTITY="identity",SEQUENTIAL="sequential",THRESHOLD="threshold",CONTINOUS=(__webpack_require__(20),"continous"),DISCRETE="discrete",constants_SEQUENTIAL="sequential",constants_ORDINAL="ordinal",constants_LINEAR="linear",constants_QUANTIZE="quantize",HIDDEN="hidden",DEFAULT_ANGLE_DOMAIN=[1];function scale_creator_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var scaleLinear=scales_namespaceObject.scaleLinear,scaleThreshold=scales_namespaceObject.scaleThreshold,scaleLog=scales_namespaceObject.scaleLog,scalePow=scales_namespaceObject.scalePow,scaleIdentity=scales_namespaceObject.scaleIdentity,scaleOrdinal=scales_namespaceObject.scaleOrdinal,scaleSequential=scales_namespaceObject.scaleSequential,scaleQuantize=scales_namespaceObject.scaleQuantize,scaleQuantile=scales_namespaceObject.scaleQuantile,scaleBand=scales_namespaceObject.scaleBand,scaleTime=scales_namespaceObject.scaleTime,scaleMap=(scale_creator_defineProperty(_scaleMap={},LINEAR,scaleLinear),scale_creator_defineProperty(_scaleMap,BAND,scaleBand),scale_creator_defineProperty(_scaleMap,QUANTIZE,scaleQuantize),scale_creator_defineProperty(_scaleMap,QUANTILE,scaleQuantile),scale_creator_defineProperty(_scaleMap,THRESHOLD,scaleThreshold),scale_creator_defineProperty(_scaleMap,SEQUENTIAL,scaleSequential),scale_creator_defineProperty(_scaleMap,LOG,scaleLog),scale_creator_defineProperty(_scaleMap,POW,scalePow),scale_creator_defineProperty(_scaleMap,scale_type_IDENTITY,scaleIdentity),scale_creator_defineProperty(_scaleMap,TIME,scaleTime),scale_creator_defineProperty(_scaleMap,scale_type_COLOR,scaleLinear),scale_creator_defineProperty(_scaleMap,ORDINAL,scaleOrdinal),_scaleMap);function scale_creator_createScale(params){if(!params.type||!scaleMap[params.type])throw new Error("".concat(params.type," is not a valid scale type"));if(!Array.isArray(params.range))throw new Error("range parameter must be an array");var scaleFactory=null,range=params.range;if(params.type===constants_LINEAR&&params.interpolator){if(scaleFactory=scaleMap[params.interpolator],params.interpolator===POW)return scaleFactory().range(range).exponent(params.exponent);if(params.interpolator===LOG)return scaleFactory().range(range).base([params.base])}else scaleFactory=scaleMap[params.type];return params.type===constants_QUANTIZE&&scaleFactory().nice(),scaleFactory().range(range)}var default_config_defaultConfig={id:getUniqueId(),adjustRange:!1,axisName:{defClassName:"axis-name"},axisNamePadding:7,base:10,classPrefix:"muze",className:"".concat("muze","-axis"),exponent:1,interpolator:"linear",fixedBaseline:!0,labels:{rotation:null,smartTicks:null},orientation:"left",numberFormat:function numberFormat(val){return val},padding:.3,nice:!0,numberOfTicks:null,rotate:!1,show:!0,showAxisName:!0,showInnerTicks:!0,showOuterTicks:!0,style:{},type:"linear",tickFormat:null,tickValues:null,xOffset:0,yOffset:0,defaultSort:"asc"},axis_renderer_changeTickOrientation=function changeTickOrientation(selectContainer,axisInstance,tickSize){var _smartTicks=axisInstance._smartTicks,config=axisInstance.config(),renderConfig=axisInstance.renderConfig(),labelManager=axisInstance.dependencies().labelManager,orientation=config.orientation,classPrefix=config.classPrefix,labels=renderConfig.labels,rotation=labels.rotation,isSmartTicks=labels.smartTicks,tickText=selectContainer.selectAll(".tick text");if(tickText.selectAll("tspan").remove(),!rotation||"top"!==orientation&&"bottom"!==orientation)if(rotation||isSmartTicks){if(tickText.text(""),"top"===orientation||"bottom"===orientation)tickText.attr("y",0).attr("x",0).attr("transform","").text(""),makeElement(tickText,"tspan",function(d,i){return _smartTicks[i]?_smartTicks[i].lines:[]},"".concat(classPrefix,"-smart-text")).attr("dy","0").style("opacity","0").transition().duration(1e3).on("end",axisInstance.registerAnimationDoneHook()).attr("dy",function(d,i){return"bottom"===orientation||0!==i?_smartTicks[0].oriTextHeight:-_smartTicks[0].oriTextHeight*(_smartTicks[0].lines.length-1)-tickSize}).style("opacity",1).text(function(e){return e}).attr("x",0);else makeElement(tickText,"tspan",function(d,i){return _smartTicks[i].lines},"".concat(classPrefix,"-smart-text")).text(function(e){return e})}else tickText.attr("transform","");else!function rotateAxis(instance,tickText,labelManager){var rotation,axis=instance.axis(),config=instance.config(),renderConfig=instance.renderConfig(),smartTicks=instance.smartTicks(),scale=axis.scale(),ticks=(scale.ticks||scale.quantile||scale.domain)(),orientation=config.orientation,fixedBaseline=config.fixedBaseline,type=config.type,labels=renderConfig.labels;rotation=labels.rotation;var tickSize=instance.getTickSize();tickText.each(function(d,index){var yShift,xShift,datum=smartTicks[index]?smartTicks[index].text:d;datum=datum.toString();var tickLabelDim=labelManager.getOriSize(datum),width=.5*tickLabelDim.width,height=.5*tickLabelDim.height;rotation<0&&(rotation=360+rotation);var quadrant=4-Math.floor(rotation/90),rotationNormalizer=(quadrant%2==0?rotation:180*Math.ceil(rotation/180)-rotation)%180;yShift=Math.sqrt(Math.pow(height,2)+Math.pow(width,2))*Math.sin(angleToRadian(rotationNormalizer)),3!==quadrant&&2!==quadrant||rotationNormalizer>67.5&&rotationNormalizer<=90||(yShift+=2*height),xShift=width,xShift=90===rotation?height:270===rotation?-height:0,orientation===axis_orientation_TOP?(xShift=fixedBaseline&&ticks[0]===d&&type===constants_LINEAR?xShift+xShift/2:xShift,renderer_utils_selectElement(this).attr("transform","translate(".concat(-xShift+tickSize,"\n                                ").concat(-yShift-tickSize,") rotate(").concat(rotation,")"))):(xShift=fixedBaseline&&ticks[0]===d&&type===constants_LINEAR?xShift-xShift/2:xShift,renderer_utils_selectElement(this).attr("transform","translate(".concat(xShift-tickSize,"\n                                ").concat(yShift+tickSize,") rotate(").concat(rotation,")")))})}(axisInstance,tickText,labelManager);return tickText},axis_renderer_setFixedBaseline=function setFixedBaseline(axisInstance){var fixedBaseline=axisInstance.config().fixedBaseline,showInnerTicks=axisInstance.renderConfig().showInnerTicks,domain=axisInstance.domain();fixedBaseline&&domain.length&&showInnerTicks&&axisInstance.setFixedBaseline()},axis_renderer_setAxisNamePos=function setAxisNamePos(textNode,orientation,measures){var axisNameHeight=measures.axisNameHeight,availableSpace=measures.availableSpace;switch(orientation){case axis_orientation_LEFT:textNode.attr("transform","translate(".concat(-(availableSpace.width-axisNameHeight),",").concat(availableSpace.height/2,")rotate(-90)"));break;case axis_orientation_RIGHT:textNode.attr("transform","translate(".concat(availableSpace.width-axisNameHeight,",").concat(availableSpace.height/2,")rotate(90)"));break;case axis_orientation_TOP:textNode.attr("transform","translate(".concat(availableSpace.width/2,",").concat(-availableSpace.height+axisNameHeight,")"));break;case axis_orientation_BOTTOM:textNode.attr("transform","translate(".concat(availableSpace.width/2,",").concat(availableSpace.height-axisNameHeight/2,")"))}return textNode};var _rangeAdjustmentMap,longestWord={month:"September",quarter:"October",halfYearly:"July",year:9999,day:"September",hour:"24 AM",mintues:"60:60",seconds:":60",week:"Wed 31"},skip_ticks_tickIntervals=[[1,1,"milliseconds",src_millisecond.every(1),"seconds"],[1,1e3,"seconds",src_second.every(1),"seconds"],[5,5e3,"five seconds",src_second.every(5),"seconds"],[10,1e4,"ten seconds",src_second.every(10),"seconds"],[15,15e3,"fifteen seconds",src_second.every(15),"seconds"],[30,3e4,"thirty seconds",src_second.every(30),"seconds"],[1,6e4,"minute",src_minute.every(1),"minutes"],[5,3e5,"five minutes",src_minute.every(5),"minutes"],[10,6e5,"ten minutes",src_minute.every(10),"minutes"],[15,9e5,"fifteen minutes",src_minute.every(15),"minutes"],[30,18e5,"thirty minutes",src_minute.every(30),"minutes"],[1,36e5,"hour",src_hour.every(1),"hour"],[3,108e5,"three hours",src_hour.every(3),"hour"],[6,216e5,"six hours",src_hour.every(6),"hour"],[12,432e5,"twelve hours",src_hour.every(12),"hour"],[1,864e5,"daily",src_day.every(1),"day"],[1,6048e5,"weekly",sunday.every(1),"week"],[1,2592e6,"monthly",src_month.every(1),"week"],[3,7776e6,"quaterly",src_month.every(3),"quarter"],[6,15552e6,"half yearly",src_month.every(6),"halfYearly"],[1,31536e6,"yearly",src_year.every(1),"year"],[2,63072e6,"2 year",src_year.every(2),"year"],[3,94608e6,"3 year",src_year.every(3),"year"],[5,15768e7,"5 year",src_year.every(5),"year"],[10,31536e7,"decade",src_year.every(10),"year"],[100,31536e8,"century",src_year.every(100),"year"],[1e3,31536e9,"millenium",src_year.every(1e3),"year"]],getTickIntervalFnBasedOnNumberOfTicks=function getTickIntervalFnBasedOnNumberOfTicks(interval,count,context){for(var possibleTickLevelIndex=skip_ticks_tickIntervals.length-1,maxPossibleTicks=1,tickIntervalLevelInfo=null,i=skip_ticks_tickIntervals.length-1;i>=0;i--){var tickIntervalInfo=skip_ticks_tickIntervals[i],numOfPossibleTicks=Math.floor(interval/tickIntervalInfo[1]);numOfPossibleTicks<=count&&(possibleTickLevelIndex=i,maxPossibleTicks=numOfPossibleTicks)}return tickIntervalLevelInfo=skip_ticks_tickIntervals[possibleTickLevelIndex],function getActualTickInterval(context,noOfTicks){var minWidthBetweenTicks=context._minTickDistance.width,width=context.availableSpace().width;return Math.floor((width-(noOfTicks-1)*minWidthBetweenTicks)/noOfTicks)}(context,maxPossibleTicks)<function getTickIntervalBasedOnCurrentLevel(context,type){var labelManager=context._dependencies.labelManager,longestWordType=longestWord[type];return labelManager.getOriSize(longestWordType).width}(context,tickIntervalLevelInfo[4])&&possibleTickLevelIndex<skip_ticks_tickIntervals.length-1&&(tickIntervalLevelInfo=skip_ticks_tickIntervals[possibleTickLevelIndex+1]),tickIntervalLevelInfo[3]};function space_setter_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var space_setter_applyTickSkipping=function applyTickSkipping(context){var minTickDistance=context._minTickDistance,minTickSpace=context._minTickSpace,minWidthBetweenTicks=minTickDistance.width,minTickWidth=minTickSpace.width,width=context.availableSpace().width,maxTicks=Math.floor((width+minWidthBetweenTicks)/(minTickWidth+minWidthBetweenTicks)),ticks=context.scale().ticks(function getSkippedTicks(context,maxPossibleTicks){var actualNumberOfTicks=maxPossibleTicks,domain=context.domain(),minDiff=context._minDiff,millisecondInterval=domain[1]-domain[0],numOfTicksAccordingToMinDiff=Math.floor(millisecondInterval/minDiff);return maxPossibleTicks>=numOfTicksAccordingToMinDiff&&(actualNumberOfTicks=numOfTicksAccordingToMinDiff),getTickIntervalFnBasedOnNumberOfTicks(millisecondInterval,actualNumberOfTicks,context)}(context,maxTicks));context.renderConfig({tickValues:ticks})},adjustHorizontalRange=function adjustHorizontalRange(range,diff){return range[0]+=diff,range[1]-=diff,range},adjustVerticalRange=function adjustVerticalRange(range,diff){return range[0]-=diff,range[1]+=diff,range},rangeAdjustmentMap=(space_setter_defineProperty(_rangeAdjustmentMap={},axis_orientation_TOP,adjustHorizontalRange),space_setter_defineProperty(_rangeAdjustmentMap,axis_orientation_BOTTOM,adjustHorizontalRange),space_setter_defineProperty(_rangeAdjustmentMap,axis_orientation_LEFT,adjustVerticalRange),space_setter_defineProperty(_rangeAdjustmentMap,axis_orientation_RIGHT,adjustVerticalRange),_rangeAdjustmentMap),setAxisRange=function setAxisRange(context,type,rangeBounds,offset){context.range(rangeBounds),offset&&context.renderConfig(space_setter_defineProperty({},"".concat(type,"Offset"),offset))},getAdjustedRange=function getAdjustedRange(minDiff,range,domain,config){var orientation=config.orientation,adjustRange=config.adjustRange,diff=function getAxisOffset(timeDiff,range,domain){var avWidth=Math.abs(range[1]-range[0]),bars=avWidth/(avWidth/(domain[1]-domain[0])*timeDiff);return(avWidth-avWidth/(bars+1)*bars)/2}(minDiff,range,domain);return adjustRange?rangeAdjustmentMap[orientation](range,diff):range},space_setter_spaceSetter=function spaceSetter(context,spaceConfig){var _ref,tickInterval,heightForTicks,config=context.config(),_context$availableSpa2=context.availableSpace(),availWidth=_context$availableSpa2.width,availHeight=_context$availableSpa2.height,padding=_context$availableSpa2.padding,top=padding.top,left=padding.left,bottom=padding.bottom,right=padding.right,isOffset=spaceConfig.isOffset,_context$renderConfig2=context.renderConfig(),showAxisName=_context$renderConfig2.showAxisName,labels=_context$renderConfig2.labels,rotation=labels.rotation,fixedBaseline=config.fixedBaseline,axisNamePadding=config.axisNamePadding,tickValues=config.tickValues,_context$getAxisDimen=context.getAxisDimensions(),tickDimensions=_context$getAxisDimen.tickDimensions,allTickDimensions=_context$getAxisDimen.allTickDimensions,axisNameDimensions=_context$getAxisDimen.axisNameDimensions,tickSize=_context$getAxisDimen.tickSize,tickDimHeight=tickDimensions.height,tickDimWidth=tickDimensions.width,namePadding=showAxisName?axisNamePadding:0,labelConfig={smartTicks:!0,rotation:labels.rotation},minTickDistance=context._minTickDistance,minTickSpace=context._minTickSpace,minDiff=context._minDiff,domain=context.domain(),axisNameHeight=axisNameDimensions.height,minWidthBetweenTicks=minTickDistance.width,minTickWidth=Math.min(minTickSpace.width,tickDimWidth),minTickHeight=Math.min(minTickSpace.height,tickDimHeight);return space_setter_defineProperty(_ref={},TIME,{x:function x(){!tickValues&&context.applyTickSkipping();var noOfTicks=context.getTickValues().length;heightForTicks=availHeight-axisNameHeight-tickSize-namePadding,(tickInterval=(availWidth-(noOfTicks-1)*minWidthBetweenTicks)/noOfTicks)<minTickWidth&&0!==rotation&&(labelConfig.rotation=rotation,tickInterval<minTickHeight&&(heightForTicks=availHeight,tickInterval=minTickHeight,context.renderConfig({showInnerTicks:!1,showOuterTicks:!1}))),availHeight<axisNameHeight&&context.renderConfig({show:!1});var tickShifter=Math.min(tickInterval,tickDimWidth);return setAxisRange(context,"y",getAdjustedRange(minDiff,[tickShifter/2,availWidth-left-right-tickShifter/2],domain,config),isOffset?availHeight:null),context.maxTickSpaces({width:tickInterval,height:heightForTicks,noWrap:null!==rotation}),labelConfig},y:function y(){var widthForTicks=availWidth,tickShifter=tickDimHeight/2;return setAxisRange(context,"x",getAdjustedRange(minDiff,[availHeight-top-bottom-tickShifter,tickShifter],domain,config),isOffset?availWidth:null),availWidth-axisNameHeight-namePadding<=minWidthBetweenTicks&&(widthForTicks=0,context.renderConfig({showInnerTicks:!1,showOuterTicks:!1})),context.maxTickSpaces({width:widthForTicks,height:availHeight,noWrap:!0}),availWidth<axisNameHeight&&context.renderConfig({show:!1}),labelConfig}}),space_setter_defineProperty(_ref,BAND,{x:function x(){setAxisRange(context,"y",[0,availWidth-left-right],isOffset?availHeight:null);var range=context.range();if(tickInterval=(range[1]-range[0])/(tickValues||domain).length-minWidthBetweenTicks,heightForTicks=availHeight-axisNameHeight-tickSize-namePadding,tickInterval<minTickWidth&&0!==rotation)labelConfig.rotation=null===rotation?-90:rotation,labelConfig.smartTicks=!1,tickInterval=Math.max(heightForTicks,minTickWidth),heightForTicks<minTickWidth&&context.renderConfig({showAxisName:!1});else if(tickValues){availWidth/domain.length-minWidthBetweenTicks<minTickWidth&&context.range([minTickHeight/2,availWidth-minTickHeight/2])}return availHeight<axisNameHeight&&context.renderConfig({show:!1}),context.maxTickSpaces({width:tickInterval,height:heightForTicks,noWrap:null!==rotation}),labelConfig},y:function y(){setAxisRange(context,"x",[availHeight-bottom,top],isOffset?availWidth:null);var widthForTicks=availWidth-axisNameHeight-tickSize-namePadding;return widthForTicks<=minWidthBetweenTicks&&(widthForTicks=0,context.renderConfig({showInnerTicks:!1,showOuterTicks:!1})),context.maxTickSpaces({width:widthForTicks,height:availHeight,noWrap:!0}),availWidth<axisNameHeight&&context.renderConfig({show:!1}),labelConfig}}),space_setter_defineProperty(_ref,LINEAR,{x:function x(){labelConfig.smartTicks=!1;var tickShifter=tickDimWidth/2;setAxisRange(context,"y",[(fixedBaseline?0:tickShifter)+left,availWidth-right-tickShifter],isOffset?availHeight:null);var range=context.range(),totalTickWidth=allTickDimensions.length*(tickDimWidth+minWidthBetweenTicks);return range[1]-range[0]<totalTickWidth&&null!==labels.rotation&&(availHeight-tickDimWidth-namePadding-tickSize>axisNameHeight?(labelConfig.rotation=null,context.renderConfig({showInnerTicks:!0,showAxisName:!0})):(labelConfig.rotation=-90,context.renderConfig({showInnerTicks:!0,showAxisName:!1}))),availHeight<axisNameHeight&&context.renderConfig({show:!1}),labelConfig},y:function y(){labelConfig.smartTicks=!1;var tickShifter=tickDimHeight/2;return setAxisRange(context,"x",[availHeight-bottom-(fixedBaseline?1:tickShifter),tickShifter+top],isOffset?availWidth:null),availWidth<tickDimWidth+axisNameHeight+namePadding&&(context.renderConfig({showInnerTicks:!1}),availWidth<axisNameHeight&&context.renderConfig({show:!1})),labelConfig}}),_ref};function helper_toConsumableArray(arr){return function helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var getRotatedSpaces=function getRotatedSpaces(){var rotation=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,width=arguments.length>1?arguments[1]:void 0,height=arguments.length>2?arguments[2]:void 0,rotatedHeight=height,rotatedWidth=width;if(rotation){var angle=(rotation||0)*Math.PI/180;rotatedWidth=Math.abs(height*Math.sin(angle))+Math.abs(width*Math.cos(angle)),rotatedHeight=Math.abs(width*Math.sin(angle))+Math.abs(height*Math.cos(angle))}return{width:rotatedWidth,height:rotatedHeight}},helper_setOffset=function setOffset(context){var x=0,y=0,logicalSpace=context.logicalSpace(),config=context.config(),orientation=config.orientation,xOffset=config.xOffset,yOffset=config.yOffset;orientation===axis_orientation_LEFT&&(x=void 0===xOffset?logicalSpace.width:xOffset),orientation===axis_orientation_TOP&&(y=void 0===yOffset?logicalSpace.height:yOffset),context.renderConfig({xOffset:x,yOffset:y})},getAxisComponentDimensions=function getAxisComponentDimensions(context){var axisTicks,largestTick="",largestTickDimensions={width:0,height:0},smartTick={},allTickDimensions=[],scale=context.scale(),_context$renderConfig=context.renderConfig(),tickValues=_context$renderConfig.tickValues,showAxisName=_context$renderConfig.showAxisName,name=context.config().name,labelManager=context.dependencies().labelManager,labelFunc=scale.ticks||scale.quantile||scale.domain;return labelManager.setStyle(context._tickLabelStyle),axisTicks=(axisTicks=tickValues||labelFunc()).map(function(originalLabel,i){var label=context.getFormattedText(originalLabel,i,axisTicks),tickDimensions=labelManager.getOriSize(label);return allTickDimensions.push(tickDimensions),tickDimensions.width>largestTickDimensions.width&&(largestTick=label,smartTick=context.smartTicks()?context.smartTicks()[i]:{},largestTickDimensions=tickDimensions,smartTick=smartTick||tickDimensions),label}),labelManager.setStyle(context._axisNameStyle),{axisNameDimensions:showAxisName?labelManager.getOriSize(name):{width:0,height:0},largestTick:largestTick,largestTickDimensions:largestTickDimensions,allTickDimensions:allTickDimensions,axisTicks:axisTicks,smartTick:smartTick,tickSize:context.getTickSize()}},getHorizontalAxisSpace=function getHorizontalAxisSpace(context,axisDimensions,range){var width,height,domain=context.domain(),minTickDistance=context._minTickDistance.width,tickSize=axisDimensions.tickSize,tickDimensions=axisDimensions.tickDimensions,axisNameDimensions=axisDimensions.axisNameDimensions,_context$config2=context.config(),axisNamePadding=_context$config2.axisNamePadding,tickValues=_context$config2.tickValues,showAxisName=context.renderConfig().showAxisName,axisDimHeight=axisNameDimensions.height,tickDimHeight=tickDimensions.height,tickDimWidth=tickDimensions.width;if(width=range&&range.length?range[1]-range[0]:3*(tickDimWidth+minTickDistance),height=0,tickValues){var minTickDiff=context.getMinTickDifference(),_ref=[Math.min.apply(Math,helper_toConsumableArray(tickValues).concat(helper_toConsumableArray(domain))),Math.max.apply(Math,helper_toConsumableArray(tickValues).concat(helper_toConsumableArray(domain)))];width=(_ref[1]-_ref[0])/Math.abs(minTickDiff)*(tickDimWidth+context._minTickDistance.width)}return height=range&&range.length?tickDimHeight:Math.max(tickDimWidth,tickDimHeight),{width:width,height:height+=(showAxisName?axisDimHeight+axisNamePadding:0)+tickSize}},getVerticalAxisSpace=function getVerticalAxisSpace(context,axisDimensions){var height,width,domain=context.domain(),tickSize=axisDimensions.tickSize,tickDimensions=axisDimensions.tickDimensions,axisNameDimensions=axisDimensions.axisNameDimensions,_context$config3=context.config(),axisNamePadding=_context$config3.axisNamePadding,tickValues=_context$config3.tickValues,showAxisName=context.renderConfig().showAxisName,axisDimHeight=axisNameDimensions.height,tickDimHeight=tickDimensions.height;if(height=0,width=tickDimensions.width,tickValues){var minTickDiff=context.getMinTickDifference(),_ref2=[Math.min.apply(Math,helper_toConsumableArray(tickValues).concat(helper_toConsumableArray(domain))),Math.max.apply(Math,helper_toConsumableArray(tickValues).concat(helper_toConsumableArray(domain)))];height=(_ref2[1]-_ref2[0])/Math.abs(minTickDiff)*tickDimHeight}return{height:height,width:width+=(showAxisName?axisDimHeight:0)+tickSize+(tickValues?axisNamePadding:0)}},helper_calculateBandSpace=function calculateBandSpace(context){var range=context.range(),axisDimensions=context.getAxisDimensions(),orientation=context.config().orientation,show=context.renderConfig().show,largestTickDimensions=axisDimensions.largestTickDimensions,axisTicks=axisDimensions.axisTicks,allTickDimensions=axisDimensions.allTickDimensions,largestDimHeight=largestTickDimensions.height,minTickWidth=context._minTickDistance.width;if(orientation===axis_orientation_TOP||orientation===axis_orientation_BOTTOM){var _getHorizontalAxisSpa=getHorizontalAxisSpace(context,axisDimensions,range),_width=_getHorizontalAxisSpa.width,_height=_getHorizontalAxisSpa.height;return range&&range.length||(_width=allTickDimensions.reduce(function(t,n){return t+Math.min(n.width,n.height)+minTickWidth},0)),!1===show&&(_height=0,_width=0),{width:_width,height:_height}}var _getVerticalAxisSpace=getVerticalAxisSpace(context,axisDimensions),width=_getVerticalAxisSpace.width,height=_getVerticalAxisSpace.height;return height&&0!==height||(height=axisTicks.length*(largestDimHeight+context._minTickDistance.height)),!1===show&&(width=0),{width:width,height:height}},helper_getValidDomain=function getValidDomain(context,domain){var userDom=context.config().domain;return userDom&&(domain=userDom),defaultValue(domain,[])},setContinousAxisDomain=function setContinousAxisDomain(context,domain){var nice=context.config().nice,scale=context.scale.bind(context);scale().domain(domain),nice&&scale().nice(),context._domain=scale().domain()},PROPS={availableSpace:{},axisDimensions:{},axisComponentDimensions:{},config:{sanitization:function sanitization(context,value){var oldConfig=Object.assign({},context._config||{}),mockedOldConfig=mergeRecursive({},oldConfig);(value=mergeRecursive(mockedOldConfig,value)).axisNamePadding=Math.max(value.axisNamePadding,0);var shouldAxesScaleUpdate=function hasAxesConfigChanged(){var obj=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},obj1=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},properties=arguments.length>2?arguments[2]:void 0;return!(!Object.keys(obj).length||!Object.keys(obj1).length)&&properties.some(function(key){return obj[key]!==obj1[key]})}(value,oldConfig,["interpolator","exponent","base","orientation"]),tickFormatter=context.sanitizeTickFormatter(value);return shouldAxesScaleUpdate&&(context._scale=context.createScale(value),context._axis=context.createAxis(value)),context._tickFormatter=function(ticks){return tickFormatter(ticks)},context.resetRenderConfig(value),value}},renderConfig:{sanitization:function sanitization(context,value){var oldConfig=Object.assign({},context._renderConfig||{});return value=mergeRecursive(oldConfig,value)}},logicalSpace:{},mount:{},range:{sanitization:function sanitization(context,value){return context.scale().range(value),context.logicalSpace(null),value}},smartTicks:{},tickSize:{},maxTickSpaces:{sanitization:function sanitization(context,value){var oldConfig=Object.assign({},context._maxTickSpaces||{});return value=mergeRecursive(oldConfig,value)}},valueParser:{defaultValue:function defaultValue(val){return val}}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function simple_axis_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function simple_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var simple_axis_SimpleAxis=function(){function SimpleAxis(config,dependencies){!function simple_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SimpleAxis),this._id=getUniqueId(),this._dependencies=dependencies,this._mount=null,this._range=[],this._domain=[],this._domainLock=!1,this._axisDimensions={},this._smartTicks=[];var defCon=mergeRecursive({},this.constructor.defaultConfig()),simpleConfig=mergeRecursive(defCon,config),bodyElem=renderer_utils_selectElement("body"),classPrefix=simpleConfig.classPrefix;this._tickLabelStyle=renderer_utils_getSmartComputedStyle(bodyElem,"".concat(classPrefix,"-ticks")),this._axisNameStyle=renderer_utils_getSmartComputedStyle(bodyElem,"".concat(classPrefix,"-axis-name")),dependencies.labelManager.setStyle(this._tickLabelStyle);var dist=dependencies.labelManager.getOriSize("w");this._minTickDistance={width:3*dist.width/4,height:dist.height/2},this._minTickSpace=dependencies.labelManager.getOriSize("www..."),generateGetterSetters(this,PROPS),this.config(simpleConfig),this._scale=this.createScale(this._config),this._axis=this.createAxis(this._config),this._animationDonePromises=[]}return function simple_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&simple_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&simple_axis_defineProperties(Constructor,staticProps),Constructor}(SimpleAxis,[{key:"setFixedBaseline",value:function setFixedBaseline(){return this}},{key:"scale",value:function scale(){return arguments.length?(this._scale=arguments.length<=0?void 0:arguments[0],this):this._scale}},{key:"resetDomain",value:function resetDomain(){return this._domain=[],this}},{key:"axis",value:function axis(){return arguments.length?(this._axis=arguments.length<=0?void 0:arguments[0],this):this._axis}},{key:"domain",value:function domain(){if(arguments.length){var domainValue=helper_getValidDomain(this,arguments.length<=0?void 0:arguments[0]);return this.scale().domain(domainValue),this._domain=this.scale().domain(),this.setAxisComponentDimensions(),this.logicalSpace(null),this}return this._domain}},{key:"setAxisComponentDimensions",value:function setAxisComponentDimensions(){this.axisComponentDimensions(getAxisComponentDimensions(this))}},{key:"dependencies",value:function dependencies(){return this._dependencies}},{key:"createScale",value:function createScale(config){var base=config.base;return scale_creator_createScale({padding:config.padding,interpolator:config.interpolator,exponent:config.exponent,base:base,range:this.range(),type:this.constructor.type()})}},{key:"sanitizeTickFormatter",value:function sanitizeTickFormatter(value){var tickFormat=value.tickFormat,numberFormat=value.numberFormat;return tickFormat?function(ticks){return function(val,i){return tickFormat(numberFormat(val),val,i,ticks)}}:function(){return function(val){return numberFormat(val)}}}},{key:"resetRenderConfig",value:function resetRenderConfig(config){var labels=config.labels,show=config.show,showInnerTicks=config.showInnerTicks,showOuterTicks=config.showOuterTicks,showAxisName=config.showAxisName,xOffset=config.xOffset,yOffset=config.yOffset,tickValues=config.tickValues,smartAxisName=config.smartAxisName;return this.renderConfig({labels:labels,show:show,showInnerTicks:showInnerTicks,showOuterTicks:showOuterTicks,showAxisName:showAxisName,xOffset:xOffset,yOffset:yOffset,tickValues:tickValues,smartAxisName:smartAxisName}),this}},{key:"resetLogicalSpace",value:function resetLogicalSpace(){this.logicalSpace(null),this.range([]),this.resetRenderConfig(this.config())}},{key:"getFormattedText",value:function getFormattedText(text,index,axisTicks){return(0,this._tickFormatter)(axisTicks)(text,index)}},{key:"createAxis",value:function createAxis(config){var orientation=config.orientation,axisClass=axisOrientationMap[orientation];return axisClass?axisClass(this.scale()):null}},{key:"setTickValues",value:function setTickValues(tickValues){var renderConfig=this.renderConfig();this.config(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){simple_axis_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}({},renderConfig,{tickValues:tickValues})),this.tickValues=tickValues,this.axis().tickValues(tickValues)}},{key:"setAvailableSpace",value:function setAvailableSpace(){var width=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,height=arguments.length>1?arguments[1]:void 0,padding=arguments.length>2?arguments[2]:void 0,isOffset=arguments.length>3?arguments[3]:void 0,labelConfig={},orientation=this.config().orientation;this.availableSpace({width:width,height:height,padding:padding});var type=this.constructor.type();return labelConfig=orientation===axis_orientation_TOP||orientation===axis_orientation_BOTTOM?space_setter_spaceSetter(this,{isOffset:isOffset})[type].x():space_setter_spaceSetter(this,{isOffset:isOffset})[type].y(),this.renderConfig({labels:labelConfig}),this.setTickConfig(),this.setSmartAxisName(),this}},{key:"setSmartAxisName",value:function setSmartAxisName(){var _this$config2=this.config(),orientation=_this$config2.orientation,name=_this$config2.name,dimType=orientation===axis_orientation_TOP||orientation===axis_orientation_BOTTOM?"width":"height",widthDim=this.availableSpace()[dimType],labelManager=this.dependencies().labelManager;return labelManager.setStyle(this._axisNameStyle),this.renderConfig({smartAxisName:function getSmartAxisName(name,width,labelManager){var oriSize=labelManager.getOriSize(name);return labelManager.useEllipsesOnOverflow(!0),labelManager.getSmartText(name,width,oriSize.height,!0)}(name,widthDim,labelManager)}),this}},{key:"setTickConfig",value:function setTickConfig(){return this}},{key:"getScaleValue",value:function getScaleValue(domainVal){if(null!==domainVal&&void 0!==domainVal)return this.scale()(domainVal)}},{key:"getTickSize",value:function getTickSize(){return this.axis().tickSize()}},{key:"getAxisDimensions",value:function getAxisDimensions(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return this.axisDimensions(function computeAxisDimensions(context){var tickDimensions={},labels=context.renderConfig().labels,smartTicks=labels.smartTicks,rotation=labels.rotation,_getAxisComponentDime=getAxisComponentDimensions(context),largestTickDimensions=_getAxisComponentDime.largestTickDimensions,axisTicks=_getAxisComponentDime.axisTicks,smartTick=_getAxisComponentDime.smartTick,axisNameDimensions=_getAxisComponentDime.axisNameDimensions,allTickDimensions=_getAxisComponentDime.allTickDimensions,tickSize=_getAxisComponentDime.tickSize,labelHeight=largestTickDimensions.height,labelWidth=largestTickDimensions.width;return 0===context.domain().length?{allTickDimensions:allTickDimensions,tickSize:0,tickDimensions:{height:0,width:0},axisNameDimensions:axisNameDimensions,largestTickDimensions:largestTickDimensions,axisTicks:axisTicks}:(tickDimensions=getRotatedSpaces(rotation,(tickDimensions=smartTicks?smartTick:{width:labelWidth,height:labelHeight}).width,tickDimensions.height),0===tickSize&&(tickDimensions={width:0,height:0}),{allTickDimensions:allTickDimensions,tickSize:tickSize,tickDimensions:tickDimensions,axisNameDimensions:axisNameDimensions,largestTickDimensions:largestTickDimensions,axisTicks:axisTicks})}.apply(void 0,[this].concat(params))),this.axisDimensions()}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||this.logicalSpace(function calculateContinousSpace(context){var range=context.range(),axisDimensions=context.getAxisDimensions(),orientation=context.config().orientation,_context$renderConfig6=context.renderConfig(),show=_context$renderConfig6.show,showAxisName=_context$renderConfig6.showAxisName,axisNameDimensions=axisDimensions.axisNameDimensions;if(!1===show)return{width:0,height:0};var axisNameWidth=axisNameDimensions.width;if(orientation===axis_orientation_TOP||orientation===axis_orientation_BOTTOM){var _getHorizontalAxisSpa2=getHorizontalAxisSpace(context,axisDimensions,range),_width2=_getHorizontalAxisSpa2.width,_height2=_getHorizontalAxisSpa2.height;return{width:Math.max(_width2,axisNameWidth),height:_height2}}var _getVerticalAxisSpace2=getVerticalAxisSpace(context,axisDimensions),width=_getVerticalAxisSpace2.width,height=_getVerticalAxisSpace2.height;return{width:width,height:Math.max(height,showAxisName?axisNameWidth:0)}}(this)),helper_setOffset(this),this.logicalSpace()}},{key:"invert",value:function invert(value){return this.scale().invert(value)}},{key:"getNearestRange",value:function getNearestRange(v1,v2){return[v1,v2]}},{key:"invertExtent",value:function invertExtent(v1,v2){return[this.invert(v1),this.invert(v2)]}},{key:"getMinTickDifference",value:function getMinTickDifference(){return this.domain()}},{key:"getFormattedTickValues",value:function getFormattedTickValues(tickValues){return tickValues}},{key:"getUnitWidth",value:function getUnitWidth(){return 0}},{key:"serialize",value:function serialize(){return{name:this.name,type:this.type,range:this.range(),config:this.config()}}},{key:"render",value:function render(){return this.mount()&&(this.setTickConfig(),function renderAxis(axisInstance){var renderConfig=axisInstance.renderConfig(),config=axisInstance.config(),show=renderConfig.show,xOffset=renderConfig.xOffset,yOffset=renderConfig.yOffset,showAxisName=renderConfig.showAxisName,labels=renderConfig.labels,smartAxisName=renderConfig.smartAxisName,mount=axisInstance.mount(),orientation=config.orientation,axisNamePadding=config.axisNamePadding,className=config.className,id=config.id,classPrefix=config.classPrefix;if(show){var availableSpace,labelProps,tickSize,selectContainer=makeElement(renderer_utils_selectElement(mount),"g",[axisInstance],"".concat(className),{},function(key){return key.config().id});if(selectContainer.attr("transform","translate(".concat(xOffset,",").concat(yOffset,")")),axisInstance.domain().length>0){var labelManager=axisInstance.dependencies().labelManager,range=axisInstance.range(),axis=axisInstance.axis(),scale=axisInstance.scale(),tickLabelStyle=axisInstance._tickLabelStyle,axisTickFormatter=axisInstance._tickFormatter;tickSize=axisInstance.getTickSize(),labelManager.setStyle(tickLabelStyle);var labelFunc=scale.ticks||scale.quantile||scale.domain,ticks=axis.tickValues()||labelFunc();axis.tickFormat(axisTickFormatter(ticks)),availableSpace=Math.abs(range[0]-range[1]),labelProps=axisInstance.axisComponentDimensions().largestTickDimensions,axis_renderer_setFixedBaseline(axisInstance),labels.rotation||!1!==labels.smartTicks?(selectContainer.call(axis),axis_renderer_changeTickOrientation(selectContainer,axisInstance,tickSize)):selectContainer.transition().duration(1e3).on("end",axisInstance.registerAnimationDoneHook()).call(axis),selectContainer.selectAll(".tick").classed("".concat(classPrefix,"-ticks"),!0),selectContainer.selectAll(".tick line").classed("".concat(classPrefix,"-tick-lines"),!0),selectContainer.selectAll(".tick text").classed("".concat(classPrefix,"-ticks"),!0).classed("".concat(classPrefix,"-ticks-").concat(id),!0)}var textNode=makeElement(selectContainer,"text",[smartAxisName],"".concat(classPrefix,"-axis-name")).attr("text-anchor","middle").classed("".concat(classPrefix,"-axis-name-").concat(id),!0).text(function(d){return d.text});textNode.classed(HIDDEN,!showAxisName);var labelOffset=availableSpace/2,measures={labelProps:labelProps,tickSize:tickSize,axisNamePadding:axisNamePadding,axisNameHeight:smartAxisName.height,yOffset:yOffset,xOffset:xOffset,labelOffset:labelOffset,availableSpace:axisInstance.availableSpace()};axis_renderer_setAxisNamePos(textNode,orientation,measures)}}(this)),this}},{key:"remove",value:function remove(){return renderer_utils_selectElement(this.mount()).remove(),this}},{key:"unsubscribe",value:function unsubscribe(){return this}},{key:"isReverse",value:function isReverse(){var range=this.range();return range[0]>range[1]}},{key:"getPixelToValueRatio",value:function getPixelToValueRatio(){var scale=this.scale(),range=scale.range(),domain=scale.domain();return Math.abs(range[1]-range[0])/(domain[1]-domain[0])}},{key:"animationDone",value:function animationDone(){return Promise.all(this._animationDonePromises)}},{key:"registerAnimationDoneHook",value:function registerAnimationDoneHook(){var resolveFn,promise=new Promise(function(resolve){resolveFn=resolve});return this._animationDonePromises.push(promise),function(){resolveFn()}}},{key:"_getRawTickValue",value:function _getRawTickValue(data){return data}},{key:"getTicksBasedOnData",value:function getTicksBasedOnData(tickData){var _this=this,allTicks=renderer_utils_selectElement(this.mount()).selectAll(".tick"),elementToBeModified=null,elementNotToBeModified=null;return tickData&&(elementToBeModified=allTicks.filter(function(tickValue){return tickData===_this._getRawTickValue(tickValue)}),elementNotToBeModified=allTicks.filter(function(tickValue){return!(tickData===_this._getRawTickValue(tickValue))})),{selectionSet:elementToBeModified,rejectionSet:elementNotToBeModified||allTicks}}},{key:"id",get:function get(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return default_config_defaultConfig}}]),SimpleAxis}();function linear_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var linear_LinearInterpolator=function(){function LinearInterpolator(){!function linear_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LinearInterpolator)}return function linear_createClass(Constructor,protoProps,staticProps){return protoProps&&linear_defineProperties(Constructor.prototype,protoProps),staticProps&&linear_defineProperties(Constructor,staticProps),Constructor}(LinearInterpolator,[{key:"createScale",value:function createScale(config){var range=config.range,scaleFactory=scaleMap.linear;return this._scale=scaleFactory().range(range),this._scale}},{key:"getScaleValue",value:function getScaleValue(domainVal){return this._scale(domainVal)+.5}},{key:"sanitizeDomain",value:function sanitizeDomain(domain){return domain.length&&(domain=sanitizeDomainWhenEqual(domain)),domain}}]),LinearInterpolator}();function log_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var log_LogInterpolator=function(){function LogInterpolator(){!function log_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LogInterpolator)}return function log_createClass(Constructor,protoProps,staticProps){return protoProps&&log_defineProperties(Constructor.prototype,protoProps),staticProps&&log_defineProperties(Constructor,staticProps),Constructor}(LogInterpolator,[{key:"createScale",value:function createScale(config){var range=config.range,base=config.base,scaleFactory=scaleMap.log;return this._scale=scaleFactory().range(range).base(base),this._scale}},{key:"getScaleValue",value:function getScaleValue(domainVal){var scale=this._scale;return domainVal<=0?scale(scale.domain()[0]):scale(domainVal)+.5}},{key:"sanitizeDomain",value:function sanitizeDomain(domain){return domain[0]<=0&&(domain[0]=Math.max(1,domain[0])),domain[1]<=0&&(domain[1]=Math.max(1,domain[1])),domain}}]),LogInterpolator}();function pow_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _interpolatorMap,pow_PowInterpolator=function(){function PowInterpolator(){!function pow_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PowInterpolator)}return function pow_createClass(Constructor,protoProps,staticProps){return protoProps&&pow_defineProperties(Constructor.prototype,protoProps),staticProps&&pow_defineProperties(Constructor,staticProps),Constructor}(PowInterpolator,[{key:"createScale",value:function createScale(config){var range=config.range,exponent=config.exponent,scaleFactory=scaleMap.pow;return this._scale=scaleFactory().range(range).exponent(exponent),this._scale}},{key:"getScaleValue",value:function getScaleValue(domainVal){return this._scale(domainVal)+.5}},{key:"sanitizeDomain",value:function sanitizeDomain(domain){return domain}}]),PowInterpolator}();function continous_axis_typeof(obj){"@babel/helpers - typeof";return(continous_axis_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function continous_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _possibleConstructorReturn(self,call){return!call||"object"!==continous_axis_typeof(call)&&"function"!=typeof call?function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function continous_axis_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var interpolatorMap=(continous_axis_defineProperty(_interpolatorMap={},LOG,log_LogInterpolator),continous_axis_defineProperty(_interpolatorMap,POW,pow_PowInterpolator),continous_axis_defineProperty(_interpolatorMap,LINEAR,linear_LinearInterpolator),_interpolatorMap),continous_axis_ContinousAxis=function(_SimpleAxis){function ContinousAxis(config,dependencies){return function continous_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ContinousAxis),config.tickFormat=config.tickFormat||function(val){return val},_possibleConstructorReturn(this,_getPrototypeOf(ContinousAxis).call(this,config,dependencies))}return function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ContinousAxis,simple_axis_SimpleAxis),function continous_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&continous_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&continous_axis_defineProperties(Constructor,staticProps),Constructor}(ContinousAxis,[{key:"createScale",value:function createScale(config){var base=config.base,padding=config.padding,interpolator=config.interpolator,exponent=config.exponent,range=this.range(),InterpolatorCls=interpolatorMap[interpolator];this._interpolator=new InterpolatorCls;var scale=this._interpolator.createScale({padding:padding,exponent:exponent,base:base,range:range});return scale=scale.nice()}},{key:"getScaleValue",value:function getScaleValue(domainVal){if(null!==domainVal&&void 0!==domainVal)return this._interpolator.getScaleValue(domainVal)}},{key:"getTickSize",value:function getTickSize(){var _this$renderConfig=this.renderConfig(),showInnerTicks=_this$renderConfig.showInnerTicks,showOuterTicks=_this$renderConfig.showOuterTicks,axis=this.axis();return axis.tickSizeInner(!1===showInnerTicks?0:6),axis.tickSizeOuter(!1===showOuterTicks?0:6),axis.tickSize()}},{key:"domain",value:function domain(){if(arguments.length){var domainVal=this._interpolator.sanitizeDomain(helper_getValidDomain(this,arguments.length<=0?void 0:arguments[0]));return setContinousAxisDomain(this,domainVal),this.setAxisComponentDimensions(),this.logicalSpace(null),this}return this._domain}},{key:"setAvailableSpace",value:function setAvailableSpace(){for(var _get2,_len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_get2=_get(_getPrototypeOf(ContinousAxis.prototype),"setAvailableSpace",this)).call.apply(_get2,[this].concat(params)),this.getTickSize(),this}},{key:"setTickConfig",value:function setTickConfig(){var _this$renderConfig2=this.renderConfig(),tickValues=_this$renderConfig2.tickValues,showInnerTicks=_this$renderConfig2.showInnerTicks,axis=this.axis();if(!showInnerTicks)return axis.tickValues([]),this;tickValues&&tickValues instanceof Array&&this.axis().tickValues(tickValues);var newTickValues=this.getTickValues();axis.tickValues(newTickValues);var smartLabel=this.dependencies().labelManager;smartLabel.setStyle(this._tickLabelStyle);var formatter=this._tickFormatter(newTickValues),smartTicks=newTickValues.map(function(val,i){var text=formatter(val,i),tickSpace=smartLabel.getOriSize(text);return tickSpace.text=text,tickSpace});return this.smartTicks(smartTicks),this}},{key:"getTickValues",value:function getTickValues(){var orientation=this.config().orientation,tickValues=this.renderConfig().tickValues,range=this.range(),axis=this.axis(),availableSpace=Math.abs(range[0]-range[1]),labelProps=this.axisComponentDimensions().largestTickDimensions;return tickValues||function getNumberOfTicks(availableSpace,labelDim,axis,axisInstance){var numberOfValues=0,tickValues=[],numberOfTicks=axisInstance.config().numberOfTicks,tickLength=axis.scale().ticks().length,minTickDistance=axisInstance._minTickDistance.width;return numberOfValues=tickLength,tickLength*(labelDim+minTickDistance)>availableSpace&&(numberOfValues=Math.floor(availableSpace/(labelDim+minTickDistance))),numberOfTicks=numberOfTicks||numberOfValues,numberOfValues=Math.min(numberOfTicks,Math.max(2,numberOfValues)),(tickValues=axis.scale().ticks(numberOfValues)).length>numberOfValues&&(tickValues=tickValues.filter(function(e,i){return i%2==0})),2===numberOfValues&&(tickValues=[(tickValues=axis.scale().ticks(10))[0],tickValues[tickValues.length-1]]),tickValues}(availableSpace,labelProps[orientation===axis_orientation_BOTTOM||orientation===axis_orientation_TOP?"width":"height"],axis,this)}},{key:"getMinTickDifference",value:function getMinTickDifference(){return getSmallestDiff(this.renderConfig().tickValues)}},{key:"setFixedBaseline",value:function setFixedBaseline(tickText){var orientation=this.config().orientation,rotation=this.renderConfig().labels.rotation,axis=this.axis(),ticks=axis.tickValues(),smartTicks=this.smartTicks();if(smartTicks&&smartTicks.length){var _this$smartTicks$=this.smartTicks()[0],width=_this$smartTicks$.width,height=_this$smartTicks$.height;axis.tickTransform(function(d){if(d===ticks[0]){if(orientation===axis_orientation_LEFT||orientation===axis_orientation_RIGHT)return"translate(0, -".concat(height/3,"px)");if((orientation===axis_orientation_TOP||orientation===axis_orientation_BOTTOM)&&!rotation)return"translate(".concat(width/2,"px,  ",0,"px)")}return""})}return tickText}}],[{key:"type",value:function type(){return LINEAR}}]),ContinousAxis}();function band_axis_typeof(obj){"@babel/helpers - typeof";return(band_axis_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function band_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function band_axis_possibleConstructorReturn(self,call){return!call||"object"!==band_axis_typeof(call)&&"function"!=typeof call?function band_axis_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function band_axis_getPrototypeOf(o){return(band_axis_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function band_axis_setPrototypeOf(o,p){return(band_axis_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var band_axis_BandAxis=function(_SimpleAxis){function BandAxis(){return function band_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BandAxis),band_axis_possibleConstructorReturn(this,band_axis_getPrototypeOf(BandAxis).apply(this,arguments))}return function band_axis_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&band_axis_setPrototypeOf(subClass,superClass)}(BandAxis,simple_axis_SimpleAxis),function band_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&band_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&band_axis_defineProperties(Constructor,staticProps),Constructor}(BandAxis,[{key:"setTickConfig",value:function setTickConfig(){var smartlabel,smartTicks="",domain=this.domain(),labelManager=this._dependencies.labelManager,padding=this.config().padding,_this$renderConfig=this.renderConfig(),labels=_this$renderConfig.labels,tickValues=_this$renderConfig.tickValues,_this$maxTickSpaces=this.maxTickSpaces(),availHeight=_this$maxTickSpaces.height,availWidth=_this$maxTickSpaces.width,noWrap=_this$maxTickSpaces.noWrap,_getRotatedSpaces=getRotatedSpaces(labels.rotation,availWidth,availHeight),width=_getRotatedSpaces.width,height=_getRotatedSpaces.height;if(tickValues&&this.axis().tickValues(tickValues),smartTicks=tickValues||domain,labelManager.setStyle(this._tickLabelStyle),"number"==typeof padding){var paddingNormalized=Math.min(1,Math.max(0,padding));this.scale().padding(paddingNormalized)}if(domain&&domain.length){var values=tickValues||domain,tickFormatter=this._tickFormatter(values);smartTicks=values.map(function(d,i){return labelManager.useEllipsesOnOverflow(!0),smartlabel=labelManager.getSmartText(tickFormatter(d,i),width,height,noWrap),labelManager.constructor.textToLines(smartlabel)})}return this.smartTicks(smartTicks),this}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||this.logicalSpace(helper_calculateBandSpace(this)),helper_setOffset(this),this.logicalSpace()}},{key:"getTickValues",value:function getTickValues(){return this.axis().scale().domain()}},{key:"formatTickValue",value:function formatTickValue(val){return this.valueParser()(val)}},{key:"sanitizeTickFormatter",value:function sanitizeTickFormatter(value){var _this=this,tickFormat=value.tickFormat;return tickFormat?function(ticks){return function(val,i){return tickFormat(_this.formatTickValue(val),val,i,ticks)}}:function(){return function(val){return _this.formatTickValue(val)}}}},{key:"getUnitWidth",value:function getUnitWidth(){return this.scale().bandwidth()}},{key:"getTickSize",value:function getTickSize(){var _this$renderConfig2=this.renderConfig(),showInnerTicks=_this$renderConfig2.showInnerTicks,showOuterTicks=_this$renderConfig2.showOuterTicks,axis=this.axis();return axis.tickSizeInner(showInnerTicks?6:0),axis.tickSizeOuter(showOuterTicks?6:0),axis.tickSize()}},{key:"invertExtent",value:function invertExtent(v1,v2){return this.scale().invertExtent(v1,v2)}},{key:"getNearestRange",value:function getNearestRange(v1,v2){var scale=this.scale(),range=scale.range(),reverse=range[0]>range[1],extent=this.invertExtent(v1,v2);return[scale(reverse?extent[extent.length-1]:extent[0]),scale(reverse?extent[0]:extent[extent.length-1])+scale.bandwidth()]}}],[{key:"type",value:function type(){return BAND}}]),BandAxis}();function time_axis_typeof(obj){"@babel/helpers - typeof";return(time_axis_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function time_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function time_axis_possibleConstructorReturn(self,call){return!call||"object"!==time_axis_typeof(call)&&"function"!=typeof call?function time_axis_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function time_axis_get(target,property,receiver){return(time_axis_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function time_axis_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=time_axis_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function time_axis_getPrototypeOf(o){return(time_axis_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function time_axis_setPrototypeOf(o,p){return(time_axis_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var time_axis_TimeAxis=function(_SimpleAxis){function TimeAxis(){var _getPrototypeOf2,_this;!function time_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TimeAxis);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=time_axis_possibleConstructorReturn(this,(_getPrototypeOf2=time_axis_getPrototypeOf(TimeAxis)).call.apply(_getPrototypeOf2,[this].concat(params))))._minDiff=1/0,_this}return function time_axis_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&time_axis_setPrototypeOf(subClass,superClass)}(TimeAxis,simple_axis_SimpleAxis),function time_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&time_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&time_axis_defineProperties(Constructor,staticProps),Constructor}(TimeAxis,[{key:"createScale",value:function createScale(range){var scale=time_axis_get(time_axis_getPrototypeOf(TimeAxis.prototype),"createScale",this).call(this,range);return scale=scale.nice()}},{key:"formatTickValue",value:function formatTickValue(val){return this.scale().tickFormat()(val)}},{key:"sanitizeTickFormatter",value:function sanitizeTickFormatter(value){var _this2=this,tickFormat=value.tickFormat;return tickFormat?function(ticks){var rawTicks=ticks.map(function(t){return t.getTime()});return function(val,i){return tickFormat(_this2.formatTickValue(val),val.getTime(),i,rawTicks)}}:function(){return function(val){return _this2.formatTickValue(val)}}}},{key:"getTickSize",value:function getTickSize(){var _this$renderConfig=this.renderConfig(),showInnerTicks=_this$renderConfig.showInnerTicks,showOuterTicks=_this$renderConfig.showOuterTicks,axis=this.axis();return axis.tickSizeInner(!1===showInnerTicks?0:6),axis.tickSizeOuter(!1===showOuterTicks?0:6),time_axis_get(time_axis_getPrototypeOf(TimeAxis.prototype),"getTickSize",this).call(this)}},{key:"getTickValues",value:function getTickValues(){return this.renderConfig().tickValues||this.scale().ticks()}},{key:"minDiff",value:function minDiff(diff){return this._minDiff=Math.min(this._minDiff,diff),this}},{key:"applyTickSkipping",value:function applyTickSkipping(){space_setter_applyTickSkipping(this)}},{key:"domain",value:function domain(){if(arguments.length){var domainValue=helper_getValidDomain(this,arguments.length<=0?void 0:arguments[0]);return setContinousAxisDomain(this,domainValue),this.setAxisComponentDimensions(),this.logicalSpace(null),function resetTickInterval(context,domain){var _context$config8=context.config(),orientation=_context$config8.orientation,isOffset=_context$config8.isOffset,minDiff=context._minDiff;if(context.range().length&&(orientation===axis_orientation_TOP||orientation===axis_orientation_BOTTOM)){context.applyTickSkipping();var largestTickDimensions=context.getAxisDimensions().largestTickDimensions,noOfTicks=context.getTickValues().length,_context$availableSpa=context.availableSpace(),width=_context$availableSpa.width,height=_context$availableSpa.height,padding=_context$availableSpa.padding,left=padding.left,right=padding.right,tickInterval=Math.min(largestTickDimensions.width,(width-(noOfTicks-1)*context._minTickDistance.width)/noOfTicks);context.maxTickSpaces({width:tickInterval});var adjustedRange=getAdjustedRange(minDiff,[tickInterval/2,width-left-right-tickInterval/2],domain,context.config());setAxisRange(context,"y",adjustedRange,isOffset?height:null),context.setTickConfig()}}(this,domainValue),this}return this._domain}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||this.logicalSpace(helper_calculateBandSpace(this)),helper_setOffset(this),this.logicalSpace()}},{key:"getMinTickDifference",value:function getMinTickDifference(){return getSmallestDiff(this.config().tickValues)}},{key:"setAvailableSpace",value:function setAvailableSpace(){for(var _get2,_len2=arguments.length,params=new Array(_len2),_key2=0;_key2<_len2;_key2++)params[_key2]=arguments[_key2];return(_get2=time_axis_get(time_axis_getPrototypeOf(TimeAxis.prototype),"setAvailableSpace",this)).call.apply(_get2,[this].concat(params)),this.getTickSize(),this}},{key:"setTickConfig",value:function setTickConfig(){var smartTicks,smartlabel,_this$renderConfig2=this.renderConfig(),labels=_this$renderConfig2.labels,tickValues=_this$renderConfig2.tickValues,_this$maxTickSpaces=this.maxTickSpaces(),availHeight=_this$maxTickSpaces.height,availWidth=_this$maxTickSpaces.width,noWrap=_this$maxTickSpaces.noWrap,labelManager=this._dependencies.labelManager,domain=this.getTickValues();tickValues&&this.axis().tickValues(tickValues);var _getRotatedSpaces=getRotatedSpaces(labels.rotation,availWidth,availHeight),width=_getRotatedSpaces.width,height=_getRotatedSpaces.height;if(smartTicks=tickValues||domain,labelManager.setStyle(this._tickLabelStyle),domain&&domain.length){var values=tickValues||domain,tickFormatter=this._tickFormatter(values);smartTicks=values.map(function(d,i){return labelManager.useEllipsesOnOverflow(!0),smartlabel=labelManager.getSmartText(tickFormatter(d,i),width,height,noWrap),labelManager.constructor.textToLines(smartlabel)})}return this.smartTicks(smartTicks),this}},{key:"_getRawTickValue",value:function _getRawTickValue(data){return new Date(data).getTime()}}],[{key:"type",value:function type(){return TIME}}]),TimeAxis}(),x11Colors={Pink:{hex:"ffc0cb",rgb:"255,192,203"},LightPink:{hex:"ffb6c1",rgb:"255,182,193"},HotPink:{hex:"ff69b4",rgb:"255,105,180"},DeepPink:{hex:"ff1493",rgb:"255,20,147"},PaleVioletRed:{hex:"db7093",rgb:"219,112,147"},MediumVioletRed:{hex:"c71585",rgb:"199,21,133"},LightSalmon:{hex:"ffa07a",rgb:"255,160,122"},Salmon:{hex:"fa8072",rgb:"250,128,114"},DarkSalmon:{hex:"e9967a",rgb:"233,150,122"},LightCoral:{hex:"f08080",rgb:"240,128,128"},IndianRed:{hex:"cd5c5c",rgb:"205,92,92"},Crimson:{hex:"dc143c",rgb:"220,20,60"},FireBrick:{hex:"b22222",rgb:"178,34,34"},DarkRed:{hex:"8b0000",rgb:"139,0,0"},Red:{hex:"ff0000",rgb:"255,0,0"},OrangeRed:{hex:"ff4500",rgb:"255,69,0"},Tomato:{hex:"ff6347",rgb:"255,99,71"},Coral:{hex:"ff7f50",rgb:"255,127,80"},DarkOrange:{hex:"ff8c00",rgb:"255,140,0"},Orange:{hex:"ffa500",rgb:"255,165,0"},Gold:{hex:"ffd700",rgb:"255,215,0"},Yellow:{hex:"ffff00",rgb:"255,255,0"},LightYellow:{hex:"ffffe0",rgb:"255,255,224"},LemonChiffon:{hex:"fffacd",rgb:"255,250,205"},LightGoldenrodYellow:{hex:"fafad2",rgb:"250,250,210"},PapayaWhip:{hex:"ffefd5",rgb:"255,239,213"},Moccasin:{hex:"ffe4b5",rgb:"255,228,181"},PeachPuff:{hex:"ffdab9",rgb:"255,218,185"},PaleGoldenrod:{hex:"eee8aa",rgb:"238,232,170"},Khaki:{hex:"f0e68c",rgb:"240,230,140"},DarkKhaki:{hex:"bdb76b",rgb:"189,183,107"},Cornsilk:{hex:"fff8dc",rgb:"255,248,220"},BlanchedAlmond:{hex:"ffebcd",rgb:"255,235,205"},Bisque:{hex:"ffe4c4",rgb:"255,228,196"},NavajoWhite:{hex:"ffdead",rgb:"255,222,173"},Wheat:{hex:"f5deb3",rgb:"245,222,179"},BurlyWood:{hex:"deb887",rgb:"222,184,135"},Tan:{hex:"d2b48c",rgb:"210,180,140"},RosyBrown:{hex:"bc8f8f",rgb:"188,143,143"},SandyBrown:{hex:"f4a460",rgb:"244,164,96"},Goldenrod:{hex:"daa520",rgb:"218,165,32"},DarkGoldenrod:{hex:"b8860b",rgb:"184,134,11"},Peru:{hex:"cd853f",rgb:"205,133,63"},Chocolate:{hex:"d2691e",rgb:"210,105,30"},SaddleBrown:{hex:"8b4513",rgb:"139,69,19"},Sienna:{hex:"a0522d",rgb:"160,82,45"},Brown:{hex:"a52a2a",rgb:"165,42,42"},Maroon:{hex:"800000",rgb:"128,0,0"},DarkOliveGreen:{hex:"556b2f",rgb:"85,107,47"},Olive:{hex:"808000",rgb:"128,128,0"},OliveDrab:{hex:"6b8e23",rgb:"107,142,35"},YellowGreen:{hex:"9acd32",rgb:"154,205,50"},LimeGreen:{hex:"32cd32",rgb:"50,205,50"},Lime:{hex:"00ff00",rgb:"0,255,0"},LawnGreen:{hex:"7cfc00",rgb:"124,252,0"},Chartreuse:{hex:"7fff00",rgb:"127,255,0"},GreenYellow:{hex:"adff2f",rgb:"173,255,47"},SpringGreen:{hex:"00ff7f",rgb:"0,255,127"},MediumSpringGreen:{hex:"00fa9a",rgb:"0,250,154"},LightGreen:{hex:"90ee90",rgb:"144,238,144"},PaleGreen:{hex:"98fb98",rgb:"152,251,152"},DarkSeaGreen:{hex:"8fbc8f",rgb:"143,188,143"},MediumSeaGreen:{hex:"3cb371",rgb:"60,179,113"},SeaGreen:{hex:"2e8b57",rgb:"46,139,87"},ForestGreen:{hex:"228b22",rgb:"34,139,34"},Green:{hex:"008000",rgb:"0,128,0"},DarkGreen:{hex:"006400",rgb:"0,100,0"},MediumAquamarine:{hex:"66cdaa",rgb:"102,205,170"},Aqua:{hex:"00ffff",rgb:"0,255,255"},Cyan:{hex:"00ffff",rgb:"0,255,255"},LightCyan:{hex:"e0ffff",rgb:"224,255,255"},PaleTurquoise:{hex:"afeeee",rgb:"175,238,238"},Aquamarine:{hex:"7fffd4",rgb:"127,255,212"},Turquoise:{hex:"40e0d0",rgb:"64,224,208"},MediumTurquoise:{hex:"48d1cc",rgb:"72,209,204"},DarkTurquoise:{hex:"00ced1",rgb:"0,206,209"},LightSeaGreen:{hex:"20b2aa",rgb:"32,178,170"},CadetBlue:{hex:"5f9ea0",rgb:"95,158,160"},DarkCyan:{hex:"008b8b",rgb:"0,139,139"},Teal:{hex:"008080",rgb:"0,128,128"},LightSteelBlue:{hex:"b0c4de",rgb:"176,196,222"},PowderBlue:{hex:"b0e0e6",rgb:"176,224,230"},LightBlue:{hex:"add8e6",rgb:"173,216,230"},SkyBlue:{hex:"87ceeb",rgb:"135,206,235"},LightSkyBlue:{hex:"87cefa",rgb:"135,206,250"},DeepSkyBlue:{hex:"00bfff",rgb:"0,191,255"},DodgerBlue:{hex:"1e90ff",rgb:"30,144,255"},CornflowerBlue:{hex:"6495ed",rgb:"100,149,237"},SteelBlue:{hex:"4682b4",rgb:"70,130,180"},RoyalBlue:{hex:"4169e1",rgb:"65,105,225"},Blue:{hex:"0000ff",rgb:"0,0,255"},MediumBlue:{hex:"0000cd",rgb:"0,0,205"},DarkBlue:{hex:"00008b",rgb:"0,0,139"},Navy:{hex:"000080",rgb:"0,0,128"},MidnightBlue:{hex:"191970",rgb:"25,25,112"},Lavender:{hex:"e6e6fa",rgb:"230,230,250"},Thistle:{hex:"d8bfd8",rgb:"216,191,216"},Plum:{hex:"dda0dd",rgb:"221,160,221"},Violet:{hex:"ee82ee",rgb:"238,130,238"},Orchid:{hex:"da70d6",rgb:"218,112,214"},Fuchsia:{hex:"ff00ff",rgb:"255,0,255"},Magenta:{hex:"ff00ff",rgb:"255,0,255"},MediumOrchid:{hex:"ba55d3",rgb:"186,85,211"},MediumPurple:{hex:"9370db",rgb:"147,112,219"},BlueViolet:{hex:"8a2be2",rgb:"138,43,226"},DarkViolet:{hex:"9400d3",rgb:"148,0,211"},DarkOrchid:{hex:"9932cc",rgb:"153,50,204"},DarkMagenta:{hex:"8b008b",rgb:"139,0,139"},Purple:{hex:"800080",rgb:"128,0,128"},Indigo:{hex:"4b0082",rgb:"75,0,130"},DarkSlateBlue:{hex:"483d8b",rgb:"72,61,139"},SlateBlue:{hex:"6a5acd",rgb:"106,90,205"},MediumSlateBlue:{hex:"7b68ee",rgb:"123,104,238"},White:{hex:"ffffff",rgb:"255,255,255"},Snow:{hex:"fffafa",rgb:"255,250,250"},Honeydew:{hex:"f0fff0",rgb:"240,255,240"},MintCream:{hex:"f5fffa",rgb:"245,255,250"},Azure:{hex:"f0ffff",rgb:"240,255,255"},AliceBlue:{hex:"f0f8ff",rgb:"240,248,255"},GhostWhite:{hex:"f8f8ff",rgb:"248,248,255"},WhiteSmoke:{hex:"f5f5f5",rgb:"245,245,245"},Seashell:{hex:"fff5ee",rgb:"255,245,238"},Beige:{hex:"f5f5dc",rgb:"245,245,220"},OldLace:{hex:"fdf5e6",rgb:"253,245,230"},FloralWhite:{hex:"fffaf0",rgb:"255,250,240"},Ivory:{hex:"fffff0",rgb:"255,255,240"},AntiqueWhite:{hex:"faebd7",rgb:"250,235,215"},Linen:{hex:"faf0e6",rgb:"250,240,230"},LavenderBlush:{hex:"fff0f5",rgb:"255,240,245"},MistyRose:{hex:"ffe4e1",rgb:"255,228,225"},Gainsboro:{hex:"dcdcdc",rgb:"220,220,220"},LightGray:{hex:"d3d3d3",rgb:"211,211,211"},Silver:{hex:"c0c0c0",rgb:"192,192,192"},DarkGrey:{hex:"a9a9a9",rgb:"169,169,169"},Grey:{hex:"808080",rgb:"128,128,128"},DimGrey:{hex:"696969",rgb:"105,105,105"},LightSlateGrey:{hex:"778899",rgb:"119,136,153"},SlateGrey:{hex:"708090",rgb:"112,128,144"},DarkSlateGrey:{hex:"2f4f4f",rgb:"47,79,79"},Black:{hex:"000000",rgb:"0,0,0"}},palette=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],DEFAULT_GRADIENT_COLOR="#eaeaea",DEFAULT_CONFIG={range:palette,value:palette[0],step:!1,stops:5,type:constants_LINEAR};function props_toConsumableArray(arr){return function props_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function props_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function props_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var props_getHslString=function getHslString(hslArr){return"hsla(".concat(360*hslArr[0],",").concat(100*hslArr[1],"%,").concat(100*hslArr[2],"%,").concat(hslArr[3]||1,")")},convertToXllString=function convertToXllString(baseString){return(baseString.split(" ")||[]).reduce(function(x,e){return"".concat(x).concat(e.charAt(0).toUpperCase()).concat(e.slice(1))},"")},props_getActualHslColor=function getActualHslColor(e,paletteColor){var color="";if("string"==typeof e)if(e=(e=e.replace(/ /g,"")).toLowerCase(),"hsl"===detectColor(e)||"hsla"===detectColor(e))color=[(color=e.match(/(\d+(\.\d+)?)/g))[0]/360,color[1]/100,color[2]/100,defaultValue(Number(color[3]),1)];else if("hex"===detectColor(e))color=hexToHsv(e);else if("rgb"===detectColor(e)){var col=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/);color=rgbToHsv.apply(void 0,props_toConsumableArray(col))}else x11Colors[convertToXllString(e)]&&(color=rgbToHsv.apply(void 0,props_toConsumableArray(x11Colors[convertToXllString(e)].rgb.split(","))));else color=e instanceof Array?e:rgbToHsv(paletteColor);return color},props_PROPS={config:{sanitization:function sanitization(context,config){var defCon=mergeRecursive({},context.constructor.defaultConfig());config.type===constants_LINEAR&&(config.range=config.range||[defCon.range[0]],config.range=config.range.length>1?config.range:[DEFAULT_GRADIENT_COLOR].concat(props_toConsumableArray(config.range)));var oldConfig=mergeRecursive(defCon,context.config()),newConfig=mergeRecursive(oldConfig,config);return newConfig.range instanceof Array&&(newConfig.range=newConfig.range.map(function(e,i){return props_getActualHslColor(e,palette[i])}),newConfig.stops=config.stops?config.stops:config.range&&config.range.length>2?config.range.length:DEFAULT_CONFIG.stops),newConfig.value=props_getActualHslColor(newConfig.value,newConfig.value),newConfig}},domain:{},scale:{},uniqueValues:{}},helper_treatNullMeasures=function treatNullMeasures(domainVal,scaledVal,minDomainScaledVal){return domainVal instanceof src_InvalidAwareTypes?minDomainScaledVal:scaledVal},helper_resolveAxisConfig=function resolveAxisConfig(propVal,defaultVal,context){switch(getObjProp(propVal,"constructor")){case Function:return propVal(defaultVal,context);case Array:return propVal;default:return defaultVal}},sanitiseConfigIntervals=function sanitiseConfigIntervals(intervals){return intervals||5};function color_strategy_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function color_strategy_toConsumableArray(arr){return function color_strategy_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function color_strategy_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function color_strategy_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var color_strategy_getStops=function getStops(domain,stops){var newStops=[];return stops instanceof Array?(newStops=stops.slice().sort(),newStops=color_strategy_toConsumableArray(new Set([domain[0]].concat(color_strategy_toConsumableArray(stops),[domain[1]]))).sort()):newStops=common_utils_getReadableTicks(domain,stops),{domain:domain,newStops:newStops}},indexedDomain=function indexedDomain(domain){var uniqueVals=domain;return{domain:domain.map(function(d,i){return i/(domain.length-1)}),uniqueVals:uniqueVals,scaleDomain:[0,1]}},indexedDomainMeasure=function indexedDomainMeasure(domain,stops,range){return{domain:domain,uniqueVals:domain,scaleDomain:[0,1],range:range}},normalDomain=function normalDomain(domain,stops,range){return{uniqueVals:domain,domain:domain,nice:!0,range:range}},color_strategy_steppedDomain=function steppedDomain(domain,stops,range){var _getStops=color_strategy_getStops(domain,stops),uniqueVals=_getStops.domain,newStops=_getStops.newStops;return{uniqueVals:uniqueVals,domain:newStops,nice:!0,range:function rangeStops(newStopsLength,range){var newRange=[];if(newStopsLength>Math.min(range.length,18))for(var interpolator=common_utils_piecewiseInterpolator()(common_utils_hslInterpolator(),range.map(function(e){return props_getHslString(e)})),i=0;i<newStopsLength;i++)newRange[i]=interpolator(i/(newStopsLength-1));else newRange=range.slice(0,newStopsLength);return{newRange:newRange}}(newStops.length-1,range).newRange}},color_strategy_continousSteppedDomain=function continousSteppedDomain(domain,stops,range){var _getStops2=color_strategy_getStops(sanitizeDomainWhenEqual(domain),range.length-1);return{uniqueVals:_getStops2.domain,domain:_getStops2.newStops,nice:!0,range:range.map(function(e){return props_getHslString(e)})}},uniqueRange=function uniqueRange(domainValue,scale,domain,uniqueVals){return scale(domain[uniqueVals.indexOf(domainValue)])},color_strategy_indexedRange=function indexedRange(domainValue,scale,domain){var numVal=(domainValue-domain[0])/(domain[domain.length-1]-domain[0]);return helper_treatNullMeasures(domainValue,scale(numVal),scale(0))},color_strategy_normalRange=function normalRange(domainValue,scale,domain){return helper_treatNullMeasures(domainValue,scale(domainValue),scale(domain[0]))},strategyGetter=function strategyGetter(domainType,rangeType,schemeType){return function strategies(){var _ref;return color_strategy_defineProperty(_ref={},"".concat(CONTINOUS,"-").concat(CONTINOUS,"-").concat(SEQUENTIAL),{scale:SEQUENTIAL,domainRange:function domainRange(){return indexedDomainMeasure},value:function value(){return color_strategy_indexedRange}}),color_strategy_defineProperty(_ref,"".concat(CONTINOUS,"-").concat(DISCRETE,"-").concat(SEQUENTIAL),{scale:SEQUENTIAL,domainRange:function domainRange(){return indexedDomainMeasure},value:function value(){return color_strategy_indexedRange}}),color_strategy_defineProperty(_ref,"".concat(DISCRETE,"-").concat(DISCRETE,"-").concat(SEQUENTIAL),{scale:SEQUENTIAL,domainRange:function domainRange(){return indexedDomain},value:function value(){return uniqueRange}}),color_strategy_defineProperty(_ref,"".concat(DISCRETE,"-").concat(DISCRETE,"-").concat(ORDINAL),{scale:ORDINAL,domainRange:function domainRange(){return normalDomain},value:function value(){return color_strategy_normalRange}}),color_strategy_defineProperty(_ref,"".concat(CONTINOUS,"-").concat(CONTINOUS,"-").concat(ORDINAL),{scale:LINEAR,domainRange:function domainRange(){return color_strategy_continousSteppedDomain},value:function value(){return color_strategy_normalRange}}),color_strategy_defineProperty(_ref,"".concat(CONTINOUS,"-").concat(DISCRETE,"-").concat(ORDINAL),{scale:QUANTILE,domainRange:function domainRange(){return color_strategy_steppedDomain},value:function value(){return color_strategy_normalRange}}),_ref}()["".concat(domainType,"-").concat(rangeType,"-").concat(schemeType||"")]};function color_axis_toConsumableArray(arr){return function color_axis_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function color_axis_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function color_axis_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function color_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _strategies,color_axis_ColorAxis=function(){function ColorAxis(config){!function color_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ColorAxis),generateGetterSetters(this,props_PROPS),this.config(config),this._domainType="linear"===this._config.type?CONTINOUS:DISCRETE,this._rangeType="linear"!==this._config.type||this._config.step?DISCRETE:CONTINOUS,this._schemeType=function getSchemeType(scheme){return scheme&&"string"==typeof scheme&&"i"===scheme[0]?constants_SEQUENTIAL:constants_ORDINAL}(this._config.range),this._colorStrategy=this.setColorStrategy(this._domainType,this._rangeType,this._schemeType),this._scale=this.createScale(this._colorStrategy),this._id=getUniqueId(),this.updateDomain(config.domain)}return function color_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&color_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&color_axis_defineProperties(Constructor,staticProps),Constructor}(ColorAxis,[{key:"createScale",value:function createScale(colorStrategy){var range=this.config().range;return range&&"string"==typeof range?function getScheme(scheme){return"i"===scheme[0]?scaleSequential(color_schemes_namespaceObject[scheme]):scaleOrdinal(color_schemes_namespaceObject[scheme])}(range):scale_creator_createScale({type:colorStrategy.scale,range:range})}},{key:"setColorStrategy",value:function setColorStrategy(domainType,rangeType,schemeType){return strategyGetter(domainType,rangeType,schemeType)}},{key:"getHslString",value:function getHslString(hslColorArray){return props_getHslString(hslColorArray)}},{key:"getColor",value:function getColor(domainVal){return this.getHslString(this.getRawColor(domainVal))}},{key:"getRawColor",value:function getRawColor(domainVal){if(this.domain()&&void 0!==domainVal){var scale=this.scale(),range=scale.range?scale.range():null,color=this._colorStrategy.value(range)(domainVal,scale,this.domain(),this.uniqueValues());if(color){if("string"==typeof color){var col=color.substring(color.indexOf("(")+1,color.lastIndexOf(")")).split(/,\s*/);return rgbToHsv.apply(void 0,color_axis_toConsumableArray(col))}return color_axis_toConsumableArray(color)}}return color_axis_toConsumableArray(this.config().value)}},{key:"setRangeWithInterpolatedColors",value:function setRangeWithInterpolatedColors(scaleType,scaleInfo){var originalDomain=scaleInfo.domain,originalRange=scaleInfo.range,originalDomainLen=originalDomain.length,originalRangeLen=originalRange.length;if(scaleType===constants_ORDINAL&&originalDomainLen>originalRangeLen){var newRange=[],newDomain=originalDomain.map(function(d,i){return i/originalDomainLen});this._linearScale=scaleMap.linear().range(this._config.range).domain(newDomain);for(var i=0,len=originalDomainLen;i<len;i++){var rangeVal=1/len*i;newRange.push(color_axis_toConsumableArray(this._linearScale(rangeVal)))}this.scale().range(newRange)}}},{key:"updateDomain",value:function updateDomain(){var domain=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(domain.length){var scale=this.scale(),range=scale.range?scale.range():null,domainRangeFn=this._colorStrategy.domainRange(),scaleType=this._colorStrategy.scale,scaleInfo=domainRangeFn(domain,this.config().stops,range);this.domain(scaleInfo.domain),scaleInfo.range&&this.scale().range(scaleInfo.range),this.uniqueValues(scaleInfo.uniqueVals),this.scale().domain(scaleInfo.scaleDomain||this.domain()),this.setRangeWithInterpolatedColors(scaleType,scaleInfo)}return this}},{key:"serialize",value:function serialize(){return{type:this.constructor.type(),scale:this.scale(),domain:this.domain(),config:this.config()}}},{key:"transformColor",value:function transformColor(color,transformationArr){var h=360*color[0],s=100*color[1],l=100*color[2],a=Math.min(defaultValue(color[3],0),1),newH=h+transformationArr[0],newS=s+transformationArr[1],newL=l+transformationArr[2],newA=Math.min(a+transformationArr[3]||0,1);return{color:"hsla(".concat(newH,",").concat(newS,"%,").concat(newL,"%,").concat(newA,")"),hsla:[newH/360,newS/100,newL/100,newA]}}},{key:"id",value:function id(){return this._id}},{key:"getHslArray",value:function getHslArray(color){return props_getActualHslColor(color)}}],[{key:"defaultConfig",value:function defaultConfig(){return DEFAULT_CONFIG}},{key:"type",value:function type(){return"color"}}]),ColorAxis}(),defaults_DEFAULT_CONFIG={value:51,range:[51,1e3]};function size_strategy_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function size_strategy_toConsumableArray(arr){return function size_strategy_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function size_strategy_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function size_strategy_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var size_strategy_strategies=(size_strategy_defineProperty(_strategies={},"".concat(DISCRETE,"-").concat(CONTINOUS),{scale:LINEAR,domain:function indexedDomain(domain){var uniqueVals=domain;return{domain:domain.map(function(d,i){return i/(domain.length-1)}),uniqueVals:uniqueVals,scaleDomain:[0,1]}},range:function pieceWiseRange(domainValue,scale,domain,uniqueVals){var numVal=domain[uniqueVals.indexOf(domainValue)];return common_utils_piecewiseInterpolator()(common_utils_numberInterpolator(),size_strategy_toConsumableArray(scale.range()))(numVal)}}),size_strategy_defineProperty(_strategies,"".concat(CONTINOUS,"-").concat(CONTINOUS),{scale:LINEAR,domain:function normalDomain(domain){return{uniqueVals:domain,domain:domain}},range:function normalRange(domainValue,scale,domain){return helper_treatNullMeasures(domainValue,scale(domainValue),scale(domain[0]))}}),size_strategy_defineProperty(_strategies,"".concat(CONTINOUS,"-").concat(DISCRETE),{scale:THRESHOLD,domain:function steppedDomain(domain,intervals){var newIntervals=[];return{uniqueVals:newIntervals=intervals instanceof Array?intervals.slice().sort():common_utils_getReadableTicks(domain,intervals),domain:newIntervals,nice:!0}},range:function discreteRange(domainValue,scale,domain){var numVal=(domainValue-domain[0])/(domain[domain.length-1]-domain[0]),interpolator=common_utils_numberInterpolator().apply(void 0,size_strategy_toConsumableArray(scale.range()));return helper_treatNullMeasures(domainValue,interpolator(numVal),interpolator(domain[0]))}}),_strategies),size_axis_props_PROPS={config:{sanitization:function sanitization(context,value){return context._userRange=value.range,mergeRecursive(context._config||{},value)}},domain:{sanitization:function sanitization(context,value){return context.scale().domain(value),value}},range:{},scale:{},uniqueValues:{}};function size_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var size_axis_SizeAxis=function(){function SizeAxis(config){!function size_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SizeAxis),generateGetterSetters(this,size_axis_props_PROPS),this._id=getUniqueId(),this.config(this.constructor.defaultConfig()),this.config(config),this._domainType="linear"===this._config.type?CONTINOUS:DISCRETE,this._config.range=this._userRange?this._userRange:this._config.range,this._config.stops=sanitiseConfigIntervals(this._config.stops),this._rangeType="linear"===this._config.type&&this._config.stops?DISCRETE:CONTINOUS,this._sizeStrategy=this.setStrategy(this._domainType,this._rangeType),this._scale=this.createScale(this._sizeStrategy),this._range=this._config.range,this.updateDomain(config.domain)}return function size_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&size_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&size_axis_defineProperties(Constructor,staticProps),Constructor}(SizeAxis,[{key:"setStrategy",value:function setStrategy(domainType,rangeType){return function strategyGetter(domainType,rangeType){return size_strategy_strategies["".concat(domainType,"-").concat(rangeType)]}(domainType,rangeType)}},{key:"createScale",value:function createScale(strategy){var range=this.config().range;return scale_creator_createScale({type:strategy.scale,range:range})}},{key:"getSize",value:function getSize(){var domainVal=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,value=this.config().value,scale=this.scale(),domain=this.domain()||[1,1];return scale&&domain[0]!==domain[1]&&1!==domain.length?this._sizeStrategy.range(domainVal,scale,this.domain(),this.uniqueValues()):value}},{key:"updateDomain",value:function updateDomain(domain){if(domain){var domainInfo=(0,this._sizeStrategy.domain)(domain,this.config().stops);this.domain(domainInfo.domain),this.uniqueValues(domainInfo.uniqueVals),this.scale().domain(domainInfo.scaleDomain||this.domain())}return this}},{key:"serialize",value:function serialize(){return{type:this.constructor.type(),scale:this.scale(),domain:this.domain(),range:this.range(),config:this.config()}}},{key:"id",value:function id(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return defaults_DEFAULT_CONFIG}},{key:"type",value:function type(){return"size"}}]),SizeAxis}(),shape_axis_defaults_DEFAULT_CONFIG={generator:null,value:"circle",range:["circle","diamond","star","cross","square","wye","triangle"]},shape_axis_props_PROPS={config:{},domain:{},scale:{},uniqueValues:{},generator:{}};function shape_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var shape_axis_ShapeAxis=function(){function ShapeAxis(config){!function shape_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ShapeAxis),generateGetterSetters(this,shape_axis_props_PROPS),this._id=getUniqueId(),this._config=Object.assign({},this.constructor.defaultConfig()),this._config=mergeRecursive(this._config,config),this._scale=scale_creator_createScale({type:"ordinal",range:this._config.range}),this.updateDomain(config.domain)}return function shape_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&shape_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&shape_axis_defineProperties(Constructor,staticProps),Constructor}(ShapeAxis,[{key:"getShape",value:function getShape(value){if(!this.scale()||!this.domain()||!value||value instanceof src_InvalidAwareTypes)return this.config().value;if(this._generatedShapes)return this._generatedShapes[value];var shapeType=this.scale()(value);return"string"===shapeType?common_utils_getSymbol(shapeType):shapeType}},{key:"updateDomain",value:function updateDomain(){var domain=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return domain.length&&(this.uniqueValues(domain),this.domain(domain),this.scale().domain(domain),this.config().generator&&(this._generatedShapes=function shapeGenerator(domain,generatorFn){var generatedShapes={};return domain.forEach(function(value){generatedShapes[value]=generatorFn(value)}),generatedShapes}(domain,this.config().generator))),this}},{key:"serialize",value:function serialize(){return{type:this.constructor.type(),scale:this.scale(),domain:this.domain(),range:this.config().range,config:this.config()}}},{key:"id",value:function id(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return shape_axis_defaults_DEFAULT_CONFIG}},{key:"type",value:function type(){return"shape"}}]),ShapeAxis}(),polar_axis_props_PROPS={config:{sanitization:function sanitization(context,config){return mergeRecursive(context.config(),config)},preset:function preset(context,config){var range=config.range,domain=config.domain;range&&context.range(range),domain&&context.domain(domain)}},domain:{},range:{}};function angle_axis_slicedToArray(arr,i){return function angle_axis_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function angle_axis_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function angle_axis_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function angle_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var angle_axis_pie=Symbols.pie,createAngleValues=function createAngleValues(context){var angleData=context._angleFn(context._domain);angleData.forEach(function(v){v.startAngle-=Math.PI/2,v.endAngle-=Math.PI/2}),context._angleValues=angleData.reduce(function(values,d){var key=d.data;return!values[key]&&(values[key]=[]),values[key].push(d),values},{})},angle_axis_AngleAxis=function(){function AngleAxis(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function angle_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AngleAxis),this._id=getUniqueId(),generateGetterSetters(this,polar_axis_props_PROPS),this._config=mergeRecursive({},this.constructor.defaultConfig()),this.config(config),this._range=[0,360],this._angleFn=angle_axis_pie().value(function(d){return"string"==typeof d?1:d}).sortValues(null),this._angleValues={}}return function angle_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&angle_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&angle_axis_defineProperties(Constructor,staticProps),Constructor}(AngleAxis,[{key:"createScale",value:function createScale(strategy){var range=this.config().range;return scale_creator_createScale({type:strategy.scale,range:range})}},{key:"getScaleValue",value:function getScaleValue(domainVal){return this._angleValues[domainVal]}},{key:"padAngle",value:function padAngle(angle){this._angleFn=this._angleFn.padAngle(angle)}},{key:"domain",value:function domain(){for(var _len=arguments.length,domainVal=new Array(_len),_key=0;_key<_len;_key++)domainVal[_key]=arguments[_key];if(domainVal.length){var customDomain=this.config().domain,domain=domainVal[0].length?domainVal[0]:DEFAULT_ANGLE_DOMAIN;return this._domain=helper_resolveAxisConfig(customDomain,domain,this),createAngleValues(this),this}return this._domain}},{key:"range",value:function range(){if(arguments.length){var customRange=this.config().range;this._range=helper_resolveAxisConfig(customRange,arguments.length<=0?void 0:arguments[0],this);var domain=this.domain(),_this$_range=angle_axis_slicedToArray(this._range,2),startAngle=_this$_range[0],endAngle=_this$_range[1];return this._angleFn.startAngle(startAngle/180*Math.PI).endAngle(Math.PI*endAngle/180),domain&&domain.length&&createAngleValues(this),this}return this._range}}],[{key:"defaultConfig",value:function defaultConfig(){return{}}}]),AngleAxis}(),X="x",Y="y",WIDTH="width",HEIGHT="height",constants_MEASUREMENT="measurement",constants_CONFIG="config",MIN_UNIT_WIDTH="minUnitWidth",MIN_UNIT_HEIGHT="minUnitHeight",DIMENSIONS="dimensions",MEASURES="measures",DIMENSION="dimension",MEASURE="measure",PIVOT="pivot",FORMAT="format",constants_MOUNT="mount",HAS_DATA_UPDATED="hasDataUpdated",ROWS="rows",COLUMNS="columns",constants_DATA="data",COL="col",ROW="row",COLUMN="column",enums_constants_COLOR="color",enums_constants_SHAPE="shape",enums_constants_SIZE="size",DETAIL="detail",LAYERS="layers",TRANSFORM="transform",enums_constants_ORDINAL="ordinal",enums_constants_LINEAR="linear",constants_LEFT="left",constants_RIGHT="right",enums_constants_TOP="top",enums_constants_BOTTOM="bottom",RETINAL="retinal",CELL="cell",X_AXES="xAxes",Y_AXES="yAxes",ENTRY_CELLS="entryCell",INITIALIZED="initialized",EXIT_CELLS="exitCell",AXIS="axis",UNIT="unit",UPDATED="updated",BEFORE_UPDATE="beforeupdate",VALUE_MATRIX="valueMatrix",FACET_HEADERS="facet-headers",enums_constants_RADIUS="radius",enums_constants_ANGLE="angle",ANGLE0="angle0",ARC="arc",constants_CATEGORICAL="categorical",constants_TEMPORAL="temporal",BAR="bar",LINE="line",POINT="point",PRIMARY="Primary",SECONDARY="Secondary",BOTH="both",INTERACTION="interaction",GRID_LINES="gridLines",GRID_BANDS="gridBands",HEADER="header",FACET="facet",DEFAULT="default",constants_ASCENDING="asc",DESCENDING="desc",DARK="dark",NONE="none",NORMAL="normal",DARKER="darker";function radius_axis_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _dataTypeScaleMap,adjustDomain=function adjustDomain(context){var minOuterRadius=context.config().minOuterRadius,domain=context._domain;if(context._range.length){var scale=context._scale,value=scale.invert(minOuterRadius)-scale.invert(0);context._domain=[domain[0]-value,domain[1]],scale.domain(context._domain)}},radius_axis_RadiusAxis=function(){function RadiusAxis(){var config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function radius_axis_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RadiusAxis),this._id=getUniqueId(),generateGetterSetters(this,polar_axis_props_PROPS),this._range=[],this._radiusFactor=1,this._config=mergeRecursive({},this.constructor.defaultConfig()),this.config(config),this._scale=this.createScale({scale:enums_constants_LINEAR})}return function radius_axis_createClass(Constructor,protoProps,staticProps){return protoProps&&radius_axis_defineProperties(Constructor.prototype,protoProps),staticProps&&radius_axis_defineProperties(Constructor,staticProps),Constructor}(RadiusAxis,[{key:"config",value:function config(){if(arguments.length){var config=mergeRecursive(this.config(),arguments.length<=0?void 0:arguments[0]);return this._config=config,this}return this._config}},{key:"createScale",value:function createScale(strategy){return scale_creator_createScale({type:strategy.scale,range:this.range()})}},{key:"domain",value:function domain(){if(arguments.length){var customDomain=this.config().domain,domain=helper_resolveAxisConfig(customDomain,arguments.length<=0?void 0:arguments[0],this);domain=sanitizeDomainWhenEqual(domain),this._scale.domain(domain),this._domain=domain,adjustDomain(this)}return this._domain}},{key:"getInnerRadius",value:function getInnerRadius(domainVal){return void 0===domainVal?this.range()[0]:this._scale(domainVal)}},{key:"getOuterRadius",value:function getOuterRadius(domainVal){return void 0===domainVal?this.range()[1]:this._scale(domainVal)*this._radiusFactor}},{key:"range",value:function range(){for(var _len=arguments.length,_range=new Array(_len),_key=0;_key<_len;_key++)_range[_key]=arguments[_key];if(_range.length){var _this$config2=this.config(),padding=_this$config2.padding,customRange=_this$config2.range,sanitizedRange=_range[0].map(function(v,i){return v+(i?-padding[i]:padding[i])}),rangeVal=helper_resolveAxisConfig(customRange,sanitizedRange,this);this._range=rangeVal,this._scale.range(rangeVal),adjustDomain(this)}return this._range}},{key:"setRadiusFactor",value:function setRadiusFactor(val){return this._radiusFactor=val,this}}],[{key:"defaultConfig",value:function defaultConfig(){return{padding:[0,1],minOuterRadius:10}}}]),RadiusAxis}();function data_type_scale_map_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DATA_TYPES_MEASURE="measure",DATA_TYPES_TEMPORAL="temporal",group_transform=(data_type_scale_map_defineProperty(_dataTypeScaleMap={},"dimension",BAND),data_type_scale_map_defineProperty(_dataTypeScaleMap,DATA_TYPES_MEASURE,LINEAR),data_type_scale_map_defineProperty(_dataTypeScaleMap,DATA_TYPES_TEMPORAL,TIME),function(schema,data,config){var groupBy=config.groupBy instanceof Array?config.groupBy:[config.groupBy],groupByIndices=groupBy.map(function(fieldName){return schema.findIndex(function(d){return d.name===fieldName})});if(void 0!==groupByIndices.find(function(d){return-1===d}))throw new Error("Groupby field ".concat(groupBy," not found in schema"));var groupedData=common_utils_nestCollection({keys:groupByIndices,data:data});return groupedData.forEach(function(d){var key=d.key;src_InvalidAwareTypes.isInvalid(key)&&(d.key=src_InvalidAwareTypes.getInvalidType(key))}),groupedData});var _transformMap;function transform_factory_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var transformMap=(transform_factory_defineProperty(_transformMap={},"identity",function identityTransform(schema,data,config){return data}),transform_factory_defineProperty(_transformMap,"group",group_transform),transform_factory_defineProperty(_transformMap,"stack",function(schema,data,config){var uniqueField=config.uniqueField,valueField=config.value,groupBy=config.groupBy,sort=config.sort||"descending",normalizedData=function normalizeData(data,schema,valueField,uniqueField,groupBy){var groupedData=group_transform(schema,data,{groupBy:uniqueField}),uniqueFieldIndex=schema.findIndex(function(d){return d.name===uniqueField}),valueFieldIndex=schema.findIndex(function(d){return d.name===valueField}),seriesKeyIndex=schema.findIndex(function(d){return d.name===groupBy}),seriesKeys=data.map(function(d){return d[seriesKeyIndex]}).filter(function(item,pos,arr){return arr.indexOf(item)===pos}).sort(),fieldNames=schema.reduce(function(acc,obj,i){return acc[i]=obj.name,acc},{});return{data:groupedData.map(function(arr){var tuples={},rowObj=arr.values.reduce(function(acc,row){return acc=row.reduce(function(obj,value,i){return i===seriesKeyIndex?(row[valueFieldIndex]instanceof src_InvalidAwareTypes&&(row[valueFieldIndex]=null),obj[value]=row[valueFieldIndex],tuples[value]=row):i!==valueFieldIndex&&(obj[fieldNames[i]]=value),obj},acc)},{});return rowObj._tuple=tuples,seriesKeys.forEach(function(seriesKey){if(void 0===rowObj[seriesKey]){rowObj[seriesKey]=0;var newArr=new Array(arr.values[0].length);newArr[uniqueFieldIndex]=arr.key,newArr[seriesKeyIndex]=seriesKey,rowObj._tuple[seriesKey]=newArr}}),rowObj}),keys:seriesKeys}}(data,schema,valueField,uniqueField,groupBy),keys=normalizedData.keys,map={},orderBy=config.orderBy,orderIndex=schema.findIndex(function(d){return d.name===orderBy}),groupByIndex=schema.findIndex(function(d){return d.name===groupBy});-1!==orderIndex&&(keys.forEach(function(key){var name=data.find(function(d){return d[groupByIndex]===key});map[key]=name[orderIndex]}),normalizedData.keys.sort(function(a,b){return map[a].localeCompare(map[b])}));var stackData=common_utils_stack({keys:normalizedData.keys,offset:config.offset||"diverging",order:sort,data:normalizedData.data});return stackData.forEach(function(seriesData){seriesData.forEach(function(dataObj){dataObj.data=dataObj.data._tuple[seriesData.key]})}),stackData}),_transformMap);var _encodingFieldInfRetr,_dataNormalizers,_domainCalculator,transform_factory=function transformFactory(type){var transform=transformMap[type];if("function"!=typeof transform)throw new Error("Invalid transform type supplied.");return transform};function helpers_toConsumableArray(arr){return function helpers_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function helpers_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function helpers_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function helpers_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var helpers_BAND=scale_type_namespaceObject.BAND,POLAR=COORD_TYPES.POLAR,helpers_CARTESIAN=COORD_TYPES.CARTESIAN,helpers_transformColor=function transformColor(colorAxis,datum,styleType,intensity,interactionType){var meta=datum.meta,stateColor=defaultValue(meta.currentState[interactionType][styleType],meta.originalState[styleType]),colorInfo=colorAxis.transformColor(stateColor,intensity);return meta.currentState[interactionType][styleType]=colorInfo.hsla,colorInfo},helpers_applyInteractionStyle=function applyInteractionStyle(context,selectionSet,interactionStyles,config){var elements=context.getPlotElementsFromSet(selectionSet),apply=config.apply,interactionType=config.interactionType,reset=config.reset,mountPoint=renderer_utils_selectElement(context.mount()).select(".muze-overlay-paths").node();elements.forEach(function(elem){var options={mountPoint:mountPoint,apply:apply,reset:reset};context.applyLayerStyle(elem,interactionType,interactionStyles,options)})},helpers_retrieveEncodingInf=function retrieveEncodingInf(encoding,fieldsConfig,encodingNames){var encodingInf={};return encodingNames.forEach(function(e){var field=getObjProp(encoding,e,"field");encodingInf["".concat(e,"Field")]=field,encodingInf["".concat(e,"FieldIndex")]=getObjProp(fieldsConfig,field,"index"),encodingInf["".concat(e,"FieldType")]=getObjProp(fieldsConfig,field,"def","type"),encodingInf["".concat(e,"FieldSubType")]=getObjProp(fieldsConfig,field,"def","subtype")}),encodingInf},encodingFieldInfRetriever=(helpers_defineProperty(_encodingFieldInfRetr={},POLAR,function(encoding,fieldsConfig){var fields=[ENCODING.RADIUS,ENCODING.RADIUS0,ENCODING.ANGLE,ENCODING.ANGLE0,COLOR,SHAPE,SIZE,TEXT];return helpers_retrieveEncodingInf(encoding,fieldsConfig,fields)}),helpers_defineProperty(_encodingFieldInfRetr,helpers_CARTESIAN,function(encoding,fieldsConfig){var fields=[ENCODING.X,ENCODING.Y,ENCODING.X0,ENCODING.Y0,COLOR,SHAPE,SIZE,TEXT];return helpers_retrieveEncodingInf(encoding,fieldsConfig,fields)}),_encodingFieldInfRetr),helpers_setNullsInStack=function setNullsInStack(transformedData,schema,value,setNulls){var uniqueFieldIndex=schema.findIndex(function(d){return d.name===value});return transformedData.forEach(function(seriesData){seriesData.forEach(function(dataObj){null!==dataObj.data[uniqueFieldIndex]||setNulls||(dataObj[0]=new src_InvalidAwareTypes,dataObj[1]=new src_InvalidAwareTypes)})}),transformedData},helpers_transformData=function transformData(dataModel,config,transformType,encodingFieldInf){var data=dataModel.getData({withUid:!0}),schema=data.schema,transform=config.transform,setNullData=config.connectNullData,xField=encodingFieldInf.xField,yField=encodingFieldInf.yField,xFieldType=encodingFieldInf.xFieldType,yFieldType=encodingFieldInf.yFieldType,uniqueField=xFieldType===dist_datamodel.FieldType.MEASURE?yField:xField,value=yFieldType===dist_datamodel.FieldType.MEASURE?yField:xField,transformedData=transform_factory(transformType)(schema,data.data,{groupBy:transform.groupBy,uniqueField:uniqueField,sort:transform.sort||"none",offset:transform.offset,orderBy:transform.orderBy,value:value},data.uids);return transformType===STACK&&(transformedData=helpers_setNullsInStack(transformedData,schema,value,setNullData)),transformedData},getIndividualClassName=function getIndividualClassName(d,i,data,context){var className=context.config().individualClassName,classNameStr="";return className instanceof Function&&(classNameStr=className(d,i,data,context)),classNameStr},dataNormalizers=(helpers_defineProperty(_dataNormalizers={},POLAR,function(transformedData,encodingFieldInf,fieldsConfig){var radiusFieldIndex=encodingFieldInf.radiusFieldIndex,angleFieldIndex=encodingFieldInf.angleFieldIndex,radius0FieldIndex=encodingFieldInf.radius0FieldIndex,angle0FieldIndex=encodingFieldInf.angle0FieldIndex,fieldsLen=Object.keys(fieldsConfig).length;return transformedData.map(function(data){return data.map(function(d){var pointObj={radius:d[radiusFieldIndex],angle:void 0!==angleFieldIndex?d[angleFieldIndex]:1,radius0:d[radius0FieldIndex],angle0:d[angle0FieldIndex]};return[COLOR,SHAPE,SIZE,TEXT].forEach(function(enc){pointObj[enc]=d[encodingFieldInf["".concat(enc,"FieldIndex")]]}),pointObj.source=d,pointObj.rowId=d[fieldsLen],pointObj})}).filter(function(d){return d.length})}),helpers_defineProperty(_dataNormalizers,helpers_CARTESIAN,function(transformedData,encodingFieldInf,fieldsConfig,transformType){var xFieldType=encodingFieldInf.xFieldType,xFieldIndex=encodingFieldInf.xFieldIndex,yFieldIndex=encodingFieldInf.yFieldIndex,x0FieldIndex=encodingFieldInf.x0FieldIndex,y0FieldIndex=encodingFieldInf.y0FieldIndex,fieldsArr=Object.keys(fieldsConfig),fieldsLen=fieldsArr.length;return transformedData.map(function(data){return(transformType===GROUP?data.values:data).map(function(d){var tuple,y,y0,x,x0,pointObj={};transformType===STACK?(tuple=d.data||[],d[1]>=d[0]?(y=x0=d[1],x=y0=d[0]):(y=x0=d[0],x=y0=d[1]),(pointObj=xFieldType===dist_datamodel.FieldType.MEASURE?{x:x,x0:x0,y:tuple[yFieldIndex],y0:tuple[yFieldIndex]}:{x:tuple[xFieldIndex],x0:tuple[xFieldIndex],y:y,y0:y0}).source=tuple,pointObj.rowId=tuple[fieldsLen],[COLOR,SHAPE,SIZE,TEXT].forEach(function(enc){pointObj[enc]=tuple[encodingFieldInf["".concat(enc,"FieldIndex")]]})):((pointObj={x:d[xFieldIndex],y:d[yFieldIndex],x0:d[x0FieldIndex],y0:d[y0FieldIndex]}).source=d,pointObj.rowId=d[fieldsLen],[COLOR,SHAPE,SIZE,TEXT].forEach(function(enc){pointObj[enc]=d[encodingFieldInf["".concat(enc,"FieldIndex")]]}));var source=pointObj.source;return pointObj.dataObj=fieldsArr.reduce(function(acc,name){return acc[name]=source[fieldsConfig[name].index],acc},{}),pointObj})}).filter(function(d){return d.length})}),_dataNormalizers),helpers_getNormalizedData=function getNormalizedData(transformedData,context){var transformType=context.transformType(),transformedDataArr=transformType===IDENTITY?[transformedData]:transformedData,encodingFieldInf=context.encodingFieldsInf(),fieldsConfig=context.data().getFieldsConfig();return dataNormalizers[context.coord()](transformedDataArr,encodingFieldInf,fieldsConfig,transformType)},domainCalculator=(helpers_defineProperty(_domainCalculator={},POLAR,function(data,layerInst){var config=layerInst.config(),sort=config.sort,angleValues=data[0],radius0Field=getObjProp(config.encoding.radius0,"field");return sort&&(angleValues=angleValues.sort(function(a,b){return sort===ASCENDING?a.radius-b.radius:b.radius-a.radius})),{radius:getDomainFromData(data,[ENCODING.RADIUS,radius0Field?ENCODING.RADIUS0:ENCODING.RADIUS]),angle:angleValues.map(function(d){return d.angle}),angle0:angleValues.map(function(d){return d.angle0})}}),helpers_defineProperty(_domainCalculator,helpers_CARTESIAN,function(data,layerInst){var transformType=layerInst.transformType(),encodingFieldInf=layerInst.encodingFieldsInf(),xFieldSubType=encodingFieldInf.xFieldSubType,yFieldSubType=encodingFieldInf.yFieldSubType,xField=encodingFieldInf.xField,yField=encodingFieldInf.yField,x0Field=encodingFieldInf.x0Field,y0Field=encodingFieldInf.y0Field,domains={},yEnc=ENCODING.Y,xEnc=ENCODING.X;return xField&&(domains.x=getDomainFromData(data,x0Field||transformType===STACK?[xEnc,ENCODING.X0]:[xEnc,xEnc],xFieldSubType)),yField&&(domains.y=getDomainFromData(data,y0Field||transformType===STACK?[ENCODING.Y0,ENCODING.Y]:[yEnc,yEnc],yFieldSubType)),domains}),_domainCalculator),defFn=function defFn(d){var _d$update=d.update;return{x:_d$update.x,y:_d$update.y}},helpers_attachDataToVoronoi=function attachDataToVoronoi(voronoi,points){var _ref,accessor=arguments.length>2&&void 0!==arguments[2]?arguments[2]:defFn;voronoi.data((_ref=[]).concat.apply(_ref,helpers_toConsumableArray(points)).filter(function(d){return void 0!==d.rowId}).map(function(d){var _accessor=accessor(d);return{x:_accessor.x,y:_accessor.y,data:d}}))},helpers_updateStyle=function updateStyle(target,styles,remove){for(var key in styles)({}).hasOwnProperty.call(styles,key)&&target.style(key,remove?null:styles[key])},helpers_animateGroup=function animateGroup(mount,context){var groupTransition,update,transition=context.transition,groupAnimateStyle=context.groupAnimateStyle,duration=transition.duration,effect=transition.effect,disabled=transition.disabled;groupAnimateStyle&&(renderer_utils_setStyles(mount.node(),groupAnimateStyle.enter),update=groupAnimateStyle.update,groupTransition=disabled?mount:mount.transition().ease(easeFns[effect]).duration(duration).on("end",function(){helpers_updateStyle(renderer_utils_selectElement(this),update,!0)}),helpers_updateStyle(groupTransition,update))},positionPoints=function positionPoints(context,points){var positioner=context.encodingTransform();return positioner?positioner(points,context,{smartLabel:context._dependencies.smartLabel}):points},getGroupSpan=function getGroupSpan(axis,minDiff){var width=axis.getUnitWidth(),scale=axis.scale(),range=scale.range(),domain=scale.domain();return width||Math.abs(range[1]-range[0])/Math.abs(domain[1]-domain[0])*minDiff},helpers_getPlotMeasurement=function getPlotMeasurement(context,dimensionalValues){var fieldInfo=context.encodingFieldsInf(),axes=context.axes(),transformType=context.transformType(),config=context.config(),bandScale=context._bandScale;return["x","y"].map(function(type){var span=0,groupSpan=0,padding=0,offsetValues=[];if(fieldInfo["".concat(type,"FieldType")]===dist_datamodel.FieldType.DIMENSION){var actualGroupWidth,timeDiff=fieldInfo["".concat(type,"FieldSubType")]===dist_datamodel.DimensionSubtype.TEMPORAL?context.dataProps().timeDiffs[type]:0,axis=axes[type],pad=config["pad".concat(type.toUpperCase())],innerPadding=config.innerPadding,keys=dimensionalValues,scale=axis.scale();groupSpan=getGroupSpan(axis,timeDiff);var isAxisBandScale=axis.constructor.type()===helpers_BAND,axisPadding=axis.config().padding;if("group"===transformType){var groupPadding=isAxisBandScale?0:axisPadding*groupSpan/2;bandScale.range([groupPadding,groupSpan-groupPadding]).domain(keys).paddingInner(innerPadding),span=bandScale.bandwidth(),actualGroupWidth=groupSpan-(isAxisBandScale?0:axisPadding*groupSpan),offsetValues=keys.map(function(key){return bandScale(key)-(isAxisBandScale?0:groupSpan/2)})}else if(void 0!==pad){var offset;if(isAxisBandScale){var step=scale.step();offset=scale.padding()*step,span=scale.bandwidth()+offset}else span=groupSpan;offsetValues=keys.map(function(){return isAxisBandScale?-offset/2:-span/2})}else actualGroupWidth=span=groupSpan-(padding=isAxisBandScale?0:axisPadding*groupSpan),offsetValues=keys.map(function(){return isAxisBandScale?0:-span/2});groupSpan=actualGroupWidth,padding=isAxisBandScale?axisPadding*axis.scale().step():axisPadding*groupSpan}return{span:span,offsetValues:offsetValues,groupSpan:groupSpan,padding:padding}})},helpers_renderLayer=function renderLayer(context){var mount=context.mount();mount&&(context.render(mount),context.dependencies().throwback.commit(common_props.ON_LAYER_DRAW,!0,context.metaInf().parentNamespace))},helpers_resolveInvalidTransformType=function resolveInvalidTransformType(context){return function transformResolverPredicates(encodingFieldInf,context,groupByField){var fieldsConfig=context.data().getFieldsConfig(),xField=encodingFieldInf.xField,yField=encodingFieldInf.yField,xFieldType=encodingFieldInf.xFieldType,yFieldType=encodingFieldInf.yFieldType,dimensionField=["xField","yField"].find(function(type){return encodingFieldInf["".concat(type,"Type")]===dist_datamodel.FieldType.DIMENSION});return[!xField,!yField,!groupByField,getObjProp(fieldsConfig[groupByField],"def","type")===dist_datamodel.FieldType.MEASURE,xFieldType===dist_datamodel.FieldType.DIMENSION&&yFieldType===dist_datamodel.FieldType.DIMENSION,dimensionField&&encodingFieldInf[dimensionField]===groupByField]}(context.encodingFieldsInf(),context,context.config().transform.groupBy).some(function(value){return value})?IDENTITY:null},getValidTransform=function getValidTransform(context){return helpers_resolveInvalidTransformType(context)||context.config().transform.type},helpers_getValidTransformForAggFn=function getValidTransformForAggFn(context){var resolvedInvalidTransformType=helpers_resolveInvalidTransformType(context);if(resolvedInvalidTransformType)return resolvedInvalidTransformType;var _context$encodingFiel=context.encodingFieldsInf(),xField=_context$encodingFiel.xField,yField=_context$encodingFiel.yField,xFieldType=_context$encodingFiel.xFieldType,yFieldType=_context$encodingFiel.yFieldType,groupByField=context.config().transform.groupBy,isCustomTransformTypeProvided=!!getObjProp(context._customConfig,"transform","type"),transformType=context.config().transform.type;if(!isCustomTransformTypeProvided&&groupByField&&xFieldType!==yFieldType){var measureField=xFieldType===dist_datamodel.FieldType.MEASURE?xField:yField;transformType=common_utils_retrieveNearestGroupByReducers(context.data(),measureField)[measureField]===AGG_FN_SUM?STACK:GROUP}return transformType},helpers_getMarkId=function getMarkId(source,schema){return source.filter(function(val,i){return schema[i]&&schema[i].type===dist_datamodel.FieldType.DIMENSION}).join()},helpers_resolveEncodingValues=function resolveEncodingValues(data,i,dataArr,layerInst){var transformedValues={},values=data.values,encoding=layerInst.config().encoding;for(var key in values){var value=getObjProp(encoding[key],"value");value instanceof Function?transformedValues[key]=value(values,i,dataArr,layerInst):transformedValues[key]=values[key]}return transformedValues},getColorMetaInf=function getColorMetaInf(initialStyle){var conf=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{originalStyle:Object.assign({},{styles:initialStyle},conf),currentState:new Map}},getCoordValue=function getCoordValue(radius,trig,angle,offset){return radius*Math[trig](angle)+offset},coordValueGetter=function coordValueGetter(radius,angle,xOffset,yOffset){return{x:getCoordValue(radius,"cos",angle,xOffset),y:getCoordValue(radius,"sin",angle,yOffset)}},toCartesianCoordinates=function toCartesianCoordinates(points,measurement){for(var rangePlot=arguments.length>2&&void 0!==arguments[2]&&arguments[2],xOffset=measurement.width/2,yOffset=measurement.height/2,i=0,len=points.length;i<len;i++){var point=points[i],_point$update=point.update,angle=_point$update.angle,radius=_point$update.radius,radius0=_point$update.radius0,angle0=_point$update.angle0;if(point.update=coordValueGetter(radius,angle,xOffset,yOffset),rangePlot){var update=point.update=coordValueGetter(radius0,angle0,xOffset,yOffset),_coordValueGetter=coordValueGetter(radius,angle,xOffset,yOffset),x0=_coordValueGetter.x,y0=_coordValueGetter.y;update.x0=x0,update.y0=y0}}return points},sortData=function sortData(data,axes){for(var axisArr=[axes.x,axes.y],i=0,len=axisArr.length;i<len;i++){var axis=axisArr[i];if(axis.constructor.type()===helpers_BAND)if("break"===function(){var key=i?"y":"x",indices=axis.domain().reduce(function(acc,v,idx){return acc[v]=idx,acc},{});return data.sort(function(a,b){return indices[a[key]]-indices[b[key]]}),"break"}())break}return data},helpers_getBoundBoxes=function getBoundBoxes(points){return points.map(function(point){var _point$update2=point.update,x=_point$update2.x,y=_point$update2.y;return{minX:x,maxX:x,minY:y,maxY:y,data:point.data}})},helpers_getDataFromEvent=function getDataFromEvent(context,event,data){var dataPoint=data||renderer_utils_selectElement(event.target).data()[0];if(isSimpleObject(dataPoint)&&getObjProp(dataPoint,"meta","layerId")===context.id()){var values=dataPoint&&dataPoint.source,identifiers=null;return values&&(identifiers=context.getIdentifiersFromData(values,dataPoint.rowId)),{dimensions:[dataPoint],id:identifiers,layerId:context.id()}}return null};var local_options_localOptions=function local_options_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},DATA,{value:null});function listener_map_slicedToArray(arr,i){return function listener_map_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function listener_map_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function listener_map_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var listenerMap=[{props:["".concat(namespace_namespaceObject.LAYER_LOCAL_NAMESPACE,".").concat(DATA)],type:"registerImmediateListener",listener:function listener(context,_ref){var _ref2=listener_map_slicedToArray(_ref,2),prevData=_ref2[0],data=_ref2[1];context.dataDidSet([prevData,data])},namespace:function namespace(context){return context.metaInf().namespace}}];function helper_slicedToArray(arr,i){return function helper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function helper_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function helper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var getPreviousStyle=function getPreviousStyle(meta,interactionType){var originalStyle=meta.originalStyle,currentState=meta.currentState,stylesForCurrentLevel=Object.assign({},originalStyle);return currentState.size>0&&(interactionType=function getLastItemInMap(map){return Array.from(map)[map.size-1]}(currentState)[0],stylesForCurrentLevel=currentState.get(interactionType)||{}),stylesForCurrentLevel},strokeProps={"stroke-width":1,stroke:1,"stroke-opacity":1},parseStyle=function parseStyle(value,_ref,apply){var datum=_ref.datum,datumStyle=_ref.datumStyle;if("function"==typeof value){if(isNaN(datumStyle))value=value(datumStyle.replace(/[^\d,.]/g,"").split(",").map(function(s){return Number(s)}),datum,apply);else value=value(parseFloat(datumStyle,10),datum,apply);return value}return value},helper_applyStylesOnInteraction=function applyStylesOnInteraction(context,elem,interactionType,conf,options){var datum,mountPoint=options.mountPoint,apply=options.apply,reset=options.reset,d=elem.data()[0],_datum$meta=(datum=Array.isArray(d)?d[0]:Array.isArray(d.data)?d.data[0]:d).meta,currentState=_datum$meta.currentState,originalStyle=_datum$meta.originalStyle,applicableStyles={},styles=conf.style,strokePosition=conf.strokePosition,applicableStrokePos=strokePosition;reset&&currentState.clear();var applyStyle=!0;if(apply){var sanitizedStyles={styles:{},strokePosition:strokePosition};for(var type in styles){var parsedStyleVal=parseStyle(styles[type],{datum:datum,datumStyle:elem.style(type)},apply);sanitizedStyles.styles[type]=parsedStyleVal}currentState.set(interactionType,sanitizedStyles),applicableStyles=sanitizedStyles.styles}else if(currentState.has(interactionType)||reset){currentState.delete(interactionType);var currentStyle=getPreviousStyle(datum.meta,interactionType);applicableStyles=Object.assign({},originalStyle.styles,currentStyle.styles),applicableStrokePos=currentStyle.strokePosition||originalStyle.strokePosition}else applyStyle=!1;var styleKeys=Object.keys(applicableStyles),_partition2=helper_slicedToArray(partition(styleKeys,function(v){return v in strokeProps}),2),strokeStyles=_partition2[0],otherStyles=_partition2[1];applyStyle&&context.applyStyles({strokeStyles:strokeStyles,otherStyles:otherStyles,styleObj:applicableStyles,elem:elem,datum:datum,applicableStrokePos:applicableStrokePos,mountPoint:mountPoint})};function base_mixin_typeof(obj){"@babel/helpers - typeof";return(base_mixin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _construct(Parent,args,Class){return(_construct=function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&base_mixin_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function base_mixin_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function base_mixin_slicedToArray(arr,i){return function base_mixin_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function base_mixin_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function base_mixin_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function base_mixin_toConsumableArray(arr){return function base_mixin_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function base_mixin_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function base_mixin_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function base_mixin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function base_mixin_getPrototypeOf(o){return(base_mixin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function base_mixin_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function base_mixin_setPrototypeOf(o,p){return(base_mixin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var layerNs=[namespace_namespaceObject.LAYER_GLOBAL_NAMESPACE,namespace_namespaceObject.LAYER_LOCAL_NAMESPACE],groupNs=namespace_namespaceObject.GROUP_GLOBAL_NAMESPACE,base_mixin_BaseLayerMixin=function BaseLayerMixin(superclass){return function(_superclass){function _class(){var _this;return function base_mixin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class),_this=function base_mixin_possibleConstructorReturn(self,call){return!call||"object"!==base_mixin_typeof(call)&&"function"!=typeof call?base_mixin_assertThisInitialized(self):call}(this,base_mixin_getPrototypeOf(_class).call(this)),generateGetterSetters(base_mixin_assertThisInitialized(_this),_this.constructor.getterSetters()),_this.axes({}),_this.alias(_this.constructor.formalName()+getUniqueId()),_this._points=[],_this._cachedData=[],_this._id=getUniqueId(),_this._measurement={},_this._animationDonePromises=[],_this._graphicElems={},_this._customConfig=null,_this}return function base_mixin_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&base_mixin_setPrototypeOf(subClass,superClass)}(_class,superclass),function base_mixin_createClass(Constructor,protoProps,staticProps){return protoProps&&base_mixin_defineProperties(Constructor.prototype,protoProps),staticProps&&base_mixin_defineProperties(Constructor,staticProps),Constructor}(_class,[{key:"store",value:function store(){if(arguments.length){var store=this._store=arguments.length<=0?void 0:arguments[0],namespace=this.metaInf().namespace;return store.addSubNamespace(namespace,BASE_LAYER,this),store_transactor(this,this.constructor.localOptions(),store,{subNamespace:namespace,namespace:"".concat(namespace_namespaceObject.LAYER_LOCAL_NAMESPACE)}),this}return this._store}},{key:"domain",value:function domain(){var prop="".concat(namespace_namespaceObject.LAYER_GLOBAL_NAMESPACE,".").concat(DOMAIN),store=this.store();if(arguments.length){var _this$metaInf2=this.metaInf(),parentNamespace=_this$metaInf2.parentNamespace,namespace=_this$metaInf2.namespace,domain=defaultValue(store.get(prop,parentNamespace),{});return domain[namespace]=arguments.length<=0?void 0:arguments[0],this.store().commit(prop,domain,parentNamespace),this}return this.store().get(prop,this.metaInf().namespace)}},{key:"alias",value:function alias(){return arguments.length?(this._alias=arguments.length<=0?void 0:arguments[0],this):this._alias||this.constructor.formalName()}},{key:"enableCaching",value:function enableCaching(){return this._cacheEnabled=!0,this}},{key:"clearCaching",value:function clearCaching(){return this._cacheEnabled=!1,this.data(this._cachedData[0])}},{key:"serialize",value:function serialize(){return this.config()}},{key:"id",value:function id(){return this._id}},{key:"getTransformedData",value:function getTransformedData(dataModel,config,transformType,encodingFieldsInf){return helpers_transformData(dataModel,config,transformType,encodingFieldsInf)}},{key:"calculateDomainFromData",value:function calculateDomainFromData(data){var domains={};return this.data().isEmpty()||(domains=domainCalculator[this.coord()](data,this)),domains}},{key:"getDataDomain",value:function getDataDomain(encodingType){var _this$metaInf3=this.metaInf(),parentNamespace=_this$metaInf3.parentNamespace,namespace=_this$metaInf3.namespace,domains=getObjProp(this.store().get("".concat(namespace_namespaceObject.LAYER_GLOBAL_NAMESPACE,".").concat(DOMAIN),parentNamespace),namespace);return void 0!==encodingType?domains[encodingType]||[]:domains}},{key:"getUidsFromPayload",value:function getUidsFromPayload(_ref,targetData){var model=_ref.model,uids=_ref.uids,uidsArr=uids,dm=model;if(targetData){var targetFields=targetData[0],payloadMap=targetData.slice(1,targetData.length).reduce(function(acc,v){return acc[v]=v,acc},{}),measures=Object.keys(this.data().getFieldspace().getMeasure()),dmUids=(dm=model.select(function(fields){return"".concat(targetFields.map(function(field){var val;if(field===reserved_fields.MEASURE_NAMES)val=measures;else if(field===reserved_fields.ROW_ID)val=fields[reserved_fields.ROW_ID];else{var currentField=fields[field];val=currentField instanceof src_InvalidAwareTypes?currentField.value():(currentField||{}).internalValue}return val}))in payloadMap},{saveChild:!1})).getUids();uidsArr=uids.filter(function(d){return dmUids.find(function(id){return"".concat(id)==="".concat(d[0])})})}return{model:dm,uids:uidsArr,length:uidsArr.length}}},{key:"getNormalizedData",value:function getNormalizedData(transformedData){return helpers_getNormalizedData(transformedData,this)}},{key:"getNearestPoint",value:function getNearestPoint(){return null}},{key:"applyInteractionStyle",value:function applyInteractionStyle(interactionType,selectionSet,options){var interactionConfig=this.config().interaction||{},apply=options.apply,styles=options.styles,reset=options.reset,interactionStyles=interactionConfig[interactionType];(interactionStyles=styles||interactionStyles)&&helpers_applyInteractionStyle(this,selectionSet,interactionStyles,{apply:apply,interactionType:interactionType,reset:reset})}},{key:"resolveTransformType",value:function resolveTransformType(){this._transformType=getValidTransform(this)}},{key:"transformType",value:function transformType(){return this._transformType}},{key:"render",value:function render(){return this}},{key:"elemType",value:function elemType(){return"g"}},{key:"remove",value:function remove(){var _this$metaInf4=this.metaInf(),namespace=_this$metaInf4.namespace,parentNamespace=_this$metaInf4.parentNamespace,store=this.store();store.removeSubNamespace(namespace,BASE_LAYER);var unitDom=store.get("".concat(namespace_namespaceObject.LAYER_GLOBAL_NAMESPACE,".domain"))[parentNamespace];return unitDom&&delete unitDom[namespace],renderer_utils_selectElement(this.mount()).remove(),this}},{key:"cachePoint",value:function cachePoint(key,data){if(null===key)return this;var pointMap=this._pointMap;return!pointMap[key]&&(pointMap[key]=[]),pointMap[key].push(data),this}},{key:"getInteractionStyles",value:function getInteractionStyles(){return helper_applyStylesOnInteraction}},{key:"addOverlayPath",value:function addOverlayPath(){return null}},{key:"removeOverlayPath",value:function removeOverlayPath(){return null}},{key:"applyLayerStyle",value:function applyLayerStyle(elem,interactionType,style,options){return this.getInteractionStyles()(this,elem,interactionType,style,options)}},{key:"getIdentifiersFromData",value:function getIdentifiersFromData(data,rowId){var schema=this.data().getSchema(),fieldsConfig=this.data().getFieldsConfig(),identifiers=[[],[]],allMeasures=schema.every(function(field){return field.type===dist_datamodel.FieldType.MEASURE});schema.forEach(function(d,i){var name=d.name;fieldsConfig[name].def.type===dist_datamodel.FieldType.DIMENSION&&(identifiers[0].push(name),identifiers[1].push(data[i]))});var _identifiers$,_identifiers$2,measures=schema.filter(function(d){return d.type===dist_datamodel.FieldType.MEASURE}).map(function(d){return d.name});allMeasures&&((_identifiers$=identifiers[0]).push.apply(_identifiers$,[reserved_fields.ROW_ID]),(_identifiers$2=identifiers[1]).push.apply(_identifiers$2,[rowId]));return measures.length&&(identifiers[0].push(reserved_fields.MEASURE_NAMES),identifiers[1].push(measures.join())),identifiers}},{key:"hasPlotSpan",value:function hasPlotSpan(){return!1}},{key:"getPlotSpan",value:function getPlotSpan(){return{x:0,y:0}}},{key:"getPlotPadding",value:function getPlotPadding(){return{x:0,y:0}}},{key:"getPointsFromIdentifiers",value:function getPointsFromIdentifiers(identifiers){var _ref2,fieldNames,values,config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},getAllAttrs=config.getAllAttrs,getBBox=config.getBBox;if(!this.data())return[];if(identifiers instanceof datamodel_default.a){var dataObj=identifiers.getData();fieldNames=dataObj.schema.map(function(d){return d.name}),values=dataObj.data}else fieldNames=identifiers[0],values=identifiers.slice(1,identifiers.length);var points=this._points,fieldsConfig=this.data().getFieldsConfig(),filteredPoints=(_ref2=[]).concat.apply(_ref2,base_mixin_toConsumableArray(points)).filter(function(point){var source=point.source,rowId=point.rowId;return fieldNames.every(function(field,idx){return field in fieldsConfig&&fieldsConfig[field].def.type===dist_datamodel.FieldType.DIMENSION?-1!==values.findIndex(function(d){return d[idx]===source[fieldsConfig[field].index]}):field!==reserved_fields.ROW_ID||-1!==values.findIndex(function(d){return d[idx]===rowId})})});return getAllAttrs?filteredPoints:filteredPoints.map(function(d){var obj=clone(d);if(getBBox){var update=obj.update||obj;if(void 0!==obj.size){var sizeVal=2*Math.sqrt(obj.size/Math.PI);update.width=sizeVal,update.height=sizeVal,update.x-=sizeVal/2,update.y-=sizeVal/2}else void 0===update.width&&(update.width=2),void 0===update.height&&(update.height=2)}return obj.update||obj}).sort(function(a,b){return a.y-b.y})}},{key:"getTransformedDataFromIdentifiers",value:function getTransformedDataFromIdentifiers(identifiers){var measureIndex,enc,idx=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,_identifiers$getData=identifiers.getData(),identifierData=_identifiers$getData.data,identifierSchema=_identifiers$getData.schema,normalizedData=this._normalizedData,fieldsConfig=this.data().getFieldsConfig(),_this$encodingFieldsI=this.encodingFieldsInf(),yField=_this$encodingFieldsI.yField,xField=_this$encodingFieldsI.xField,yFieldType=_this$encodingFieldsI.yFieldType;if(_this$encodingFieldsI.xFieldType===dist_datamodel.FieldType.MEASURE)measureIndex=fieldsConfig[xField].index,enc="x";else if(yFieldType===dist_datamodel.FieldType.MEASURE){var layerName=this.constructor.formalName();measureIndex=fieldsConfig[yField].index,enc="y",layerName===AREA_LAYER&&(enc=idx%2==0?"y":"y0")}var transformedData=[];return normalizedData.forEach(function(dataArr){dataArr.forEach(function(dataObj){var tupleArr=dataObj.source;if(identifierSchema.every(function(obj,i){return-1!==identifierData.findIndex(function(d){return tupleArr[fieldsConfig[obj.name].index]===d[i]})})){var transformedVal=dataObj[enc]||0,row=dataObj.source,tuple={};for(var key in fieldsConfig){var index=fieldsConfig[key].index;tuple[key]=row[index],index===measureIndex&&(tuple[key]=transformedVal)}transformedData.push(tuple)}})}),[transformedData,this.data().getSchema()]}},{key:"getPlotElementsFromSet",value:function getPlotElementsFromSet(set){for(var graphicElems=this._graphicElems,elems=[],i=0,len=set.length;i<len;i++){var elem=graphicElems[set[i]];elem&&elems.push(elem)}return elems}},{key:"animationDone",value:function animationDone(){return Promise.all(this._animationDonePromises)}},{key:"registerAnimationDoneHook",value:function registerAnimationDoneHook(){var resolveFn,promise=new Promise(function(resolve){resolveFn=resolve});return this._animationDonePromises.push(promise),function(){resolveFn()}}},{key:"dataDidSet",value:function dataDidSet(_ref3){var data=base_mixin_slicedToArray(_ref3,2)[1],config=this.config();if(data&&config){this._cacheEnabled?this._cachedData.push(data):this._cachedData=[data];var encodingValue=config.encoding;if(encodingValue){var fieldsConfig=data.getFieldsConfig(),encodingFieldsInf=this.retrieveEncodingFields(encodingValue,this.coord(),data);if(this.encodingFieldsInf(encodingFieldsInf),this.resolveTransformType(),this._transformedData=this.getTransformedData(data,config,this.transformType(),encodingFieldsInf),this._normalizedData=this.getNormalizedData(this._transformedData,fieldsConfig),!1!==config.calculateDomain){var domain=this.calculateDomainFromData(this._normalizedData,this.encodingFieldsInf(),this.data().getFieldsConfig());this.domain(domain)}}}return this}},{key:"retrieveEncodingFields",value:function retrieveEncodingFields(encoding,coord,data){var fieldsConfig=data.getFieldsConfig();return encodingFieldInfRetriever[coord](encoding,fieldsConfig)}},{key:"applyStyles",value:function applyStyles(_ref5){var _this2=this,strokeStyles=_ref5.strokeStyles,otherStyles=_ref5.otherStyles,styleObj=_ref5.styleObj,elem=_ref5.elem,mountPoint=_ref5.mountPoint,applicableStrokePos=_ref5.applicableStrokePos,datum=_ref5.datum;strokeStyles.forEach(function(type){_this2.addOverlayPath(elem.node(),datum,{type:type,value:styleObj[type]},applicableStrokePos,mountPoint)}),this.applyElementStyles(elem,otherStyles,styleObj)}},{key:"applyElementStyles",value:function applyElementStyles(elem,styles,styleObj){styles.forEach(function(type){elem.style(type,styleObj[type])})}},{key:"getBoundBoxes",value:function getBoundBoxes(){return null}}],[{key:"getState",value:function getState(){return[{domain:null},Object.keys(this.localOptions()).reduce(function(acc,v){return acc[v]=local_options_localOptions[v].value,acc},{})]}},{key:"getListeners",value:function getListeners(){return{store:[].concat(base_mixin_toConsumableArray(listenerMap),[{type:"registerChangeListener",props:this.getRenderProps(),listener:function listener(context){helpers_renderLayer(context)},subNamespace:function subNamespace(context){var _ref6,_context$metaInf=context.metaInf(),unitRowIndex=_context$metaInf.unitRowIndex,unitColIndex=_context$metaInf.unitColIndex,namespace=_context$metaInf.namespace;return base_mixin_defineProperty(_ref6={},"".concat(layerNs[1],".").concat(DATA),namespace),base_mixin_defineProperty(_ref6,"".concat(groupNs,".domain.x"),"".concat(unitColIndex,"0")),base_mixin_defineProperty(_ref6,"".concat(groupNs,".domain.y"),"".concat(unitRowIndex,"0")),base_mixin_defineProperty(_ref6,"".concat(groupNs,".domain.radius"),"".concat(unitRowIndex,"-").concat(unitColIndex)),_ref6}}]),throwback:[]}}},{key:"getQualifiedStateProps",value:function getQualifiedStateProps(){return this.getState().map(function(state,i){return Object.keys(state).map(function(prop){return"".concat(layerNs[i],".").concat(prop)})})}},{key:"create",value:function create(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return _construct(this,params)}},{key:"defaultConfig",value:function defaultConfig(){return{transform:{type:"identity"}}}},{key:"getterSetters",value:function getterSetters(){return props_props}},{key:"localOptions",value:function localOptions(){return local_options_localOptions}},{key:"defaultPolicy",value:function defaultPolicy(conf,userConf){return mergeRecursive(conf,userConf)}},{key:"shouldDrawAnchors",value:function shouldDrawAnchors(){return!1}},{key:"getRenderProps",value:function getRenderProps(){return["".concat(layerNs[1],".").concat(DATA)].concat(base_mixin_toConsumableArray(["x","y","radius"].map(function(type){return"".concat(groupNs,".domain.").concat(type)})))}}]),_class}()};function base_layer_typeof(obj){"@babel/helpers - typeof";return(base_layer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function base_layer_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function base_layer_possibleConstructorReturn(self,call){return!call||"object"!==base_layer_typeof(call)&&"function"!=typeof call?function base_layer_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function base_layer_getPrototypeOf(o){return(base_layer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function base_layer_setPrototypeOf(o,p){return(base_layer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var base_layer_BaseLayer=function(_mix$with){function BaseLayer(){return function base_layer_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BaseLayer),base_layer_possibleConstructorReturn(this,base_layer_getPrototypeOf(BaseLayer).apply(this,arguments))}return function base_layer_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&base_layer_setPrototypeOf(subClass,superClass)}(BaseLayer,mix(simple_layer_SimpleLayer)["with"](base_mixin_BaseLayerMixin)),function base_layer_createClass(Constructor,protoProps,staticProps){return protoProps&&base_layer_defineProperties(Constructor.prototype,protoProps),staticProps&&base_layer_defineProperties(Constructor,staticProps),Constructor}(BaseLayer,null,[{key:"formalName",value:function formalName(){return BASE_LAYER}}]),BaseLayer}(),renderer_line=Symbols.line,renderer_filterFn=function filterFn(d){var update=d.update;return null!==update.y&&null!==update.x},containsNull=function containsNull(elem){var _ref=elem?elem.update:{},x=_ref.x,y=_ref.y;return null===x||null===y},getborderIndexes=function getborderIndexes(arr){var indexes={prevOfNull:[],nextOfNull:[]};return arr.forEach(function(value,index){var update=value.update;null!==update.y&&null!==update.x||function settIndexPrevOrNext(arr,index,indexesObj){var prevContainsNull=containsNull(arr[index-1]),nextContainsNull=containsNull(arr[index+1]);!prevContainsNull&&indexesObj.prevOfNull.push(index-1),!nextContainsNull&&indexesObj.nextOfNull.push(index+1)}(arr,index,indexes)}),indexes},renderer_getElementsForLine=function getElementsForLine(params){var mount=params.mount,data=params.data,className=params.className,layer=params.layer,strokeStyle=params.strokeStyle,linepath=params.linepath,transition=params.transition,updateFns=params.updateFns,element=makeElement(mount,"path",data.length?[data]:[],className,updateFns);return element.attr("class",function(d,i){return d[i].className}),renderer_utils_setStyles(element,strokeStyle),transition.disabled||(element=element.transition().duration(transition.duration).on("end",layer.registerAnimationDoneHook())),element.attr("d",linepath(data)).style("fill-opacity",0),element},renderer_drawLine=function drawLine(context){var layer=context.layer,container=context.container,points=context.points,interpolate=context.interpolate,connectNullData=context.connectNullData,className=context.className,style=context.style,transition=context.transition,containerSelection=renderer_utils_selectElement(container),strokeStyle=layer.config().nullDataLineStyle,nullDataLineClass=layer.config().nullDataLineClass,mount=containerSelection.attr("class",className),curveInterpolatorFn=pathInterpolators[interpolate],linepath=renderer_line().curve(curveInterpolatorFn).x(function(d){return d.update.x}).y(function(d){return d.update.y}).defined(renderer_filterFn),graphicElems=layer._graphicElems,updateFns={update:function update(group,d){d.forEach(function(dd){graphicElems[dd.rowId]=containerSelection})}};helpers_updateStyle(mount,style);var elementWithNullData=renderer_getElementsForLine({mount:mount,data:points,strokeStyle:void 0,layer:layer,linepath:linepath,transition:transition,updateFns:updateFns});return function sanitizeNullConfig(arr){return function makeStartEndPair(arr,borderIndexes){var pairArray=[],prevOfNull=borderIndexes.prevOfNull,nextOfNull=borderIndexes.nextOfNull,length=prevOfNull.length;if(!length)return pairArray;for(var i=0;i<length;i++){var pair=[],prevValue=arr[prevOfNull[i]],nextValue=arr[nextOfNull[i]];prevValue&&pair.push(prevValue),nextValue&&pair.push(nextValue),pairArray.push(pair)}return pairArray}(arr,getborderIndexes(arr))}(points).map(function(d){return connectNullData&&d.length>1&&renderer_getElementsForLine({mount:mount,data:d,strokeStyle:strokeStyle,className:".".concat(className,"-").concat(nullDataLineClass),layer:layer,linepath:linepath,transition:transition,updateFns:updateFns}),null}),elementWithNullData},line_default_config_defaultConfig={classPrefix:CLASSPREFIX,defClassName:"layer-line",className:"",interpolate:"linear",transform:{type:"group"},interaction:{fade:{style:{stroke:function stroke(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.5},data,apply).color}}},focus:{style:{stroke:function stroke(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.5},data,apply).color}}},brushStroke:{style:{stroke:function stroke(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.5},data,apply).color}}}},crossline:!0,nearestPointThreshold:20,encoding:{color:{},x:{},y:{},strokeOpacity:{value:1},fillOpacity:{value:0},strokeWidth:{value:"2px"}},transition:{effect:"cubic",duration:1e3},connectNullData:!1,nullDataLineStyle:{},nullDataLineClass:"null"};__webpack_require__(21);function line_mixin_typeof(obj){"@babel/helpers - typeof";return(line_mixin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function line_mixin_toConsumableArray(arr){return function line_mixin_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function line_mixin_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function line_mixin_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function line_mixin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function line_mixin_possibleConstructorReturn(self,call){return!call||"object"!==line_mixin_typeof(call)&&"function"!=typeof call?function line_mixin_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function line_mixin_get(target,property,receiver){return(line_mixin_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function line_mixin_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=line_mixin_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function line_mixin_getPrototypeOf(o){return(line_mixin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function line_mixin_setPrototypeOf(o,p){return(line_mixin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var line_mixin_LineLayerMixin=function LineLayerMixin(superclass){return function(_superclass){function _class(){var _getPrototypeOf2,_this;!function line_mixin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=line_mixin_possibleConstructorReturn(this,(_getPrototypeOf2=line_mixin_getPrototypeOf(_class)).call.apply(_getPrototypeOf2,[this].concat(args))))._voronoi=new common_utils_Voronoi,_this}return function line_mixin_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&line_mixin_setPrototypeOf(subClass,superClass)}(_class,superclass),function line_mixin_createClass(Constructor,protoProps,staticProps){return protoProps&&line_mixin_defineProperties(Constructor.prototype,protoProps),staticProps&&line_mixin_defineProperties(Constructor,staticProps),Constructor}(_class,[{key:"elemType",value:function elemType(){return"path"}},{key:"getDrawFn",value:function getDrawFn(){return renderer_drawLine}},{key:"translatePoints",value:function translatePoints(data){var _this2=this,points=[],axes=this.axes(),encoding=this.config().encoding,xAxis=axes.x,yAxis=axes.y,colorAxis=axes.color,_this$encodingFieldsI=this.encodingFieldsInf(),xFieldType=_this$encodingFieldsI.xFieldType,yFieldType=_this$encodingFieldsI.yFieldType,isXDim=xFieldType===dist_datamodel.FieldType.DIMENSION,isYDim=yFieldType===dist_datamodel.FieldType.DIMENSION,key=isXDim?ENCODING.X:isYDim?ENCODING.Y:null;return sortData(data,axes),points=data.map(function(d,i){var xPx=xAxis.getScaleValue(d.x)+xAxis.getUnitWidth()/2,yPx=yAxis.getScaleValue(d.y)+yAxis.getUnitWidth()/2,color=colorAxis.getColor(d.color),resolvedEncodings=helpers_resolveEncodingValues({values:{x:xPx,y:yPx,color:color},data:d},i,data,_this2),style={stroke:resolvedEncodings.color,"fill-opacity":encoding.fillOpacity.value,"stroke-width":encoding.strokeWidth.value},point={enter:{},update:{x:d.x instanceof src_InvalidAwareTypes?null:resolvedEncodings.x,y:d.y instanceof src_InvalidAwareTypes?null:resolvedEncodings.y},style:style,rowId:d.rowId,source:d.source,data:d.dataObj,meta:getColorMetaInf(style)};return point.className=getIndividualClassName(d,i,data,_this2),_this2.cachePoint(d[key],point),point}),points=(points=positionPoints(this,points)).filter(function(point){var update=point.update;return!isNaN(update.x)&&!isNaN(update.y)})}},{key:"getTranslatedData",value:function getTranslatedData(normalizedData,colorValFn,colorFieldIndex,axes){var _this3=this;return normalizedData.map(function(data,i){var color,colorVal=data.find(function(d){return null!==d.source[colorFieldIndex]&&void 0!==d.source[colorFieldIndex]});return color=colorValFn?colorValFn(data,i,normalizedData):axes.color.getColor(colorVal&&colorVal.source[colorFieldIndex]),{data:_this3.translatePoints(data),style:_this3.getPathStyle(color)}})}},{key:"render",value:function render(container){var _this4=this,config=this.config(),encoding=config.encoding,interpolate=config.interpolate,className=config.className,defClassName=config.defClassName,transition=config.transition,normalizedData=this._normalizedData,transformedData=this._transformedData,fieldsConfig=this.data().getFieldsConfig(),axes=this.axes(),keys=transformedData.map(function(d){return d.key}),qualifiedClassName=getQualifiedClassName(defClassName,this.id(),config.classPrefix),containerSelection=renderer_utils_selectElement(container),colorField=encoding.color.field,colorFieldIndex=fieldsConfig[colorField]&&fieldsConfig[colorField].index;this._points=[],this._pointMap={},containerSelection.attr("class","".concat(qualifiedClassName.join(" ")," ").concat(className));var colorValFn=encoding.color.value,translatedPoints=this.getTranslatedData(normalizedData,colorValFn,colorFieldIndex,axes);return makeElement(container,"g",translatedPoints,null,{enter:function enter(group){helpers_animateGroup(group,{transition:transition,groupAnimateStyle:{enter:{"stroke-opacity":0,"fill-opacity":_this4.getPathStyle()["fill-opacity"]},update:{"stroke-opacity":encoding.strokeOpacity.value}}})},update:function update(group,dataArr,i){var points=dataArr.data,seriesClassName="".concat(qualifiedClassName[0],"-").concat(keys[i]||i).toLowerCase(),style=dataArr.style;_this4._points.push(points),_this4.getDrawFn()({layer:_this4,container:group.node(),interpolate:interpolate,points:points,className:seriesClassName,transition:transition,style:style||{},connectNullData:config.connectNullData})}},function(d){return d.data[0].source[colorFieldIndex]||d.data[0].rowId}),helpers_attachDataToVoronoi(this._voronoi,this._points),this}},{key:"getPathStyle",value:function getPathStyle(color){return{stroke:color,"fill-opacity":"0"}}},{key:"getNearestPoint",value:function getNearestPoint(x,y,config){var searchRadius=config.searchRadius,data=this.data();if(!data||data&&data.isEmpty())return null;searchRadius=void 0!==searchRadius?searchRadius:this.config().nearestPointThreshold;var point=this._voronoi.find(x,y,searchRadius),dimensions=getObjProp(point,"data","data","update");if(point){var _point$data$data=point.data.data,source=_point$data$data.source,rowId=_point$data$data.rowId;return{id:this.getIdentifiersFromData(source,rowId),dimensions:[{x:dimensions.x,y:dimensions.y,width:2,height:2}],layerId:this.id()}}return null}},{key:"applyStyles",value:function applyStyles(_ref){var strokeStyles=_ref.strokeStyles,otherStyles=_ref.otherStyles,styleObj=_ref.styleObj,elem=_ref.elem;[].concat(line_mixin_toConsumableArray(otherStyles),line_mixin_toConsumableArray(strokeStyles)).forEach(function(type){elem.style(type,styleObj[type])})}},{key:"getBoundBoxes",value:function getBoundBoxes(){return helpers_getBoundBoxes(this._points.flat())}}],[{key:"formalName",value:function formalName(){return"line"}},{key:"defaultConfig",value:function defaultConfig(){return line_default_config_defaultConfig}},{key:"defaultPolicy",value:function defaultPolicy(conf,userConf){var config=line_mixin_get(line_mixin_getPrototypeOf(_class),"defaultPolicy",this).call(this,conf,userConf),encoding=config.encoding,transform=config.transform,colorField=encoding.color&&encoding.color.field;return colorField&&!transform.groupBy&&(transform.groupBy=colorField),config}},{key:"shouldDrawAnchors",value:function shouldDrawAnchors(){return!0}}]),_class}()},area_default_config_defaultConfig={classPrefix:CLASSPREFIX,defClassName:"layer-area",className:"",interpolate:"linear",transform:{type:STACK},interaction:{fade:{style:{"fill-opacity":.7}},focus:{style:{"fill-opacity":.7}},brushStroke:{style:{"fill-opacity":.7}}},crossline:!0,nearestPointThreshold:10,encoding:{color:{},x:{},y:{},y0:{},strokeOpacity:{value:1},fillOpacity:{value:.3}},transition:{effect:"cubic",duration:1e3},connectNullData:!1};function renderer_slicedToArray(arr,i){return function renderer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function renderer_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function renderer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var renderer_area=Symbols.area,area_renderer=function drawArea(params){var layer=params.layer,container=params.container,style=params.style,points=params.points,transition=params.transition,className=params.className,interpolate=params.interpolate,connectNullData=params.connectNullData,graphicElems=layer._graphicElems,easeEffect=transition.effect,duration=transition.duration,mount=renderer_utils_selectElement(container),curveInterpolatorFn=pathInterpolators[interpolate],selection=mount.selectAll("path").data(points.length?[points]:[]),_map2=renderer_slicedToArray(["enter","update"].map(function(e){return renderer_area().curve(curveInterpolatorFn).x(function(d){return d[e].x}).y1(function(d){return d[e].y}).y0(function(d){return d[e].y0}).defined(function(d){return null!==d[e].y})}),2),enterAreaPath=_map2[0],updateAreaPath=_map2[1];mount.attr("class",className);var filteredPoints=points;connectNullData&&(filteredPoints=filteredPoints.filter(function(d){return null!==d.update.y}));var selectionEnter=selection.enter().append("path").attr("d",enterAreaPath(filteredPoints)).each(function(d){d.forEach(function(dd){null!==dd.rowId&&(graphicElems[dd.rowId]=mount.select("path"))})});selection.merge(selectionEnter).transition().ease(easeFns[easeEffect]).duration(duration).on("end",layer.registerAnimationDoneHook()).attr("d",updateAreaPath(filteredPoints)).each(function(){var element=renderer_utils_selectElement(this);Object.keys(style).forEach(function(key){return element.style(key,style[key])})})};__webpack_require__(22);function area_mixin_typeof(obj){"@babel/helpers - typeof";return(area_mixin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function area_mixin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function area_mixin_possibleConstructorReturn(self,call){return!call||"object"!==area_mixin_typeof(call)&&"function"!=typeof call?function area_mixin_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function area_mixin_get(target,property,receiver){return(area_mixin_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function area_mixin_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=area_mixin_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function area_mixin_getPrototypeOf(o){return(area_mixin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function area_mixin_setPrototypeOf(o,p){return(area_mixin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var area_mixin_AreaLayerMixin=function AreaLayerMixin(superclass){return function(_superclass){function _class(){return function area_mixin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class),area_mixin_possibleConstructorReturn(this,area_mixin_getPrototypeOf(_class).apply(this,arguments))}return function area_mixin_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&area_mixin_setPrototypeOf(subClass,superClass)}(_class,superclass),function area_mixin_createClass(Constructor,protoProps,staticProps){return protoProps&&area_mixin_defineProperties(Constructor.prototype,protoProps),staticProps&&area_mixin_defineProperties(Constructor,staticProps),Constructor}(_class,[{key:"calculateDomainFromData",value:function calculateDomainFromData(data,encodingFieldsInf,fieldsConfig){var domains=area_mixin_get(area_mixin_getPrototypeOf(_class.prototype),"calculateDomainFromData",this).call(this,data,fieldsConfig);return[ENCODING.X,ENCODING.Y].forEach(function(type){encodingFieldsInf["".concat(type,"FieldType")]===dist_datamodel.FieldType.MEASURE&&getObjProp(domains[type],"length")&&(domains[type][0]=Math.min(domains[type][0],0),domains[type][1]=Math.max(0,domains[type][1]))}),domains}},{key:"getDrawFn",value:function getDrawFn(){return area_renderer}},{key:"getNearestPoint",value:function getNearestPoint(x,y,config){var searchRadius=config.searchRadius,data=this.data();if(!data||data&&data.isEmpty())return null;searchRadius=void 0!==searchRadius?searchRadius:this.config().nearestPointThreshold;var index,point=this._voronoi.find(x,y,searchRadius),nearestPoint=null;if(!point&&config.dimValue&&this._pointMap){for(var pointArr=this._pointMap[config.dimValue[1][0]]||[],i=0,len=pointArr.length;i<len;i++){var _pointArr$i$update=pointArr[i].update,pointY=_pointArr$i$update.y,pointY0=_pointArr$i$update.y0;if(pointY<y&&y<pointY0){index=i,nearestPoint=pointArr[i];break}}void 0!==index&&(point={index:index,data:{x:x,y:y,data:nearestPoint}})}var dimensions=getObjProp(point,"data","data","update");if(point){var _point$data$data=point.data.data,source=_point$data$data.source,rowId=_point$data$data.rowId;return{id:this.getIdentifiersFromData(source,rowId),dimensions:[{x:dimensions.x,y0:dimensions.y0,y:dimensions.y,width:2,height:2}],layerId:this.id()}}return null}},{key:"translatePoints",value:function translatePoints(data){var _this=this,points=[],transformType=this.transformType(),axes=this.axes(),colorAxis=axes.color,config=this.config(),encoding=config.encoding,fieldsConfig=this.data().getFieldsConfig(),_this$encodingFieldsI=this.encodingFieldsInf(),xField=_this$encodingFieldsI.xField,yField=_this$encodingFieldsI.yField,y0Field=_this$encodingFieldsI.y0Field,xAxis=axes.x,yAxis=axes.y,classNameFn=config.individualClassName,isXDim=fieldsConfig[xField]&&fieldsConfig[xField].def.type===dist_datamodel.FieldType.DIMENSION,isYDim=fieldsConfig[yField]&&fieldsConfig[yField].def.type===dist_datamodel.FieldType.DIMENSION,key=isXDim?"x":isYDim?"y":null,minYVal=yAxis.domain()[0],basePos=minYVal<0?yAxis.getScaleValue(0):yAxis.getScaleValue(minYVal);return sortData(data,axes),points=data.map(function(d,i){var color,xPx=xAxis.getScaleValue(d.x)+xAxis.getUnitWidth()/2,yPx=yAxis.getScaleValue(d.y),y0Px=y0Field||transformType===STACK?yAxis.getScaleValue(d.y0):basePos;color=colorAxis.getColor(d.color);var invalidY=d.y instanceof src_InvalidAwareTypes,invalidY0=d.y0 instanceof src_InvalidAwareTypes,resolvedValues=helpers_resolveEncodingValues({values:{x:xPx,y:yPx,y0:y0Px,color:color},data:d},i,data,_this),style={fill:color=resolvedValues.color,"fill-opacity":encoding.fillOpacity.value},point={enter:{x:xPx,y:invalidY?null:basePos,y0:invalidY0?null:basePos},update:{x:xPx,y:invalidY?null:resolvedValues.y,y0:invalidY0?null:resolvedValues.y0},source:d.source,rowId:d.rowId,data:d.dataObj,className:classNameFn?classNameFn(d,i,data,_this):"",style:style,meta:getColorMetaInf(style)};return point.className=getIndividualClassName(d,i,data,_this),_this.cachePoint(d[key],point),point}),points=(points=positionPoints(this,points)).filter(function(point){var update=point.update;return!isNaN(update.x)})}},{key:"resolveTransformType",value:function resolveTransformType(){this._transformType=helpers_getValidTransformForAggFn(this)}},{key:"getPathStyle",value:function getPathStyle(color){return{fill:color,"fill-opacity":.3}}}],[{key:"defaultConfig",value:function defaultConfig(){return area_default_config_defaultConfig}}]),_class}()};function area_typeof(obj){"@babel/helpers - typeof";return(area_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function area_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function area_possibleConstructorReturn(self,call){return!call||"object"!==area_typeof(call)&&"function"!=typeof call?function area_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function area_getPrototypeOf(o){return(area_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function area_setPrototypeOf(o,p){return(area_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var area_AreaLayer=function(_mix$with){function AreaLayer(){return function area_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AreaLayer),area_possibleConstructorReturn(this,area_getPrototypeOf(AreaLayer).apply(this,arguments))}return function area_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&area_setPrototypeOf(subClass,superClass)}(AreaLayer,mix(base_layer_BaseLayer)["with"](base_mixin_BaseLayerMixin,line_mixin_LineLayerMixin,area_mixin_AreaLayerMixin)),function area_createClass(Constructor,protoProps,staticProps){return protoProps&&area_defineProperties(Constructor.prototype,protoProps),staticProps&&area_defineProperties(Constructor,staticProps),Constructor}(AreaLayer,null,[{key:"formalName",value:function formalName(){return AREA_LAYER}}]),AreaLayer}(),arc_default_config_defaultConfig={classPrefix:CLASSPREFIX,defClassName:"layer-arc",padding:{top:1,bottom:1,left:1,right:1},className:"",interaction:{highlight:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.1},data,apply).color}}},fade:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.3},data,apply).color}}},focus:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.5},data,apply).color}}}},height:100,width:100,sort:"",colors:["#F44336","blue","green","yellow","orange","purple"],transform:{type:"identity"},encoding:{"stroke-width":{value:"2px"},"stroke-linejoin":{value:"round"},angle:{value:"1"},radius:{value:"1"},opacity:{value:"1"},color:{value:"1"},shape:{value:"1"},size:{value:"1"}},transition:{effect:"cubic",duration:500},states:{highlight:{className:"".concat(CLASSPREFIX,"-layer-arc-highlight")},fadeout:{className:"".concat(CLASSPREFIX,"-layer-arc-fadeout")},selected:{className:"".concat(CLASSPREFIX,"-layer-arc-selected")}}};function arc_helper_slicedToArray(arr,i){return function arc_helper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function arc_helper_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function arc_helper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}__webpack_require__(23);function arc_mixin_typeof(obj){"@babel/helpers - typeof";return(arc_mixin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function arc_mixin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function arc_mixin_possibleConstructorReturn(self,call){return!call||"object"!==arc_mixin_typeof(call)&&"function"!=typeof call?function arc_mixin_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function arc_mixin_getPrototypeOf(o){return(arc_mixin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function arc_mixin_setPrototypeOf(o,p){return(arc_mixin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var arc_mixin_arc=Symbols.arc,arc_mixin_ArcLayerMixin=function ArcLayerMixin(superclass){return function(_superclass){function _class(data,axes,config,dependencies){var _this;return function arc_mixin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class),(_this=arc_mixin_possibleConstructorReturn(this,arc_mixin_getPrototypeOf(_class).call(this,data,axes,config,dependencies)))._prevPieData={},_this}return function arc_mixin_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&arc_mixin_setPrototypeOf(subClass,superClass)}(_class,superclass),function arc_mixin_createClass(Constructor,protoProps,staticProps){return protoProps&&arc_mixin_defineProperties(Constructor.prototype,protoProps),staticProps&&arc_mixin_defineProperties(Constructor,staticProps),Constructor}(_class,[{key:"elemType",value:function elemType(){return"path"}},{key:"getNearestPoint",value:function getNearestPoint(x,y){var config=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getDataFromEvent(config.event)}},{key:"getDataFromEvent",value:function getDataFromEvent(event){var dataPoint=renderer_utils_selectElement(event.target).data()[0];if(isSimpleObject(dataPoint)){var source=dataPoint.source,rowId=dataPoint.rowId;return{id:this.getIdentifiersFromData(source,rowId),layerId:this.id()}}return null}},{key:"translatePoints",value:function translatePoints(data){var _this2=this,_this$axes=this.axes(),angle=_this$axes.angle,colorAxis=_this$axes.color,radiusAxis=_this$axes.radius,pieIndex={},prevData=this._points[0]||[],points=[],angleV={};return this._prevPieData={},prevData.forEach(function(e,index){_this2._prevPieData[e.rowId]=[e,index],pieIndex[e.index]=e}),data.forEach(function(d,i){var angles=angle.getScaleValue(d.angle);if(angles){!angleV[d.angle]&&(angleV[d.angle]=0);var _angles=angles[angleV[d.angle]++],startAngle=_angles.startAngle,endAngle=_angles.endAngle,uid=d.rowId,resolvedEncodings=helpers_resolveEncodingValues({values:{radius:radiusAxis.getOuterRadius(d.radius),radius0:radiusAxis.getInnerRadius(d.radius0),color:colorAxis.getColor(d.color),angle0:startAngle,angle:endAngle,startAngle:startAngle,endAngle:endAngle,startAngle0:startAngle,endAngle0:endAngle},data:d},i,data,_this2),color=resolvedEncodings.color;points.push({source:d.source,index:i,enter:{},update:{angle0:resolvedEncodings.angle0,angle:resolvedEncodings.angle,radius0:resolvedEncodings.radius0,radius:resolvedEncodings.radius},color:color,meta:getColorMetaInf({fill:color}),rowId:uid,_previousInfo:_this2._prevPieData[uid]?_this2._prevPieData[uid][0]:function getPreviousPoint(prevData,currIndex,context){var prevArc=prevData[currIndex-1],nextArc=prevData[currIndex],_context$axes$angle$r2=arc_helper_slicedToArray(context.axes().angle.range(),2),startAngle=_context$axes$angle$r2[0],endAngle=_context$axes$angle$r2[1];return prevArc&&nextArc?{update:{angle0:getObjProp(prevArc,"update","angle"),angle:getObjProp(nextArc,"update","angle0")}}:nextArc?{update:{angle0:(startAngle-90)*Math.PI*2/360,angle:(startAngle-90)*Math.PI*2/360}}:{update:{angle0:(endAngle-90)*Math.PI*2/360,angle:(endAngle-90)*Math.PI*2/360}}}(pieIndex,i,_this2)})}}),points}},{key:"render",value:function render(container){var _this3=this,measurement=this.measurement(),_this$config=this.config(),classPrefix=_this$config.classPrefix,defClassName=_this$config.defClassName,cornerRadius=_this$config.cornerRadius,padAngle=_this$config.padAngle,padRadius=_this$config.padRadius,transition=_this$config.transition,qualClassName=getQualifiedClassName(defClassName,this.id(),classPrefix),path=this._arcFn=arc_mixin_arc().cornerRadius(cornerRadius).startAngle(function(d){return d.update.angle0+Math.PI/2}).endAngle(function(d){return d.update.angle+Math.PI/2}).padAngle(padAngle).padRadius(padRadius).outerRadius(function(d){return d.update.radius}).innerRadius(function(d){return d.update.radius0});this._points=this._normalizedData.map(function(arr){return _this3.translatePoints(arr)});var graphicElems=this._graphicElems={},g=makeElement(renderer_utils_selectElement(container),"g",this._points,"".concat(qualClassName[0],"-group")).classed("".concat(qualClassName[1],"-group"),!0).attr("transform","translate(".concat(measurement.width/2,",\n                    ").concat(measurement.height/2,")")),consecutiveExits=[],exitCounter=0;return makeElement(g,"g",function(d){return d},"".concat(qualClassName[0]),{update:function tween(elem){makeElement(elem,"path",function(d){return[d]},"".concat(qualClassName[0],"-path")).style("fill",function(d){return d.color}).each(function(d){graphicElems[d.rowId]=renderer_utils_selectElement(this)}).transition().duration(transition.duration).on("end",_this3.registerAnimationDoneHook()).attrTween("d",function(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return function tweenPie(path,b){var datum=b[0];return function(t){return path(common_utils_interpolator()(datum._previousInfo,datum)(t))}}(path,params)}).attr("class",function(d,i){var individualClass=getIndividualClassName(d,i,_this3._points,_this3);return"".concat(qualClassName[0],"-path ").concat(qualClassName[1],"-path-").concat(d.index,"\n                        ").concat(individualClass)})},exit:function tweenExit(elem,d){var exitArr=consecutiveExits[exitCounter],oldExitCounter=exitCounter;exitArr?exitArr[exitArr.length-1].datum.index===d.index-1?exitArr.push({elem:elem,datum:d}):exitCounter++:exitArr=[{elem:elem,datum:d}],consecutiveExits[oldExitCounter]=exitArr}}).attr("class",function(d,i){return"".concat(qualClassName[0]," ").concat(qualClassName[1],"-").concat(i)}),function tweenExitPie(consecutiveExits,transition,path){consecutiveExits.length>0&&consecutiveExits.forEach(function(consecutiveExitArr){var startAngle=consecutiveExitArr[0].datum.update.angle0,endAngle=consecutiveExitArr[consecutiveExitArr.length-1].datum.update.angle,mid=2*Math.PI*startAngle/(2*Math.PI+startAngle-endAngle);consecutiveExitArr.forEach(function(e){var elem=e.elem,datum=e.datum;elem.each(function(){var gElem=renderer_utils_selectElement(this);gElem.selectAll("path").transition().duration(transition.duration).attrTween("d",function(){return function(t){return path(common_utils_interpolator()(datum,{update:{angle0:mid,angle:mid,radius:datum.radius,radius0:datum.radius0}})(t))}}).remove(),gElem.remove()})})})}(consecutiveExits,transition,path),this}},{key:"getPointsFromIdentifiers",value:function getPointsFromIdentifiers(identifiers){if(!this.data())return[];var fieldNames=identifiers[0],values=identifiers.slice(1,identifiers.length),pieSlices=renderer_utils_selectElement(this.mount()).selectAll("path").data(),fieldsConfig=this.data().getFieldsConfig(),pieSliceInf=pieSlices.filter(function(tData){var source=tData.source,rowId=tData.rowId;return fieldNames.every(function(field,idx){return field in fieldsConfig&&fieldsConfig[field].def.type===dist_datamodel.FieldType.DIMENSION?-1!==values.findIndex(function(d){return d[idx]===source[fieldsConfig[field].index]}):field!==reserved_fields.ROW_ID||-1!==values.findIndex(function(d){return d[idx]===rowId})})})[0];if(pieSliceInf){var measurement=this.measurement(),centroid=this._arcFn.centroid(pieSliceInf);return[{x:centroid[0]+measurement.width/2,y:centroid[1]+measurement.height/2,width:2,height:2}]}return[]}}],[{key:"defaultConfig",value:function defaultConfig(){return arc_default_config_defaultConfig}},{key:"formalName",value:function formalName(){return"arc"}}]),_class}()};function arc_typeof(obj){"@babel/helpers - typeof";return(arc_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function arc_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function arc_possibleConstructorReturn(self,call){return!call||"object"!==arc_typeof(call)&&"function"!=typeof call?function arc_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function arc_getPrototypeOf(o){return(arc_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function arc_setPrototypeOf(o,p){return(arc_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var ArcLayer=function(_mix$with){function ArcLayer(){return function arc_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ArcLayer),arc_possibleConstructorReturn(this,arc_getPrototypeOf(ArcLayer).apply(this,arguments))}return function arc_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&arc_setPrototypeOf(subClass,superClass)}(ArcLayer,mix(base_layer_BaseLayer)["with"](base_mixin_BaseLayerMixin,arc_mixin_ArcLayerMixin)),function arc_createClass(Constructor,protoProps,staticProps){return protoProps&&arc_defineProperties(Constructor.prototype,protoProps),staticProps&&arc_defineProperties(Constructor,staticProps),Constructor}(ArcLayer,null,[{key:"formalName",value:function formalName(){return"arc"}}]),ArcLayer}();function line_typeof(obj){"@babel/helpers - typeof";return(line_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function line_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function line_possibleConstructorReturn(self,call){return!call||"object"!==line_typeof(call)&&"function"!=typeof call?function line_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function line_getPrototypeOf(o){return(line_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function line_setPrototypeOf(o,p){return(line_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var line_LineLayer=function(_mix$with){function LineLayer(){return function line_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LineLayer),line_possibleConstructorReturn(this,line_getPrototypeOf(LineLayer).apply(this,arguments))}return function line_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&line_setPrototypeOf(subClass,superClass)}(LineLayer,mix(base_layer_BaseLayer)["with"](base_mixin_BaseLayerMixin,line_mixin_LineLayerMixin)),function line_createClass(Constructor,protoProps,staticProps){return protoProps&&line_defineProperties(Constructor.prototype,protoProps),staticProps&&line_defineProperties(Constructor,staticProps),Constructor}(LineLayer,null,[{key:"formalName",value:function formalName(){return LINE_LAYER}}]),LineLayer}(),text_renderer=function drawText(container,data,config,layerInst){var selection=renderer_utils_selectElement(container).selectAll("g").data(data),smartLabel=layerInst._dependencies.smartLabel,graphicElems=layerInst._graphicElems,selectionMerge=selection.enter().append("g").each(function(dataObj){renderer_utils_setAttrs(this,dataObj.enter)}).merge(selection),style=renderer_utils_getSmartComputedStyle(renderer_utils_selectElement(container),config.className),fontSize=parseInt(style.fontSize,10);return smartLabel.setStyle(style),selectionMerge.each(function(dataObj){var element=renderer_utils_selectElement(this);graphicElems[dataObj.rowId]=element;var backgroundVal,update=dataObj.update,text=dataObj.text,color=dataObj.color,textanchor=dataObj.textanchor,textStyle=dataObj.style,background=dataObj.background;if(backgroundVal=background.value){var diff,backgroundPadding=background.padding,_smartLabel$getOriSiz=smartLabel.getOriSize(dataObj.text),width=_smartLabel$getOriSiz.width,height=_smartLabel$getOriSiz.height,backgroundEl=makeElement(element,"rect",[1]);diff="end"===textanchor?width:"start"===textanchor?0:width/2,renderer_utils_setAttrs(backgroundEl.node(),{x:update.x-diff-backgroundPadding/2,y:update.y-fontSize-backgroundPadding/2,width:width+backgroundPadding,height:height+backgroundPadding}),background&&renderer_utils_setStyles(backgroundEl,{background:backgroundVal})}var textEl=makeElement(element,"text",function(d){return[d]}).text(text),textNode=textEl.node();textStyle&&renderer_utils_setStyles(textNode,textStyle),color&&renderer_utils_setStyles(textNode,{fill:color}),dataObj.className&&textEl.classed(dataObj.className,!0),renderer_utils_setAttrs(textNode,update),textEl.attr("text-anchor",textanchor),textEl.attr("alignment-baseline",dataObj["alignment-baseline"]),textEl.attr("transform","rotate(".concat(dataObj.rotation," ").concat(update.x," ").concat(update.y,")"))}),selection.exit().remove(),selection},text_default_config_defaultConfig={defClassName:"layer-text",classPrefix:CLASSPREFIX,className:"",transform:{type:"identity"},interaction:{highlight:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{l:-15},data,apply).color}}},fade:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{l:15},data,apply).color}}},focus:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{l:15},data,apply).color}}}},crossline:!1,transition:{effect:"cubic",duration:1e3},encoding:{color:{},size:{},radius:{},angle:{},text:{value:"",formatter:function formatter(val,i,data,context){return context.valueParser()(val)},background:{padding:10}},rotation:{value:0},"alignment-baseline":{value:"middle"}},states:{highlight:{className:"".concat(CLASSPREFIX,"-layer-text-highlight")},fadeout:{className:"".concat(CLASSPREFIX,"-layer-text-fadeout")},selected:{className:"".concat(CLASSPREFIX,"-layer-text-selected")}}};__webpack_require__(24);function text_mixin_typeof(obj){"@babel/helpers - typeof";return(text_mixin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function text_mixin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function text_mixin_possibleConstructorReturn(self,call){return!call||"object"!==text_mixin_typeof(call)&&"function"!=typeof call?function text_mixin_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function text_mixin_getPrototypeOf(o){return(text_mixin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function text_mixin_setPrototypeOf(o,p){return(text_mixin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function text_mixin_slicedToArray(arr,i){return function text_mixin_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function text_mixin_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function text_mixin_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function text_mixin_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function text_mixin_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?text_mixin_ownKeys(Object(source),!0).forEach(function(key){text_mixin_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):text_mixin_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function text_mixin_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var defaultEncoding=text_default_config_defaultConfig.encoding,alignmentBaseLine=defaultEncoding["alignment-baseline"].value,defRotation=defaultEncoding.rotation.value,pointTranslators={polar:function polar(data,config,layerInst){for(var points=[],axes=layerInst.axes(),encoding=layerInst.config().encoding,textEncoding=encoding.text,radiusAxis=axes.radius,colorAxis=axes.color,angleAxis=axes.angle,textFormatter=textEncoding.formatter,backgroundEncoding=encoding.text.background,backgroundPadding=backgroundEncoding.padding,backgroundValue=backgroundEncoding.value,angleV={},i=0,len=data.length;i<len;i++){var d=data[i],source=d.source,text=d.text,color=colorAxis.getColor(d.color),radius=radiusAxis.getOuterRadius(d.radius),angles=angleAxis.getScaleValue(d.angle);!angleV[d.angle]&&(angleV[d.angle]=0);var _angles=angles[angleV[d.angle]++],startAngle=_angles.startAngle,endAngle=_angles.endAngle,resolvedVal=helpers_resolveEncodingValues({values:{angle:(startAngle+endAngle)/2,radius:radius,color:color,text:text,startAngle:startAngle,endAngle:endAngle,rotation:defRotation,"alignment-baseline":alignmentBaseLine},data:d},i,data,layerInst),point={enter:{},update:{angle:resolvedVal.angle,radius:resolvedVal.radius},text:textFormatter?textFormatter(text,i,data,layerInst):resolvedVal.text,color:resolvedVal.color,rotation:resolvedVal.rotation,background:{value:backgroundValue instanceof Function?backgroundValue(d,i,data,layerInst):null,padding:backgroundPadding},"alignment-baseline":resolvedVal["alignment-baseline"],meta:text_mixin_objectSpread({},{layerId:layerInst.id()},{},getColorMetaInf({fill:resolvedVal.color})),style:{},source:source,rowId:d.rowId};point.className=getIndividualClassName(d,i,data,layerInst),points.push(point)}return points=(points=toCartesianCoordinates(positionPoints(layerInst,points),layerInst.measurement())).filter(function(d){var update=d.update;return!isNaN(update.x)&&!isNaN(update.y)})},cartesian:function cartesian(data,config,layerInst){for(var points=[],axes=layerInst.axes(),colorAxis=axes.color,encoding=layerInst.config().encoding,textEncoding=encoding.text,textField=textEncoding.field,value=textEncoding.value,textFormatter=textEncoding.formatter,fieldsConfig=layerInst.data().getFieldsConfig(),backgroundEncoding=encoding.text.background,backgroundPadding=backgroundEncoding.padding,backgroundValue=backgroundEncoding.value,textFieldIndex=textField?fieldsConfig[textField]&&fieldsConfig[textField].index:-1,xEnc=ENCODING.X,yEnc=ENCODING.Y,_loop=function _loop(i,len){var d=data[i],row=d.source,textValue=textField?row[textFieldIndex]:value,_map2=text_mixin_slicedToArray([xEnc,yEnc].map(function(type){return axes[type]?axes[type].getScaleValue(d[type])+axes[type].getUnitWidth()/2:0}),2),xPx=_map2[0],yPx=_map2[1],color=colorAxis.getColor(d.color,colorAxis),resolvedEncodings=helpers_resolveEncodingValues({values:{x:xPx,y:yPx,text:textValue,color:color,rotation:defRotation,"alignment-baseline":alignmentBaseLine},data:d},i,data,layerInst),point={enter:{},update:{x:resolvedEncodings.x,y:resolvedEncodings.y},text:textFormatter(resolvedEncodings.text,i,data,layerInst),color:resolvedEncodings.color,background:{value:backgroundValue instanceof Function?backgroundValue(d,i,data,layerInst):null,padding:backgroundPadding},"alignment-baseline":resolvedEncodings["alignment-baseline"],rotation:resolvedEncodings.rotation,meta:text_mixin_objectSpread({},{layerId:layerInst.id()},{},getColorMetaInf({fill:resolvedEncodings.color})),style:{},source:d.source,rowId:d.rowId};point.className=getIndividualClassName(d,i,data,layerInst),points.push(point)},i=0,len=data.length;i<len;i++)_loop(i);return points=(points=positionPoints(layerInst,points)).filter(function(d){var update=d.update;return!isNaN(update.x)&&!isNaN(update.y)})}},text_mixin_TextLayerMixin=function TextLayerMixin(superclass){return function(_superclass){function _class(){return function text_mixin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class),text_mixin_possibleConstructorReturn(this,text_mixin_getPrototypeOf(_class).apply(this,arguments))}return function text_mixin_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&text_mixin_setPrototypeOf(subClass,superClass)}(_class,superclass),function text_mixin_createClass(Constructor,protoProps,staticProps){return protoProps&&text_mixin_defineProperties(Constructor.prototype,protoProps),staticProps&&text_mixin_defineProperties(Constructor,staticProps),Constructor}(_class,[{key:"elemType",value:function elemType(){return"text"}},{key:"getPointTranslator",value:function getPointTranslator(val){return pointTranslators[val]}},{key:"translatePoints",value:function translatePoints(data){var config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return pointTranslators[this.coord()](data,config,this)}},{key:"render",value:function render(container){var _this=this,config=this.config(),normalizedData=this._normalizedData,className=config.className,qualifiedClassName=getQualifiedClassName(config.defClassName,this.id(),config.classPrefix);return renderer_utils_selectElement(container).classed("".concat(qualifiedClassName.join(" ")," ").concat(className),!0),this._graphicElems={},renderer_utils_createElements({data:normalizedData,append:"g",selector:"g",container:container,each:function each(dataArr,group){var node=group.node(),points=_this.translatePoints(dataArr,{},_this);renderer_utils_setStyles(node,{"text-anchor":TEXT_ANCHOR_MIDDLE}),text_renderer(node,points,{className:qualifiedClassName[0]},_this)}}),this}},{key:"getNearestPoint",value:function getNearestPoint(x,y,_ref){var event=_ref.event;return this.data()?this.getDataFromEvent(event):null}},{key:"getDataFromEvent",value:function getDataFromEvent(event){return helpers_getDataFromEvent(this,event)}}],[{key:"defaultConfig",value:function defaultConfig(){return text_default_config_defaultConfig}},{key:"formalName",value:function formalName(){return"text"}}]),_class}()};function text_typeof(obj){"@babel/helpers - typeof";return(text_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function text_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function text_possibleConstructorReturn(self,call){return!call||"object"!==text_typeof(call)&&"function"!=typeof call?function text_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function text_getPrototypeOf(o){return(text_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function text_setPrototypeOf(o,p){return(text_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var TextLayer=function(_mix$with){function TextLayer(){return function text_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TextLayer),text_possibleConstructorReturn(this,text_getPrototypeOf(TextLayer).apply(this,arguments))}return function text_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&text_setPrototypeOf(subClass,superClass)}(TextLayer,mix(base_layer_BaseLayer)["with"](base_mixin_BaseLayerMixin,text_mixin_TextLayerMixin)),function text_createClass(Constructor,protoProps,staticProps){return protoProps&&text_defineProperties(Constructor.prototype,protoProps),staticProps&&text_defineProperties(Constructor,staticProps),Constructor}(TextLayer,null,[{key:"formalName",value:function formalName(){return"text"}}]),TextLayer}(),point_renderer=function drawSymbols(params){var layer=params.layer,container=params.container,points=params.points,transition=params.transition,className=params.className,duration=transition.duration,effect=transition.effect,disabled=transition.disabled,mount=renderer_utils_selectElement(container),graphicElems=layer._graphicElems;return mount.attr("class",className),makeElement(mount,"g",points,null,{enter:function enter(group,d){var enter=d.enter;group.attr("transform","translate(".concat(enter.x,",").concat(enter.y,")"))},update:function update(group,d){!function createShape(d,groupElement){var shape=d.shape,size=d.size,update=d.update,style=d.style;if(shape instanceof Promise)shape.then(function(res){d.shape=res,createShape(d,groupElement)});else if(shape instanceof Element){var newShape=shape.cloneNode(!0);if("img"===newShape.nodeName.toLowerCase()){var src=newShape.src||newShape.href;(newShape=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("href",src)}var shapeElement=renderer_utils_selectElement(newShape);"path"===newShape.nodeName||"image"===newShape.nodeName?shapeElement.attr("transform","scale(".concat(size/100,")")):(shapeElement.attr("height",size),shapeElement.attr("width",size)),shapeElement.attr("x",-size/2),shapeElement.attr("y",-size/2),makeElement(groupElement,function(){return newShape},[1])}else if("string"==typeof shape){var pathStr;pathStr=function checkPath(str){return!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(str)&&/[\dz]$/i.test(str)&&str.length>4)}(shape)?shape:common_utils_getSymbol(shape).size(size)(update);var pathEl=makeElement(groupElement,"path",function(data){return[data]}).attr("d",pathStr);renderer_utils_setStyles(pathEl,style)}else d.shape="circle",createShape(d,groupElement)}(d,group),graphicElems[d.rowId]=group;var update=d.update,style=d.style;objectIterator(style,function(key){return group.style(key,style[key])}),group.attr("class",className),group.classed(d.className,!0),disabled||(group=group.transition().duration(transition.duration).on("end",layer.registerAnimationDoneHook())),group.attr("transform","translate(".concat(update.x,",").concat(update.y,")"))},exit:function exit(exitGroup){disabled?exitGroup.remove():exitGroup.transition().ease(easeFns[effect]).duration(duration).on("end",function(){return exitGroup.remove()}).style("fill-opacity",0).style("stroke-opacity",0)}},params.keyFn)},point_default_config_defaultConfig={defClassName:"layer-point",className:"",classPrefix:CLASSPREFIX,defColorStyle:"stroke",interaction:{highlight:{className:"highlight-class",style:{stroke:"black","stroke-width":"1px"},strokePosition:"center"},focusStroke:{className:"focus-stroke-class",style:{stroke:"black","stroke-width":"1px"},strokePosition:"outside"},commonDoubleStroke:{style:{stroke:"black","stroke-width":"2px"},strokePosition:"outside"},brushStroke:{className:"brush-stroke-class",style:{stroke:"black","stroke-width":"1px"},strokePosition:"outside"},doubleStroke:{style:{stroke:"black","stroke-width":"2px"},strokePosition:"outside"},fade:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.5},data,apply).color}}},focus:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.5},data,apply).color}}}},innerPadding:.1,nearestPointThreshold:5,transform:{type:"identity"},transition:{effect:"cubic",duration:1e3},encoding:{size:{value:30},color:{},stroke:{value:"#000"},"stroke-width":{value:0},fill:{},shape:{value:"circle"},x:{},y:{},"stroke-opacity":{value:1},"fill-opacity":{value:.5},strokePosition:{value:"center"},interaction:{anchors:"highlight","persistent-anchors":"focusStroke","brush-anchors":"brushStroke"}},shapes:["circle","cross","diamond","square","star","wye","triangle"],sizes:[20,30,40,50,60,70]};__webpack_require__(25);function point_helper_slicedToArray(arr,i){return function point_helper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function point_helper_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function point_helper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var helper_prepareDrawingInf=function prepareDrawingInf(_ref){var data=_ref.data,datum=_ref.datum,i=_ref.i,layerInst=_ref.layerInst,xPx=_ref.xPx,yPx=_ref.yPx,axes=layerInst.axes(),shapeAxis=axes.shape,colorAxis=axes.color,sizeAxis=axes.size,shape=shapeAxis.getShape(datum.shape),size=sizeAxis.getSize(datum.size),color=colorAxis.getColor(datum.color),layerEncoding=layerInst.config().encoding,stroke=layerEncoding.stroke.value,strokeWidth=layerEncoding["stroke-width"].value,resolvedEncodings=helpers_resolveEncodingValues({values:{x:xPx,y:yPx,color:color,stroke:stroke,"stroke-width":strokeWidth,size:size,shape:shape,data:datum},data:datum},i,data,layerInst),rowId=datum.rowId,source=datum.source;shape=resolvedEncodings.shape,size=resolvedEncodings.size;var style={fill:color=resolvedEncodings.color,stroke:resolvedEncodings.stroke,"stroke-width":resolvedEncodings["stroke-width"]},pos={x:resolvedEncodings.x,y:resolvedEncodings.y};return{enter:pos,update:pos,shape:shape,source:source,rowId:rowId,style:style,data:datum.dataObj,meta:Object.assign({layerId:layerInst.id()},getColorMetaInf(style,{strokePosition:layerEncoding.strokePosition.value})),size:size}},helper_pointTranslators=function helper_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},COORD_TYPES.CARTESIAN,function(data,config,layerInst){for(var points=[],encoding=layerInst.config().encoding,axes=layerInst.axes(),x=encoding.x,y=encoding.y,xField=x.field,yField=y.field,fieldsConfig=layerInst.data().getFieldsConfig(),isXDim=fieldsConfig[xField]&&fieldsConfig[xField].def.type===dist_datamodel.FieldType.DIMENSION,isYDim=fieldsConfig[yField]&&fieldsConfig[yField].def.type===dist_datamodel.FieldType.DIMENSION,key=isXDim?ENCODING.X:isYDim?ENCODING.Y:null,measurement=layerInst.measurement(),_config$offset=config.offset,offsetX=_config$offset.x,offsetY=_config$offset.y,_loop=function _loop(i,len){var d=data[i],_map2=point_helper_slicedToArray([ENCODING.X,ENCODING.Y].map(function(type){var value=null===d[type]?void 0:d[type],measure=type===ENCODING.X?measurement.width:measurement.height;return encoding[type].field?axes[type].getScaleValue(value):measure/2}),2),xPx=_map2[0],yPx=_map2[1];if(xPx+=offsetX,yPx+=offsetY,!isNaN(xPx)&&!isNaN(yPx)){var point=helper_prepareDrawingInf({data:data,datum:d,i:i,layerInst:layerInst,xPx:xPx,yPx:yPx});point.className=getIndividualClassName(d,i,data,layerInst),points.push(point),layerInst.cachePoint(d[key],point)}},i=0,len=data.length;i<len;i++)_loop(i);return points=positionPoints(layerInst,points)}),getStrokeWidthByPosition=function getStrokeWidthByPosition(position,radius){return{center:-radius,inside:-radius*Math.PI,outside:+radius*Math.PI}[position]};function point_mixin_typeof(obj){"@babel/helpers - typeof";return(point_mixin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function point_mixin_slicedToArray(arr,i){return function point_mixin_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function point_mixin_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function point_mixin_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function point_mixin_toConsumableArray(arr){return function point_mixin_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function point_mixin_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function point_mixin_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function point_mixin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function point_mixin_possibleConstructorReturn(self,call){return!call||"object"!==point_mixin_typeof(call)&&"function"!=typeof call?function point_mixin_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function point_mixin_get(target,property,receiver){return(point_mixin_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function point_mixin_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=point_mixin_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function point_mixin_getPrototypeOf(o){return(point_mixin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function point_mixin_setPrototypeOf(o,p){return(point_mixin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var point_mixin_PointLayerMixin=function PointLayerMixin(superclass){return function(_superclass){function _class(){var _getPrototypeOf2,_this;!function point_mixin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return(_this=point_mixin_possibleConstructorReturn(this,(_getPrototypeOf2=point_mixin_getPrototypeOf(_class)).call.apply(_getPrototypeOf2,[this].concat(args))))._voronoi=new common_utils_Voronoi,_this._bandScale=Scales.band(),_this._overlayPath={},_this.formattedUids=[],_this}return function point_mixin_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&point_mixin_setPrototypeOf(subClass,superClass)}(_class,superclass),function point_mixin_createClass(Constructor,protoProps,staticProps){return protoProps&&point_mixin_defineProperties(Constructor.prototype,protoProps),staticProps&&point_mixin_defineProperties(Constructor,staticProps),Constructor}(_class,[{key:"elemType",value:function elemType(){return"g"}},{key:"translatePoints",value:function translatePoints(data){var config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return helper_pointTranslators[this.coord()](data,config,this)}},{key:"render",value:function render(container){var seriesClassName,_this2=this,maxSize=0,config=this.config(),keys=this._transformedData.map(function(d){return d.key}),transition=config.transition,className=config.className,defClassName=config.defClassName,classPrefix=config.classPrefix,normalizedData=this._normalizedData,containerSelection=renderer_utils_selectElement(container),qualifiedClassName=getQualifiedClassName(defClassName,this.id(),classPrefix);this._points=[],this._pointMap={},containerSelection.classed(qualifiedClassName.join(" "),!0).classed(className,!0),this._points=this.generateDataPoints(normalizedData,keys),this._graphicElems={};var schema=this.data().getSchema();return makeElement(container,"g",this._points,null,{update:function update(group,points){maxSize=Math.max.apply(Math,[maxSize].concat(point_mixin_toConsumableArray(points.map(function(d){return d.size||0})))),seriesClassName="".concat(qualifiedClassName[0]),_this2.constructor.drawFn()({layer:_this2,container:group.node(),points:points,interpolate:config.interpolate,className:seriesClassName,transition:transition,keyFn:function keyFn(v){return helpers_getMarkId(v.source,schema)}})}},function(data){return data[0].rowId}),this._maxSize=2*Math.sqrt(maxSize/Math.PI),this.attachDataToVoronoi(this._points),this}},{key:"attachDataToVoronoi",value:function attachDataToVoronoi(points){helpers_attachDataToVoronoi(this._voronoi,points)}},{key:"generateDataPoints",value:function generateDataPoints(normalizedData,keys){var _this3=this,_getPlotMeasurement2=point_mixin_slicedToArray(helpers_getPlotMeasurement(this,keys),2),widthMetrics=_getPlotMeasurement2[0],heightMetrics=_getPlotMeasurement2[1],offsetXValues=widthMetrics.offsetValues||[],offsetYValues=heightMetrics.offsetValues||[];return normalizedData.map(function(dataArr,i){var measurementConf=_this3.getMeasurementConfig(offsetXValues[i],offsetYValues[i],widthMetrics.span,heightMetrics.span);return _this3.translatePoints(dataArr,measurementConf)}).filter(function(d){return d.length})}},{key:"getMeasurementConfig",value:function getMeasurementConfig(offsetX,offsetY,widthSpan,heightSpan){return{offset:{x:(offsetX||0)+widthSpan/2,y:(offsetY||0)+heightSpan/2},span:{x:widthSpan,y:heightSpan}}}},{key:"getNearestPoint",value:function getNearestPoint(x,y){var nearestPointThreshold=this.config().nearestPointThreshold,distanceLimit=Math.max(this._maxSize,nearestPointThreshold);if(!this.data())return null;var point=this._voronoi.find(x,y,distanceLimit),dimensions=point&&point.data.data.update,radius=point?Math.sqrt(point.data.data.size/Math.PI):0;if(point&&pointWithinCircle({x:dimensions.x,y:dimensions.y,r:radius+nearestPointThreshold},{x:x,y:y})){var _point$data$data=point.data.data,source=_point$data$data.source,rowId=_point$data$data.rowId;return{id:this.getIdentifiersFromData(source,rowId),dimensions:[{x:dimensions.x,y:dimensions.y,width:radius,height:radius}],layerId:this.id()}}return null}},{key:"addOverlayPath",value:function addOverlayPath(refElement,data,style,strokePosition){var pathElement,container=refElement.parentElement;if(this._overlayPath[data.rowId]?pathElement=this._overlayPath[data.rowId]:((pathElement=makeElement(container,"path",[data.update],null,{},function(d){return"".concat(d.x," ").concat(data.rowId)})).style("fill","none"),pathElement.style("fill-opacity",0),pathElement.attr("id",data.rowId),this._overlayPath[data.rowId]=pathElement),"stroke-width"===style.type){var position=strokePosition,radius=Math.sqrt(data.size/Math.PI);radius=getStrokeWidthByPosition(position,radius);var size=data.size+radius;if("string"==typeof data.shape){var path=common_utils_getSymbol(data.shape).size(size);pathElement.attr("d",path)}}var styleVal=style.value;"function"==typeof styleVal&&(styleVal=styleVal(pathElement.style(style.type)));pathElement.style(style.type,styleVal),appendElement(refElement,pathElement.node())}},{key:"removeOverlayPath",value:function removeOverlayPath(data,style){var currentPath=this._overlayPath[data.rowId];currentPath&&(currentPath.node().removeAttribute("style"),Object.keys(style).forEach(function(s){return currentPath.style(s,style[s])}),currentPath.style("fill-opacity",0))}},{key:"getBoundBoxes",value:function getBoundBoxes(){return helpers_getBoundBoxes(this._points.flat())}},{key:"applyElementStyles",value:function applyElementStyles(elem,styles,styleObj){styles.forEach(function(type){elem.select("path").style(type,styleObj[type])})}}],[{key:"defaultConfig",value:function defaultConfig(){return point_default_config_defaultConfig}},{key:"defaultPolicy",value:function defaultPolicy(conf,userConf){var config=point_mixin_get(point_mixin_getPrototypeOf(_class),"defaultPolicy",this).call(this,conf,userConf),encoding=config.encoding,transform=config.transform,colorField=encoding.color&&encoding.color.field;return colorField&&(transform.groupBy=colorField),config}},{key:"drawFn",value:function drawFn(){return point_renderer}}]),_class}()};function point_typeof(obj){"@babel/helpers - typeof";return(point_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function point_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function point_possibleConstructorReturn(self,call){return!call||"object"!==point_typeof(call)&&"function"!=typeof call?function point_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function point_getPrototypeOf(o){return(point_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function point_setPrototypeOf(o,p){return(point_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var point_PointLayer=function(_mix$with){function PointLayer(){return function point_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PointLayer),point_possibleConstructorReturn(this,point_getPrototypeOf(PointLayer).apply(this,arguments))}return function point_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&point_setPrototypeOf(subClass,superClass)}(PointLayer,mix(base_layer_BaseLayer)["with"](point_mixin_PointLayerMixin)),function point_createClass(Constructor,protoProps,staticProps){return protoProps&&point_defineProperties(Constructor.prototype,protoProps),staticProps&&point_defineProperties(Constructor,staticProps),Constructor}(PointLayer,null,[{key:"formalName",value:function formalName(){return POINT_LAYER}}]),PointLayer}(),renderer_drawRects=function drawRects(params){var layer=params.layer,points=params.points,container=params.container,keyFn=params.keyFn,className=params.className,graphicElems=layer._graphicElems,updateFns={enter:function enter(elem,d){!function barEnterFn(elem,d){var selection=elem,enter=d.enter||{};Object.entries(enter).forEach(function(attr){return!isNaN(attr[1])&&selection.attr(attr[0],attr[1])})}(elem,d)},update:function update(elem,d,i){graphicElems[d.rowId]=elem,function transitionBars(layer,elem,datum,index,context){var transition=context.transition,duration=transition.duration,disabled=transition.disabled,effect=transition.effect,selection=elem,selTransition=disabled?selection:selection.transition().duration(duration).ease(easeFns[effect]).on("end",layer.registerAnimationDoneHook()),update=datum.update||datum,updateStyle=datum.style||{};datum.className&&selection.classed(datum.className,!0),Object.entries(update).forEach(function(attr){return!isNaN(attr[1])&&selTransition.attr(attr[0],attr[1])}),Object.entries(updateStyle).forEach(function(styleObj){return selection.style(styleObj[0],styleObj[1])})}(layer,elem,d,0,params)}};return makeElement(container,"g",points,null,{update:function update(group,d){makeElement(group.node(),"rect",function(data){return[data]},null,updateFns,keyFn),group.attr("class","".concat(className,"-").concat(d.rowId)),group.classed(d.className,!0)}},keyFn)},bar_default_config_defaultConfig={classPrefix:CLASSPREFIX,defClassName:"layer-bar",className:"",interaction:{highlight:{style:{stroke:"black","stroke-width":"1px"},strokePosition:"center"},focusStroke:{className:"focus-stroke-class",style:{stroke:"black","stroke-width":"1px"},strokePosition:"outside"},brushStroke:{className:"brush-stroke-class",style:{stroke:"black","stroke-width":"1px"},strokePosition:"outside"},doubleStroke:{style:{stroke:"black","stroke-width":"2px"},strokePosition:"outside"},commonDoubleStroke:{style:{stroke:"black","stroke-width":"2px"},strokePosition:"outside"},fade:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.3},data,apply).color}}},focus:{style:{fill:function fill(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{a:-.5},data,apply).color}}}},transform:{type:"stack"},transition:{effect:"cubic",duration:1e3},innerPadding:.1,encoding:{color:{},x:{},y:{},x0:{},y0:{},stroke:{value:"#000"},strokeWidth:{value:"0px"},strokePosition:{value:"center"}}};__webpack_require__(10);function bar_helper_slicedToArray(arr,i){return function bar_helper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function bar_helper_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function bar_helper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var positionRetriever={x:function x(xPx,isNegativeVal,barBasePos){return isNegativeVal?[xPx,barBasePos]:[barBasePos,xPx]},y:function y(yPx,isNegativeVal,barBasePos){return isNegativeVal?[barBasePos,yPx]:[yPx,barBasePos]}},bar_helper_resolveDimByField=function resolveDimByField(type,axesInfo,config,data){var pos,spaceType="x"===type?"width":"height",_ref=[config["".concat(type,"FieldType")],axesInfo["".concat(type,"Axis")]],fieldType=_ref[0],axis=_ref[1],transformType=config.transformType,sizeEncoding=config.sizeEncoding,sizeConfig=config.sizeConfig,measurement=config.measurement,sizeValue=sizeEncoding.value,enter=0,space=0,enterSpace=0;if(void 0!==fieldType)if(config["".concat(type,"0Field")]){var min,max,minVal=data[type],maxVal=data["".concat(type,"0")];if(null===minVal||null===maxVal)return{enterSpace:void 0,enter:void 0,pos:void 0,space:void 0};fieldType===dist_datamodel.MeasureSubtype.CONTINUOUS||fieldType===dist_datamodel.DimensionSubtype.TEMPORAL?(min=Math.min(minVal,maxVal),max=Math.max(minVal,maxVal)):(min=minVal,max=maxVal);var scales="x"===type?[min,max]:[max,min];pos=axis.getScaleValue(scales[0])+axis.getUnitWidth()/2,space=Math.abs(axis.getScaleValue(scales[1])-pos)+axis.getUnitWidth()/2,enter=pos,enterSpace=0}else if(fieldType===dist_datamodel.DimensionSubtype.CATEGORICAL||fieldType===dist_datamodel.DimensionSubtype.TEMPORAL){if(pos=axis.getScaleValue(data[type])+(sizeConfig["x"===type?"barWidthOffset":"barHeightOffset"]||0),space=sizeConfig["x"===type?"barWidth":"barHeight"],void 0!==sizeValue){var diffPx=sizeValue*space;space-=diffPx,pos+=diffPx/2}enter=pos,enterSpace=space}else{var minDomVal=axis.domain()[0],barBasePos=minDomVal<0?axis.getScaleValue(0):axis.getScaleValue(minDomVal);pos=axis.getScaleValue(data[type]);var endPos=axis.getScaleValue(data["".concat(type,"0")]);enterSpace=0;var isNegativeVal=data[type]<0;if(transformType!==STACK){var _positionRetriever$ty2=bar_helper_slicedToArray(positionRetriever[type](pos,isNegativeVal,barBasePos),2);pos=_positionRetriever$ty2[0],endPos=_positionRetriever$ty2[1]}space=Math.abs(pos-endPos),enter=barBasePos}else pos=0,space=measurement[spaceType];return{enterSpace:enterSpace,enter:enter,pos:pos,space:space}},resolveDimensions=function resolveDimensions(data,config,axes){var axesInfo={xAxis:axes.x,yAxis:axes.y},_resolveDimByField=bar_helper_resolveDimByField("x",axesInfo,config,data),enterWidth=_resolveDimByField.enterSpace,enterX=_resolveDimByField.enter,xPos=_resolveDimByField.pos,width=_resolveDimByField.space,_resolveDimByField2=bar_helper_resolveDimByField("y",axesInfo,config,data),enterHeight=_resolveDimByField2.enterSpace;return{enter:{x:enterX,y:_resolveDimByField2.enter,width:enterWidth,height:enterHeight},update:{x:xPos,y:_resolveDimByField2.pos,width:width,height:_resolveDimByField2.space}}};function bar_mixin_typeof(obj){"@babel/helpers - typeof";return(bar_mixin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function bar_mixin_slicedToArray(arr,i){return function bar_mixin_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function bar_mixin_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function bar_mixin_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function bar_mixin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function bar_mixin_possibleConstructorReturn(self,call){return!call||"object"!==bar_mixin_typeof(call)&&"function"!=typeof call?function bar_mixin_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function bar_mixin_get(target,property,receiver){return(bar_mixin_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function bar_mixin_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=bar_mixin_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function bar_mixin_getPrototypeOf(o){return(bar_mixin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function bar_mixin_setPrototypeOf(o,p){return(bar_mixin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var bar_mixin_MEASURE=dist_datamodel.FieldType.MEASURE,bar_mixin_BarLayerMixin=function BarLayerMixin(superclass){return function(_superclass){function _class(){var _getPrototypeOf2,_this;!function bar_mixin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=bar_mixin_possibleConstructorReturn(this,(_getPrototypeOf2=bar_mixin_getPrototypeOf(_class)).call.apply(_getPrototypeOf2,[this].concat(params))))._bandScale=Scales.band(),_this._plotPadding={x:0,y:0},_this._plotSpan={x:0,y:0},_this._pointMap={},_this._overlayPath={},_this._rtree=new RTree,_this}return function bar_mixin_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&bar_mixin_setPrototypeOf(subClass,superClass)}(_class,superclass),function bar_mixin_createClass(Constructor,protoProps,staticProps){return protoProps&&bar_mixin_defineProperties(Constructor.prototype,protoProps),staticProps&&bar_mixin_defineProperties(Constructor,staticProps),Constructor}(_class,[{key:"elemType",value:function elemType(){return"rect"}},{key:"calculateDomainFromData",value:function calculateDomainFromData(data,encodingFieldInf,fieldsConfig){var domain=bar_mixin_get(bar_mixin_getPrototypeOf(_class.prototype),"calculateDomainFromData",this).call(this,data,encodingFieldInf,fieldsConfig);return["x","y"].forEach(function(d){encodingFieldInf["".concat(d,"FieldType")]===bar_mixin_MEASURE&&getObjProp(domain[d],"length")&&(encodingFieldInf["".concat(d,"0Field")]?domain[d]=domain[d].sort(function(a,b){return a-b}):(domain[d][0]=Math.min(domain[d][0],0),domain[d][1]=Math.max(0,domain[d][1])))}),domain}},{key:"translatePoints",value:function translatePoints(data,sizeConfig){return function getTranslatedPoints(context,data,sizeConfig){for(var points=[],encoding=context.config().encoding,axes=context.axes(),colorAxis=axes.color,sizeEncoding=encoding.size||{},_context$encodingFiel=context.encodingFieldsInf(),x0Field=_context$encodingFiel.x0Field,y0Field=_context$encodingFiel.y0Field,xFieldSubType=_context$encodingFiel.xFieldSubType,yFieldSubType=_context$encodingFiel.yFieldSubType,measurement=context.measurement(),isXDim=xFieldSubType===dist_datamodel.DimensionSubtype.CATEGORICAL||xFieldSubType===dist_datamodel.DimensionSubtype.TEMPORAL,isYDim=yFieldSubType===dist_datamodel.DimensionSubtype.CATEGORICAL||yFieldSubType===dist_datamodel.DimensionSubtype.TEMPORAL,key=isXDim?"x":isYDim?"y":null,transformType=context.transformType(),i=0,len=data.length;i<len;i++){var d=data[i],dimensions=resolveDimensions(d,{xFieldType:xFieldSubType,yFieldType:yFieldSubType,x0Field:x0Field,y0Field:y0Field,transformType:transformType,measurement:measurement,sizeConfig:sizeConfig,sizeEncoding:sizeEncoding},axes),color=colorAxis.getColor(d.color),update=dimensions.update,resolvedEncodings=helpers_resolveEncodingValues({values:{x:update.x,y:update.y,width:update.width,height:update.height,color:color},data:d},i,data,context);color=resolvedEncodings.color;var x=resolvedEncodings.x,y=resolvedEncodings.y,width=resolvedEncodings.width,height=resolvedEncodings.height,style={fill:color,stroke:encoding.stroke.value,"stroke-width":encoding.strokeWidth.value},conf={strokePosition:encoding.strokePosition.value};if(!isNaN(x)&&!isNaN(y)&&void 0!==d.rowId){var point=null;(point={enter:dimensions.enter,update:{x:x,y:y,width:width,height:height},source:d.source,rowId:d.rowId,data:d.dataObj,style:style,meta:Object.assign({layerId:context.id()},getColorMetaInf(style,conf))}).className=getIndividualClassName(d,i,data,context),points.push(point),context.cachePoint(d[key],point)}}return points=positionPoints(context,points)}(this,data,sizeConfig)}},{key:"render",value:function render(container){var _this2=this,config=this.config(),transition=config.transition,normalizedDataArr=this._normalizedData,keys=this._transformedData.map(function(d){return d.key}),fieldsConfig=this.data().getFieldsConfig(),axes=this.axes(),height=axes.y&&axes.y.scale().range()[0],width=axes.x&&axes.x.scale().range()[1],defClassName=config.defClassName,qualifiedClassName=getQualifiedClassName(defClassName,this.id(),config.classPrefix),className=config.className,containerSelection=renderer_utils_selectElement(container),dimensions=Object.values(fieldsConfig).filter(function(e){return e.def.type===dist_datamodel.FieldType.DIMENSION}).map(function(e){return e.index});containerSelection.classed(qualifiedClassName.join(" "),!0),containerSelection.classed(className,!0),renderer_utils_clipElement(container,{x:0,y:0,width:width,height:height},"id-".concat(this.id())),this._points=this.generateDataPoints(normalizedDataArr,keys),this._graphicElems={},Object.keys(this._overlayPath).forEach(function(path){return _this2._overlayPath[path].remove()}),this._overlayPath={};var barContainer=makeElement(containerSelection,"g",[1],"muze-layer-bars",{},null);makeElement(containerSelection,"g",[1],"muze-overlay-paths",{},null),renderer_utils_createElements({data:this._points,container:barContainer.node(),selector:"g",append:"g",each:function each(points,group,i){var seriesClassName="".concat(qualifiedClassName[0],"-").concat(keys[i]||i).toLowerCase();group.style("display","block"),renderer_drawRects({layer:_this2,container:group.node(),points:points,className:seriesClassName,transition:transition,style:{},keyFn:function keyFn(d){return dimensions.map(function(key){return d.source[key]}).join("-")}})}});var elements=this.getBoundBoxes().flat().filter(function(d){return null!==d});return this._rtree=new RTree,this._rtree.load(elements),this}},{key:"generateDataPoints",value:function generateDataPoints(normalizedData,keys){var _this3=this,_getPlotMeasurement2=bar_mixin_slicedToArray(helpers_getPlotMeasurement(this,keys),2),barWidthMetrics=_getPlotMeasurement2[0],barHeightMetrics=_getPlotMeasurement2[1],barWidthOffsets=barWidthMetrics.offsetValues||[],barHeightOffsets=barHeightMetrics.offsetValues||[];return this._plotSpan={x:barWidthMetrics.groupSpan||0,y:barHeightMetrics.groupSpan||0},this._plotPadding={x:barWidthMetrics.padding||0,y:barHeightMetrics.padding||0},this._pointMap={},normalizedData.map(function(data,i){return _this3.translatePoints(data,{barWidth:barWidthMetrics.span,barWidthOffset:barWidthOffsets[i]||0,barHeight:barHeightMetrics.span,barHeightOffset:barHeightOffsets[i]||0})})}},{key:"getPlotPadding",value:function getPlotPadding(){return this._plotPadding}},{key:"resolveTransformType",value:function resolveTransformType(){this._transformType=helpers_getValidTransformForAggFn(this)}},{key:"getNearestPoint",value:function getNearestPoint(x,y){if(!this.data())return null;var data=this._rtree.search({minX:Math.max(x-1,0),minY:Math.max(y-1,0),maxX:x+1,maxY:y+1});return data.length?this.getDataFromEvent(null,data[0].point):null}},{key:"getDataFromEvent",value:function getDataFromEvent(event,data){return helpers_getDataFromEvent(this,event,data)}},{key:"getPlotSpan",value:function getPlotSpan(){return this._plotSpan}},{key:"hasPlotSpan",value:function hasPlotSpan(){return!0}},{key:"addOverlayPath",value:function addOverlayPath(refElement,data,style,strokePosition,mountPoint){var pathElement;if(this._overlayPath[data.rowId])pathElement=this._overlayPath[data.rowId];else{var pathGroup=makeElement(mountPoint,"g",[1],null,{},function(d){return"".concat(d.x," ").concat(data.rowId)});(pathElement=makeElement(pathGroup,"path",[data],null,{},function(d){return"".concat(d.update.x," ").concat(data.rowId)})).style("fill","none"),pathElement.style("fill-opacity",0),pathElement.attr("id",data.rowId),this._overlayPath[data.rowId]=pathElement}if("stroke-width"===style.type){var _strokeWidthPositionM=function strokeWidthPositionMap(_ref2){var offset=_ref2.width/2;return{center:{M:{x:0,y:0},L1:{x:0,y:0},L2:{x:0,y:0},L3:{x:0,y:0}},inside:{M:{x:+offset,y:+offset},L1:{x:-offset,y:+offset},L2:{x:-offset,y:-offset},L3:{x:+offset,y:-offset}},outside:{M:{x:-offset,y:-offset},L1:{x:+offset,y:-offset},L2:{x:+offset,y:+offset},L3:{x:-offset,y:+offset}}}[_ref2.position]}({width:parseInt(style.value,10),position:strokePosition}),L1=_strokeWidthPositionM.L1,L2=_strokeWidthPositionM.L2,L3=_strokeWidthPositionM.L3,M=_strokeWidthPositionM.M;pathElement.attr("d",function(d){return"M ".concat(d.update.x+M.x," ").concat(d.update.y+M.y,"\n            L ").concat(d.update.x+d.update.width+L1.x," ").concat(d.update.y+L1.y,"\n            L ").concat(d.update.x+d.update.width+L2.x," ").concat(d.update.y+d.update.height+L2.y,"\n            L").concat(d.update.x+L3.x," ").concat(d.update.y+d.update.height+L3.y," Z")})}var styleVal=style.value;"function"==typeof styleVal&&(styleVal=styleVal(pathElement.style(style.type)));pathElement.style(style.type,styleVal),appendElement(mountPoint,pathElement.node())}},{key:"removeOverlayPath",value:function removeOverlayPath(data,style){var currentPath=this._overlayPath[data.rowId];currentPath&&(currentPath.node().removeAttribute("style"),Object.keys(style).forEach(function(s){return currentPath.style(s,style[s])}),currentPath.style("fill-opacity",0),currentPath.attr("d",function(d){return"M ".concat(d.update.x," ").concat(d.update.y,"\n            L ").concat(d.update.x+d.update.width," ").concat(d.update.y,"\n            L ").concat(d.update.x+d.update.width," ").concat(d.update.y+d.update.height,"\n            L").concat(d.update.x," ").concat(d.update.y+d.update.height," Z")}))}},{key:"getBoundBoxes",value:function getBoundBoxes(){return this._points.flat().map(function(point){var _point$update=point.update,x=_point$update.x,y=_point$update.y;return{minX:x,maxX:x+_point$update.width,minY:y,maxY:y+_point$update.height,data:point.data,point:point}})}}],[{key:"defaultConfig",value:function defaultConfig(){return bar_default_config_defaultConfig}},{key:"defaultPolicy",value:function defaultPolicy(conf,userConf){var config=base_layer_BaseLayer.defaultPolicy(conf,userConf),colorField=config.encoding.color.field,transform=config.transform;return colorField&&(transform.groupBy=colorField),config}}]),_class}()};function bar_typeof(obj){"@babel/helpers - typeof";return(bar_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function bar_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function bar_possibleConstructorReturn(self,call){return!call||"object"!==bar_typeof(call)&&"function"!=typeof call?function bar_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function bar_getPrototypeOf(o){return(bar_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function bar_setPrototypeOf(o,p){return(bar_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var bar_BarLayer=function(_mix$with){function BarLayer(){return function bar_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BarLayer),bar_possibleConstructorReturn(this,bar_getPrototypeOf(BarLayer).apply(this,arguments))}return function bar_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&bar_setPrototypeOf(subClass,superClass)}(BarLayer,mix(base_layer_BaseLayer)["with"](base_mixin_BaseLayerMixin,bar_mixin_BarLayerMixin)),function bar_createClass(Constructor,protoProps,staticProps){return protoProps&&bar_defineProperties(Constructor.prototype,protoProps),staticProps&&bar_defineProperties(Constructor,staticProps),Constructor}(BarLayer,null,[{key:"formalName",value:function formalName(){return BAR_LAYER}}]),BarLayer}(),tick_default_config_defaultConfig={defClassName:"layer-tick",className:"",classPrefix:CLASSPREFIX,nearestPointThreshold:10,interaction:{fade:{style:{stroke:function stroke(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{l:15},data,apply).color}}},focus:{style:{stroke:function stroke(rgbaValues,data,apply){return common_utils_transformColor(rgbaValues,{l:15},data,apply).color}}}},innerPadding:.1,transform:{type:"identity"},transition:{effect:"cubic",duration:1e3},interpolate:"linear",encoding:{color:{},x:{},y:{},x0:{},y0:{},radius:{},radius0:{},angle:{},angle0:{},strokeOpacity:{value:.5},fillOpacity:{value:.5}},states:{highlight:{className:"".concat(CLASSPREFIX,"-layer-tick-highlight")},fadeout:{className:"".concat(CLASSPREFIX,"-layer-tick-fadeout")},selected:{className:"".concat(CLASSPREFIX,"-layer-tick-selected")}}},tick_renderer_line=Symbols.line,tick_renderer=function(params){var points=params.points,container=params.container,keyFn=params.keyFn,className=params.className,interpolate=params.interpolate,layer=params.layer,transition=params.transition,disabled=transition.disabled,mount=renderer_utils_selectElement(container),graphicElems=layer._graphicElems;return mount.attr("class",className),makeElement(mount,"g",points,null,{enter:function enter(group,d){var enter=d.enter||{};Object.entries(enter).forEach(function(attr){return!isNaN(attr[1])&&group.attr(attr[0],attr[1])})},update:function update(group,d){var pathElem=makeElement(group,"path",[1]);graphicElems[d.rowId]=group;var update=d.update,style=d.style;group.attr("class",className),group.classed(d.className,!0);var x0=void 0!==update.x0?update.x0:update.x,y0=void 0!==update.y0?update.y0:update.y,curveInterpolatorFn=pathInterpolators[interpolate],linepath=tick_renderer_line().curve(curveInterpolatorFn).x(function(e){return e[0]}).y(function(e){return e[1]});d.className&&group.classed(d.className,!0),pathElem.attr("d",linepath([[update.x,update.y],[x0,y0]])),disabled||(group=group.transition().duration(transition.duration).on("end",layer.registerAnimationDoneHook())),Object.entries(style).forEach(function(styleObj){return group.style(styleObj[0],styleObj[1])})},exit:function exit(exitGroup){exitGroup.remove()}},keyFn)};__webpack_require__(26);function tick_mixin_typeof(obj){"@babel/helpers - typeof";return(tick_mixin_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function tick_mixin_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function tick_mixin_possibleConstructorReturn(self,call){return!call||"object"!==tick_mixin_typeof(call)&&"function"!=typeof call?function tick_mixin_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function tick_mixin_getPrototypeOf(o){return(tick_mixin_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function tick_mixin_setPrototypeOf(o,p){return(tick_mixin_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function tick_mixin_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function tick_mixin_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?tick_mixin_ownKeys(Object(source),!0).forEach(function(key){tick_mixin_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):tick_mixin_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function tick_mixin_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var tick_mixin_pointTranslators={polar:function polar(data){arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(var layerInst=arguments.length>2?arguments[2]:void 0,axes=layerInst.axes(),points=[],radiusAxis=axes.radius,angleAxis=axes.angle,angle0Axis=axes.angle0,measurement=layerInst.measurement(),colorAxis=axes.color,angleV={},angle0V={},i=0,len=data.length;i<len;i++){var d=data[i],color=colorAxis.getColor(d.color),angles=angleAxis.getScaleValue(d.angle);!angleV[d.angle]&&(angleV[d.angle]=0);var _angles=angles[angleV[d.angle]++],startAngle=_angles.startAngle,endAngle=_angles.endAngle,angles0=angle0Axis.getScaleValue(d.angle0);!angle0V[d.angle0]&&(angle0V[d.angle0]=0);var _angles2=angles0[angle0V[d.angle0]++],startAngle0=_angles2.startAngle,endAngle0=_angles2.endAngle,radius=radiusAxis.getOuterRadius(d.radius),angle=(startAngle+endAngle)/2,angle0=(startAngle0+endAngle0)/2,resolvedVal=helpers_resolveEncodingValues({values:{radius:radius,radius0:radiusAxis.getInnerRadius(d.radius0),color:color,angle:angle,angle0:angle0,startAngle:startAngle,endAngle:endAngle,startAngle0:startAngle0,endAngle0:endAngle0},data:d},i,data,layerInst),style={stroke:resolvedVal.color},point={enter:{},update:{radius:resolvedVal.radius,radius0:resolvedVal.radius0,angle:resolvedVal.angle,angle0:resolvedVal.angle0},style:style,source:d.source,rowId:d.rowId,data:d,meta:tick_mixin_objectSpread({},{layerId:layerInst.id()},{},getColorMetaInf(style))};point.className=getIndividualClassName(d,i,data,layerInst),points.push(point)}return points=toCartesianCoordinates(positionPoints(layerInst,points),measurement,!0)},cartesian:function cartesian(data){for(var config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},layerInst=arguments.length>2?arguments[2]:void 0,axes=layerInst.axes(),points=[],xAxis=axes.x,yAxis=axes.y,_layerInst$encodingFi=layerInst.encodingFieldsInf(),xField=_layerInst$encodingFi.xField,yField=_layerInst$encodingFi.yField,x0Field=_layerInst$encodingFi.x0Field,y0Field=_layerInst$encodingFi.y0Field,xFieldType=_layerInst$encodingFi.xFieldType,yFieldType=_layerInst$encodingFi.yFieldType,isXDim=xFieldType===dist_datamodel.FieldType.DIMENSION,isYDim=yFieldType===dist_datamodel.FieldType.DIMENSION,key=isXDim?ENCODING.X:isYDim?ENCODING.Y:null,measurement=layerInst.measurement(),colorAxis=axes.color,_config$offset=config.offset,offsetX=_config$offset.x,offsetY=_config$offset.y,_config$span=config.span,xSpan=_config$span.x,ySpan=_config$span.y,i=0,len=data.length;i<len;i++){var xPx=void 0,x0Px=void 0,y0Px=void 0,yPx=void 0,d=data[i],row=d.source;xField&&(x0Px=(xPx=xAxis.getScaleValue(d.x)+offsetX)+xSpan),yField&&(y0Px=null!==(yPx=yAxis.getScaleValue(d.y)+offsetY)?yPx+ySpan:null),xField||(xPx=0,x0Px=measurement.width,isNaN(yPx)||(y0Px=yPx+=ySpan/2)),yField||(yPx=0,y0Px=measurement.height,x0Px=xPx+=xSpan/2),x0Field&&(x0Px=xAxis.getScaleValue(d.x0)+xSpan,yPx+=ySpan/2,y0Px-=ySpan/2),y0Field&&(y0Px=yAxis.getScaleValue(d.y0)+ySpan,xPx+=xSpan/2,x0Px-=xSpan/2);var color=colorAxis.getColor(d.color),resolvedEncodings=helpers_resolveEncodingValues({values:{x:xPx,y:yPx,x0:x0Px,y0:y0Px,color:color},data:d},i,data,layerInst),style={stroke:resolvedEncodings.color};if(!isNaN(xPx)&&!isNaN(yPx)){var point={enter:{},update:{x:resolvedEncodings.x,y:resolvedEncodings.y,x0:resolvedEncodings.x0,y0:resolvedEncodings.y0},style:style,source:row,rowId:d.rowId,data:d.dataObj,meta:tick_mixin_objectSpread({},{layerId:layerInst.id()},{},getColorMetaInf(style))};point.className=getIndividualClassName(d,i,data,layerInst),points.push(point),layerInst.cachePoint(d[key],point)}}return points=positionPoints(layerInst,points)}},tick_mixin_TickLayerMixin=function TickLayerMixin(superclass){return function(_superclass){function _class(){return function tick_mixin_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,_class),tick_mixin_possibleConstructorReturn(this,tick_mixin_getPrototypeOf(_class).apply(this,arguments))}return function tick_mixin_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&tick_mixin_setPrototypeOf(subClass,superClass)}(_class,superclass),function tick_mixin_createClass(Constructor,protoProps,staticProps){return protoProps&&tick_mixin_defineProperties(Constructor.prototype,protoProps),staticProps&&tick_mixin_defineProperties(Constructor,staticProps),Constructor}(_class,[{key:"elemType",value:function elemType(){return"path"}},{key:"translatePoints",value:function translatePoints(data,config){return tick_mixin_pointTranslators[this.coord()](data,config,this)}},{key:"attachDataToVoronoi",value:function attachDataToVoronoi(points){helpers_attachDataToVoronoi(this._voronoi,points,function(d){var _d$update=d.update,x=_d$update.x,x0=_d$update.x0,y=_d$update.y;return{x:x+(x0-x)/2,y:y+(_d$update.y0-y)/2}})}},{key:"getMeasurementConfig",value:function getMeasurementConfig(offsetX,offsetY,widthSpan,heightSpan){return{offset:{x:offsetX||0,y:offsetY||0},span:{x:widthSpan,y:heightSpan}}}},{key:"addOverlayPath",value:function addOverlayPath(refElement,data,style,strokePosition){var pathElement;this._overlayPath[data.rowId]?pathElement=this._overlayPath[data.rowId]:((pathElement=makeElement(refElement,"path",[data.update],null,{},function(d){return"".concat(d.x," ").concat(data.rowId)})).style("fill","none"),pathElement.style("fill-opacity",0),pathElement.attr("id",data.rowId),this._overlayPath[data.rowId]=pathElement);var offsetM={x:0,y:0},offsetL={x:0,y:0};if("stroke-width"===style.type){var _strokeWidthPositionM=function strokeWidthPositionMap(_ref){var width=_ref.width,_ref$position=_ref.position,offset=width?width/2:1;return{center:{M:{x:0,y:0},L:{x:0,y:0}},inside:{M:{x:+offset,y:+offset},L:{x:-offset,y:+offset}},outside:{M:{x:-offset,y:-offset},L:{x:+offset,y:-offset}}}[void 0===_ref$position?"center":_ref$position]}({width:parseInt(style.value,10),position:strokePosition}),L=_strokeWidthPositionM.L,M=_strokeWidthPositionM.M;offsetM=M,offsetL=L}pathElement.attr("d",function(d){return d.update?"M ".concat(d.update.x+offsetM.x," ").concat(d.update.y+offsetM.y,"\n                    L ").concat(d.update.x0+offsetL.x," ").concat(d.update.y0+offsetL.y):"M ".concat(d.x+offsetM.x," ").concat(d.y+offsetM.y,"\n                L ").concat(d.x0+offsetL.x," ").concat(d.y0+offsetL.y)});var styleVal=style.value;"function"==typeof styleVal&&(styleVal=styleVal(pathElement.style(style.type)));pathElement.style(style.type,styleVal),appendElement(refElement,pathElement.node())}},{key:"removeOverlayPath",value:function removeOverlayPath(data,style){var currentPath=this._overlayPath[data.rowId];currentPath&&(currentPath.node().removeAttribute("style"),Object.keys(style).forEach(function(s){return currentPath.style(s,style[s])}),currentPath.style("fill-opacity",0))}}],[{key:"defaultConfig",value:function defaultConfig(){return tick_default_config_defaultConfig}},{key:"formalName",value:function formalName(){return"tick"}},{key:"drawFn",value:function drawFn(){return tick_renderer}}]),_class}()};function tick_typeof(obj){"@babel/helpers - typeof";return(tick_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function tick_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function tick_possibleConstructorReturn(self,call){return!call||"object"!==tick_typeof(call)&&"function"!=typeof call?function tick_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function tick_getPrototypeOf(o){return(tick_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function tick_setPrototypeOf(o,p){return(tick_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var TickLayer=function(_mix$with){function TickLayer(){return function tick_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TickLayer),tick_possibleConstructorReturn(this,tick_getPrototypeOf(TickLayer).apply(this,arguments))}return function tick_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&tick_setPrototypeOf(subClass,superClass)}(TickLayer,mix(base_layer_BaseLayer)["with"](base_mixin_BaseLayerMixin,point_mixin_PointLayerMixin,tick_mixin_TickLayerMixin)),function tick_createClass(Constructor,protoProps,staticProps){return protoProps&&tick_defineProperties(Constructor.prototype,protoProps),staticProps&&tick_defineProperties(Constructor,staticProps),Constructor}(TickLayer,null,[{key:"formalName",value:function formalName(){return"tick"}}]),TickLayer}(),layer_types_AREA_LAYER="area",layer_types_ARC_LAYER="arc",layer_types_LINE_LAYER="line",layer_types_TEXT_LAYER="text",layer_types_POINT_LAYER="point",layer_types_BAR_LAYER="bar",layer_types_TICK_LAYER="tick",layer_types_SIMPLE_LAYER="simple",layer_types_BASE_LAYER="base";function layer_factory_toConsumableArray(arr){return function layer_factory_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function layer_factory_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function layer_factory_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var _DEFAULT_LAYERS,sanitizeEncoding=function sanitizeEncoding(encoding){for(var key in encoding)"string"==typeof encoding[key]&&(encoding[key]={field:encoding[key]})},src_layer_factory=function(){var compositeLayers={},factoryObj={setLayerRegistry:function setLayerRegistry(reg){factoryObj._layerRegistry=reg},getSerializedConf:function getSerializedConf(mark,layerDef){var serializedDefs,defs=compositeLayers[mark],newConf=mergeRecursive({},layerDef);if(defs)serializedDefs=defs.map(function(unitLayerDef){var sDef={};return function parseLayerDefinition(sink,definition,layerDef,layerType){for(var key in definition)if(Object.hasOwnProperty.call(definition,key)){var strs=void 0,propValue=void 0,def=definition[key];isSimpleObject(def)?(sink[key]={},parseLayerDefinition(sink[key],def,layerDef,layerType)):"string"==typeof def&&(strs=def.split("."))&&strs[0]===layerType?void 0!==(propValue=getObjProp.apply(void 0,[layerDef].concat(layer_factory_toConsumableArray(strs.slice(1,strs.length)))))&&(sink[key]=propValue):sink[key]=def}}(sDef,unitLayerDef,newConf,mark),sanitizeEncoding(sDef.encoding),sDef});else{var encoding=newConf.encoding;sanitizeEncoding(encoding),serializedDefs=newConf}return serializedDefs},getLayerInstance:function getLayerInstance(layerDef){for(var _len=arguments.length,params=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)params[_key-1]=arguments[_key];var layerRegistry=factoryObj._layerRegistry,instances=(layerDef=layerDef instanceof Array?layerDef:[layerDef]).map(function(layerObj){var layerConstructor=layerRegistry[layerObj.mark];return layerConstructor.create.apply(layerConstructor,params)});return 1===instances.length?instances[0]:instances},getLayerClass:function getLayerClass(mark){return factoryObj._layerRegistry[mark]},composeLayers:function composeLayers(layerType,layerDefs){compositeLayers[layerType]=layerDefs},sanitizeLayerConfig:function sanitizeLayerConfig(layerDef){var newConf=mergeRecursive({},layerDef);return sanitizeEncoding(newConf.encoding),newConf}};return factoryObj}();function defaults_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DEFAULT_LAYERS=(defaults_defineProperty(_DEFAULT_LAYERS={},layer_types_AREA_LAYER,area_AreaLayer),defaults_defineProperty(_DEFAULT_LAYERS,layer_types_ARC_LAYER,ArcLayer),defaults_defineProperty(_DEFAULT_LAYERS,layer_types_LINE_LAYER,line_LineLayer),defaults_defineProperty(_DEFAULT_LAYERS,layer_types_TEXT_LAYER,TextLayer),defaults_defineProperty(_DEFAULT_LAYERS,layer_types_POINT_LAYER,point_PointLayer),defaults_defineProperty(_DEFAULT_LAYERS,layer_types_TICK_LAYER,TickLayer),defaults_defineProperty(_DEFAULT_LAYERS,layer_types_BAR_LAYER,bar_BarLayer),defaults_defineProperty(_DEFAULT_LAYERS,layer_types_BASE_LAYER,base_layer_BaseLayer),_DEFAULT_LAYERS),layer_registry=function(){var layers=arguments.length>0&&void 0!==arguments[0]?arguments[0]:DEFAULT_LAYERS,reg=Object.assign({},layers),regObj={register:function register(def){var key=def.formalName();return reg[key]=def,regObj},get:function get(){return reg}};return regObj},helpers=Object.assign(helpers_namespaceObject,{pointLayerHelpers:point_helper_namespaceObject}),layerMixins={BarLayerMixin:bar_mixin_BarLayerMixin,BaseLayerMixin:base_mixin_BaseLayerMixin,LineLayerMixin:line_mixin_LineLayerMixin,AreaLayerMixin:area_mixin_AreaLayerMixin,PointLayerMixin:point_mixin_PointLayerMixin,TextLayerMixin:text_mixin_TextLayerMixin,TickLayerMixin:tick_mixin_TickLayerMixin,ArcLayerMixin:arc_mixin_ArcLayerMixin};function src_helper_toConsumableArray(arr){return function src_helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function src_helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function src_helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var helper_getDimensionMeasureMap=function getDimensionMeasureMap(layers,fieldsConfig){var retinalEncodingsAndMeasures={};for(var key in layers.forEach(function(layer){var _layer$encodingFields=layer.encodingFieldsInf(),colorField=_layer$encodingFields.colorField,sizeField=_layer$encodingFields.sizeField,shapeField=_layer$encodingFields.shapeField,measures=[_layer$encodingFields.xField,_layer$encodingFields.yField].filter(function(field){return fieldsConfig[field]&&fieldsConfig[field].def.type===dist_datamodel.FieldType.MEASURE});[colorField,sizeField,shapeField].forEach(function(field){var _retinalEncodingsAndM;getObjProp(fieldsConfig,field,"def","type")===dist_datamodel.FieldType.DIMENSION&&measures.length&&(!retinalEncodingsAndMeasures[field]&&(retinalEncodingsAndMeasures[field]=[]),(_retinalEncodingsAndM=retinalEncodingsAndMeasures[field]).push.apply(_retinalEncodingsAndM,src_helper_toConsumableArray(measures)))})}),retinalEncodingsAndMeasures)({}).hasOwnProperty.call(retinalEncodingsAndMeasures,key)&&(retinalEncodingsAndMeasures[key]=src_helper_toConsumableArray(new Set(retinalEncodingsAndMeasures[key])));return retinalEncodingsAndMeasures},transformDataModels=function transformDataModels(transform,dataModel){var dataModels={};for(var key in transform)if({}.hasOwnProperty.call(transform,key)){var transformVal=transform[key];dataModels[key]=transformVal(dataModel)}return dataModels},helper_getLayerFromDef=function getLayerFromDef(context,definition,existingLayer,namespaces){var instances=existingLayer,dependencies=context._dependencies,metaInf=context.metaInf();existingLayer||(instances=src_layer_factory.getLayerInstance(definition),toArray(instances).forEach(function(inst,i){inst.metaInf({unitRowIndex:metaInf.rowIndex,unitColIndex:metaInf.colIndex,namespace:namespaces[i],parentNamespace:metaInf.namespace}).dependencies(dependencies).store(context.store())}));var layers={},instanceArr=toArray(instances);return(definition=toArray(definition)).reduce(function(acc,def,idx){var instance=instanceArr[idx];return instance.coord(context.coord()),instance.config(def),instance.valueParser(context.valueParser()),instance.dataProps({timeDiffs:context._timeDiffs}),def.name&&instance.alias(def.name),layers[instance.alias()]=instance,acc},{}),layers},resolveEncodingTransform=function resolveEncodingTransform(layerInst,store){var encodingTransform=layerInst.config().encodingTransform||{},resolvable=encodingTransform.resolvable,depArr=[];if(resolvable){var resolved=resolvable(store);depArr=resolved.depArr,layerInst.encodingTransform(resolved.fn)}else encodingTransform instanceof Function&&layerInst.encodingTransform(encodingTransform);return depArr},helper_sanitizeLayerDef=function sanitizeLayerDef(layerDefs){var sanitizedDefs=[];return layerDefs.forEach(function(layerDef,i){var def=layerDef.def,mark=layerDef.mark;if(def)def.name||(def.name="".concat(mark,"-").concat(i)),sanitizedDefs.push(layerDef);else{var sConf=src_layer_factory.getSerializedConf(layerDef.mark,layerDef);sConf.name||(sConf.name="".concat(mark,"-").concat(i)),sanitizedDefs.push({mark:layerDef.mark,def:sConf})}}),sanitizedDefs},attachDataToLayers=function attachDataToLayers(layers,dm,transformedDataModels){layers.forEach(function(layer){var dataSource=layer.config().source,dataModel=dataSource instanceof Function?dataSource(dm):transformedDataModels[dataSource]||dm;layer.data(dataModel)})},helper_attachAxisToLayers=function attachAxisToLayers(axes,layers,layerAxisIndex){layers.forEach(function(layer){var layerId=layer.id(),axesObj={};objectIterator(axes,function(key){var axisInf=layerAxisIndex[layerId];if(axisInf){var axisArr=axes[key]||[],axisIndex=axisInf[key]>=0?axisInf[key]:axisArr.length-1;axes[key]&&(axesObj[key]=defaultValue(axes[key][axisIndex]))}}),Object.keys(axesObj).length&&layer.axes(axesObj)})},helper_X=ENCODING.X,helper_Y=ENCODING.Y,helper_RADIUS=ENCODING.RADIUS,helper_ANGLE=ENCODING.ANGLE,helper_ANGLE0=ENCODING.ANGLE0,RADIUS0=ENCODING.RADIUS0,helper_getLayerAxisIndex=function getLayerAxisIndex(layers,fields){var layerAxisIndex={};return layers.forEach(function(layer){var _layer$config=layer.config(),axis=_layer$config.axis,encoding=_layer$config.encoding,id=layer.id();[helper_X,helper_Y,helper_ANGLE,helper_ANGLE0,helper_RADIUS].forEach(function(type){var index,specificField=getObjProp(encoding,type,"field"),encodingField=type===helper_RADIUS?defaultValue(specificField,getObjProp(encoding,RADIUS0,"field")):getObjProp(encoding,type,"field"),field=defaultValue(getObjProp(axis,type),encodingField);index=fields[type]&&fields[type].length?fields[type].findIndex(function(fieldInst){return-1!==fieldInst.getMembers().indexOf(field)}):0,!layerAxisIndex[id]&&(layerAxisIndex[id]={}),layerAxisIndex[id][type]=index})}),layerAxisIndex},helper_unionDomainFromLayers=function unionDomainFromLayers(layers,axisFields,layerAxisIndex,fieldsConfig){var domains={};return(layers=layers.filter(function(layer){return null!==layer.getDataDomain()})).forEach(function(layer){var domainValues={},config=layer.config(),layerDomain=layer.getDataDomain(),layerId=layer.id();null!==layerDomain&&!1!==config.calculateDomain&&(domainValues=Object.entries(layerDomain),domains=domainValues.reduce(function(fieldDomain,domain){var encodingType=domain[0],axisIndex=layerAxisIndex[layerId][encodingType],field=getObjProp(axisFields,encodingType,axisIndex);!fieldDomain[encodingType]&&(fieldDomain[encodingType]={});var encodingDomain=fieldDomain[encodingType];if(field){var fieldStr="".concat(field);encodingDomain[fieldStr]=encodingDomain[fieldStr]||[],encodingDomain[fieldStr]=function getValidDomain(domain,domain1,encodingType,fieldType){return encodingType===helper_ANGLE||encodingType===helper_ANGLE0?domain.concat(domain1.filter(function(d){return-1===domain.indexOf(d)})):unionDomain([domain,domain1],fieldType)}(encodingDomain[fieldStr],domain[1],encodingType,fieldsConfig[field.getMembers()[0]].def.subtype)}return fieldDomain},domains))}),domains},helper_renderLayers=function renderLayers(context,container,layers,measurement){context._lifeCycleManager.notify({client:layers,action:"beforedraw",formalName:"layer"});var classPrefix=context.config().classPrefix,orderedLayers=layers.sort(function(a,b){return a.config().order-b.config().order}),layerParentGroup=makeElement(container,"g",[1],"".concat(classPrefix,"-layer-group")),layerDepOrder=getDependencyOrder(context._layerDepOrder),groups={};makeElement(layerParentGroup,"g",orderedLayers,null,{update:function update(group,layer){groups[layer.alias()]={group:group,layer:layer}}}),layerDepOrder.map(function(name){return groups[name]}).filter(function(d){return void 0!==d}).forEach(function(o){var layer=o.layer,group=o.group;layer.measurement(measurement),layer.dataProps({timeDiffs:context._timeDiffs}),!1!==layer.config().render&&layer.mount(group.node())})},helper_getNearestDimensionalValue=function getNearestDimensionalValue(context,position){var fields=context.fields();if(!fields.x.length||!fields.y.length)return null;var data=context.data(),axes=context.axes(),fieldsConfig=data.getFieldsConfig(),xField=getObjProp(fields,"x",0).getMembers()[0],yField=getObjProp(fields,"y",0).getMembers()[0],xFieldType=fieldsConfig[xField].def.subtype,yFieldType=fieldsConfig[yField].def.subtype,entryVal=[["x",xFieldType,xField],["y",yFieldType,yField]].find(function(entry){return entry[1]===dist_datamodel.DimensionSubtype.CATEGORICAL||entry[1]===dist_datamodel.DimensionSubtype.TEMPORAL});if(!entryVal||xFieldType!==dist_datamodel.MeasureSubtype.CONTINUOUS&&yFieldType!==dist_datamodel.MeasureSubtype.CONTINUOUS)return null;var field=entryVal[2],index=fieldsConfig[field].index,key=axes[entryVal[0]][0].invert(position[entryVal[0]]);if(entryVal[1]===dist_datamodel.DimensionSubtype.TEMPORAL){var filterData=src_helper_toConsumableArray(new Set(data.getData().data.map(function(d){return d[index]})));key=getNearestValue(filterData,key)}return void 0!==key?[[field],[key]]:null},getLayersBy=function getLayersBy(layers,searchBy,value){return layers.filter(function(layer){return("type"===searchBy?layer.constructor.formalName():layer.alias())===value})},removeLayersBy=function removeLayersBy(layers,searchBy,value){layers.filter(function(inst){return("type"===searchBy?inst.config().mark:inst.alias())!==value||(inst.remove(),!1)})},helper_createSideEffectGroup=function createSideEffectGroup(container,className){return makeElement(container,"g",[1],className).node()},createRenderPromise=function createRenderPromise(unit){unit._renderedPromise.then(function(){unit._renderedPromise=new Promise(function(resolve){unit._renderedResolve=resolve}),createRenderPromise(unit)})},getRadiusRange=function getRadiusRange(width,height){var config=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},innerRadius=config.innerRadius,outerRadius=config.outerRadius;return[innerRadius||0,outerRadius||Math.min(height,width)/2]},helper_setAxisRange=function setAxisRange(context){var radiusAxes=context.axes().radius;radiusAxes&&radiusAxes.forEach(function(axis){axis.range(getRadiusRange(context.width(),context.height()))})},helper_createRTree=function createRTree(context){var _ref,elements=(_ref=[]).concat.apply(_ref,src_helper_toConsumableArray(context.layers().filter(function(layer){return!1!==layer.config().interactive}).map(function(layer){return layer.getBoundBoxes()}))).flat().filter(function(d){return null!==d}),rtree=new RTree;return rtree.load(elements),rtree},reactive_props_CONFIG="config",reactive_props_DATA="data",AXES="axes",LAYERDEFS="layerDef",reactive_props_WIDTH="width",reactive_props_HEIGHT="height",reactive_props_MOUNT="mount",reactive_props_TRANSFORM="transform",TRANSFORMEDDATA="transformedData",DATADOMAIN="dataDomain",FIELDS="fields",LAYERAXISINDEX="layerAxisIndex",reactive_props_LAYERS="layers",reactive_props_DOMAIN="domain",enums_constants_CLASSPREFIX="muze",IDFIELD="__id__",GRID_LINE_PARENT_GROUP_CLASS="grid-lines",GRID_BAND_PARENT_GROUP_CLASS="grid-bands",GRID_PARENT_GROUP="grid-parent-group",enums_constants_BAND="band",TICK="tick",GRID_BAND="gridBands",GRID_LINE="gridLines",CONSOLIDATED="consolidated",FRAGMENTED="fragmented",FACET_BY_FIELDS="facetByFields",RETINAL_FIELDS="retinalFields",PARENT_ALIAS="parentAlias",constants_LAYERS="layers",CACHED_DATA="cachedData",STORE="store",DRAG="drag",HOVER="hover",SELECTIONDRAG="selectiondrag",CLICK="click",LONGTOUCH="longtouch",TOUCHDRAG="touchdrag",ALL_ACTIONS="*",SELECTION_NEW_ENTRY=1,SELECTION_NEW_EXIT=-1,SELECTION_NULL=0,SELECTION_OLD_ENTRY=2,SELECTION_OLD_EXIT=-2;function selection_set_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var src_selection_set=function(){function SelectionSet(_ref,_volatile){var keys=_ref.keys,fields=_ref.fields;for(var key in function selection_set_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SelectionSet),this.completeSet=keys,this._set={},this._uidMap={},this._measureNames={},this._dimVals={},keys)this._set[key]=SELECTION_NULL,this._uidMap[key]=keys[key].uid,this._measureNames[key]=keys[key].measureNames,this._dimVals[key]=keys[key].dims;this._fields=fields,this._fieldIndices=fields.reduce(function(acc,v,i){return acc[v]=i,acc},{}),this._volatile=_volatile,this._completeSetCount=Object.keys(keys).length,this._resetted=!0}return function selection_set_createClass(Constructor,protoProps,staticProps){return protoProps&&selection_set_defineProperties(Constructor.prototype,protoProps),staticProps&&selection_set_defineProperties(Constructor,staticProps),Constructor}(SelectionSet,[{key:"add",value:function add(ids){this._resetted=!1;var set=this._set;for(var key in ids.forEach(function(i){i in set&&(set[i]=SELECTION_NEW_ENTRY)}),set)set[key]!==SELECTION_NEW_ENTRY&&set[key]!==SELECTION_OLD_ENTRY&&(set[key]=set[key]<0?SELECTION_OLD_EXIT:SELECTION_NEW_EXIT);return this}},{key:"update",value:function update(ids){var set=this._set;return ids.forEach(function(i){i in set&&(set[i]=SELECTION_OLD_ENTRY)}),this}},{key:"updateEntry",value:function updateEntry(){var set=this._set;for(var key in set)set[key]=set[key]===SELECTION_NEW_ENTRY?SELECTION_OLD_ENTRY:set[key];return this}},{key:"updateExit",value:function updateExit(){var set=this._set;for(var key in set)set[key]=set[key]===SELECTION_NEW_EXIT?SELECTION_OLD_EXIT:set[key];return this}},{key:"remove",value:function remove(ids){this._resetted=!1;var set=this._set;for(var key in ids.forEach(function(i){i in set&&(set[i]=SELECTION_NEW_EXIT)}),set)set[key]!==SELECTION_NEW_EXIT&&set[key]!==SELECTION_OLD_EXIT&&(set[key]=0===set[key]?SELECTION_NEW_ENTRY:SELECTION_OLD_ENTRY);return this}},{key:"getSets",value:function getSets(){var _this=this,config=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},set=this._set,uidMap=this._uidMap,retObj={entrySet:[[],[]],exitSet:[[],[]],mergedEnter:[],mergedExit:[],completeSet:[]},dimVals=this._dimVals,keepDims=config.keepDims,_config$fields=config.fields,fields=void 0===_config$fields?[]:_config$fields,_config$keys=config.keys,keys=void 0!==_config$keys&&_config$keys,measureNames=this._measureNames,_loop=function _loop(key){var measureNamesArr=measureNames[key]||[],val=void 0;val=keepDims?fields.map(function(field){return field===reserved_fields.MEASURE_NAMES?measureNamesArr:field===reserved_fields.ROW_ID?uidMap[key]:dimVals[key][_this._fieldIndices[field]]}):keys?key:measureNamesArr.length?[uidMap[key],measureNamesArr]:[uidMap[key]],set[key]>0?([SELECTION_OLD_ENTRY,SELECTION_NEW_ENTRY].forEach(function(v,i){set[key]===v&&retObj.entrySet[i].push(val)}),set[key]!==SELECTION_OLD_ENTRY&&set[key]!==SELECTION_NEW_ENTRY||retObj.mergedEnter.push(val)):set[key]<0&&([SELECTION_OLD_EXIT,SELECTION_NEW_EXIT].forEach(function(v,i){set[key]===v&&retObj.exitSet[i].push(val)}),set[key]!==SELECTION_OLD_EXIT&&set[key]!==SELECTION_NEW_EXIT||retObj.mergedExit.push(val)),retObj.completeSet.push(val)};for(var key in set)_loop(key);return retObj}},{key:"reset",value:function reset(ids){var set=this._set;if(ids)ids.forEach(function(i){i in set&&(set[i]=SELECTION_NULL)});else for(var key in set)set[key]=SELECTION_NULL;return this._resetted=!0,this}},{key:"getEntrySet",value:function getEntrySet(){var set=this._set,addSet=[];for(var key in set)set[key]===SELECTION_NEW_ENTRY&&addSet.push(key);return addSet}},{key:"getExistingEntrySet",value:function getExistingEntrySet(addSet){var set=this._set;return addSet.filter(function(d){return set[d]===SELECTION_NEW_ENTRY||set[d]===SELECTION_OLD_ENTRY})}},{key:"getExistingExitSet",value:function getExistingExitSet(removeSet){var set=this._set;return removeSet.filter(function(d){return set[d]===SELECTION_NEW_EXIT||set[d]===SELECTION_OLD_EXIT})}},{key:"getExitSet",value:function getExitSet(){var set=this._set,removeSet=[];for(var key in set)set[key]===SELECTION_NEW_EXIT&&removeSet.push(key);return removeSet}},{key:"getCompleteSet",value:function getCompleteSet(){var set=this._set,completeSet=[];for(var key in set)completeSet.push(key);return completeSet}},{key:"getCompleteSetCount",value:function getCompleteSetCount(){return this._completeSetCount}},{key:"resetted",value:function resetted(){return this._resetted}}]),SelectionSet}();function muze_firebolt_src_helper_toConsumableArray(arr){return function muze_firebolt_src_helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function muze_firebolt_src_helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function muze_firebolt_src_helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var changeSideEffectAvailability=function changeSideEffectAvailability(context,fn,toEnable){var sideEffects=context.sideEffects();for(var key in sideEffects)if({}.hasOwnProperty.call(sideEffects,key)){var change=!0;fn&&!1===fn(key)&&(change=!1),change&&(toEnable?sideEffects[key].enable():sideEffects[key].disable())}},getMergedSet=function getMergedSet(set){return muze_firebolt_src_helper_toConsumableArray(new Set([].concat(muze_firebolt_src_helper_toConsumableArray(set[0]),muze_firebolt_src_helper_toConsumableArray(set[1]))))},getSideEffects=function getSideEffects(behaviour,behaviourEffectMap){var sideEffects=[];for(var key in behaviourEffectMap){var behaviours=key.split(",");behaviours.some(function(d){return d===behaviour})&&sideEffects.push({effects:behaviourEffectMap[key],behaviours:behaviours})}return sideEffects};function firebolt_typeof(obj){"@babel/helpers - typeof";return(firebolt_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function firebolt_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function firebolt_toConsumableArray(arr){return function firebolt_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function firebolt_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function firebolt_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var firebolt_getUidsFromCriteria=function getUidsFromCriteria(data,_ref){var dm=_ref.dm,dimensionsMap=_ref.dimensionsMap,dimsMapGetter=_ref.dimsMapGetter,_ref$addMeasures=_ref.addMeasures,addMeasures=void 0===_ref$addMeasures||_ref$addMeasures,fieldsConfig=Object.assign({},dm.getFieldsConfig(),function firebolt_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},reserved_fields.ROW_ID,{index:Object.keys(dm.getFieldsConfig()).length,def:{name:reserved_fields.ROW_ID,type:dist_datamodel.FieldType.DIMENSION}}));if(null===data)return null;for(var criteriaFields=data[0],fields=criteriaFields.length?criteriaFields.map(function(d,i){return{name:d,index:i}}):[],fieldIndexMap=fields.reduce(function(acc,v,i){return acc[v.name]=i,acc},{}),uids=[],measureNameField=criteriaFields.find(function(field){return field===reserved_fields.MEASURE_NAMES}),propDims=fields.filter(function(d){return d.name in fieldsConfig}).map(function(d){return d.name}),dimsMap=dimsMapGetter(propDims,fieldsConfig),_loop=function _loop(i,len){var row=data[i],dimKey=propDims.map(function(field){return row[fieldIndexMap[field]]}),origRow=dimsMap[dimKey];origRow&&origRow.forEach(function(rowVal){var rowId=rowVal[rowVal.length-1];if(measureNameField){var _measuresArr=row[fieldIndexMap[measureNameField]];_measuresArr.length?uids.push(_measuresArr.length?[rowId,_measuresArr]:[rowId]):(_measuresArr=dimensionsMap[rowId].length?dimensionsMap[rowId]:[]).length?_measuresArr.forEach(function(measures){uids.push([rowId,measures])}):uids.push([rowId])}else{(dimensionsMap[rowId].length?dimensionsMap[rowId]:[[]]).forEach(function(measures){uids.push([rowId].concat(firebolt_toConsumableArray(addMeasures?measures:[])))})}})},i=1,len=data.length;i<len;i++)_loop(i);return uids},firebolt_cloneObj=function cloneObj(behaviourEffectMap){return Object.keys(behaviourEffectMap).reduce(function(acc,key){var cloned=behaviourEffectMap[key].map(function(d){var clonedVal=d;return isSimpleObject(d)&&(clonedVal=mergeRecursive({},d)),clonedVal});return acc[key]=cloned,acc},{})},firebolt_Firebolt=function(){function Firebolt(context,actions,sideEffects,behaviourEffectMap){!function firebolt_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Firebolt),this.context=context,this._sideEffectDefinitions={},this._sideEffects={},this._propagationInf={},this._sourceSelectionSet={},this._actions={behavioural:{},physical:{}},this._selectionSet={},this._volatileSelectionSet={},this._propagationFields={},this._sideEffectPolicies={},this._propagationBehaviourMap={},this._behaviourPolicies={},this._actionBehaviourMap={},this._config={},this._behaviourEffectMap={},this._entryExitSet={},this._actionHistory={},this._queuedSideEffects={},this._handlers={},this._payloadGenerators={},this._payloads={},this.mapSideEffects(firebolt_cloneObj(behaviourEffectMap)),this.registerBehaviouralActions(actions.behavioural),this.registerSideEffects(sideEffects),this.registerPhysicalBehaviouralMap(actions.physicalBehaviouralMap),this.registerPhysicalActions(actions.physical)}return function firebolt_createClass(Constructor,protoProps,staticProps){return protoProps&&firebolt_defineProperties(Constructor.prototype,protoProps),staticProps&&firebolt_defineProperties(Constructor,staticProps),Constructor}(Firebolt,[{key:"config",value:function config(){return arguments.length?(this._config=mergeRecursive(this._config,arguments.length<=0?void 0:arguments[0]),function setSideEffectConfig(sideEffects,config){for(var key in sideEffects){var sideEffect=sideEffects[key],sideEffectConf=config[sideEffect.constructor.formalName()];sideEffectConf&&sideEffect.config(sideEffectConf)}}(this.sideEffects(),this._config),this):this._config}},{key:"mapSideEffects",value:function mapSideEffects(behEffectMap){var behaviourEffectMap=this._behaviourEffectMap;for(var key in behEffectMap)if({}.hasOwnProperty.call(behEffectMap,key)){var sideEffects=behEffectMap[key]||[],preventDefaultActions=!1,effectNames=void 0;isSimpleObject(sideEffects)?(effectNames=sideEffects.effects,preventDefaultActions=sideEffects.preventDefaultActions):effectNames=sideEffects,effectNames=effectNames.map(function(effect){return isSimpleObject(effect)?effect:{name:effect}}),!behaviourEffectMap[key]&&(behaviourEffectMap[key]=[]),this._behaviourEffectMap[key]=firebolt_toConsumableArray(new Set(preventDefaultActions?effectNames:[].concat(firebolt_toConsumableArray(behaviourEffectMap[key]),firebolt_toConsumableArray(effectNames))))}return this}},{key:"registerBehaviouralActions",value:function registerBehaviouralActions(actions){var behaviours=function initializeBehaviouralActions(context,actions){var dispatchableBehaviours={};return(actions=actions instanceof Array?actions:Object.values(actions)).forEach(function(Action){dispatchableBehaviours[Action.formalName()]=new Action(context)}),dispatchableBehaviours}(this,actions);return this.prepareSelectionSets(behaviours),Object.assign(this._actions.behavioural,behaviours),this}},{key:"prepareSelectionSets",value:function prepareSelectionSets(){return this}},{key:"registerSideEffects",value:function registerSideEffects(sideEffects){for(var key in sideEffects)this._sideEffectDefinitions[sideEffects[key].formalName()]=sideEffects[key];return this.initializeSideEffects(),this}},{key:"applySideEffects",value:function applySideEffects(sideEffects,selectionSet,payload){var _this=this,sideEffectStore=this.sideEffects(),actionHistory=this._actionHistory,queuedSideEffects=this._queuedSideEffects;return sideEffects.forEach(function(sideEffect){var effects=sideEffect.effects,behaviours=sideEffect.behaviours;effects.forEach(function(effect){var name,options={};"object"===firebolt_typeof(effect)?(name=effect.name,options=effect.options||{}):name=effect;var sideEffectInstance=sideEffectStore[name];sideEffectInstance&&sideEffectInstance.isEnabled()&&(!sideEffectInstance.constructor.mutates()&&Object.values(actionHistory).some(function(d){return d.isMutableAction})?queuedSideEffects["".concat(name,"-").concat(behaviours.join())]={name:name,params:[selectionSet,payload,options]}:_this.dispatchSideEffect(name,selectionSet,payload,options))})}),this}},{key:"dispatchSideEffect",value:function dispatchSideEffect(name,selectionSet,payload){var options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},sideEffect=this.sideEffects()[name],setTransform=options.setTransform;selectionSet=setTransform?setTransform(selectionSet,payload,sideEffect):selectionSet,sideEffect.apply(selectionSet,payload,options)}},{key:"registerPropagationBehaviourMap",value:function registerPropagationBehaviourMap(map){return this._propagationBehaviourMap=Object.assign(this._propagationBehaviourMap,map||{}),this}},{key:"shouldApplyHighlightEffect",value:function shouldApplyHighlightEffect(){return!0}},{key:"dispatchBehaviour",value:function dispatchBehaviour(behaviour,payload){var propagationInfo=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},propagate=void 0===propagationInfo.propagate||propagationInfo.propagate,action=this._actions.behavioural[behaviour],behaviourEffectMap=this._behaviourEffectMap,sideEffects=getSideEffects(behaviour,behaviourEffectMap);if(this._propagationInf=propagationInfo,this._payloads[behaviour]=payload,action){action.dispatch(payload),this._entryExitSet[behaviour]=action.entryExitSet();var shouldApplySideEffects=this.shouldApplySideEffects(propagationInfo);if(this.shouldApplyHighlightEffect(behaviour)&&(propagate&&this.propagate(behaviour,payload,action.propagationIdentifiers(),{sideEffects:sideEffects}),shouldApplySideEffects)){var applicableSideEffects=this.getApplicableSideEffects(sideEffects,payload,propagationInfo);this.applySideEffects(applicableSideEffects,this.getEntryExitSet(behaviour),payload)}}return this}},{key:"getPropagationSelectionSet",value:function getPropagationSelectionSet(selectionSet){return selectionSet.find(function(d){return!d.sourceSelectionSet})}},{key:"shouldApplySideEffects",value:function shouldApplySideEffects(){return!0}},{key:"changeBehaviourStateOnPropagation",value:function changeBehaviourStateOnPropagation(behaviour,value){var key=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",behaviourConditions=this._behaviourPolicies[behaviour]||(this._behaviourPolicies[behaviour]={});return value instanceof Function?behaviourConditions[key]=value:behaviourConditions[key]=function(){return value},this}},{key:"changeSideEffectStateOnPropagation",value:function changeSideEffectStateOnPropagation(sideEffect,value){var key=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",sideEffectConditions=this._sideEffectPolicies[sideEffect]||(this._sideEffectPolicies[sideEffect]={});value instanceof Function?sideEffectConditions[key]=value:sideEffectConditions[key]=function(){return value}}},{key:"removeSideEffectPolicy",value:function removeSideEffectPolicy(sideEffect,key){return delete this._sideEffectPolicies[sideEffect][key],this}},{key:"removeBehaviourPolicy",value:function removeBehaviourPolicy(behaviour,key){return delete this._behaviourPolicies[behaviour][key],this}},{key:"propagate",value:function propagate(){return this}},{key:"sideEffects",value:function sideEffects(){return arguments.length?(this._sideEffects=arguments.length<=0?void 0:arguments[0],this):this._sideEffects}},{key:"enableSideEffects",value:function enableSideEffects(fn){return changeSideEffectAvailability(this,fn,!0),this}},{key:"disableSideEffects",value:function disableSideEffects(fn){return changeSideEffectAvailability(this,fn,!1),this}},{key:"dissociateBehaviour",value:function dissociateBehaviour(behaviour,physicalAction){var actionBehaviourMap=this._actionBehaviourMap;for(var key in actionBehaviourMap)if(key===physicalAction){var behaviourMap=actionBehaviourMap[key];behaviourMap.behaviours=behaviourMap.behaviours.filter(function(d){return d!==behaviour}),this.mapActionsAndBehaviour(key)}return this}},{key:"dissociateSideEffect",value:function dissociateSideEffect(sideEffect,behaviour){var behaviourEffectMap=this._behaviourEffectMap;return behaviourEffectMap[behaviour]=behaviourEffectMap[behaviour].filter(function(d){return(d.name||d)!==sideEffect}),this}},{key:"getApplicableSideEffects",value:function getApplicableSideEffects(sideEffects){return sideEffects}},{key:"attachPropagationListener",value:function attachPropagationListener(dataModel){var handler=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.onDataModelPropagation();return dataModel.unsubscribe("propagation"),dataModel.on("propagation",handler),this}},{key:"onDataModelPropagation",value:function onDataModelPropagation(){var _this2=this;return function(propValue){var payload=propValue.payload,action=payload.action;_this2.dispatchBehaviour(action,payload,{propagate:!1})}}},{key:"createSelectionSet",value:function createSelectionSet(uniqueIds,behaviouralActions){var behaviours=behaviouralActions||this._actions.behavioural,selectionSet=this._selectionSet,volatileSelectionSet=this._volatileSelectionSet;for(var key in behaviours)({}).hasOwnProperty.call(behaviours,key)&&(selectionSet[key]=new src_selection_set(uniqueIds),volatileSelectionSet[key]=new src_selection_set(uniqueIds,!0),this._entryExitSet[key]=null);return this._volatileSelectionSet=volatileSelectionSet,this.selectionSet(selectionSet),this}},{key:"selectionSet",value:function selectionSet(){return arguments.length?(this._selectionSet=arguments.length<=0?void 0:arguments[0],this):this._selectionSet}},{key:"initializeSideEffects",value:function initializeSideEffects(){var sideEffectDefinitions=this._sideEffectDefinitions;return this.sideEffects(function initializeSideEffects(context,sideEffects){var sideEffectsMap=context._sideEffects;return(sideEffects=sideEffects instanceof Array?sideEffects:Object.values(sideEffects)).forEach(function(SideEffect){var formalName=SideEffect.formalName(),target=SideEffect.target();if(target===context.target()||"all"===target){var sideEffectInstance=sideEffectsMap[formalName];sideEffectsMap[formalName]=sideEffectInstance||new SideEffect(context)}}),sideEffectsMap}(this,sideEffectDefinitions)),this}},{key:"target",value:function target(){return"all"}},{key:"registerPhysicalActions",value:function registerPhysicalActions(actions){var initedActions=function initializePhysicalActions(context,actions){var physicalActions={};for(var name in actions)({}).hasOwnProperty.call(name,actions)||(physicalActions[name]=actions[name](context));return physicalActions}(arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,actions);return Object.assign(this._actions.physical,initedActions),this}},{key:"propagateWith",value:function propagateWith(action,fields){var append=arguments.length>2&&void 0!==arguments[2]&&arguments[2],behaviouralActions=this._actions.behavioural;if(action===ALL_ACTIONS)for(var key in behaviouralActions)this._propagationFields[key]={fields:fields,append:append};else this._propagationFields[action]={fields:fields,append:append};return this}},{key:"mapActionsAndBehaviour",value:function mapActionsAndBehaviour(phyAction){var initedPhysicalActions=this._actions.physical,map=this._actionBehaviourMap;for(var action in map)if(!{}.hasOwnProperty.call(action,map)&&action===(phyAction||action)){var target=void 0,mapObj=map[action];target=mapObj.target;var touch=mapObj.touch;target||(target=this.context.getDefaultTargetContainer()),(hasTouch()?!0===touch||void 0===touch:!touch)&&this.bindActionWithBehaviour(initedPhysicalActions[action],target,mapObj.behaviours)}return this.registerPhysicalActionHandlers(),this}},{key:"registerPhysicalBehaviouralMap",value:function registerPhysicalBehaviouralMap(map){return this._actionBehaviourMap=mergeRecursive(this._actionBehaviourMap,map),this}},{key:"bindActionWithBehaviour",value:function bindActionWithBehaviour(action,targets,behaviourList){var _this3=this;return"string"==typeof targets&&(targets=[targets]),targets.forEach(function(target){var mount=_this3.context.mount(),nodes=target.node instanceof Function?target:renderer_utils_selectElement(mount).selectAll(target);nodes.empty()||(nodes instanceof Array?nodes.forEach(function(node){action(renderer_utils_selectElement(node),behaviourList)}):action(nodes,behaviourList))}),this}},{key:"getPropagationInf",value:function getPropagationInf(){return this._propagationInf}},{key:"getAddSetFromCriteria",value:function getAddSetFromCriteria(criteria){var propagationInf=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{model:propagationInf.data?propagationInf.data:null,uids:criteria?function getKeysFromCriteria(criteria,firebolt){if(criteria){var data=firebolt.data(),dimensionsMap=firebolt._metaData.dimensionsMap,values=[];if(isSimpleObject(criteria))getDataModelFromRange(data,criteria).getData({withUid:!0}).data.forEach(function(row){var id=row[row.length-1],measures=criteria[reserved_fields.MEASURE_NAMES]||dimensionsMap[id]||[];measures.length?measures.forEach(function(measureArr){values.push("".concat([id].concat(firebolt_toConsumableArray(measureArr))))}):values.push([id])});else{var dimsMapGetter=firebolt._dimsMapGetter;values=firebolt_getUidsFromCriteria(criteria,{dm:firebolt.data(),dimensionsMap:dimensionsMap,dimsMapGetter:dimsMapGetter})}return values}return null}(criteria,this):null}}},{key:"getSelectionSet",value:function getSelectionSet(action){return this.selectionSet()[action]}},{key:"getFullData",value:function getFullData(){return this.context.data()}},{key:"resetted",value:function resetted(){return this._resetted}},{key:"getEntryExitSet",value:function getEntryExitSet(behaviour){return this._entryExitSet[behaviour]}},{key:"data",value:function data(){return this.context.data()}},{key:"currentData",value:function currentData(){return this.data()}},{key:"triggerPhysicalAction",value:function triggerPhysicalAction(event,payload){var handlers=this._handlers[event]||[],genericHandlers=this._handlers["*"];return[].concat(firebolt_toConsumableArray(Object.values(handlers)),firebolt_toConsumableArray(Object.values(genericHandlers))).forEach(function(fn){fn(event,payload)}),this}},{key:"onPhysicalAction",value:function onPhysicalAction(event,fn,namespace){return!this._handlers[event]&&(this._handlers[event]={}),this._handlers[event][namespace]=fn,this}},{key:"registerPhysicalActionHandlers",value:function registerPhysicalActionHandlers(){var _this4=this;this.onPhysicalAction("*",function(event,payload){_this4._actionBehaviourMap[event].behaviours.forEach(function(beh){return _this4.dispatchBehaviour(beh,payload)})})}},{key:"id",value:function id(){return this.context.id()}},{key:"getRangeFromIdentifiers",value:function getRangeFromIdentifiers(){var _this$context;return(_this$context=this.context).getRangeFromIdentifiers.apply(_this$context,arguments)}},{key:"sanitizePayload",value:function sanitizePayload(payload){return payload}},{key:"payloadGenerators",value:function payloadGenerators(){return arguments.length&&Object.assign(this._payloadGenerators,arguments.length<=0?void 0:arguments[0]),this._payloadGenerators}},{key:"getPayloadGeneratorFor",value:function getPayloadGeneratorFor(action){var defaultFn=this._payloadGenerators.__default,fn=this._payloadGenerators[action];return defaultValue(fn,defaultFn)}},{key:"getPayload",value:function getPayload(action){return this._payloads[action]}},{key:"actions",value:function actions(){return this._actions}}]),Firebolt}();function entry_exit_set_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var entry_exit_set_EntryExitSet=function(){function EntryExitSet(_ref){var uids=_ref.uids,data=_ref.data,filteredModel=_ref.filteredModel;!function entry_exit_set_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,EntryExitSet),this._uids=uids,this._data=data,this._filteredModel=filteredModel,this._model=null}return function entry_exit_set_createClass(Constructor,protoProps,staticProps){return protoProps&&entry_exit_set_defineProperties(Constructor.prototype,protoProps),staticProps&&entry_exit_set_defineProperties(Constructor,staticProps),Constructor}(EntryExitSet,[{key:"uids",get:function get(){return this._uids}},{key:"model",get:function get(){return this._model||(this._model=this._filteredModel(this._data)),this._model}},{key:"length",get:function get(){return this._uids.length}},{key:"aggFns",get:function get(){return common_utils_retrieveNearestGroupByReducers(this._model)}}]),EntryExitSet}();function generic_toConsumableArray(arr){return function generic_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function generic_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function generic_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function generic_slicedToArray(arr,i){return function generic_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function generic_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function generic_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function generic_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var generic_GenericBehaviour=function(){function GenericBehaviour(firebolt){!function generic_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GenericBehaviour),this.firebolt=firebolt,this._enabled=!0}return function generic_createClass(Constructor,protoProps,staticProps){return protoProps&&generic_defineProperties(Constructor.prototype,protoProps),staticProps&&generic_defineProperties(Constructor,staticProps),Constructor}(GenericBehaviour,[{key:"dispatch",value:function dispatch(payload){var criteria=payload.criteria,firebolt=this.firebolt,formalName=this.constructor.formalName(),selectionSet=firebolt.getSelectionSet(formalName),propInf=this.firebolt.getPropagationInf(),_this$getAddSetFromCr=this.getAddSetFromCriteria(criteria,this.firebolt.getPropagationInf()),filteredDataModel=_this$getAddSetFromCr.model,uids=_this$getAddSetFromCr.uids;this._payload=payload,this.setSelectionSet(uids,selectionSet,{filteredDataModel:filteredDataModel,payload:payload}),propInf.sourceId||this.propagationIdentifiers(selectionSet,payload),this.entryExitSet(selectionSet,filteredDataModel,payload)}},{key:"getAddSetFromCriteria",value:function getAddSetFromCriteria(){var _this$firebolt;return(_this$firebolt=this.firebolt).getAddSetFromCriteria.apply(_this$firebolt,arguments)}},{key:"setSelectionSet",value:function setSelectionSet(){return this}},{key:"entryExitSet",value:function entryExitSet(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];if(params.length){var selectionSet=params[0],filteredDataModel=params[1],payload=params[2],_selectionSet$getSets=selectionSet.getSets(),entrySet=_selectionSet$getSets.entrySet,exitSet=_selectionSet$getSets.exitSet,mergedEnter=_selectionSet$getSets.mergedEnter,mergedExit=_selectionSet$getSets.mergedExit,completeSet=_selectionSet$getSets.completeSet,propagationInf=this.firebolt.getPropagationInf();return this._entryExitSet={entrySet:[this.getSetInfo("oldEntry",entrySet[0],filteredDataModel),this.getSetInfo("newEntry",entrySet[1],filteredDataModel)],exitSet:[this.getSetInfo("oldEntry",exitSet[0],filteredDataModel),this.getSetInfo("newExit",exitSet[1],filteredDataModel)],mergedEnter:this.getSetInfo("mergedEnter",mergedEnter,filteredDataModel),mergedExit:this.getSetInfo("mergedExit",mergedExit,filteredDataModel),completeSet:this.getSetInfo("complete",completeSet,filteredDataModel),fields:function getSourceFields(propagationInf){var criteria=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},sourceIdentifiers=propagationInf.sourceIdentifiers;return sourceIdentifiers?sourceIdentifiers.fields.map(function(d){return d.name}):criteria instanceof Array?criteria[0]:Object.keys(criteria||{})}(propagationInf,payload.criteria)},this}return this._entryExitSet}},{key:"getSetInfo",value:function getSetInfo(type,set,filteredDataModel){var sourceId=this.firebolt.getPropagationInf().sourceId,data=this.firebolt.data();return new entry_exit_set_EntryExitSet({uids:set,filteredModel:function filteredModel(fullData){var model=null;if("complete"===type)return fullData;if("mergedEnter"===type&&sourceId)model=filteredDataModel;else{var uidMap=set.reduce(function(acc,v){return acc[v[0]]=1,acc},{});model=fullData.select(function(fields){return fields[reserved_fields.ROW_ID]in uidMap},{saveChild:!1})}return model},data:data})}},{key:"propagationIdentifiers",value:function propagationIdentifiers(){for(var _len2=arguments.length,params=new Array(_len2),_key2=0;_key2<_len2;_key2++)params[_key2]=arguments[_key2];if(params.length){var propData=null,selectionSet=params[0],payload=params[1],fieldsConfig=this.firebolt.data().getFieldsConfig(),criteria=payload.criteria,propagationFields=this._propagationFields;if(selectionSet.resetted()||null===criteria)propData=null;else if(isSimpleObject(criteria)){var fields=Object.keys(criteria),otherFields=generic_slicedToArray(partition(fields,function(d){return fieldsConfig[d]?fieldsConfig[d].def.subtype===dist_datamodel.DimensionSubtype.CATEGORICAL:d===reserved_fields.MEASURE_NAMES}),2)[1],allFields=fields.filter(function(d){return d===reserved_fields.ROW_ID||fieldsConfig[d]&&fieldsConfig[d].def.subtype===dist_datamodel.DimensionSubtype.CATEGORICAL}),mergedEnter=selectionSet.getSets({keepDims:!0,fields:allFields}).mergedEnter;propData={fields:fields.map(function(d){return fieldsConfig[d]?fieldsConfig[d].def:{name:d}}),range:this.firebolt.getRangeFromIdentifiers({criteria:criteria,entrySet:selectionSet.getSets().mergedEnter,fields:otherFields}),identifiers:[[].concat(generic_toConsumableArray(allFields),[reserved_fields.MEASURE_NAMES])].concat(generic_toConsumableArray(mergedEnter))}}else{var _fields=propagationFields?[].concat(generic_toConsumableArray(propagationFields),[reserved_fields.MEASURE_NAMES]):criteria[0],_mergedEnter=selectionSet.getSets({keepDims:!0,fields:_fields}).mergedEnter;propData={fields:_fields.map(function(d){return fieldsConfig[d]?fieldsConfig[d].def:{name:d}}),identifiers:[_fields].concat(generic_toConsumableArray(_mergedEnter))}}return this._propagationIdentifiers=propData,this}return this._propagationIdentifiers}},{key:"enable",value:function enable(){this._enabled=!0}},{key:"disable",value:function disable(){this._enabled=!1}},{key:"isEnabled",value:function isEnabled(){return this._enabled}},{key:"propagateWith",value:function propagateWith(){return this._propagationFields=arguments.length<=0?void 0:arguments[0],this}}],[{key:"mutates",value:function mutates(){return!1}}]),GenericBehaviour}();function volatile_typeof(obj){"@babel/helpers - typeof";return(volatile_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function volatile_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function volatile_possibleConstructorReturn(self,call){return!call||"object"!==volatile_typeof(call)&&"function"!=typeof call?function volatile_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function volatile_getPrototypeOf(o){return(volatile_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function volatile_setPrototypeOf(o,p){return(volatile_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var volatile_VolatileBehaviour=function(_GenericBehaviour){function VolatileBehaviour(){return function volatile_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VolatileBehaviour),volatile_possibleConstructorReturn(this,volatile_getPrototypeOf(VolatileBehaviour).apply(this,arguments))}return function volatile_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&volatile_setPrototypeOf(subClass,superClass)}(VolatileBehaviour,generic_GenericBehaviour),function volatile_createClass(Constructor,protoProps,staticProps){return protoProps&&volatile_defineProperties(Constructor.prototype,protoProps),staticProps&&volatile_defineProperties(Constructor,staticProps),Constructor}(VolatileBehaviour,[{key:"setSelectionSet",value:function setSelectionSet(addSet,selectionSet){if(null===addSet)selectionSet.reset();else if(addSet.length){var existingAddSet=addSet.filter(function(d){return selectionSet._set[d]===SELECTION_NEW_ENTRY||selectionSet._set[d]===SELECTION_OLD_ENTRY});selectionSet.updateExit();var entrySet=selectionSet.getSets({keys:!0}).entrySet;selectionSet.reset(getMergedSet(entrySet)),selectionSet.add(addSet),selectionSet.update(existingAddSet)}else selectionSet.remove(selectionSet.getCompleteSet())}}]),VolatileBehaviour}(),BRUSH="brush",HIGHLIGHT="highlight",behaviours_TOOLTIP="tooltip",FILTER="filter",SELECT="select";function highlight_typeof(obj){"@babel/helpers - typeof";return(highlight_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function highlight_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function highlight_possibleConstructorReturn(self,call){return!call||"object"!==highlight_typeof(call)&&"function"!=typeof call?function highlight_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function highlight_getPrototypeOf(o){return(highlight_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function highlight_setPrototypeOf(o,p){return(highlight_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var highlight_HighlightBehaviour=function(_VolatileBehaviour){function HighlightBehaviour(){return function highlight_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,HighlightBehaviour),highlight_possibleConstructorReturn(this,highlight_getPrototypeOf(HighlightBehaviour).apply(this,arguments))}return function highlight_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&highlight_setPrototypeOf(subClass,superClass)}(HighlightBehaviour,volatile_VolatileBehaviour),function highlight_createClass(Constructor,protoProps,staticProps){return protoProps&&highlight_defineProperties(Constructor.prototype,protoProps),staticProps&&highlight_defineProperties(Constructor,staticProps),Constructor}(HighlightBehaviour,null,[{key:"formalName",value:function formalName(){return HIGHLIGHT}}]),HighlightBehaviour}();function brush_typeof(obj){"@babel/helpers - typeof";return(brush_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function brush_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function brush_possibleConstructorReturn(self,call){return!call||"object"!==brush_typeof(call)&&"function"!=typeof call?function brush_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function brush_getPrototypeOf(o){return(brush_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function brush_setPrototypeOf(o,p){return(brush_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var brush_BrushBehaviour=function(_VolatileBehaviour){function BrushBehaviour(){return function brush_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BrushBehaviour),brush_possibleConstructorReturn(this,brush_getPrototypeOf(BrushBehaviour).apply(this,arguments))}return function brush_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&brush_setPrototypeOf(subClass,superClass)}(BrushBehaviour,volatile_VolatileBehaviour),function brush_createClass(Constructor,protoProps,staticProps){return protoProps&&brush_defineProperties(Constructor.prototype,protoProps),staticProps&&brush_defineProperties(Constructor,staticProps),Constructor}(BrushBehaviour,null,[{key:"formalName",value:function formalName(){return BRUSH}}]),BrushBehaviour}();function filter_typeof(obj){"@babel/helpers - typeof";return(filter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function filter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function filter_possibleConstructorReturn(self,call){return!call||"object"!==filter_typeof(call)&&"function"!=typeof call?function filter_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function filter_getPrototypeOf(o){return(filter_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function filter_setPrototypeOf(o,p){return(filter_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var filter_FilterBehaviour=function(_VolatileBehaviour){function FilterBehaviour(){return function filter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FilterBehaviour),filter_possibleConstructorReturn(this,filter_getPrototypeOf(FilterBehaviour).apply(this,arguments))}return function filter_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&filter_setPrototypeOf(subClass,superClass)}(FilterBehaviour,volatile_VolatileBehaviour),function filter_createClass(Constructor,protoProps,staticProps){return protoProps&&filter_defineProperties(Constructor.prototype,protoProps),staticProps&&filter_defineProperties(Constructor,staticProps),Constructor}(FilterBehaviour,null,[{key:"formalName",value:function formalName(){return FILTER}},{key:"mutates",value:function mutates(){return!0}}]),FilterBehaviour}();function persistent_typeof(obj){"@babel/helpers - typeof";return(persistent_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function persistent_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function persistent_possibleConstructorReturn(self,call){return!call||"object"!==persistent_typeof(call)&&"function"!=typeof call?function persistent_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function persistent_getPrototypeOf(o){return(persistent_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function persistent_setPrototypeOf(o,p){return(persistent_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var persistent_PersistentBehaviour=function(_GenericBehaviour){function PersistentBehaviour(){return function persistent_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PersistentBehaviour),persistent_possibleConstructorReturn(this,persistent_getPrototypeOf(PersistentBehaviour).apply(this,arguments))}return function persistent_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&persistent_setPrototypeOf(subClass,superClass)}(PersistentBehaviour,generic_GenericBehaviour),function persistent_createClass(Constructor,protoProps,staticProps){return protoProps&&persistent_defineProperties(Constructor.prototype,protoProps),staticProps&&persistent_defineProperties(Constructor,staticProps),Constructor}(PersistentBehaviour,[{key:"setSelectionSet",value:function setSelectionSet(addSet,selectionSet){if(null===addSet)selectionSet.reset();else{var propagationInf=this.firebolt.getPropagationInf(),existingAddSet=addSet.filter(function(d){return selectionSet._set[d]===SELECTION_NEW_ENTRY||selectionSet._set[d]===SELECTION_OLD_ENTRY});if(propagationInf.sourceId){selectionSet.updateExit();var entrySet=selectionSet.getSets({keys:!0}).entrySet;selectionSet.reset(getMergedSet(entrySet)),selectionSet.add(addSet),selectionSet.update(existingAddSet)}else selectionSet.updateEntry(),selectionSet.add(addSet)}return this}}]),PersistentBehaviour}();function select_typeof(obj){"@babel/helpers - typeof";return(select_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function select_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function select_possibleConstructorReturn(self,call){return!call||"object"!==select_typeof(call)&&"function"!=typeof call?function select_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function select_getPrototypeOf(o){return(select_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function select_setPrototypeOf(o,p){return(select_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _dragCriteriaRetrieve,select_SelectBehaviour=function(_PersistentBehaviour){function SelectBehaviour(){return function select_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SelectBehaviour),select_possibleConstructorReturn(this,select_getPrototypeOf(SelectBehaviour).apply(this,arguments))}return function select_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&select_setPrototypeOf(subClass,superClass)}(SelectBehaviour,persistent_PersistentBehaviour),function select_createClass(Constructor,protoProps,staticProps){return protoProps&&select_defineProperties(Constructor.prototype,protoProps),staticProps&&select_defineProperties(Constructor,staticProps),Constructor}(SelectBehaviour,[{key:"setSelectionSet",value:function setSelectionSet(addSet,selectionSet){if(null===addSet)selectionSet.reset();else if(addSet.length){var propagationInf=this.firebolt.getPropagationInf(),existingAddSet=addSet.filter(function(d){return selectionSet._set[d]===enums_selection_namespaceObject.SELECTION_NEW_ENTRY||selectionSet._set[d]===enums_selection_namespaceObject.SELECTION_OLD_ENTRY});if(propagationInf.sourceId){selectionSet.updateExit();var entrySet=selectionSet.getSets().entrySet;selectionSet.reset(getMergedSet(entrySet)),selectionSet.add(addSet),selectionSet.update(existingAddSet)}else{existingAddSet.length?(selectionSet.updateExit(),selectionSet.remove(existingAddSet)):(selectionSet.updateEntry(),selectionSet.add(addSet));var exitSet=selectionSet.getSets({keys:!0}).exitSet,mergedExitSet=getMergedSet(exitSet),completeSetCount=selectionSet.getCompleteSet().length;mergedExitSet.length===completeSetCount&&selectionSet.reset()}}else selectionSet.remove(selectionSet.getCompleteSet());return this}}],[{key:"formalName",value:function formalName(){return SELECT}}]),SelectBehaviour}();function drag_action_config_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _physicalActions,dragCriteriaRetriever=(drag_action_config_defineProperty(_dragCriteriaRetrieve={},COORD_TYPES.CARTESIAN,function(firebolt,sourceInfo,_ref){var startPos=_ref.startPos,endPos=_ref.endPos;if(startPos.x===endPos.x&&startPos.y===endPos.y)return{criteria:null};var ranges=firebolt.context.getRangeFromPositions({startPos:startPos,endPos:endPos}),dimensions={};return dimensions.x=[startPos.x,endPos.x],dimensions.y=[startPos.y,endPos.y],{criteria:ranges,dimensions:dimensions}}),drag_action_config_defineProperty(_dragCriteriaRetrieve,COORD_TYPES.POLAR,function(){return{criteria:null}}),_dragCriteriaRetrieve),drag_action_config=function getDragActionConfig(firebolt,config){var context=firebolt.context,sourceInfo=context.getSourceInfo(),coordType=context.coord();return dragCriteriaRetriever[coordType](firebolt,sourceInfo,config)},drag_event_attachDragEvent=function attachDragEvent(targetEl,action,firebolt,touch){var drawingInf,touchStart,startPos={},endPos={},d3Drag=renderer_utils_getD3Drag();targetEl.call(d3Drag().on("start",function(){var event=renderer_utils_getEvent();startPos={x:event.x,y:event.y},drawingInf=firebolt.context.getDrawingContext(),touchStart=(new Date).getTime()}).on("drag",function(){var event=renderer_utils_getEvent();if(endPos={x:event.x,y:event.y},!(touch&&Math.abs(startPos.x-endPos.x)<=5)){endPos.x=Math.max(0,Math.min(endPos.x,drawingInf.width)),endPos.y=Math.max(0,Math.min(endPos.y,drawingInf.height));var newStartPos=Object.assign({},startPos),newEndPos=Object.assign({},endPos);if(startPos.x>endPos.x&&(newStartPos.x=endPos.x,newEndPos.x=startPos.x),startPos.y>endPos.y){var y=startPos.y;newStartPos.y=endPos.y,newEndPos.y=y}var payload=drag_action_config(firebolt,{startPos:newStartPos,endPos:newEndPos});payload.dragging=!0,payload.dragDiff=Math.abs(startPos.x-endPos.x)+Math.abs(startPos.y-endPos.y),firebolt.triggerPhysicalAction(action,payload)}}).on("end",function(){var event=renderer_utils_getEvent();endPos={x:event.x,y:event.y};var duration=(new Date).getTime()-touchStart;if(!(touch&&duration>100&&Math.abs(startPos.x-endPos.x)<=5)){if(endPos.x=Math.max(0,Math.min(endPos.x,drawingInf.width)),endPos.y=Math.max(0,Math.min(endPos.y,drawingInf.height)),startPos.x>endPos.x){var x=startPos.x;startPos.x=endPos.x,endPos.x=x}if(startPos.y>endPos.y){var y=startPos.y;startPos.y=endPos.y,endPos.y=y}var payload=drag_action_config(firebolt,{startPos:startPos,endPos:endPos});payload.dragEnd=!0,payload.hideSelBox=!0,firebolt.triggerPhysicalAction(action,payload)}}))},physical_hover=function hover(firebolt){return function(targetEl){var dispatchBehaviour=function dispatchBehaviour(args){var event=renderer_utils_getEvent(),context=firebolt.context,mode=context.config().interaction.tooltip.mode,pos=renderer_utils_getClientPoint(context.getDrawingContext().svgContainer,event),nearestPoint=context.getNearestPoint(pos.x,pos.y,{getAllPoints:!0,data:args,event:event}),payload={criteria:nearestPoint?nearestPoint.id:null,getAllPoints:!1,showInPosition:nearestPoint.showInPosition,target:nearestPoint.target,position:pos,mode:mode};firebolt.triggerPhysicalAction(HOVER,payload),event.stopPropagation()};targetEl.on("mouseover",dispatchBehaviour).on("mousemove",dispatchBehaviour).on("mouseout",function(){firebolt.triggerPhysicalAction(HOVER,{criteria:null})})}},helpers_generatePayloadFromEvent=function generatePayloadFromEvent(args,event,firebolt){var context=firebolt.context,pos=renderer_utils_getClientPoint(context.getDrawingContext().svgContainer,event.touches?event.touches[0]:event),nearestPoint=context.getNearestPoint(pos.x,pos.y,{data:args,event:event});return{criteria:nearestPoint?nearestPoint.id:null,showInPosition:nearestPoint.showInPosition,target:nearestPoint.target,position:pos}},selection_box_drag_selectionBoxDrag=function selectionBoxDrag(firebolt){return function(targetEl){var subject,drawingInf,context=firebolt.context,onDrag=function onDrag(payload){firebolt.triggerPhysicalAction(actions_namespaceObject.SELECTIONDRAG,payload)},d3Drag=renderer_utils_getD3Drag();targetEl.call(d3Drag().on("start",function(){var event=renderer_utils_getEvent();drawingInf=context.getDrawingContext(),subject=event.subject}).on("drag",function(){var event=renderer_utils_getEvent();subject.x+=event.dx,subject.y+=event.dy;var width=drawingInf.width,height=drawingInf.height,x=Math.min(width-subject.width,Math.max(subject.x,0)),y=Math.min(height-subject.height,Math.max(subject.y,0)),y2=y+subject.height,x2=x+subject.width;if(x>=0&&x2<=width&&y>=0&&y2<=height){var payload=drag_action_config(firebolt,{startPos:{x:x,y:y},endPos:{x:x2,y:y2}});onDrag(payload)}}).on("end",function(){var width=drawingInf.width,height=drawingInf.height,x=Math.min(width-subject.width,Math.max(subject.x,0)),y=Math.min(height-subject.height,Math.max(subject.y,0)),y2=y+subject.height,x2=x+subject.width;if(x>=0&&x2<=width&&y>=0&&y2<=height){var payload=drag_action_config(firebolt,{startPos:{x:x,y:y},endPos:{x:x2,y:y2}});payload.dragEnd=!0,onDrag(payload)}}))}},physical_click=function click(firebolt){return function(targetEl){targetEl.on("click",function dispatchBehaviour(args){var event=renderer_utils_getEvent(),payload=helpers_generatePayloadFromEvent(args,event,firebolt);firebolt.triggerPhysicalAction(CLICK,payload),event.stopPropagation()})}};function physical_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var physicalActions=(physical_defineProperty(_physicalActions={},DRAG,function drag(firebolt){return function(targetEl){drag_event_attachDragEvent(targetEl,DRAG,firebolt)}}),physical_defineProperty(_physicalActions,HOVER,physical_hover),physical_defineProperty(_physicalActions,CLICK,physical_click),physical_defineProperty(_physicalActions,LONGTOUCH,function longtouch(firebolt){return function(targetEl){var event,touchEnd;touchEnd=!1,event=renderer_utils_getEvent(),targetEl.on("touchstart",function(args){event=renderer_utils_getEvent(),touchEnd=!1,setTimeout(function(){touchEnd?firebolt.triggerPhysicalAction(LONGTOUCH,{criteria:null}):function dispatchBehaviour(args){var payload=helpers_generatePayloadFromEvent(args,event,firebolt);firebolt.triggerPhysicalAction(LONGTOUCH,payload),event.stopPropagation()}(args)},100)}).on("touchend",function(){touchEnd=!0})}}),physical_defineProperty(_physicalActions,TOUCHDRAG,function touchdrag(firebolt){return function(targetEl,behaviours){drag_event_attachDragEvent(targetEl,behaviours,firebolt,!0)}}),physical_defineProperty(_physicalActions,SELECTIONDRAG,selection_box_drag_selectionBoxDrag),_physicalActions),side_effects_ANCHORS="anchors",side_effects_TOOLTIP="tooltip",side_effects_BRUSH_ANCHORS="brush-anchors",side_effects_PERSISTENT_ANCHORS="persistent-anchors",side_effects_FILTER="filter",side_effects_HIGHLIGHTER="highlighter",CROSSLINE="crossline",FRAGMENTED_TOOLTIP="fragmented-tooltip",AXIS_LABEL_HIGHLIGHTER="axis-label-highlighter",generic_props_PROPS={valueParser:{defaultValue:function defaultValue(val){return val}}};function generic_sideeffect_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var generic=function(){function GenericSideEffect(firebolt){var _this=this;!function generic_sideeffect_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GenericSideEffect),this.firebolt=firebolt,this._enabled=!0,this._strategy="default",this._config={},this._id=getUniqueId(),this._strategies={},generateGetterSetters(this,generic_props_PROPS),this.config(this.constructor.defaultConfig()),this.sourceInfo(function(){return _this.firebolt.context.getSourceInfo()}),this.layers(function(){return _this.firebolt.context.layers()}),this.plotPointsFromIdentifiers(function(){var _this$firebolt$contex;return(_this$firebolt$contex=_this.firebolt.context).getPlotPointsFromIdentifiers.apply(_this$firebolt$contex,arguments)})}return function generic_sideeffect_createClass(Constructor,protoProps,staticProps){return protoProps&&generic_sideeffect_defineProperties(Constructor.prototype,protoProps),staticProps&&generic_sideeffect_defineProperties(Constructor,staticProps),Constructor}(GenericSideEffect,[{key:"config",value:function config(){return arguments.length?(this._config=mergeRecursive(this._config,arguments.length<=0?void 0:arguments[0]),this):this._config}},{key:"disable",value:function disable(){return this._enabled=!1,this}},{key:"enable",value:function enable(){return this._enabled=!0,this}},{key:"isEnabled",value:function isEnabled(){return this._enabled}},{key:"apply",value:function apply(){return this}},{key:"setStrategy",value:function setStrategy(name,fn){return fn&&(this._strategies[name]=fn),this}},{key:"sourceInfo",value:function sourceInfo(){return arguments.length?(this._sourceInfo=arguments.length<=0?void 0:arguments[0],this):this._sourceInfo()}},{key:"layers",value:function layers(){return arguments.length?(this._layers=arguments.length<=0?void 0:arguments[0],this):this._layers()}},{key:"plotPointsFromIdentifiers",value:function plotPointsFromIdentifiers(){return arguments.length&&(arguments.length<=0?void 0:arguments[0])instanceof Function?(this._plotPointsFromIdentifiers=arguments.length<=0?void 0:arguments[0],this):this._plotPointsFromIdentifiers.apply(this,arguments)}}],[{key:"defaultConfig",value:function defaultConfig(){return{}}},{key:"formalName",value:function formalName(){return"generic"}},{key:"target",value:function target(){return"all"}},{key:"mutates",value:function mutates(){return!1}}]),GenericSideEffect}();function surrogate_typeof(obj){"@babel/helpers - typeof";return(surrogate_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function surrogate_slicedToArray(arr,i){return function surrogate_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function surrogate_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function surrogate_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function surrogate_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function surrogate_possibleConstructorReturn(self,call){return!call||"object"!==surrogate_typeof(call)&&"function"!=typeof call?function surrogate_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function surrogate_getPrototypeOf(o){return(surrogate_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function surrogate_setPrototypeOf(o,p){return(surrogate_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var SurrogateSideEffect=function(_GenericSideEffect){function SurrogateSideEffect(){return function surrogate_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SurrogateSideEffect),surrogate_possibleConstructorReturn(this,surrogate_getPrototypeOf(SurrogateSideEffect).apply(this,arguments))}return function surrogate_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&surrogate_setPrototypeOf(subClass,superClass)}(SurrogateSideEffect,generic),function surrogate_createClass(Constructor,protoProps,staticProps){return protoProps&&surrogate_defineProperties(Constructor.prototype,protoProps),staticProps&&surrogate_defineProperties(Constructor,staticProps),Constructor}(SurrogateSideEffect,[{key:"applyInteractionStyle",value:function applyInteractionStyle(set){var config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},layers=arguments.length>2?arguments[2]:void 0,interactionType=config.interactionType,apply=config.apply,_config$reset=config.reset,reset=void 0!==_config$reset&&_config$reset;return(layers||this.firebolt.context.layers()).forEach(function(layer){if(!1!==layer.config().interactive){var layerFields=layer.data().getFieldsConfig(),filteredUids=set.uids.filter(function(_ref){var _ref2$=surrogate_slicedToArray(_ref,2)[1];return(void 0===_ref2$?[]:_ref2$).every(function(m){return m in layerFields})}).map(function(d){return d[0]}),options={apply:apply,reset:reset,styles:null};layer.applyInteractionStyle(interactionType,filteredUids,options)}}),this}}]),SurrogateSideEffect}();function spawnable_typeof(obj){"@babel/helpers - typeof";return(spawnable_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function spawnable_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function spawnable_possibleConstructorReturn(self,call){return!call||"object"!==spawnable_typeof(call)&&"function"!=typeof call?function spawnable_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function spawnable_getPrototypeOf(o){return(spawnable_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function spawnable_setPrototypeOf(o,p){return(spawnable_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var spawnable_SpawnableSideEffect=function(_GenericSideEffect){function SpawnableSideEffect(){return function spawnable_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SpawnableSideEffect),spawnable_possibleConstructorReturn(this,spawnable_getPrototypeOf(SpawnableSideEffect).apply(this,arguments))}return function spawnable_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&spawnable_setPrototypeOf(subClass,superClass)}(SpawnableSideEffect,generic),function spawnable_createClass(Constructor,protoProps,staticProps){return protoProps&&spawnable_defineProperties(Constructor.prototype,protoProps),staticProps&&spawnable_defineProperties(Constructor,staticProps),Constructor}(SpawnableSideEffect,[{key:"createElement",value:function createElement(container,elemType,data,className,callbacks){return makeElement(container,elemType,data,className,callbacks)}},{key:"drawingContext",value:function drawingContext(){return arguments.length?(this._drawingContext=arguments.length<=0?void 0:arguments[0],this):this._drawingContext()}},{key:"show",value:function show(){return this}},{key:"hide",value:function hide(){return this}}]),SpawnableSideEffect}();__webpack_require__(27);function selection_box_helper_slicedToArray(arr,i){return function selection_box_helper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function selection_box_helper_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function selection_box_helper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var helper_changeVisibility=function changeVisibility(context,sideEffectGroup,visible){var config=context.config(),className=config.defClassName,classPrefix=config.classPrefix;renderer_utils_selectElement(sideEffectGroup).selectAll(".".concat(classPrefix,"-").concat(className)).style("display",visible?"block":"none")};function selection_box_typeof(obj){"@babel/helpers - typeof";return(selection_box_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function selection_box_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function selection_box_possibleConstructorReturn(self,call){return!call||"object"!==selection_box_typeof(call)&&"function"!=typeof call?function selection_box_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function selection_box_getPrototypeOf(o){return(selection_box_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function selection_box_setPrototypeOf(o,p){return(selection_box_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var selection_box=function(_SpawnableSideEffect){function SelectionBox(){return function selection_box_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SelectionBox),selection_box_possibleConstructorReturn(this,selection_box_getPrototypeOf(SelectionBox).apply(this,arguments))}return function selection_box_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&selection_box_setPrototypeOf(subClass,superClass)}(SelectionBox,spawnable_SpawnableSideEffect),function selection_box_createClass(Constructor,protoProps,staticProps){return protoProps&&selection_box_defineProperties(Constructor.prototype,protoProps),staticProps&&selection_box_defineProperties(Constructor,staticProps),Constructor}(SelectionBox,[{key:"apply",value:function apply(selectionSet,payload){var width,height,x=0,y=0,config=this._config,boxConf=config.box,firebolt=this.firebolt,drawingInf=this.drawingContext(),mountPoint=drawingInf.sideEffectGroup,unitWidth=drawingInf.width,unitHeight=drawingInf.height,classPrefix=config.classPrefix,selectionGroupClassName=config.defClassName;if(width=unitWidth,height=unitHeight,!payload.criteria||payload.hideSelBox&&!config.persistent)return this.hide(drawingInf),this;var sourceInf=this.sourceInfo(),_getBoxDimensionsFrom=function getBoxDimensionsFromPayload(payload,axes,axisFields){var x1,x2,y1,y2,xRange,yRange,criteria=payload.criteria,dimensions=payload.dimensions||{},xDim=dimensions.x,yDim=dimensions.y;if(!criteria)return null;if(axes.x&&axes.y){var xAxis=axes.x[0],yAxis=axes.y[0],xLinear="linear"===xAxis.constructor.type(),yLinear="linear"===yAxis.constructor.type(),xField="".concat(axisFields.x[0]),yField="".concat(axisFields.y[0]),xCriteria=criteria[xField],yCriteria=criteria[yField];if(xCriteria&&xCriteria[0]instanceof Array?(xRange=xCriteria[0],yRange=xCriteria[1]):(xRange=xCriteria||[],yRange=yCriteria||[]),xRange&&xRange.length){var domain=xAxis.domain(),bandScale="band"===xAxis.constructor.type(),x1Val=xRange[0],x2Val=xRange[xRange.length-1];if(bandScale){var x1DomainIndex=domain.indexOf(xRange[0]),x2DomainIndex=domain.indexOf(xRange[xRange.length-1]),_sort2=selection_box_helper_slicedToArray([x1DomainIndex,x2DomainIndex].sort(function(a,b){return a-b}),2);x1DomainIndex=_sort2[0],x2DomainIndex=_sort2[1],x1Val=domain[x1DomainIndex],x2Val=domain[x2DomainIndex]}x1=xAxis.getScaleValue(x1Val),x2=xAxis.getScaleValue(x2Val),x2+=bandScale?xAxis.getUnitWidth():0}if(yRange&&yRange.length){var _domain=yAxis.domain(),_bandScale="band"===yAxis.constructor.type(),y1Val=yRange[0],y2Val=yRange[yRange.length-1];if(_bandScale){var y1DomainIndex=_domain.indexOf(yRange[0]),y2DomainIndex=_domain.indexOf(yRange[yRange.length-1]),_sort4=selection_box_helper_slicedToArray([y1DomainIndex,y2DomainIndex].sort(function(a,b){return b-a}),2);y1DomainIndex=_sort4[0],y2DomainIndex=_sort4[1],y1Val=_domain[y1DomainIndex],y2Val=_domain[y2DomainIndex]}y1=yAxis.getScaleValue(y1Val),y2=yAxis.getScaleValue(y2Val),y2+="band"===yAxis.constructor.type()?yAxis.getUnitWidth():0}if(yLinear&&xLinear||!payload.dragEnd){if(xDim){var _xDim=selection_box_helper_slicedToArray(xDim,2);x1=_xDim[0],x2=_xDim[1]}if(yDim){var _yDim=selection_box_helper_slicedToArray(yDim,2);y1=_yDim[0],y2=_yDim[1]}}}return{dimension:{x1:x1,x2:x2,y1:y1,y2:y2},direction:"both"}}(payload,sourceInf.axes,sourceInf.fields),dimension=_getBoxDimensionsFrom.dimension,direction=_getBoxDimensionsFrom.direction,transition=payload.dragEnd&&config.transition;"both"===direction&&(x=Math.min(dimension.x1,dimension.x2),y=Math.min(dimension.y1,dimension.y2),width=Math.abs(dimension.x2-dimension.x1),height=Math.abs(dimension.y2-dimension.y1)),this.show(drawingInf);var points=[{x:x,y:y,width:width,height:height}],sideEffect=this,selection=makeElement(renderer_utils_selectElement(mountPoint),"g",[1],".".concat(classPrefix,"-").concat(selectionGroupClassName)).selectAll("rect").data(points),selectionBox=selection.enter().append("rect").each(function(){firebolt.registerPhysicalBehaviouralMap(function selection_box_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},SELECTIONDRAG,{target:[renderer_utils_selectElement(this)],behaviours:[behaviours_namespaceObject.BRUSH]})),selection_box_drag_selectionBoxDrag(firebolt)(renderer_utils_selectElement(this),["brush"],sideEffect)}).merge(selection).each(function(attrs){var element=renderer_utils_selectElement(this);for(var key in transition&&(element=element.transition().duration(transition.duration)),attrs)({}).hasOwnProperty.call(attrs,key)&&isValidValue(attrs[key])&&element.attr(key,attrs[key])}),boxClassName=getQualifiedClassName(boxConf.defClassName,this._id,classPrefix);return selectionBox.classed(boxClassName.join(" "),!0),selectionBox.classed(boxConf.className,!0),this}},{key:"hide",value:function hide(drawingInf){helper_changeVisibility(this,drawingInf.sideEffectGroup,!1)}},{key:"show",value:function show(drawingInf){helper_changeVisibility(this,drawingInf.sideEffectGroup,!0)}}],[{key:"defaultConfig",value:function defaultConfig(){return{defClassName:"selection-box-group",className:"",classPrefix:"muze",box:{defClassName:"selection-box",className:""},transition:{duration:200},persistent:!1}}},{key:"formalName",value:function formalName(){return"selectionBox"}}]),SelectionBox}(),src_default_config_defaultConfig={classPrefix:"muze",defClassName:"tooltip-box",parentClassName:"tooltip-parent-container",connectorClassName:"tooltip-connectors",className:"",row:{margin:0},spacing:5,content:{spacing:5,iconContainerSize:10,iconScale:1,iconShape:"circle",iconColor:"#ff0000",rowMargin:"4px 0 4px 0",margin:10,separator:":",className:"tooltip-content-container",parentClassName:"tooltip-content-parent-container"},arrow:{size:10,disabled:!1,defClassName:"tooltip-arrow",className:"",color:"rgba(195,195,195,0.85)"}};__webpack_require__(28);function content_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var content_Content=function(){function Content(){!function content_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Content),this._model=null,this._formatter=null,this._config=this.constructor.defaultConfig()}return function content_createClass(Constructor,protoProps,staticProps){return protoProps&&content_defineProperties(Constructor.prototype,protoProps),staticProps&&content_defineProperties(Constructor,staticProps),Constructor}(Content,[{key:"config",value:function config(){return arguments.length>0?(this._config=mergeRecursive(this._config,arguments.length<=0?void 0:arguments[0]),this):this._config}},{key:"update",value:function update(item){return this._model=item.model,this._formatter=item.formatter,this}},{key:"context",value:function context(ctx){return this._context=ctx,this}},{key:"render",value:function render(mount){var data,config=this._config,iconContainerSize=config.iconContainerSize,formatter=this._formatter,rowMargin=config.rowMargin,model=this._model,classPrefix=config.classPrefix;if(this._mount=mount,(data=model instanceof Array?model:formatter(this._model,this.config(),this._context))instanceof Function){makeElement(mount,"div",[1],"".concat(classPrefix,"-tooltip-html-container")).html(data())}else{var content=data,displayFormat="default";isSimpleObject(data)&&(content=data.content,displayFormat=data.displayFormat);var body=makeElement(mount,"div",[displayFormat],"".concat(classPrefix,"-tooltip-content"),{},function(d){return d});if("table"===displayFormat){var table=makeElement(body,"table",[1],"".concat(classPrefix,"-tooltip-table")),tbody=makeElement(table,"tbody",[1],"".concat(classPrefix,"-tooltip-table-tbody")),rows=makeElement(tbody,"tr",content,"".concat(classPrefix,"-tooltip-table-row"));rows.each(function(d,i){renderer_utils_selectElement(this).classed("".concat(classPrefix,"-tooltip-table-row-").concat(i),!0)}),makeElement(rows,"td",function(d){return d},"".concat(classPrefix,"-tooltip-table-cell")).each(function(d){renderer_utils_selectElement(this).html(d)})}else{var _rows=makeElement(body,"div",content,"",{update:function update(elem,elemData){return elem.attr("class",elemData.className)}}),_cells=makeElement(_rows,"span",function(d){return d.data},"".concat(classPrefix,"-tooltip-content"));_cells.attr("class","".concat(classPrefix,"-tooltip-content")),renderer_utils_setStyles(_rows,{margin:rowMargin}),renderer_utils_setStyles(_cells,{display:"inline-block"}),_cells.each(function(d){var el=renderer_utils_selectElement(this);if(el.html(""),d instanceof Object)if("icon"===d.type){var svg=makeElement(el,"svg",[1]),path=makeElement(svg,"path",[1]),shape=d.shape instanceof Function?d.shape:common_utils_getSymbol(d.shape);renderer_utils_setAttrs(svg,{x:0,y:0,width:iconContainerSize,height:iconContainerSize}),renderer_utils_setAttrs(path,{d:shape.size(d.size)(),transform:"translate(".concat(iconContainerSize/2,", ").concat(iconContainerSize/2,")")}),renderer_utils_setStyles(path,{fill:d.color}),renderer_utils_setStyles(svg,{width:"".concat(iconContainerSize,"px"),height:"".concat(iconContainerSize,"px")})}else el.html(d.value),d.className&&el.classed(d.className,!0),renderer_utils_setStyles(el,d.style);else el.html(d)})}}return this}},{key:"clear",value:function clear(){return this._model=null,this}}],[{key:"defaultConfig",value:function defaultConfig(){var config=src_default_config_defaultConfig.content;return config.classPrefix=src_default_config_defaultConfig.classPrefix,config}}]),Content}();function tooltip_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var strategies_strategies,tooltip_Tooltip=function(){function Tooltip(htmlContainer,svgContainer){!function tooltip_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Tooltip);var connectorContainer=svgContainer;this._id=getUniqueId(),this._config={},this.config({});var tooltipConf=this._config,classPrefix=tooltipConf.classPrefix,contentClass=tooltipConf.content.parentClassName,container=makeElement(htmlContainer,"div",[1],"".concat(classPrefix,"-tooltip-container"));this._container=container,this._tooltipContainer=container.append("div").style("position","absolute"),this._contentContainer=this._tooltipContainer.append("div").attr("class","".concat(classPrefix,"-").concat(tooltipConf.defClassName," ").concat(classPrefix,"-").concat(contentClass,"\n            ").concat(tooltipConf.className)),svgContainer||(connectorContainer=htmlContainer.append("svg").style("pointer-events","none")),this._contents={},this._tooltipConnectorContainer=renderer_utils_selectElement(connectorContainer).append("g").attr("class","".concat(tooltipConf.classPrefix,"-").concat(tooltipConf.connectorClassName));var id=this._id,defClassName=tooltipConf.parentClassName,qualifiedClassName=getQualifiedClassName(defClassName,id,tooltipConf.classPrefix);this.addClass(qualifiedClassName.join(" ")),this.hide()}return function tooltip_createClass(Constructor,protoProps,staticProps){return protoProps&&tooltip_defineProperties(Constructor.prototype,protoProps),staticProps&&tooltip_defineProperties(Constructor,staticProps),Constructor}(Tooltip,[{key:"config",value:function config(){if(arguments.length>0){var defConf=mergeRecursive({},this.constructor.defaultConfig());return this._config=mergeRecursive(defConf,arguments.length<=0?void 0:arguments[0]),this}return this._config}},{key:"addClass",value:function addClass(className){return this._tooltipContainer.classed(className,!0),this}},{key:"context",value:function context(){return arguments.length?(this._context=arguments.length<=0?void 0:arguments[0],this):this._context}},{key:"content",value:function content(name,data){var contentConfig=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},config=this.config(),classPrefix=config.classPrefix,contentClass=config.content.className,formatter=config.formatter,className="".concat(classPrefix,"-").concat(contentClass,"-").concat(name),specificClass="".concat(classPrefix,"-").concat(contentConfig.className),content=this._contents[name]=this._contents[name]||new content_Content,container=makeElement(this._contentContainer,"div",[contentConfig.order],className);container.attr("class","".concat(classPrefix,"-").concat(contentClass," ").concat(className," ").concat(specificClass)),function reorderContainers(parentContainer,className){parentContainer.selectAll(className).sort(function(a,b){return a-b})}(this._contentContainer,".".concat(classPrefix,"-").concat(contentClass));var contentConf=config.content;return contentConfig.classPrefix=this._config.classPrefix,content.config(contentConf),null===data?(content.clear(),container.remove(),delete this._contents[name]):(content.update({model:data,formatter:contentConfig.formatter||formatter}),content.context(this._context),content.render(container)),Object.keys(this._contents).length||this.hide(),this}},{key:"getContents",value:function getContents(){return Object.values(this._contents)}},{key:"position",value:function position(x,y){if(!Object.keys(this._contents).length)return this.hide(),this;this.show();var target=this._target;if(target){var node=this._tooltipContainer.node(),tooltipPos=this._orientation;if("left"===tooltipPos||"right"===tooltipPos?y+node.offsetHeight<target.y||y>target.y+target.height:x+node.offsetWidth<target.x||x>target.x+target.width){var path;this._tooltipConnectorContainer.style("display","block");var connector=this._tooltipConnectorContainer.selectAll("path").data([1]),enter=connector.enter().append("path");"left"===tooltipPos?path="M ".concat(x," ").concat(y+node.offsetHeight/2," L ").concat(target.x+target.width)+" ".concat(target.y+target.height/2):"right"===tooltipPos?path="M ".concat(x+node.offsetWidth," ").concat(y+node.offsetHeight/2)+" L ".concat(target.x," ").concat(target.y+target.height/2):"bottom"===tooltipPos&&(path="M ".concat(x+node.offsetWidth/2," ").concat(y+node.offsetHeight)+" L ".concat(target.x+target.width/2," ").concat(target.y)),enter.merge(connector).attr("d",path).style("display","block")}else this._tooltipConnectorContainer.style("display","none")}var offset=this._offset||{x:0,y:0};return this._tooltipContainer.style("left","".concat(offset.x+x,"px")).style("top","".concat(offset.y+y,"px")),this}},{key:"positionRelativeTo",value:function positionRelativeTo(dim){var obj,tooltipConf=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},orientation=tooltipConf.orientation;if(this.show(),!dim)return this.hide(),this;var extent=this._extent,contentContainer=this._contentContainer.node();this._tooltipContainer.style("top","0px").style("left","0px").style("width","2000px").style("height","2000px");var offsetWidth=contentContainer.offsetWidth+4,offsetHeight=contentContainer.offsetHeight+4,config=this._config,offset=this._offset,spacing=config.spacing,draw=void 0===tooltipConf.draw||tooltipConf.draw,topSpace=dim.y,dimX=dim.x+dim.width+offset.x,rightSpace=extent.width-dimX,leftSpace=dim.x+offset.x-extent.x,bottomSpace=extent.height-(dim.y+dim.height+offset.y),arrowSize=spacing,tooltipHeight=offsetHeight+arrowSize,tooltipWidth=offsetWidth+arrowSize,spaces=[{position:"top",value:topSpace-tooltipHeight},{position:"right",value:rightSpace-tooltipWidth},{position:"left",value:leftSpace-tooltipWidth},{position:"bottom",value:bottomSpace-tooltipHeight}],positionHorizontal=function positionHorizontal(positionVal){var position,x=dim.x+dim.width,y=dim.y;return"right"===positionVal?(position="left",x+=arrowSize):"left"===positionVal&&(x=dim.x-offsetWidth,position="right",x-=arrowSize),dim.height<offsetHeight&&(y=Math.max(0,dim.y+dim.height/2-offsetHeight/2)),{position:position,x:x,y:y}},positionVertical=function positionVertical(positionVal){var position,y,x=dim.x-offsetWidth/2+dim.width/2;return extent.width-(dim.x+offset.x)<offsetWidth?x=extent.width-offsetWidth-offset.x:x+offset.x<extent.x&&(x=extent.x),"top"===positionVal?(y=dim.y-offsetHeight-arrowSize,position="bottom"):(y=dim.y+dim.height+arrowSize,position="top"),{position:position,x:x,y:y}};this._target=dim;var hMax=getMaxPoint(spaces.filter(function(d){return"left"===d.position||"right"===d.position}),"value"),vMax=getMaxPoint(spaces.filter(function(d){return"top"===d.position||"bottom"===d.position}),"value");if(orientation)if("horizontal"===orientation){obj=positionHorizontal(hMax.position)}else{obj=positionVertical(vMax.position)}else obj=hMax.value>0?positionHorizontal(hMax.position):positionVertical(vMax.position);return this._position={x:obj.x,y:obj.y},this._tooltipContainer.style("height","".concat(offsetHeight,"px")).style("width","".concat(offsetWidth,"px")),this._orientation=obj.position,draw&&this.position(obj.x,obj.y),this}},{key:"hide",value:function hide(){return this._tooltipContainer.style("display","none"),this._tooltipConnectorContainer.style("display","none"),this}},{key:"show",value:function show(){return this._tooltipContainer.style("display","block"),this}},{key:"extent",value:function extent(_extent){return this._extent=_extent,this}},{key:"offset",value:function offset(_offset){return this._offset=_offset,this}},{key:"remove",value:function remove(){return this._tooltipContainer.remove(),this._tooltipConnectorContainer.remove(),this}}],[{key:"defaultConfig",value:function defaultConfig(){return src_default_config_defaultConfig}}]),Tooltip}(),HIGHLIGHT_SUMMARY="highlightSummary";function strategies_construct(Parent,args,Class){return(strategies_construct=function strategies_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&strategies_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function strategies_setPrototypeOf(o,p){return(strategies_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function strategies_toConsumableArray(arr){return function strategies_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function strategies_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function strategies_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function strategies_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _configResolvers,SUM=dist_datamodel.GROUP_BY_FUNCTIONS.SUM,COUNT=dist_datamodel.GROUP_BY_FUNCTIONS.COUNT,strategies_InvalidAwareTypes=datamodel_default.a.InvalidAwareTypes,defNumberFormat=function defNumberFormat(value){return"".concat(value%value.toFixed(0)==0?value:value.toFixed(2))},strategies_formatters=function formatters(formatter,interval,valueParser){var _ref;return strategies_defineProperty(_ref={},dist_datamodel.DimensionSubtype.TEMPORAL,function(value){return value instanceof strategies_InvalidAwareTypes?valueParser(value):common_utils_formatTemporal(Number(value),interval)}),strategies_defineProperty(_ref,dist_datamodel.MeasureSubtype.CONTINUOUS,function(value){return value instanceof strategies_InvalidAwareTypes?valueParser(value):formatter(defNumberFormat(value))}),strategies_defineProperty(_ref,dist_datamodel.DimensionSubtype.CATEGORICAL,function(value){return valueParser(value)}),_ref},isSingleValue=function isSingleValue(dataLen,stackedSum){return 1===dataLen&&!stackedSum},getStackedKeyValue=function getStackedKeyValue(params){var field=params.field,value=params.value,classPrefix=params.classPrefix;return{className:"".concat(classPrefix,"-tooltip-stacked-row"),data:[{value:field,className:"".concat(classPrefix,"-tooltip-stacked-row-key")},{value:"".concat(value),className:"".concat(classPrefix,"-tooltip-stacked-row-value")}]}},strategies_getKeyValue=function getKeyValue(params){var field=params.field,value=params.value,classPrefix=params.classPrefix,margin=params.margin,isSelected=params.isSelected,removeKey=params.removeKey,stackedSum=params.stackedSum,isStackedBar=params.isStackedBar,stackedValue=params.stackedValue;if(!removeKey){var keyObj={value:field,className:"".concat(classPrefix,"-tooltip-key")},valueObj={value:value,className:"".concat(classPrefix,"-tooltip-value")};"null"!==stackedValue&&"undefined"!==stackedValue||(stackedValue=0);var stackedValueObj={value:stackedSum?"(".concat((100*stackedValue/stackedSum).toFixed(2)," %)"):void 0,className:"".concat(classPrefix,"-tooltip-stacked-percentage")};return void 0!==margin&&(keyObj.style={"margin-left":"".concat(margin,"px")},valueObj.style={"margin-left":"".concat(margin,"px")},stackedValueObj.style={"margin-left":"".concat(margin,"px")}),{className:isSelected?"".concat(classPrefix,"-tooltip-row ").concat(classPrefix,"-tooltip-selected-row"):"".concat(classPrefix,"-tooltip-row"),data:stackedSum&&isStackedBar?[keyObj,stackedValueObj,valueObj]:[keyObj,valueObj]}}return{data:[{className:"",value:value,style:{"margin-left":"10px"}}],className:"".concat(classPrefix,"-tooltip-first")}},getStackedSum=function getStackedSum(values,index){return values.reduce(function(a,b){return b[index]instanceof strategies_InvalidAwareTypes?a+0:a+b[index]},0)},generateRetinalFieldsValues=function generateRetinalFieldsValues(valueArr,retinalFields,content,context){var fieldsConfig=context.fieldsConfig,dimensionMeasureMap=context.dimensionMeasureMap,axes=context.axes,config=context.config,fieldInf=context.fieldInf,dataLen=context.dataLen,target=context.target,stackedSum=context.stackedSum,isStackedBar=context.isStackedBar,classPrefix=config.classPrefix,margin=config.margin,separator=config.separator,colorAxis=axes.color[0],shapeAxis=axes.shape[0],sizeAxis=axes.size[0],_loop=function _loop(retField){var retIndex=fieldsConfig[retField].index,retinalFieldValue=valueArr[retIndex],measuresArr=dimensionMeasureMap[retField],icon={type:"icon",color:colorAxis.getColor(retinalFieldValue),size:sizeAxis.config().value,shape:shapeAxis.getShape(retinalFieldValue)},_fieldInf$retField=fieldInf[retField],displayName=_fieldInf$retField.displayName,formattedRetinalValue=(0,_fieldInf$retField.fn)(retinalFieldValue);if(isSingleValue(dataLen,stackedSum))content.push(strategies_getKeyValue({field:displayName,value:formattedRetinalValue,classPrefix:classPrefix,margin:10}));else{var hasMultipleMeasures=measuresArr.length>1;hasMultipleMeasures&&content.push({data:[icon,formattedRetinalValue]});var isSelected=(target&&target[1][target[0].indexOf(retField)])===retinalFieldValue;measuresArr.forEach(function(measure){var measureIndex=fieldsConfig[measure].index,_fieldInf$measure=fieldInf[measure],dName=_fieldInf$measure.displayName,formatterFn=_fieldInf$measure.fn,currentMeasureValue=valueArr[measureIndex],value=formatterFn(currentMeasureValue),keyValue=strategies_getKeyValue({field:hasMultipleMeasures?"".concat(dName).concat(separator):formattedRetinalValue,value:value,classPrefix:classPrefix,margin:hasMultipleMeasures?margin:void 0,isSelected:isSelected,stackedSum:stackedSum,stackedValue:currentMeasureValue instanceof strategies_InvalidAwareTypes?currentMeasureValue.value():currentMeasureValue.toFixed(2),isStackedBar:isStackedBar});hasMultipleMeasures||(keyValue.data=[icon].concat(strategies_toConsumableArray(keyValue.data))),content.push(keyValue)})}};for(var retField in retinalFields)_loop(retField)},strategies_buildTooltipData=function buildTooltipData(dataModel){var nestedDataObj,displayFormat,config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},context=arguments.length>2?arguments[2]:void 0,fieldValues=[],_dataModel$getData=dataModel.getData(),data=_dataModel$getData.data,schema=_dataModel$getData.schema,fieldspace=dataModel.getFieldspace(),fieldsConfig=dataModel.getFieldsConfig(),_context$retinalField=context.retinalFields,color=_context$retinalField.color,shape=_context$retinalField.shape,size=_context$retinalField.size,detailFields=context.detailFields||[],_ref2$showStackSum=(context.config||{}).showStackSum,showStackSum=void 0===_ref2$showStackSum||_ref2$showStackSum,_context$payload$sele=context.payload.selectedMeasures,selectedMeasures=void 0===_context$payload$sele?[]:_context$payload$sele,dimensions=schema.filter(function(d){return d.type===dist_datamodel.FieldType.DIMENSION}),measures=schema.filter(function(d){return d.type===dist_datamodel.FieldType.MEASURE}),containsDetailField=!!common_utils_intersect(schema,detailFields).length,dataLen=data.length,dimensionMeasureMap=context.dimensionMeasureMap,axes=context.axes,fieldInf=function getFieldInf(schema,dataModel,context){var valueParser=context.valueParser,timeDiffs=context.timeDiffs,fieldsObj=dataModel.getFieldspace().fieldsObj(),defFormatter=strategies_formatters(null,null,valueParser)[dist_datamodel.DimensionSubtype.CATEGORICAL];return schema.reduce(function(inf,field){var subtype=field.subtype,name=field.name,type=field.type,interval=subtype===dist_datamodel.DimensionSubtype.TEMPORAL?timeDiffs[name]:0,nf=type===dist_datamodel.FieldType.MEASURE?fieldsObj[name].numberFormat():function(val){return val};return inf[name]={fn:defaultValue(strategies_formatters(nf,interval,valueParser)[subtype],defFormatter),displayName:"".concat(retrieveFieldDisplayName(dataModel,name))},inf},{})}(schema,dataModel,context);if(dataLen>1&&containsDetailField)fieldValues=function getTabularData(dataObj,fieldInf){var rows=[],data=dataObj.data,schema=dataObj.schema;return rows.push(schema.map(function(d){return fieldInf[d.name].displayName})),data.forEach(function(d){var row=[];schema.forEach(function(fieldObj,i){var value=fieldInf[fieldObj.name].fn(d[i]);row.push(value)}),rows.push(row)}),rows}({data:data,schema:schema,fieldspace:fieldspace},fieldInf),displayFormat="table";else{var retinalFields=[color.field,shape.field,size.field].reduce(function(acc,field){return field&&fieldsConfig[field].def.type===dist_datamodel.FieldType.DIMENSION&&(acc[field]=1),acc},{}),indices=dimensions.filter(function(field){return!retinalFields[field.name]}).map(function(dim){return fieldsConfig[dim.name].index}),allMeasures=strategies_toConsumableArray(strategies_construct(Set,strategies_toConsumableArray(Object.values(dimensionMeasureMap)))),isStacked=function isStackedChart(layers){return layers.some(function(d){return"stack"===d.transformType()})}(context.layers),isStackedBar=function isStackedBarChart(layers){return layers.some(function(d){return"stack"===d.transformType()&&d.config().mark===BAR})}(context.layers),filteredMeasures=isSingleValue(dataLen,isStacked)?measures:measures.filter(function(d){return-1===allMeasures.indexOf(d.name)});!function generateTooltipContent(nestedData){for(var index=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,content=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],classPrefix=config.classPrefix,separator=config.separator,i=0,len=nestedData.length;i<len;i++){var _nestedData$i=nestedData[i],values=_nestedData$i.values,key=_nestedData$i.key,field=getObjProp(schema,indices[index],"name"),margin=1===dataLen||0===Object.keys(retinalFields).length?10:void 0;if(field){var _fieldInf$field=fieldInf[field],displayName=_fieldInf$field.displayName,formattedValue=(0,_fieldInf$field.fn)(key),removeKey=!isSingleValue(dataLen,isStacked);content.push(strategies_getKeyValue({field:"".concat(displayName).concat(separator),value:formattedValue,classPrefix:classPrefix,margin:margin,isSelected:void 0,removeKey:removeKey}))}if(values[0]&&values[0].key)generateTooltipContent(values,index+1,content);else{var stackedSum=0;if(isStacked&&showStackSum){stackedSum=getStackedSum(values,fieldsConfig[measures[0].name].index);var nf=measures[0].numberFormat;content.push(getStackedKeyValue({field:"Total".concat(separator),value:nf?nf(stackedSum.toFixed(2)):stackedSum.toFixed(2),classPrefix:classPrefix}))}for(var _loop2=function _loop2(j,len2){var valueArr=values[j];generateRetinalFieldsValues(valueArr,retinalFields,content,{fieldInf:fieldInf,axes:axes,config:config,fieldsConfig:fieldsConfig,dimensionMeasureMap:dimensionMeasureMap,dataLen:dataLen,target:context.payload.target,stackedSum:stackedSum,isStackedBar:isStackedBar}),filteredMeasures.forEach(function(measure){var name=measure.name,_fieldInf$name=fieldInf[name],displayName=_fieldInf$name.displayName,fn=_fieldInf$name.fn;content.push(strategies_getKeyValue({field:"".concat(displayName).concat(separator),isSelected:-1!==selectedMeasures.indexOf(name),value:fn(valueArr[fieldsConfig[name].index]),classPrefix:classPrefix,margin:10}))})},j=0,len2=values.length;j<len2;j++)_loop2(j)}}}(nestedDataObj="key"in(nestedDataObj=common_utils_nestCollection({data:data,keys:indices}))[0]?nestedDataObj:[{values:nestedDataObj}],0,fieldValues)}return{content:fieldValues,displayFormat:displayFormat}},tooltip_strategies_strategies=(strategies_defineProperty(strategies_strategies={},"selectionSummary",function(dm,config,context){var selectionSet=context.selectionSet,classPrefix=config.classPrefix,showMultipleMeasures=context.config.showMultipleMeasures,aggFns=selectionSet.mergedEnter.aggFns,entryUids=selectionSet.mergedEnter.uids,fieldsConf=dm.getFieldsConfig(),aggregatedValues=function getAggregatedValues(dm,entrySet){var aggFns=entrySet.aggFns,dimsMap=entrySet.uids.reduce(function(acc,v){var dims=v[0];return!acc[dims]&&(acc[dims]=[]),acc[dims].push(v[1]),acc},{}),aggregatedValues={};return Object.keys(dm.getFieldspace().getMeasure()).forEach(function(measure){var groupedDm=dm.select(function(dmFields){var id=dmFields[reserved_fields.ROW_ID],measures=dimsMap[id];return!!measures&&measures.find(function(arr){return-1!==arr.indexOf(measure)})},{saveChild:!1}).groupBy([""],strategies_defineProperty({},measure,aggFns[measure]===COUNT?SUM:aggFns[measure]),{saveChild:!1}),fieldsConfig=groupedDm.getFieldsConfig();groupedDm.isEmpty()||(aggregatedValues[measure]=groupedDm.getData().data[0][fieldsConfig[measure].index])}),aggregatedValues}(dm,selectionSet.mergedEnter),values=[{className:"".concat(classPrefix,"-tooltip-row"),data:[{value:"".concat(entryUids.length),style:{"font-weight":"bold"}},"Items Selected"]}],measures=Object.keys(aggregatedValues);return showMultipleMeasures||(measures=measures.slice(0,1)),measures.forEach(function(measure){var _values$0$data,_fieldsConf$measure$d=fieldsConf[measure].def.numberFormat,numberFormat=void 0===_fieldsConf$measure$d?defNumberFormat:_fieldsConf$measure$d,value=aggregatedValues[measure],rowValues=value instanceof strategies_InvalidAwareTypes?[]:["(".concat(aggFns[measure].toUpperCase(),")"),"".concat(retrieveFieldDisplayName(dm,measure),":"),{value:numberFormat(value),style:{"font-weight":"bold"},className:"".concat(classPrefix,"-tooltip-value")}];showMultipleMeasures?values.push({className:"".concat(classPrefix,"-tooltip-row"),data:rowValues}):(_values$0$data=values[0].data).push.apply(_values$0$data,rowValues)}),values}),strategies_defineProperty(strategies_strategies,HIGHLIGHT_SUMMARY,function(data,config,context){return strategies_buildTooltipData(data,config,context)}),strategies_strategies),helper_shouldApplySideEffect=(__webpack_require__(29),function shouldApplySideEffect(dm,sideEffect){var propagationInf=sideEffect.firebolt.getPropagationInf();if(propagationInf.sourceIdentifiers&&dm){var sourceDims=propagationInf.sourceIdentifiers.fields.filter(function(field){return"dimension"===field.type}).map(function(d){return d.name}),dims=Object.keys(dm.getFieldspace().getDimension());return common_utils_intersect(sourceDims,dims).length}return!0});function tooltip_typeof(obj){"@babel/helpers - typeof";return(tooltip_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function side_effects_tooltip_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function tooltip_possibleConstructorReturn(self,call){return!call||"object"!==tooltip_typeof(call)&&"function"!=typeof call?function tooltip_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function tooltip_get(target,property,receiver){return(tooltip_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function tooltip_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=tooltip_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function tooltip_getPrototypeOf(o){return(tooltip_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function tooltip_setPrototypeOf(o,p){return(tooltip_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function tooltip_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var configResolvers=(tooltip_defineProperty(_configResolvers={},HIGHLIGHT_SUMMARY,function(specificConf,config){return defaultValue(specificConf,config)}),tooltip_defineProperty(_configResolvers,"default",function _default(specificConf){return defaultValue(specificConf,{})}),_configResolvers),side_effects_tooltip_Tooltip=function(_SpawnableSideEffect){function Tooltip(){var _getPrototypeOf2,_this;!function side_effects_tooltip_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Tooltip);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=tooltip_possibleConstructorReturn(this,(_getPrototypeOf2=tooltip_getPrototypeOf(Tooltip)).call.apply(_getPrototypeOf2,[this].concat(params))))._tooltips={},_this._strategies=mergeRecursive({},tooltip_strategies_strategies),_this._strategy=HIGHLIGHT_SUMMARY,_this}return function tooltip_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&tooltip_setPrototypeOf(subClass,superClass)}(Tooltip,spawnable_SpawnableSideEffect),function side_effects_tooltip_createClass(Constructor,protoProps,staticProps){return protoProps&&side_effects_tooltip_defineProperties(Constructor.prototype,protoProps),staticProps&&side_effects_tooltip_defineProperties(Constructor,staticProps),Constructor}(Tooltip,[{key:"config",value:function config(){if(arguments.length){var config=this._config=mergeRecursive(this._config,function sanitizeConfig(config,context){var strategyObj=context._strategies,sanitizedConf=Object.assign({},config);for(var key in strategyObj)sanitizedConf[key]=defaultValue(configResolvers[key],configResolvers.default)(config[key],config);return sanitizedConf}(arguments.length<=0?void 0:arguments[0],this)),strategyObj=this._strategies;for(var key in strategyObj){var formatter=config[key].formatter;this.setStrategy(key,formatter)}return this}return this._config}},{key:"apply",value:function apply(selectionSet,payload){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},dataModel=selectionSet&&selectionSet.mergedEnter.model;if(!helper_shouldApplySideEffect(dataModel,this))return this;if(null===payload.criteria||dataModel&&dataModel.isEmpty()||null===selectionSet)return this.hide(options,null),this;var strategy=defaultValue(options.strategy,this._strategy);return this.createTooltip(dataModel,Object.assign({},{payload:payload,selectionSet:selectionSet,strategy:strategy,options:options}),null,0),this}},{key:"hide",value:function hide(options){var tooltips=this._tooltips,orientation=this.config().orientation;for(var key in tooltips)if({}.hasOwnProperty.call(tooltips,key)){var tooltip=tooltips[key],strategy=options.strategy||this._strategy;tooltip.content(strategy,null),Object.keys(tooltip._contents).length?tooltip.positionRelativeTo(tooltip._target,{orientation:orientation}):tooltip.hide()}}},{key:"getPlotPointsFromIdentifiers",value:function getPlotPointsFromIdentifiers(payload){var target=payload.target;return tooltip_get(tooltip_getPrototypeOf(Tooltip.prototype),"plotPointsFromIdentifiers",this).call(this,target||payload.criteria,{getBBox:!0})}},{key:"createTooltip",value:function createTooltip(dataModel){var props=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},plotDim=arguments.length>2?arguments[2]:void 0,key=arguments.length>3?arguments[3]:void 0,drawingInf=this.drawingContext(),sourceInf=this.sourceInfo(),config=this.config(),strategy=props.strategy,payload=props.payload,selectionSet=props.selectionSet;plotDim=(plotDim=defaultValue(plotDim,this.getPlotPointsFromIdentifiers(payload)))&&plotDim[0];var pad=config.padding,showInPosition=payload.showInPosition,tooltipPos=payload.position,_config$strategy=config[strategy],projectFields=_config$strategy.fields,dataTransform=_config$strategy.dataTransform,strategyFn=this._strategies[strategy],dt=dataTransform(dataModel,projectFields,this),layoutContainer=drawingInf.parentContainer,parentContainerDimensions=drawingInf.parentContainerDimensions,layoutBoundBox=layoutContainer.getBoundingClientRect(),unitBoundBox=drawingInf.htmlContainer.getBoundingClientRect(),offsetLeft=unitBoundBox.left-layoutBoundBox.left,offsetTop=unitBoundBox.top-layoutBoundBox.top,tooltipInst=this._tooltips[key]=this._tooltips[key]||new tooltip_Tooltip(layoutContainer,drawingInf.svgContainer);Object.assign(sourceInf,{payload:payload,firebolt:this.firebolt,detailFields:[],timeDiffs:sourceInf.timeDiffs,valueParser:this.valueParser(),selectionSet:selectionSet,config:config[strategy]}),tooltipInst.context(sourceInf),tooltipInst.content(strategy,dt,{formatter:strategyFn,order:config[strategy].order,className:config[strategy].className}).config(this.config()).extent({x:0,y:0,width:parentContainerDimensions.width,height:parentContainerDimensions.height}).offset({x:offsetLeft+(config.offset.x||0),y:offsetTop+(config.offset.y||0)}),showInPosition?tooltipInst.position(tooltipPos.x+pad,tooltipPos.y+pad):plotDim?tooltipInst.positionRelativeTo({x:plotDim.x,y:plotDim.y,width:plotDim.width||0,height:plotDim.height||0},{orientation:config.orientation}):tooltipInst.hide()}}],[{key:"defaultConfig",value:function defaultConfig(){return{padding:5,offset:{x:0,y:0},highlightSummary:{order:1,dataTransform:function dataTransform(dm,fields){return fields?dm.project(fields,{saveChild:!1}):dm}},selectionSummary:{order:0,dataTransform:function dataTransform(dm){return dm}}}}},{key:"formalName",value:function formalName(){return side_effects_TOOLTIP}},{key:"target",value:function target(){return"all"}}]),Tooltip}();function fragmented_tooltip_typeof(obj){"@babel/helpers - typeof";return(fragmented_tooltip_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function fragmented_tooltip_toConsumableArray(arr){return function fragmented_tooltip_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function fragmented_tooltip_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function fragmented_tooltip_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fragmented_tooltip_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function fragmented_tooltip_possibleConstructorReturn(self,call){return!call||"object"!==fragmented_tooltip_typeof(call)&&"function"!=typeof call?function fragmented_tooltip_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function fragmented_tooltip_get(target,property,receiver){return(fragmented_tooltip_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function fragmented_tooltip_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=fragmented_tooltip_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function fragmented_tooltip_getPrototypeOf(o){return(fragmented_tooltip_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function fragmented_tooltip_setPrototypeOf(o,p){return(fragmented_tooltip_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var fragmented_tooltip_FragmentedTooltip=function(_Tooltip){function FragmentedTooltip(){return function fragmented_tooltip_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FragmentedTooltip),fragmented_tooltip_possibleConstructorReturn(this,fragmented_tooltip_getPrototypeOf(FragmentedTooltip).apply(this,arguments))}return function fragmented_tooltip_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&fragmented_tooltip_setPrototypeOf(subClass,superClass)}(FragmentedTooltip,side_effects_tooltip_Tooltip),function fragmented_tooltip_createClass(Constructor,protoProps,staticProps){return protoProps&&fragmented_tooltip_defineProperties(Constructor.prototype,protoProps),staticProps&&fragmented_tooltip_defineProperties(Constructor,staticProps),Constructor}(FragmentedTooltip,[{key:"createTooltip",value:function createTooltip(dataModel,props){var totalHeight=0,totalWidth=0,config=this.config(),strategy=props.strategy,context=this.firebolt.context,drawingInf=this.drawingContext(),tooltips=this._tooltips,boundBox={width:drawingInf.width,height:drawingInf.height},pad=config.padding,dataModels=[],fields=context.getSourceInfo().fields,showVertically=!!(!!fields.x[0]&&fields.x[0].type()===dist_datamodel.FieldType.DIMENSION),boxes=[],uids=dataModel.getUids();dataModels.push.apply(dataModels,fragmented_tooltip_toConsumableArray(uids.map(function(uid){return dataModel.select(function(fieldsArr){return fieldsArr[reserved_fields.ROW_ID].value===uid},{saveChild:!1})})));for(var enter={},i=0,len=dataModels.length;i<len;i++){var dm=dataModels[i],dimensions=dm.getData().schema.filter(function(d){return d.type===dist_datamodel.FieldType.DIMENSION}).map(function(d){return d.name}),plotDim=context.getPlotPointsFromIdentifiers(dm.project(dimensions),{getBBox:!0});fragmented_tooltip_get(fragmented_tooltip_getPrototypeOf(FragmentedTooltip.prototype),"createTooltip",this).call(this,dm,props,plotDim,i);var tooltipInst=this._tooltips[i];enter[i]=this._tooltips[i];var position=tooltipInst._position,tooltipBoundBox=tooltipInst._tooltipContainer.node().getBoundingClientRect();if(totalHeight+=tooltipBoundBox.height+pad,totalWidth+=tooltipBoundBox.width+pad,showVertically?totalHeight>drawingInf.height:totalWidth>drawingInf.width)break;position&&boxes.push({x:position.x,y:position.y,width:tooltipBoundBox.width,height:tooltipBoundBox.height,tooltip:tooltipInst})}for(var key in tooltips)if(!enter[key]){var tooltip=tooltips[key];tooltip.content(strategy,null),tooltip.getContents().length||(tooltip.remove(),delete tooltips[key])}return boxes.length&&function spaceOutBoxes(boxes,extent,showVertically){var y,height,x,width,i,len=boxes.length,spaceOutIfOverlap=function spaceOutIfOverlap(firstBox,secondBox,opposite){x=firstBox.x,width=firstBox.width,y=firstBox.y,height=firstBox.height;var bottom=y+height,right=x+width;showVertically?(opposite?y<secondBox.y+secondBox.height:bottom>secondBox.y)&&(secondBox.y=opposite?firstBox.y-secondBox.height-5:bottom+5):(opposite?x<secondBox.x+secondBox.width:right>secondBox.x)&&(secondBox.x=opposite?firstBox.x-secondBox.width-5:right+5)};for(boxes.sort(function(a,b){return showVertically?a.y-b.y:a.x-b.x}),i=0,i=0;i<len-1;i++)spaceOutIfOverlap(boxes[i],boxes[i+1]);if(boxes[i].y+boxes[i].height>extent.height||boxes[i].x+boxes[i].width>extent.width)for(showVertically?boxes[i].y-=boxes[i].height+boxes[i].y-extent.height:boxes[i].x-=boxes[i].width+boxes[i].x-extent.width,i=len-1;i>0;i--)spaceOutIfOverlap(boxes[i],boxes[i-1],!0)}(boxes,boundBox,showVertically),boxes.forEach(function(box){return box.tooltip.position(box.x,box.y,{repositionArrow:!0})}),this}},{key:"hide",value:function hide(options){var tooltips=this._tooltips;for(var key in tooltips)if({}.hasOwnProperty.call(tooltips,key)){var strategy=options.strategy||this._strategy;tooltips[key].content(strategy,null),tooltips[key].hide()}}}],[{key:"formalName",value:function formalName(){return FRAGMENTED_TOOLTIP}}]),FragmentedTooltip}();__webpack_require__(30);function crossline_typeof(obj){"@babel/helpers - typeof";return(crossline_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function crossline_toConsumableArray(arr){return function crossline_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function crossline_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function crossline_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function crossline_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function crossline_possibleConstructorReturn(self,call){return!call||"object"!==crossline_typeof(call)&&"function"!=typeof call?function crossline_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function crossline_getPrototypeOf(o){return(crossline_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function crossline_setPrototypeOf(o,p){return(crossline_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var crossline_Crossline=function(_SpawnableSideEffect){function Crossline(){return function crossline_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Crossline),crossline_possibleConstructorReturn(this,crossline_getPrototypeOf(Crossline).apply(this,arguments))}return function crossline_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&crossline_setPrototypeOf(subClass,superClass)}(Crossline,spawnable_SpawnableSideEffect),function crossline_createClass(Constructor,protoProps,staticProps){return protoProps&&crossline_defineProperties(Constructor.prototype,protoProps),staticProps&&crossline_defineProperties(Constructor,staticProps),Constructor}(Crossline,[{key:"apply",value:function apply(selectionSet,payload){var height,bandWidth,px,width,_this=this,_this$config=this.config(),className=_this$config.className,bandClass=_this$config.bandClass,lineClass=_this$config.lineClass,dataModel=selectionSet.mergedEnter.model,drawingInf=this.drawingContext(),isEmptyDataModel=dataModel&&dataModel.isEmpty();if(payload.criteria&&isEmptyDataModel)return this.hide(),this;if(null===payload.criteria||!dataModel)return this.hide(),this;var dataObj=dataModel.getData(),sourceInf=this.firebolt.context.getSourceInfo(),axes=sourceInf.axes,axisFields=sourceInf.fields,fields=selectionSet.fields,data=dataObj.data,fieldsConfig=dataModel.getFieldsConfig(),svgContainer=drawingInf.sideEffectGroup,elemData=[];if(fields.forEach(function(field){var fieldIndex=fieldsConfig[field]&&fieldsConfig[field].index,dataArr=data.map(function(d){return d[fieldIndex]}),axisIndex=[["x",0],["x",1],["y",0],["y",1]].find(function(arr){var fieldInst=axisFields[arr[0]][arr[1]];return fieldInst&&fieldInst.type()===dist_datamodel.FieldType.DIMENSION&&-1!==fieldInst.getMembers().indexOf(field)});if(void 0!==axisIndex&&data.length){var type=axisIndex[0],axis=axes[type][axisIndex[1]],value=dataArr[0];bandWidth=axis.getUnitWidth()||0,px=axis.getScaleValue(value)+bandWidth/2+drawingInf.xOffset;var layers=_this.firebolt.context.layers();if((layers=layers.filter(function(layer){return!!layer.config().crossline})).length){var plotWidth=Math.max.apply(Math,crossline_toConsumableArray(layers.map(function(layer){return layer.getPlotSpan()[type]}))),pad=Math.max.apply(Math,crossline_toConsumableArray(layers.map(function(layer){return layer.getPlotPadding()[type]})));height=drawingInf.height,width=drawingInf.width;var startPx=px-plotWidth/2-pad/2,endPx=px+plotWidth/2+pad/2,dataPoint={};dataPoint.d="y"===type?"M 0 ".concat(startPx," L 0 ").concat(endPx," L ").concat(width," ").concat(endPx," L ").concat(width," ").concat(startPx," Z"):"M ".concat(startPx," 0 L ").concat(endPx," 0 L ").concat(endPx," ").concat(height," L ").concat(startPx," ").concat(height," Z"),dataPoint.className=plotWidth?bandClass:lineClass,!isNaN(px)&&elemData.push(dataPoint)}}}),elemData.length){var parentGroup=this.createElement(svgContainer,"g",[1],className);this.createElement(parentGroup,"path",elemData).attr("d",function(d){return d.d}).style("pointer-events","none").attr("class",function(d){return d.className})}return this}},{key:"hide",value:function hide(){var className=this.config().className,drawingInf=this.drawingContext();renderer_utils_selectElement(drawingInf.sideEffectGroup).selectAll(".".concat(className)).remove()}}],[{key:"defaultConfig",value:function defaultConfig(){return{className:"".concat("muze","-crossline-group"),bandClass:"".concat("muze","-crossband"),lineClass:"".concat("muze","-crossline")}}},{key:"formalName",value:function formalName(){return CROSSLINE}},{key:"target",value:function target(){return"visual-unit"}}]),Crossline}(),strategy_strategies={fade:function fadeFn(set,context){var mergedEnter=set.mergedEnter,mergedExit=set.mergedExit,completeSet=set.completeSet;mergedEnter.length||mergedExit.length?context.firebolt.context.layers().forEach(function(layer){"area"===layer.constructor.formalName()?(context.applyInteractionStyle(mergedEnter,{interactionType:"fade",apply:!0},[layer]),context.applyInteractionStyle(mergedExit,{interactionType:"fade",apply:!1},[layer])):(context.applyInteractionStyle(mergedExit,{interactionType:"fade",apply:!0},[layer]),context.applyInteractionStyle(mergedEnter,{interactionType:"fade",apply:!1},[layer]))}):context.applyInteractionStyle(completeSet,{interactionType:"fade",apply:!1})},fadeOnBrush:function fadeOnBrushFn(set,context,payload){var mergedEnter=set.mergedEnter,mergedExit=set.mergedExit,completeSet=set.completeSet,dragEnd=payload.dragEnd,interactionType="brushStroke";mergedEnter.length||mergedExit.length?(dragEnd&&(interactionType="doubleStroke",context.applyInteractionStyle(completeSet,{interactionType:"brushStroke",apply:!1})),context.firebolt.context.layers().forEach(function(layer){"area"===layer.constructor.formalName()?dragEnd&&(context.applyInteractionStyle(mergedExit,{interactionType:"fade",apply:!1},[layer]),mergedEnter.length&&context.applyInteractionStyle(mergedEnter,{interactionType:"focus",apply:!0},[layer])):(context.applyInteractionStyle(mergedExit,{interactionType:interactionType,apply:!1},[layer]),payload.dragEnd?context.applyInteractionStyle(mergedExit,{interactionType:"focus",apply:!0},[layer]):context.applyInteractionStyle(mergedExit,{interactionType:"focus",apply:!1},[layer]),"doubleStroke"!==interactionType&&context.applyInteractionStyle(mergedExit,{interactionType:"doubleStroke",apply:!1}),context.applyInteractionStyle(mergedEnter,{interactionType:interactionType,apply:!0},[layer]))})):(context.applyInteractionStyle(completeSet,{interactionType:interactionType,apply:!1}),context.applyInteractionStyle(completeSet,{interactionType:"doubleStroke",apply:!1}))},focus:function focus(set,context){var mergedEnter=set.mergedEnter,mergedExit=set.mergedExit,completeSet=set.completeSet,firebolt=context.firebolt;if(mergedEnter.length||mergedExit.length){context.applyInteractionStyle(mergedExit,{interactionType:"focusStroke",apply:!1}),context.applyInteractionStyle(mergedEnter,{interactionType:"focusStroke",apply:!0});var payload=firebolt.getPayload(behaviours_namespaceObject.HIGHLIGHT)||{},entryExitSet=firebolt.getEntryExitSet(behaviours_namespaceObject.HIGHLIGHT);firebolt.context.layers().forEach(function(layer){if("area"===layer.constructor.formalName()?(context.applyInteractionStyle(mergedExit,{interactionType:"focus",apply:!1},[layer]),context.applyInteractionStyle(mergedEnter,{interactionType:"focus",apply:!0},[layer])):(context.applyInteractionStyle(mergedExit,{interactionType:"focus",apply:!0},[layer]),context.applyInteractionStyle(mergedEnter,{interactionType:"focus",apply:!1},[layer])),null!==payload.target&&entryExitSet){var actualPoint=layer.getUidsFromPayload(entryExitSet.mergedEnter,payload.target),commonSet=common_utils_intersect(mergedEnter.uids,actualPoint.uids,[function(v){return v[0]},function(v){return v[0]}]);commonSet.length?context.applyInteractionStyle({uids:commonSet},{interactionType:"commonDoubleStroke",apply:!0},[layer]):context.applyInteractionStyle({uids:mergedExit.uids},{interactionType:"commonDoubleStroke",apply:!1},[layer])}})}else context.applyInteractionStyle(completeSet,{interactionType:"focus",apply:!1}),context.applyInteractionStyle(completeSet,{interactionType:"focusStroke",apply:!1}),context.applyInteractionStyle(completeSet,{interactionType:"commonDoubleStroke",apply:!1})},highlight:function highlight(selectionSet,context,payload){selectionSet.mergedEnter.length||selectionSet.mergedExit.length?context.firebolt.context.layers().forEach(function(layer){if(null!==payload.target){var currentHighlightedSet=layer.getUidsFromPayload(selectionSet.mergedEnter,payload.target);context.applyInteractionStyle(currentHighlightedSet,{interactionType:"highlight",apply:!0},[layer]),context.applyInteractionStyle(selectionSet.mergedExit,{interactionType:"highlight",apply:!1},[layer]);var selectEntrySet=context.firebolt.getEntryExitSet("select");if(selectEntrySet){var commonSet=common_utils_intersect(selectEntrySet.mergedEnter.uids,currentHighlightedSet.uids,[function(v){return v[0]},function(v){return v[0]}]),diffSet=difference(selectEntrySet.mergedEnter.uids,currentHighlightedSet.uids,[function(v){return v[0]},function(v){return v[0]}]);commonSet.length&&context.applyInteractionStyle({uids:commonSet},{interactionType:"commonDoubleStroke",apply:!0},[layer]),context.applyInteractionStyle({uids:diffSet},{interactionType:"commonDoubleStroke",apply:!1},[layer])}}}):(context.applyInteractionStyle(selectionSet.completeSet,{interactionType:"highlight",apply:!1}),context.applyInteractionStyle(selectionSet.completeSet,{interactionType:"commonDoubleStroke",apply:!1}))},pseudoFocus:function pseudoFocus(set,context){var mergedEnter=set.mergedEnter;context.applyInteractionStyle(mergedEnter,{interactionType:"focus",apply:!1})}};function plot_highlighter_typeof(obj){"@babel/helpers - typeof";return(plot_highlighter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function plot_highlighter_toConsumableArray(arr){return function plot_highlighter_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function plot_highlighter_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function plot_highlighter_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function plot_highlighter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function plot_highlighter_possibleConstructorReturn(self,call){return!call||"object"!==plot_highlighter_typeof(call)&&"function"!=typeof call?function plot_highlighter_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function plot_highlighter_getPrototypeOf(o){return(plot_highlighter_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function plot_highlighter_setPrototypeOf(o,p){return(plot_highlighter_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var plot_highlighter_PlotHighlighter=function(_SurrogateSideEffect){function PlotHighlighter(){var _getPrototypeOf2,_this;!function plot_highlighter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PlotHighlighter);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=plot_highlighter_possibleConstructorReturn(this,(_getPrototypeOf2=plot_highlighter_getPrototypeOf(PlotHighlighter)).call.apply(_getPrototypeOf2,[this].concat(params))))._strategy="highlight",_this._strategies=strategy_strategies,_this}return function plot_highlighter_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&plot_highlighter_setPrototypeOf(subClass,superClass)}(PlotHighlighter,SurrogateSideEffect),function plot_highlighter_createClass(Constructor,protoProps,staticProps){return protoProps&&plot_highlighter_defineProperties(Constructor.prototype,protoProps),staticProps&&plot_highlighter_defineProperties(Constructor,staticProps),Constructor}(PlotHighlighter,[{key:"getExcludeSetIds",value:function getExcludeSetIds(){var _this2=this,excludeSet=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return excludeSet instanceof Function?excludeSet(this.firebolt.getEntryExitSet):excludeSet.reduce(function(acc,behaviour){var selectedPointsIds=((_this2.firebolt.getEntryExitSet(behaviour)||{}).mergedEnter||{}).uids;return selectedPointsIds&&acc.push.apply(acc,plot_highlighter_toConsumableArray(selectedPointsIds)),acc},[])}},{key:"apply",value:function apply(selectionSet,payload){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,this._strategies[options.strategy||this._strategy])(selectionSet,this,payload),this}}],[{key:"formalName",value:function formalName(){return side_effects_HIGHLIGHTER}},{key:"target",value:function target(){return"visual-unit"}}]),PlotHighlighter}();function side_effects_filter_typeof(obj){"@babel/helpers - typeof";return(side_effects_filter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function side_effects_filter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function side_effects_filter_possibleConstructorReturn(self,call){return!call||"object"!==side_effects_filter_typeof(call)&&"function"!=typeof call?function side_effects_filter_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function side_effects_filter_getPrototypeOf(o){return(side_effects_filter_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function side_effects_filter_setPrototypeOf(o,p){return(side_effects_filter_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var FilterEffect=function(_SurrogateSideEffect){function FilterEffect(){return function side_effects_filter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,FilterEffect),side_effects_filter_possibleConstructorReturn(this,side_effects_filter_getPrototypeOf(FilterEffect).apply(this,arguments))}return function side_effects_filter_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&side_effects_filter_setPrototypeOf(subClass,superClass)}(FilterEffect,SurrogateSideEffect),function side_effects_filter_createClass(Constructor,protoProps,staticProps){return protoProps&&side_effects_filter_defineProperties(Constructor.prototype,protoProps),staticProps&&side_effects_filter_defineProperties(Constructor,staticProps),Constructor}(FilterEffect,[{key:"apply",value:function apply(selectionSet,payload){var firebolt=this.firebolt,entryModel=selectionSet.mergedEnter.model;return null===payload.criteria?firebolt.resetData():firebolt.data(entryModel),this}}],[{key:"formalName",value:function formalName(){return"filter"}},{key:"target",value:function target(){return"all"}},{key:"mutates",value:function mutates(){return!0}}]),FilterEffect}();__webpack_require__(31);function anchors_typeof(obj){"@babel/helpers - typeof";return(anchors_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function anchors_slicedToArray(arr,i){return function anchors_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function anchors_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function anchors_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function anchors_toConsumableArray(arr){return function anchors_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function anchors_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function anchors_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function anchors_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function anchors_possibleConstructorReturn(self,call){return!call||"object"!==anchors_typeof(call)&&"function"!=typeof call?function anchors_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function anchors_getPrototypeOf(o){return(anchors_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function anchors_setPrototypeOf(o,p){return(anchors_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var anchors_AnchorEffect=function(_SpawnableSideEffect){function AnchorEffect(){var _getPrototypeOf2,_this;!function anchors_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AnchorEffect);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=anchors_possibleConstructorReturn(this,(_getPrototypeOf2=anchors_getPrototypeOf(AnchorEffect)).call.apply(_getPrototypeOf2,[this].concat(params))))._layersMap={},_this.addAnchorLayers(),_this}return function anchors_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&anchors_setPrototypeOf(subClass,superClass)}(AnchorEffect,spawnable_SpawnableSideEffect),function anchors_createClass(Constructor,protoProps,staticProps){return protoProps&&anchors_defineProperties(Constructor.prototype,protoProps),staticProps&&anchors_defineProperties(Constructor,staticProps),Constructor}(AnchorEffect,[{key:"addAnchorLayers",value:function addAnchorLayers(){var context=this.firebolt.context;return function addLayer(layerRegistry,context,sideEffect){context.addLayer(function(layerDefs){var layers=[];return layerDefs&&layerDefs.forEach(function(layerDef){var mark=layerDef.mark,layerCls=layerRegistry[mark];if(layerCls&&layerCls.shouldDrawAnchors()){var depLayerEncoding=layerDef.def.encoding,encoding={x:getObjProp(depLayerEncoding,"x","field"),y:getObjProp(depLayerEncoding,"y","field"),color:{field:getObjProp(depLayerEncoding,"color","field"),value:getObjProp(depLayerEncoding,"color","value")},size:{field:getObjProp(depLayerEncoding,"size","field"),value:function value(){return sideEffect.defaultSizeValue()}}},commonName=sideEffect.constructor.formalName(),layerOwner=layerDef.def.name,name="".concat(layerOwner,"-").concat(commonName),defaultClassName="".concat(sideEffect.constructor.defaultConfig().className);layers.push({name:"".concat(name,"-upper"),mark:"point",groupId:"".concat(commonName,"-upper"),className:"".concat(defaultClassName,"-upper"),encoding:encoding,transform:{type:"identity"},calculateDomain:!1,transition:sideEffect.getTransitionConfig(),source:function source(dm){return dm.select(function(){return!1},{saveChild:!1})},interactive:!1,owner:layerDef.def.name}),"area"===mark&&layers.push({name:"".concat(name,"-lower"),mark:"point",groupId:"".concat(commonName,"-lower"),className:"".concat(defaultClassName,"-lower"),encoding:encoding,transform:{type:"identity"},calculateDomain:!1,transition:sideEffect.getTransitionConfig(),source:function source(dm){return dm.select(function(){return!1},{saveChild:!1})},interactive:!1,owner:layerDef.def.name})}}),layers})}(context.registry().layerRegistry,context,this),this}},{key:"getTransitionConfig",value:function getTransitionConfig(){return{disabled:!0}}},{key:"defaultSizeValue",value:function defaultSizeValue(){return 70}},{key:"getAnchorSizeOnInteraction",value:function getAnchorSizeOnInteraction(_ref){return _ref.dragEnd?40:0}},{key:"apply",value:function apply(selectionSet,payload){var _this2=this,dataModel=selectionSet.mergedEnter.model,formalName=this.constructor.formalName(),context=this.firebolt.context,upperAnchors=context.layers().filter(function(layer){return layer.config().groupId==="".concat(formalName,"-upper")}),lowerAnchors=context.layers().filter(function(layer){return layer.config().groupId==="".concat(formalName,"-lower")}),target=payload.target,action=payload.action,targetObj=null;target&&(targetObj=target[1].reduce(function(acc,v,i){var field=target[0][i];return field!==reserved_fields.MEASURE_NAMES&&(acc[field]=v),acc},{})),[].concat(anchors_toConsumableArray(upperAnchors),anchors_toConsumableArray(lowerAnchors)).forEach(function(layer,index){var layerConfig=layer.config(),linkedLayer=context.getLayerByName(layerConfig.owner),linkedLayerName=linkedLayer.constructor.formalName(),isUpperAnchor=layerConfig.groupId==="".concat(formalName,"-upper"),transformedData=[],schema=[],_linkedLayer$getTrans2=anchors_slicedToArray(linkedLayer.getTransformedDataFromIdentifiers(dataModel,index),2);if(transformedData=_linkedLayer$getTrans2[0],schema=_linkedLayer$getTrans2[1],"area"===linkedLayerName&&target&&"highlight"===action){var filterFn=common_utils_dmMultipleSelection(target,dataModel),dmFromPayload=dataModel.select(filterFn,{});if(!isUpperAnchor){var _linkedLayer$getTrans4=anchors_slicedToArray(linkedLayer.getTransformedDataFromIdentifiers(dmFromPayload,index),2);transformedData=_linkedLayer$getTrans4[0],schema=_linkedLayer$getTrans4[1]}}var transformedDataModel=new datamodel_default.a(transformedData,schema),anchorSizeConfig={encoding:{size:{value:function value(){return _this2.defaultSizeValue()+_this2.getAnchorSizeOnInteraction(payload)}},"stroke-width":{value:_this2.getAnchorStroke(payload,targetObj)}}},newConfig=mergeRecursive(layerConfig,anchorSizeConfig);return layer.data(transformedDataModel).config(newConfig),_this2})}},{key:"getAnchorStroke",value:function getAnchorStroke(payload,targetObj){return function(d){var dataObj=d.data.dataObj;return!!targetObj&&Object.keys(targetObj).every(function(key){return dataObj[key]===targetObj[key]})?"1px":"0px"}}}],[{key:"target",value:function target(){return"visual-unit"}},{key:"defaultConfig",value:function defaultConfig(){return{className:"".concat("muze","-anchors-group")}}},{key:"formalName",value:function formalName(){return side_effects_ANCHORS}}]),AnchorEffect}();function persistent_anchors_typeof(obj){"@babel/helpers - typeof";return(persistent_anchors_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function persistent_anchors_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function persistent_anchors_possibleConstructorReturn(self,call){return!call||"object"!==persistent_anchors_typeof(call)&&"function"!=typeof call?function persistent_anchors_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function persistent_anchors_getPrototypeOf(o){return(persistent_anchors_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function persistent_anchors_setPrototypeOf(o,p){return(persistent_anchors_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var persistent_anchors_PersistentAnchors=function(_AnchorEffect){function PersistentAnchors(){return function persistent_anchors_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PersistentAnchors),persistent_anchors_possibleConstructorReturn(this,persistent_anchors_getPrototypeOf(PersistentAnchors).apply(this,arguments))}return function persistent_anchors_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&persistent_anchors_setPrototypeOf(subClass,superClass)}(PersistentAnchors,anchors_AnchorEffect),function persistent_anchors_createClass(Constructor,protoProps,staticProps){return protoProps&&persistent_anchors_defineProperties(Constructor.prototype,protoProps),staticProps&&persistent_anchors_defineProperties(Constructor,staticProps),Constructor}(PersistentAnchors,[{key:"getTransitionConfig",value:function getTransitionConfig(){return{disabled:!0}}},{key:"setAnchorLayerStyle",value:function setAnchorLayerStyle(layers){var _this=this;layers.filter(function(l){return l.config().groupId===side_effects_PERSISTENT_ANCHORS}).forEach(function(anchor){var ids=anchor.data().getUids(),layerName=_this.constructor.formalName(),defaultInteractionLayerEncoding=anchor.config().encoding.interaction;anchor.applyInteractionStyle(defaultInteractionLayerEncoding[layerName],ids,{apply:!0})})}},{key:"getAnchorSizeonInteraction",value:function getAnchorSizeonInteraction(){return 50}},{key:"getAnchorStroke",value:function getAnchorStroke(){return"2px"}}],[{key:"formalName",value:function formalName(){return side_effects_PERSISTENT_ANCHORS}},{key:"defaultConfig",value:function defaultConfig(){return{className:"".concat("muze","-persistent-anchors")}}}]),PersistentAnchors}();function brush_anchors_typeof(obj){"@babel/helpers - typeof";return(brush_anchors_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function brush_anchors_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function brush_anchors_possibleConstructorReturn(self,call){return!call||"object"!==brush_anchors_typeof(call)&&"function"!=typeof call?function brush_anchors_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function brush_anchors_getPrototypeOf(o){return(brush_anchors_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function brush_anchors_setPrototypeOf(o,p){return(brush_anchors_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var brush_anchors_BrushAnchors=function(_AnchorEffect){function BrushAnchors(){return function brush_anchors_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BrushAnchors),brush_anchors_possibleConstructorReturn(this,brush_anchors_getPrototypeOf(BrushAnchors).apply(this,arguments))}return function brush_anchors_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&brush_anchors_setPrototypeOf(subClass,superClass)}(BrushAnchors,anchors_AnchorEffect),function brush_anchors_createClass(Constructor,protoProps,staticProps){return protoProps&&brush_anchors_defineProperties(Constructor.prototype,protoProps),staticProps&&brush_anchors_defineProperties(Constructor,staticProps),Constructor}(BrushAnchors,[{key:"getTransitionConfig",value:function getTransitionConfig(){return{disabled:!0}}},{key:"setAnchorLayerStyle",value:function setAnchorLayerStyle(layers){var _this=this;layers.filter(function(l){return l.config().groupId===side_effects_BRUSH_ANCHORS}).forEach(function(anchor){var ids=anchor.data().getUids(),layerName=_this.constructor.formalName(),defaultInteractionLayerEncoding=anchor.config().encoding.interaction;anchor.applyInteractionStyle(defaultInteractionLayerEncoding[layerName],ids,{apply:!0})})}},{key:"getAnchorStroke",value:function getAnchorStroke(payload){return payload.dragEnd?"2px":"1px"}}],[{key:"formalName",value:function formalName(){return side_effects_BRUSH_ANCHORS}},{key:"defaultConfig",value:function defaultConfig(){return{className:"".concat("muze","-brush-anchors")}}}]),BrushAnchors}();__webpack_require__(32);function axis_labels_highlighter_typeof(obj){"@babel/helpers - typeof";return(axis_labels_highlighter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function axis_labels_highlighter_toConsumableArray(arr){return function axis_labels_highlighter_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function axis_labels_highlighter_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function axis_labels_highlighter_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function axis_labels_highlighter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function axis_labels_highlighter_possibleConstructorReturn(self,call){return!call||"object"!==axis_labels_highlighter_typeof(call)&&"function"!=typeof call?function axis_labels_highlighter_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function axis_labels_highlighter_getPrototypeOf(o){return(axis_labels_highlighter_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function axis_labels_highlighter_setPrototypeOf(o,p){return(axis_labels_highlighter_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _behaviourEffectMap,axis_labels_highlighter_AxisLabelHighLighter=function(_SurrogateSideEffect){function AxisLabelHighLighter(){return function axis_labels_highlighter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AxisLabelHighLighter),axis_labels_highlighter_possibleConstructorReturn(this,axis_labels_highlighter_getPrototypeOf(AxisLabelHighLighter).apply(this,arguments))}return function axis_labels_highlighter_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&axis_labels_highlighter_setPrototypeOf(subClass,superClass)}(AxisLabelHighLighter,SurrogateSideEffect),function axis_labels_highlighter_createClass(Constructor,protoProps,staticProps){return protoProps&&axis_labels_highlighter_defineProperties(Constructor.prototype,protoProps),staticProps&&axis_labels_highlighter_defineProperties(Constructor,staticProps),Constructor}(AxisLabelHighLighter,[{key:"apply",value:function apply(selectionSet){var context=this.firebolt.context,dataModel=selectionSet&&selectionSet.mergedEnter.model;if(!helper_shouldApplySideEffect(dataModel,this))return this;var selectedData=dataModel&&dataModel.getData().data,selectedDataValues=selectedData&&selectedData.length?selectedData[0]:[],_context$axes=context.axes(),_context$axes$x=_context$axes.x,x=void 0===_context$axes$x?[]:_context$axes$x,_context$axes$y=_context$axes.y,y=void 0===_context$axes$y?[]:_context$axes$y;return[].concat(axis_labels_highlighter_toConsumableArray(x),axis_labels_highlighter_toConsumableArray(y)).forEach(function(axis){var fieldMeta=dataModel?dataModel.getFieldsConfig()[axis.config().field]:void 0,selData=selectedDataValues[fieldMeta&&void 0!==fieldMeta.index?fieldMeta.index:void 0],_axis$getTicksBasedOn=axis.getTicksBasedOnData(selData),selectedElements=_axis$getTicksBasedOn.selectionSet,rejectionSet=_axis$getTicksBasedOn.rejectionSet;selectedElements&&selectedElements.selectAll("text").classed("muze-axis-ticks-highlight",!0),rejectionSet.selectAll("text").classed("muze-axis-ticks-highlight",!1)}),this}}],[{key:"formalName",value:function formalName(){return AXIS_LABEL_HIGHLIGHTER}},{key:"target",value:function target(){return"visual-unit"}}]),AxisLabelHighLighter}();function behaviour_effect_map_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var nullDataTooltipMap={area:!0,arc:!1,line:!0,text:!1,point:!1,bar:!1,tick:!1},applySideEffectOnEmptyTarget=function applySideEffectOnEmptyTarget(sideEffect,_ref){var target=_ref.target;return sideEffect.layers().some(function(l){var layerName=l.constructor.formalName();return nullDataTooltipMap[layerName]})||target},behaviour_effect_map_behaviourEffectMap=(behaviour_effect_map_defineProperty(_behaviourEffectMap={},BRUSH,["selectionBox",{name:"highlighter",options:{strategy:"fadeOnBrush"}},"brush-anchors"]),behaviour_effect_map_defineProperty(_behaviourEffectMap,HIGHLIGHT,[{name:"highlighter",options:{strategy:"highlight"}},"crossline",{name:"tooltip",options:{setTransform:function setTransform(selectionSet,payload,sideEffect){return sideEffect.firebolt._actions.behavioural.brush.active?null:applySideEffectOnEmptyTarget(sideEffect,payload)?selectionSet:null}}},"anchors",{name:"tooltip",options:{strategy:"selectionSummary",setTransform:function setTransform(selectionSet,payload,sideEffect){if(!0===sideEffect.firebolt._actions.behavioural.brush.active||!applySideEffectOnEmptyTarget(sideEffect,payload))return null;var selectEntrySet=sideEffect.firebolt.getEntryExitSet(SELECT),brushEntrySet=sideEffect.firebolt.getEntryExitSet(BRUSH);if(selectEntrySet||brushEntrySet){var uids=[],returnEntrySet=null;getObjProp(selectEntrySet,"mergedEnter","uids","length")?(uids=selectEntrySet.mergedEnter.uids,returnEntrySet=selectEntrySet):getObjProp(brushEntrySet,"mergedEnter","uids","length")&&(uids=brushEntrySet.mergedEnter.uids,returnEntrySet=brushEntrySet);var highlightUids=selectionSet.mergedEnter.uids;if(common_utils_intersect(uids,highlightUids,[function(id){return id[0]},function(id){return id[0]}]).length)return returnEntrySet}return null}}},{name:AXIS_LABEL_HIGHLIGHTER,options:{setTransform:function setTransform(selectionSet,payload,sideEffect){return sideEffect.firebolt._actions.behavioural.brush.active?null:applySideEffectOnEmptyTarget(sideEffect,payload)?selectionSet:null}}}]),behaviour_effect_map_defineProperty(_behaviourEffectMap,FILTER,["filter"]),behaviour_effect_map_defineProperty(_behaviourEffectMap,SELECT,[{name:"highlighter",options:{strategy:"focus"}},"persistent-anchors",{name:"tooltip",options:{strategy:"selectionSummary"}}]),behaviour_effect_map_defineProperty(_behaviourEffectMap,"pseudoSelect",[{name:"highlighter",options:{strategy:"pseudoFocus"}}]),_behaviourEffectMap),convertToObj=function convertToObj(comps){var obj={};for(var key in comps){var val=comps[key];obj[val.formalName()]=val}return obj},registry_registry={behaviours:common_utils_componentRegistry(convertToObj(behavioural_namespaceObject)),physicalActions:common_utils_componentRegistry(physicalActions),sideEffects:common_utils_componentRegistry(convertToObj(src_side_effects_namespaceObject))};function payload_generator_toConsumableArray(arr){return function payload_generator_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function payload_generator_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function payload_generator_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var payloadGenerator={brush:function brush(instance,selectionDataModel,propConfig,facetByFields){var payload,propPayload=propConfig.payload;if(isSimpleObject(propPayload.criteria)){var criteria=function getRangeFromData(instance,selectionDataModel,propConfig){var dataObj=selectionDataModel.getData(),_propConfig$includeMe=propConfig.includeMeasures,includeMeasures=void 0===_propConfig$includeMe||_propConfig$includeMe,sourceIdentifiers=propConfig.sourceIdentifiers,schema=dataObj.schema,fieldMap=instance.data().getFieldsConfig(),selectionDataFields=selectionDataModel.getFieldspace().fieldsObj(),criteria=null;if(null!==sourceIdentifiers){criteria=schema.reduce(function(ranges,obj){var field=obj.name;return fieldMap[field]?(ranges[field]=selectionDataFields[field].domain(),ranges):ranges},{});var measureNamesIdx=sourceIdentifiers.identifiers[0].findIndex(function(field){return field===reserved_fields.MEASURE_NAMES});if(void 0!==measureNamesIdx&&includeMeasures){var measureNames=sourceIdentifiers.identifiers.slice(1,sourceIdentifiers.identifiers.length).map(function(d){return d[measureNamesIdx]});criteria[reserved_fields.MEASURE_NAMES]=measureNames.map(function(d){return[d]})}}return criteria}(instance,selectionDataModel,propConfig);(payload=Object.assign({},propPayload)).criteria=criteria}else payload=payloadGenerator.__default(instance,selectionDataModel,propConfig,facetByFields);return payload},__default:function __default(instance,propagationDataModel,propConfig){var facetByFields=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},propagationDataDims=[],criteria=null,propPayload=propConfig.payload,sourceIdentifiers=propConfig.sourceIdentifiers,excludeSelectedMeasures=propConfig.excludeSelectedMeasures,data=propagationDataModel.getData({withUid:!0}).data,payload=Object.assign({},propPayload),fieldsConfig=Object.assign({},propagationDataModel.getFieldsConfig(),function payload_generator_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},reserved_fields.ROW_ID,{index:Object.keys(propagationDataModel.getFieldsConfig()).length}));return!(propagationDataDims=Object.keys(propagationDataModel.getFieldspace().getDimension())).length&&(propagationDataDims=[reserved_fields.ROW_ID]),sourceIdentifiers&&function(){for(var identifierMap=function getIdentifierMeasureMap(identifiers,fields,facetsMap){var identifierIdxMap=getIndexMap(identifiers[0]);return identifiers.slice(1,identifiers.length).reduce(function(acc,row){var facetPresent=!0;for(var field in facetsMap){var facetVal=row[identifierIdxMap[field]];facetPresent=facetPresent&&facetVal===facetsMap[field]}if(facetPresent){var key=fields.map(function(field){var fieldIndex=identifierIdxMap[field];return row[fieldIndex]}),measureNamesIdx=identifierIdxMap[reserved_fields.MEASURE_NAMES];if(void 0!==measureNamesIdx){var measureArr=row[measureNamesIdx];!acc[key]&&(acc[key]=[]),measureArr&&measureArr.length&&acc[key].push([measureArr])}}return acc},{})}(sourceIdentifiers.identifiers,propagationDataDims,facetByFields),dataArr=[],_loop=function _loop(i,len){var row=data[i],dims=[];propagationDataDims.forEach(function(field){var idx=fieldsConfig[field].index;dims.push(row[idx])});var uid=row[row.length-1],dimKey="".concat(dims);if(dimKey in identifierMap){var measures=identifierMap[dimKey],allMeasures=instance._metaData.dimensionsMap[uid];if(excludeSelectedMeasures)difference(allMeasures,measures).forEach(function(measureArr){dataArr.push([].concat(dims,[measureArr]))});else measures&&measures.length?measures.forEach(function(measureArr){dataArr.push([].concat(dims,[measureArr]))}):dataArr.push([].concat(dims,[[]]))}else dataArr.push([].concat(dims,[[]]))},i=0,len=data.length;i<len;i++)_loop(i);criteria=[[].concat(payload_generator_toConsumableArray(propagationDataDims),[reserved_fields.MEASURE_NAMES])].concat(dataArr)}(),payload.criteria=criteria,payload.sourceFields=sourceIdentifiers?sourceIdentifiers.fields.map(function(d){return d.name}):[],payload},pseudoSelect:function pseudoSelect(instance,selectionDataModel,propConfig){return payloadGenerator.__default(instance,selectionDataModel,Object.assign({},{excludeSelectedMeasures:!0},propConfig))}};function firebolt_helper_toConsumableArray(arr){return function firebolt_helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function firebolt_helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function firebolt_helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var isSideEffectEnabled=function isSideEffectEnabled(firebolt,_ref){var se=_ref.se,propagationInf=_ref.propagationInf,sideEffectPolicies=firebolt._sideEffectPolicies,sideEffectCheckers=Object.values(sideEffectPolicies[se.name||se]||{}),sourceIdentifiers=propagationInf.sourceIdentifiers,propagationData=propagationInf.data;return!sideEffectCheckers.length||sideEffectCheckers.every(function(checker){return checker(propagationInf.propPayload,firebolt,{sourceIdentifiers:sourceIdentifiers,propagationData:propagationData})})},prepareSelectionSetMap=function prepareSelectionSetMap(_ref3,layers){var data=_ref3.data,uids=_ref3.uids,dimensions=_ref3.dimensions,maps=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},obj=function getUniqueKeys(data,_ref2){var layers=_ref2.layers,uids=_ref2.uids,_ref2$keys=_ref2.keys,keys=void 0===_ref2$keys?{}:_ref2$keys,_ref2$dimensionsMap=_ref2.dimensionsMap,dimensionsMap=void 0===_ref2$dimensionsMap?{}:_ref2$dimensionsMap,dimensions=_ref2.dimensions;return data.forEach(function(row,i){var key=[uids[i]],dims=dimensions.map(function(d){return row[d.index]});layers.forEach(function(layer){var measureNames=Object.keys(layer.data().getFieldspace().getMeasure()),mKey="".concat([key].concat(firebolt_helper_toConsumableArray(measureNames)));keys[mKey]=defaultValue(keys[mKey],{}),keys[mKey]={dims:dims,measureNames:measureNames,uid:uids[i]},dimensionsMap[key]=defaultValue(dimensionsMap[key],[]),measureNames.length&&dimensionsMap[key].push(measureNames)})}),{keys:keys,dimensionsMap:dimensionsMap}}(data,{layers:layers,uids:uids,keys:maps.keys,dimensions:dimensions,dimensionsMap:maps.dimensionsMap});return{keys:obj.keys,dimensionsMap:obj.dimensionsMap}},createMapByDimensions=function createMapByDimensions(context,dm){var cacheMap=context._cacheMap={};return function(propDims,fieldsConfig){return(cacheMap=context._cacheMap)[propDims]||(cacheMap[propDims]=dm.getData({withUid:!0}).data.reduce(function(acc,row){var key=propDims.map(function(d){return row[fieldsConfig[d].index]});return acc[key]||(acc[key]=[]),acc[key].push(row),acc},{})),cacheMap[propDims]}};function src_firebolt_typeof(obj){"@babel/helpers - typeof";return(src_firebolt_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function src_firebolt_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function firebolt_possibleConstructorReturn(self,call){return!call||"object"!==src_firebolt_typeof(call)&&"function"!=typeof call?function firebolt_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function firebolt_get(target,property,receiver){return(firebolt_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function firebolt_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=firebolt_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function firebolt_getPrototypeOf(o){return(firebolt_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function firebolt_setPrototypeOf(o,p){return(firebolt_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _actionBehaviourMap,firebolt_sideEffectPolicy=function sideEffectPolicy(propPayload,firebolt,propagationInf){var sourceIdentifiers=propagationInf.sourceIdentifiers,propagationData=propagationInf.propagationData,sourceIdentifierFields=sourceIdentifiers.fields.filter(function(field){return field.type!==dist_datamodel.FieldType.MEASURE}).map(function(field){return field.name}),propFields=Object.keys(propagationData.getFieldsConfig()),hasCommonCanvas=propPayload.sourceCanvas===firebolt.sourceCanvas();return common_utils_intersect(sourceIdentifierFields,propFields).length||hasCommonCanvas},firebolt_UnitFireBolt=function(_Firebolt){function UnitFireBolt(){var _getPrototypeOf2,_this;!function src_firebolt_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UnitFireBolt);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];_this=firebolt_possibleConstructorReturn(this,(_getPrototypeOf2=firebolt_getPrototypeOf(UnitFireBolt)).call.apply(_getPrototypeOf2,[this].concat(params)));var TOOLTIP=side_effects_namespaceObject.TOOLTIP,HIGHLIGHTER=side_effects_namespaceObject.HIGHLIGHTER,ANCHORS=side_effects_namespaceObject.ANCHORS,BRUSH_ANCHORS=side_effects_namespaceObject.BRUSH_ANCHORS,PERSISTENT_ANCHORS=side_effects_namespaceObject.PERSISTENT_ANCHORS;return _this._handlers={},_this._propagationIdentifiers={},_this._connectedBehaviours={},_this.payloadGenerators(payloadGenerator),_this.sideEffects().tooltip.disable(),[TOOLTIP,HIGHLIGHTER,ANCHORS,BRUSH_ANCHORS,PERSISTENT_ANCHORS].forEach(function(sideEffect){_this.changeSideEffectStateOnPropagation(sideEffect,firebolt_sideEffectPolicy,"sourceTargetPolicy")}),_this}return function firebolt_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&firebolt_setPrototypeOf(subClass,superClass)}(UnitFireBolt,firebolt_Firebolt),function src_firebolt_createClass(Constructor,protoProps,staticProps){return protoProps&&src_firebolt_defineProperties(Constructor.prototype,protoProps),staticProps&&src_firebolt_defineProperties(Constructor,staticProps),Constructor}(UnitFireBolt,[{key:"getApplicableSideEffects",value:function getApplicableSideEffects(sideEffects,payload,propagationInf){var _this2=this,context=this.context,unitId=context.id(),aliasName=context.parentAlias(),propagationSourceCanvas=propagationInf.propPayload&&propagationInf.propPayload.sourceCanvas,sourceUnitId=propagationInf.propPayload&&propagationInf.propPayload.sourceUnit,sideEffectInstances=this.sideEffects(),actionOnSource=!sourceUnitId||sourceUnitId===unitId,applicableSideEffects=payload.sideEffects?[{effects:payload.sideEffects,behaviours:[payload.action]}]:sideEffects;return applicableSideEffects.forEach(function(d){var mappedEffects=d.effects;mappedEffects=mappedEffects.filter(function(se){return(!sideEffectInstances[se.name||se].constructor.mutates()||!1!==propagationInf.isMutableAction)&&(actionOnSource||null===payload.criteria?propagationSourceCanvas!==aliasName&&!actionOnSource||!1!==se.applyOnSource:isSideEffectEnabled(_this2,{se:se,propagationInf:propagationInf}))}),d.effects=mappedEffects}),applicableSideEffects}},{key:"shouldApplySideEffects",value:function shouldApplySideEffects(propInf){return!1===propInf.propagate&&!1!==propInf.applySideEffect}},{key:"data",value:function data(){if(arguments.length){var model=arguments.length<=0?void 0:arguments[0];return this.context.enableCaching().data(model),this}return this.context.data()}},{key:"resetData",value:function resetData(){return this.context.clearCaching().resetData(),this}},{key:"onDataModelPropagation",value:function onDataModelPropagation(){var _this3=this;return function(data,config){var isMutableAction=!1,context=_this3.context;if(context.mount()){var propagationData=data,enabledFn=config.enabled,sourceIdentifiers=config.sourceIdentifiers,action=config.action,propPayload=config.payload,payload=_this3.getPayloadGeneratorFor(action)(_this3,propagationData,config,context.facetFieldsMap()),behaviourPolicies=_this3._behaviourPolicies,enabled=Object.values(behaviourPolicies[action]||behaviourPolicies["*"]||{}).every(function(fn){return fn(propPayload||{},_this3,{sourceIdentifiers:sourceIdentifiers,propagationData:propagationData})});if(enabledFn&&(enabled=enabledFn(config,_this3)&&!1!==enabled),enabled){var effects=_this3._behaviourEffectMap[action],sideEffectInstances=_this3.sideEffects();isMutableAction=config.groupId?effects.some(function(d){return sideEffectInstances[d.name||d].constructor.mutates()}):config.isMutableAction;var propagationInf={propagate:!1,data:propagationData,propPayload:propPayload,sourceIdentifiers:sourceIdentifiers,sourceId:config.propagationSourceId,isMutableAction:config.isMutableAction};_this3._actionHistory[action]={payload:payload,propagationInf:propagationInf,isMutableAction:isMutableAction},_this3.dispatchBehaviour(action,payload,propagationInf),function dispatchSecondaryActions(firebolt,_ref4){var action=_ref4.action,propagationData=_ref4.propagationData,config=_ref4.config,propagationInf=_ref4.propagationInf,context=firebolt.context;(firebolt._connectedBehaviours[action]||[]).forEach(function(secAction){var generatedPayload=firebolt.getPayloadGeneratorFor(secAction)(firebolt,propagationData,config,context.facetByFields());firebolt.dispatchBehaviour(secAction,generatedPayload,propagationInf)})}(_this3,{action:action,propagationInf:propagationInf,propagationData:propagationData,config:config})}}}}},{key:"target",value:function target(){return"visual-unit"}},{key:"createSelectionSet",value:function createSelectionSet(){for(var _get2,_len2=arguments.length,params=new Array(_len2),_key2=0;_key2<_len2;_key2++)params[_key2]=arguments[_key2];return(_get2=firebolt_get(firebolt_getPrototypeOf(UnitFireBolt.prototype),"createSelectionSet",this)).call.apply(_get2,[this].concat(params)),this._dimsMapGetter=createMapByDimensions(this,this.data()),this}},{key:"remove",value:function remove(){return this.context.cachedData()[0].unsubscribe("propagation"),this}},{key:"propagationIdentifiers",value:function propagationIdentifiers(action,identifiers){return identifiers&&(this._propagationIdentifiers=identifiers),this._propagationIdentifiers[action]}},{key:"registerPhysicalActionHandlers",value:function registerPhysicalActionHandlers(){return this}},{key:"id",value:function id(){return this.context.id()}},{key:"getPropagationSource",value:function getPropagationSource(){return this.context.cachedData()[0]}},{key:"sourceCanvas",value:function sourceCanvas(){return this.context.parentAlias()}}]),UnitFireBolt}();function action_behaviour_map_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var actionBehaviourMap=(action_behaviour_map_defineProperty(_actionBehaviourMap={},actions_namespaceObject.DRAG,{behaviours:[behaviours_namespaceObject.BRUSH],touch:!1}),action_behaviour_map_defineProperty(_actionBehaviourMap,actions_namespaceObject.HOVER,{behaviours:[behaviours_namespaceObject.HIGHLIGHT]}),action_behaviour_map_defineProperty(_actionBehaviourMap,actions_namespaceObject.LONGTOUCH,{behaviours:[behaviours_namespaceObject.SELECT],touch:!0}),action_behaviour_map_defineProperty(_actionBehaviourMap,actions_namespaceObject.TOUCHDRAG,{behaviours:[behaviours_namespaceObject.BRUSH],touch:!0}),action_behaviour_map_defineProperty(_actionBehaviourMap,actions_namespaceObject.CLICK,{behaviours:[behaviours_namespaceObject.SELECT],touch:!1}),_actionBehaviourMap);function behaviours_brush_typeof(obj){"@babel/helpers - typeof";return(behaviours_brush_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function behaviours_brush_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function behaviours_brush_possibleConstructorReturn(self,call){return!call||"object"!==behaviours_brush_typeof(call)&&"function"!=typeof call?function behaviours_brush_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function brush_get(target,property,receiver){return(brush_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function brush_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=behaviours_brush_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function behaviours_brush_getPrototypeOf(o){return(behaviours_brush_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function behaviours_brush_setPrototypeOf(o,p){return(behaviours_brush_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var brush_UnitBrushBehaviour=function(_VolatileBehaviour){function UnitBrushBehaviour(){return function behaviours_brush_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UnitBrushBehaviour),behaviours_brush_possibleConstructorReturn(this,behaviours_brush_getPrototypeOf(UnitBrushBehaviour).apply(this,arguments))}return function behaviours_brush_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&behaviours_brush_setPrototypeOf(subClass,superClass)}(UnitBrushBehaviour,volatile_VolatileBehaviour),function behaviours_brush_createClass(Constructor,protoProps,staticProps){return protoProps&&behaviours_brush_defineProperties(Constructor.prototype,protoProps),staticProps&&behaviours_brush_defineProperties(Constructor,staticProps),Constructor}(UnitBrushBehaviour,[{key:"dispatch",value:function dispatch(){for(var _get2,_len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return this.active=params[0].dragging,this.start=params[0].dragStart,(_get2=brush_get(behaviours_brush_getPrototypeOf(UnitBrushBehaviour.prototype),"dispatch",this)).call.apply(_get2,[this].concat(params))}}],[{key:"formalName",value:function formalName(){return"brush"}}]),UnitBrushBehaviour}();function grid_lines_slicedToArray(arr,i){return function grid_lines_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function grid_lines_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function grid_lines_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function grid_lines_toConsumableArray(arr){return function grid_lines_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function grid_lines_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function grid_lines_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function grid_lines_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var grid_lines_BAR_LAYER=layer_types_namespaceObject.BAR_LAYER,grid_lines_TICK_LAYER=layer_types_namespaceObject.TICK_LAYER,grid_lines_LINEAR=scale_type_namespaceObject.LINEAR,grid_lines_getGridLayerDefinitions=function getGridLayerDefinitions(context,config,type){return["x","y"].map(function(axisType){var axes=context.axes();return axes[axisType]&&defaultValue(config[axisType]&&config[axisType].show,function getDefaultVisibilty(show,axis){return axis.constructor.type()===grid_lines_LINEAR&&show}(config.show,axes[axisType][0]))?function getLayerDefinition(context,axes,type,orientation){var _definition,_axes,encoding,_encoding,config=context.config(),classPrefix=config.classPrefix,gridLines=config.gridLines,gridBands=config.gridBands,gridLineColor=gridLines.color,zeroLineColor=gridLines.zeroLineColor,defClassName=type===GRID_BAND?gridBands.defClassName:gridLines.defClassName,gridBandColor=gridBands[orientation].color,axis=axes[orientation][0],isLinearScale=axis.constructor.type()===grid_lines_LINEAR;type===GRID_BAND&&isLinearScale?(grid_lines_defineProperty(_encoding={},orientation,"".concat(orientation,"value")),grid_lines_defineProperty(_encoding,"".concat(orientation,"0"),"".concat(orientation,"value0")),encoding=_encoding):encoding=grid_lines_defineProperty({},orientation,"".concat(orientation,isLinearScale?"value":"dim"));encoding.color={value:function value(data,i){var isNegativeDomain=isLinearScale&&axis.domain()[0]<0;return type===GRID_BAND?gridBandColor[i%2]:isNegativeDomain&&0===data[orientation]?zeroLineColor:gridLineColor}};var _context$axes=context.axes(),color=_context$axes.color,shape=_context$axes.shape,size=_context$axes.size;return{definition:(_definition={defClassName:"".concat(defClassName,"-").concat(orientation),className:config.className,name:orientation,calculateDomain:!1,individualClassName:function individualClassName(data,i){return isLinearScale&&axis.domain()[0]<0&&0===data.y&&type!==GRID_BAND?"".concat(classPrefix,"-axis-zero-line"):"".concat(classPrefix,"-grid-").concat(type,"-").concat(orientation,"-").concat(i%2)}},grid_lines_defineProperty(_definition,"pad".concat(orientation.toUpperCase()),type===GRID_BAND?0:void 0),grid_lines_defineProperty(_definition,"encoding",encoding),_definition),axes:(_axes={},grid_lines_defineProperty(_axes,orientation,axis),grid_lines_defineProperty(_axes,"color",color[0]),grid_lines_defineProperty(_axes,"shape",shape[0]),grid_lines_defineProperty(_axes,"size",size[0]),_axes),interactive:!1}}(context,axes,type,axisType):null}).filter(function(d){return null!==d})},dimensionSubTypes=Object.values(dist_datamodel.DimensionSubtype).reduce(function(acc,v){return acc[v]=1,acc},{}),grid_lines_getValidSubtype=function getValidSubtype(subtype){return dimensionSubTypes[subtype]?subtype:dist_datamodel.DimensionSubtype.CATEGORICAL},attachDataToGridLineLayers=function attachDataToGridLineLayers(context){var axes=context.axes(),gridLines=context._gridLines,gridBands=context._gridBands;if(gridLines.length||gridBands.length){var _ref,gridLayerData=function getGridLayerData(axes,fields,fieldsConfig){var gridData={};return["x","y"].forEach(function(type){var ticks=axes[type][0].getTickValues(),subtype=getObjProp(fieldsConfig,getObjProp(fields,type,0).getMembers()[0],"def","subtype"),jsonData=[],schema=[{name:"yvalue",type:"measure"},{name:"xvalue",type:"measure"},{name:"yvalue0",type:"measure"},{name:"xvalue0",type:"measure"},{name:"xdim",type:"dimension",subtype:grid_lines_getValidSubtype(subtype)},{name:"ydim",type:"dimension",subtype:grid_lines_getValidSubtype(subtype)}],len=Math.max(ticks.length);ticks=subtype===dist_datamodel.DimensionSubtype.TEMPORAL?ticks.map(function(d){return d.getTime()}):ticks;for(var i=0;i<len;i+=1){var _jsonData$push;jsonData.push((grid_lines_defineProperty(_jsonData$push={},"".concat(type,"value"),ticks[i]),grid_lines_defineProperty(_jsonData$push,"".concat(type,"value0"),ticks[i+1]),grid_lines_defineProperty(_jsonData$push,"".concat(type,"dim"),ticks[i]),grid_lines_defineProperty(_jsonData$push,"".concat(type,"dim"),ticks[i]),_jsonData$push))}gridData[type]=new datamodel_default.a(jsonData,schema)}),gridData}(axes,context.fields(),context.data().getFieldsConfig());(_ref=[]).concat.apply(_ref,grid_lines_toConsumableArray(gridBands).concat(grid_lines_toConsumableArray(gridLines))).forEach(function(inst){inst.data(inst.axes().x?gridLayerData.x:gridLayerData.y)})}};function listener_map_toConsumableArray(arr){return function listener_map_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function listener_map_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function listener_map_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function src_listener_map_slicedToArray(arr,i){return function src_listener_map_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function src_listener_map_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function src_listener_map_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var _PROPS,listener_map_listenerMap=[{type:"registerImmediateListener",props:[LAYERDEFS],listener:function listener(context,_ref){var layerDefs=src_listener_map_slicedToArray(_ref,2)[1],fieldsVal=context.fields();if(layerDefs&&fieldsVal){!function removeExitLayers(layerDefs,context){var layersMap=context._layersMap,markSet={};for(var key in layerDefs.forEach(function(layerDef,i){var id=defaultValue(layerDef.name,"".concat(layerDef.mark,"-").concat(i));markSet[id]=!0}),layersMap)key in markSet||(layersMap[key].forEach(function(layer){return layer.remove()}),delete layersMap[key])}(layerDefs,context);var queuedLayerDefs=context._queuedLayerDefs,layerDefArr=layerDefs;queuedLayerDefs.forEach(function(defFn){layerDefArr=[].concat(listener_map_toConsumableArray(layerDefArr),listener_map_toConsumableArray(defFn(layerDefs)))}),context.addLayer(layerDefArr);var adjustRange=context.layers().some(function(inst){return inst.hasPlotSpan()});["x","y"].forEach(function(type){defaultValue(getObjProp(context.axes(),type),[]).forEach(function(axis){axis.config({adjustRange:adjustRange})})}),context._lifeCycleManager.notify({client:context.layers(),action:"initialized",formalName:"layer"})}}},{type:"registerImmediateListener",props:[reactive_props_DATA],listener:function listener(context,_ref3){var dataModel=src_listener_map_slicedToArray(_ref3,2)[1];if(dataModel){var axesObj=context.axes(),timeDiffs={},timeDiffsByField={};Object.entries(common_utils_temporalFields(dataModel)).forEach(function(_ref5){var _ref6=src_listener_map_slicedToArray(_ref5,2),fieldName=_ref6[0],fieldObj=_ref6[1];timeDiffsByField[fieldName]=fieldObj.minimumConsecutiveDifference()}),Object.entries(context.fields()).forEach(function(_ref7){var _ref8=src_listener_map_slicedToArray(_ref7,2),type=_ref8[0],field=src_listener_map_slicedToArray(_ref8[1],1)[0];if(field){var timeDiff=timeDiffsByField["".concat(field)];timeDiff&&(timeDiffs[type]=timeDiff,axesObj[type].forEach(function(axis){return axis.minDiff(timeDiff)}))}}),context._timeDiffsByField=timeDiffsByField,context._timeDiffs=timeDiffs;var firebolt=context.firebolt(),originalData=context.cachedData()[0],_prepareSelectionSetD=function prepareSelectionSetData(dataModel,unit){var _dataModel$getData=dataModel.getData(),data=_dataModel$getData.data,uids=_dataModel$getData.uids,fieldsConfig=dataModel.getFieldsConfig(),dimensions=Object.values(fieldsConfig).filter(function(d){return d.def.type===dist_datamodel.FieldType.DIMENSION}),layers=unit.layers(),_prepareSelectionSetM=prepareSelectionSetMap({data:data,uids:uids,dimensions:dimensions},layers);return{keys:_prepareSelectionSetM.keys,dimensions:dimensions,dimensionsMap:_prepareSelectionSetM.dimensionsMap}}(context.data(),context),keys=_prepareSelectionSetD.keys,dimensionsMap=_prepareSelectionSetD.dimensionsMap,dimensions=_prepareSelectionSetD.dimensions;firebolt._metaData={dimensionsMap:dimensionsMap,dimensions:dimensions},firebolt.createSelectionSet({keys:keys,fields:dimensions.map(function(d){return d.def.name})}),firebolt.attachPropagationListener(originalData)}}},{type:"registerImmediateListener",props:[reactive_props_CONFIG],listener:function listener(context,_ref9){var config=src_listener_map_slicedToArray(_ref9,2)[1];if(config){var firebolt=context.firebolt(),interaction=config.interaction;if(firebolt.config(interaction),"fragmented"===interaction.tooltip.mode){var map=firebolt._behaviourEffectMap;for(var key in map){var sideEffects=map[key];map[key]=sideEffects.map(function(val){var name=val;return isSimpleObject(val)&&(name=val.name),name===side_effects_TOOLTIP?FRAGMENTED_TOOLTIP:val})}}!function createGridLineLayer(context){var vuConf=context.config(),metaInf=context.metaInf(),store=context.store(),timeDiffs=context._timeDiffs;[GRID_BAND,GRID_LINE].forEach(function(type){var mark,config;type===GRID_BAND?(mark=grid_lines_BAR_LAYER,config=vuConf.gridBands):(mark=grid_lines_TICK_LAYER,config=vuConf.gridLines);var definitions=grid_lines_getGridLayerDefinitions(context,config,type),sel="_".concat(type,"Selection");context[sel]=common_utils_createSelection(context[sel],function(atomicDef){var inst=src_layer_factory.getLayerInstance({mark:mark});inst.dependencies(context._dependencies);var name=atomicDef.definition.name;return inst.metaInf({unitRowIndex:metaInf.rowIndex,unitColIndex:metaInf.colIndex,namespace:"".concat(metaInf.namespace).concat(type).concat(name),parentNamespace:metaInf.namespace}).store(store),inst},definitions,function(atomicDef){return atomicDef.definition.name}),context[sel].each(function(layer,atomicDef){var definition=atomicDef.definition,sConf=src_layer_factory.getSerializedConf(mark,definition),axesObj=atomicDef.axes;layer.config(sConf).dataProps({timeDiffs:timeDiffs}).axes(axesObj)}),context["_".concat(type)]=context[sel].getObjects()})}(context)}}},{type:"registerImmediateListener",props:[reactive_props_DATA,reactive_props_TRANSFORM],listener:function listener(context,_ref11,_ref12){var dataModel=src_listener_map_slicedToArray(_ref11,2)[1],transform=src_listener_map_slicedToArray(_ref12,2)[1];if(dataModel){var dataModels=transformDataModels(transform,dataModel),metaInf=context.metaInf();context.store().commit("".concat(namespace_namespaceObject.UNIT_LOCAL_NAMESPACE,".").concat(TRANSFORMEDDATA),dataModels,metaInf.namespace)}}},{type:"registerImmediateListener",props:[TRANSFORMEDDATA,reactive_props_LAYERS],listener:function listener(context,_ref15,_ref16){var transformedData=src_listener_map_slicedToArray(_ref15,2)[1],layers=src_listener_map_slicedToArray(_ref16,2)[1],layerAxisIndexVal=context._layerAxisIndex,axesVal=context.axes(),dataModel=context.data();transformedData&&layers&&axesVal&&layerAxisIndexVal&&(context._lifeCycleManager.notify({client:layers,action:"beforeupdate",formalName:"layer"}),attachDataToLayers(layers,dataModel,transformedData),context._dimensionMeasureMap=helper_getDimensionMeasureMap(layers,dataModel.getFieldsConfig(),context.retinalFields()),helper_attachAxisToLayers(axesVal,layers,layerAxisIndexVal),context._lifeCycleManager.notify({client:layers,action:"updated",formalName:"layer"}))}}];function src_props_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _CONFIG$LAYERDEFS$TRA,src_props_PROPS=(src_props_defineProperty(_PROPS={},FACET_BY_FIELDS,{onset:function onset(context,facets){var facetKeys=facets[0].reduce(function(acc,v,i){return acc["".concat(v)]=facets[1][i],acc},{});context.facetFieldsMap(facetKeys)}}),src_props_defineProperty(_PROPS,"facetFieldsMap",{}),src_props_defineProperty(_PROPS,RETINAL_FIELDS,{}),src_props_defineProperty(_PROPS,PARENT_ALIAS,{}),src_props_defineProperty(_PROPS,CACHED_DATA,{}),src_props_defineProperty(_PROPS,"detailFields",{}),src_props_defineProperty(_PROPS,"axes",{defaultValue:{x:[],y:[]}}),src_props_defineProperty(_PROPS,"fields",{defaultValue:{x:[],y:[]},sanitization:function sanitization(context,value){return mergeRecursive({x:[],y:[]},value)}}),src_props_defineProperty(_PROPS,"metaInf",{}),src_props_defineProperty(_PROPS,"registry",{}),src_props_defineProperty(_PROPS,"parentContainerInf",{}),src_props_defineProperty(_PROPS,"valueParser",{defaultValue:function defaultValue(val){return val}}),src_props_defineProperty(_PROPS,"coord",{}),_PROPS),visual_unit_src_default_config_defaultConfig=(__webpack_require__(33),{classPrefix:enums_constants_CLASSPREFIX,defClassName:"visual-unit",className:"",trackerClassName:"visual-unit-tracker",minOuterRadius:10,gridLines:{defClassName:"axis-grid-lines",className:"",show:!0,color:"#efefef",zeroLineColor:"#b6b6b6"},gridBands:{defClassName:"axis-grid-bands",className:"",show:!1,y:{color:["#fff","#fbfbfb"]},x:{color:["#fff","#f9f9f9"]}},arcLayerClassName:"layer-arc",interaction:{tooltip:{mode:CONSOLIDATED}},sideEffectClassName:"side-effect-container"});function src_local_options_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function local_options_toConsumableArray(arr){return function local_options_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function local_options_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function local_options_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var local_options=(src_local_options_defineProperty(_CONFIG$LAYERDEFS$TRA={},reactive_props_CONFIG,{value:null,meta:{sanitization:function sanitization(config,oldConfig){return mergeRecursive(oldConfig||mergeRecursive({},visual_unit_src_default_config_defaultConfig),config)}}}),src_local_options_defineProperty(_CONFIG$LAYERDEFS$TRA,LAYERDEFS,{value:null,meta:{preset:function preset(layerDef){return helper_sanitizeLayerDef(layerDef)}}}),src_local_options_defineProperty(_CONFIG$LAYERDEFS$TRA,reactive_props_TRANSFORM,{value:null}),src_local_options_defineProperty(_CONFIG$LAYERDEFS$TRA,reactive_props_LAYERS,{value:null}),src_local_options_defineProperty(_CONFIG$LAYERDEFS$TRA,reactive_props_DATA,{value:null,meta:{typeCheck:function typeCheck(d){return d instanceof datamodel_default.a},preset:function preset(data,context){if(context._cache){var cachedData=context.cachedData();context.cachedData([].concat(local_options_toConsumableArray(cachedData),[data]))}else{var oldData=context.cachedData()[0];oldData&&oldData.unsubscribe("propagation"),context.cachedData([data])}}}}),src_local_options_defineProperty(_CONFIG$LAYERDEFS$TRA,TRANSFORMEDDATA,{value:null}),src_local_options_defineProperty(_CONFIG$LAYERDEFS$TRA,"width",{value:null}),src_local_options_defineProperty(_CONFIG$LAYERDEFS$TRA,"height",{value:null}),_CONFIG$LAYERDEFS$TRA);function pseudo_select_typeof(obj){"@babel/helpers - typeof";return(pseudo_select_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function pseudo_select_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function pseudo_select_possibleConstructorReturn(self,call){return!call||"object"!==pseudo_select_typeof(call)&&"function"!=typeof call?function pseudo_select_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function pseudo_select_getPrototypeOf(o){return(pseudo_select_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function pseudo_select_setPrototypeOf(o,p){return(pseudo_select_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var pseudo_select_PseudoSelectBehaviour=function(_VolatileBehaviour){function PseudoSelectBehaviour(){return function pseudo_select_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PseudoSelectBehaviour),pseudo_select_possibleConstructorReturn(this,pseudo_select_getPrototypeOf(PseudoSelectBehaviour).apply(this,arguments))}return function pseudo_select_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&pseudo_select_setPrototypeOf(subClass,superClass)}(PseudoSelectBehaviour,volatile_VolatileBehaviour),function pseudo_select_createClass(Constructor,protoProps,staticProps){return protoProps&&pseudo_select_defineProperties(Constructor.prototype,protoProps),staticProps&&pseudo_select_defineProperties(Constructor,staticProps),Constructor}(PseudoSelectBehaviour,null,[{key:"formalName",value:function formalName(){return"pseudoSelect"}}]),PseudoSelectBehaviour}();function visual_unit_construct(Parent,args,Class){return(visual_unit_construct=function visual_unit_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&visual_unit_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function visual_unit_setPrototypeOf(o,p){return(visual_unit_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function visual_unit_slicedToArray(arr,i){return function visual_unit_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function visual_unit_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function visual_unit_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function visual_unit_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function visual_unit_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?visual_unit_ownKeys(Object(source),!0).forEach(function(key){visual_unit_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):visual_unit_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function visual_unit_toConsumableArray(arr){return function visual_unit_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function visual_unit_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function visual_unit_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function visual_unit_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function visual_unit_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var unitNs=[namespace_namespaceObject.UNIT_GLOBAL_NAMESPACE,namespace_namespaceObject.UNIT_LOCAL_NAMESPACE],visual_unit_groupNs=namespace_namespaceObject.GROUP_GLOBAL_NAMESPACE,visual_unit_VisualUnit=function(){function VisualUnit(registry,dependencies){var _this=this;!function visual_unit_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VisualUnit),this._id=getUniqueId(),this._dependencies=dependencies,this._renderedResolve=null,this._renderedPromise=new Promise(function(resolve){_this._renderedResolve=resolve}),createRenderPromise(this),this._lifeCycleManager=dependencies.lifeCycleManager,this._layersMap={},this._gridLinesSelection=null,this._gridBandsSelection=null,this._gridLines=[],this._gridBands=[],this._layerAxisIndex={},this._queuedLayerDefs=[],src_layer_factory.setLayerRegistry(registry.layerRegistry),generateGetterSetters(this,this.constructor.getterSetters()),this.registry(registry),this.cachedData([])}return function visual_unit_createClass(Constructor,protoProps,staticProps){return protoProps&&visual_unit_defineProperties(Constructor.prototype,protoProps),staticProps&&visual_unit_defineProperties(Constructor,staticProps),Constructor}(VisualUnit,[{key:"store",value:function store(){if(arguments.length){var store=this._store=arguments.length<=0?void 0:arguments[0],throwback=this._dependencies.throwback,namespace=this.metaInf().namespace;return store.addSubNamespace(namespace,"VisualUnit",this),throwback.addSubNamespace(namespace,"VisualUnit",this),store_transactor(this,this.constructor.localOptions(),store,{subNamespace:namespace,namespace:"".concat(namespace_namespaceObject.UNIT_LOCAL_NAMESPACE)}),this.createFireboltInstance(),this}return this._store}},{key:"createFireboltInstance",value:function createFireboltInstance(){var _Object$assign,interactions=this.registry().interactions,fireboltDeps=this._dependencies.fireboltDeps,Cls=this.getFireboltCls();return this.firebolt(new Cls(this,{physical:Object.assign({},interactions.physicalActions.get(),fireboltDeps.physicalActions),behavioural:Object.assign({},interactions.behaviours.get(),(_Object$assign={},visual_unit_defineProperty(_Object$assign,brush_UnitBrushBehaviour.formalName(),brush_UnitBrushBehaviour),visual_unit_defineProperty(_Object$assign,"pseudoSelect",pseudo_select_PseudoSelectBehaviour),_Object$assign),fireboltDeps.behaviouralActions),physicalBehaviouralMap:this.getActionBehaviourMap()},Object.assign({},interactions.sideEffects.get(),fireboltDeps.sideEffects),this.getBehaviourEffectMap())),this}},{key:"getFireboltCls",value:function getFireboltCls(){return firebolt_UnitFireBolt}},{key:"getBehaviourEffectMap",value:function getBehaviourEffectMap(){return behaviour_effect_map_behaviourEffectMap}},{key:"getActionBehaviourMap",value:function getActionBehaviourMap(){return actionBehaviourMap}},{key:"firebolt",value:function firebolt(){return arguments.length?(this._firebolt=arguments.length<=0?void 0:arguments[0],this):this._firebolt}},{key:"id",value:function id(){return this._id}},{key:"lockModel",value:function lockModel(){return this.store().lockModel(),this}},{key:"unlockModel",value:function unlockModel(){return this.store().unlockModel(),this}},{key:"timeDiffsByField",value:function timeDiffsByField(){return arguments.length?this:this._timeDiffsByField}},{key:"render",value:function render(container){this.createRootContainers(container),helper_setAxisRange(this),this.renderLayers();var node=this._rootSvg.node(),_this$config=this.config(),sideEffectClassName=_this$config.sideEffectClassName,classPrefix=_this$config.classPrefix;this._sideEffectGroup=helper_createSideEffectGroup(node,"".concat(classPrefix,"-").concat(sideEffectClassName));var firebolt=this.firebolt();return function initSideEffects(sideEffects,firebolt){for(var key in sideEffects)({}).hasOwnProperty.call(sideEffects,key)&&(sideEffects[key]instanceof spawnable_SpawnableSideEffect&&sideEffects[key].drawingContext(function(){return firebolt.context.getDrawingContext()}),sideEffects[key].valueParser(firebolt.context.valueParser()))}(firebolt.sideEffects(),firebolt),this}},{key:"createRootContainers",value:function createRootContainers(container){var config=this.config(),className=config.className,defClassName=config.defClassName,qualifiedClassName=getQualifiedClassName(defClassName,this.id(),config.classPrefix),width=this.width(),height=this.height(),containerSelection=renderer_utils_selectElement(container).style("position","relative");this._rootSvg=makeElement(containerSelection,"svg",[null],className).style("width","".concat(width,"px")).style("height","".concat(height,"px"));var node=this._rootSvg.node();return renderer_utils_setAttrs(node,{width:width,height:height,class:qualifiedClassName.join(" ")}),this}},{key:"renderLayers",value:function renderLayers(){var width=this.width(),height=this.height(),node=this._rootSvg.node();return function renderGridLineLayers(context,container){var classPrefix=context.config().classPrefix,gridLines=context._gridLines,gridBands=context._gridBands,measurement={width:context.width(),height:context.height()},gridLineParentGroup=makeElement(container,"g",[1],"".concat(classPrefix,"-").concat(GRID_PARENT_GROUP));[[gridLines,"".concat(classPrefix,"-").concat(GRID_LINE_PARENT_GROUP_CLASS)],[gridBands,"".concat(classPrefix,"-").concat(GRID_BAND_PARENT_GROUP_CLASS)]].forEach(function(entry){var _entry=grid_lines_slicedToArray(entry,2),instances=_entry[0],parentGroupClass=_entry[1],mountPoint=makeElement(gridLineParentGroup,"g",[1],".".concat(parentGroupClass)),className="".concat(parentGroupClass,"-group");makeElement(mountPoint,"g",instances,".".concat(className),{update:function update(group,instance){instance.dataProps({timeDiffs:context._timeDiffs}).measurement(measurement).mount(group.node())}})})}(this,node),helper_renderLayers(this,node,this.layers(),{width:width,height:height}),this}},{key:"done",value:function done(){return this._renderedPromise}},{key:"enableCaching",value:function enableCaching(){return this._cache=!0,this}},{key:"clearCaching",value:function clearCaching(){return this._cache=!1,this.cachedData([this.cachedData()[0]]),this}},{key:"getDrawingContext",value:function getDrawingContext(){var rootSvg=this._rootSvg&&this._rootSvg.node(),width=this.width(),height=this.height(),_this$parentContainer=this.parentContainerInf(),el=_this$parentContainer.el,dimensions=_this$parentContainer.dimensions;return{htmlContainer:this.mount(),svgContainer:rootSvg,width:width,height:height,sideEffectGroup:this._sideEffectGroup,parentContainer:el,parentContainerDimensions:dimensions,xOffset:0,yOffset:0}}},{key:"serialize",value:function serialize(){return{layers:this.layers().map(function(layer){return layer.serialize()}),config:this.config(),axes:this.axes().map(function(axis){return axis.serialize()})}}},{key:"mount",value:function mount(){return arguments.length?(this._mount=arguments.length<=0?void 0:arguments[0],this.render(arguments.length<=0?void 0:arguments[0]),this):this._mount}},{key:"addLayer",value:function addLayer(layerDefinition){var _ref,_this2=this;if(layerDefinition instanceof Function)return this._queuedLayerDefs.push(layerDefinition),this;var layerDefinitions=helper_sanitizeLayerDef(toArray(layerDefinition)),layersMap=this._layersMap,markSet={},store={layers:{},components:{unit:this}},layerIndex=0,metaInf=this.metaInf(),layers=layerDefinitions.sort(function(a,b){return a.order-b.order}).reduce(function(layersArr,layerDef){var _layersArr,definition=layerDef.def,markId=definition.name,defArr=toArray(definition),namespaces=[];defArr.forEach(function(def){def.order=layerDef.order+layerIndex;var namespace="".concat(metaInf.namespace,"-").concat(def.mark,"-").concat(getUniqueId());namespaces.push(namespace)}),layerIndex+=defArr.length;var instances=helper_getLayerFromDef(_this2,definition,layersMap[markId],namespaces);store.layers=Object.assign(store.layers,instances);var instanceValues=Object.values(instances);return layersArr=(_layersArr=layersArr).concat.apply(_layersArr,visual_unit_toConsumableArray(instanceValues)),layersMap[markId]=instanceValues,markSet[markId]=markId,layersArr},[]);store.unit=this;var layerdeps={},layersArr=(_ref=[]).concat.apply(_ref,visual_unit_toConsumableArray(Object.values(this._layersMap)));return layersArr.forEach(function(layer){var alias=layer.alias();store.layers[alias]=layer,layerdeps[alias]=[]}),layers.forEach(function(layer){var depArr=resolveEncodingTransform(layer,store);layerdeps[layer.alias()]=depArr}),this._layerDepOrder=layerdeps,this._layerAxisIndex=Object.assign(this._layerAxisIndex,helper_getLayerAxisIndex(layers,this.fields())),this.layers(layersArr),layers}},{key:"remove",value:function remove(){var formalName=this.constructor.formalName(),_this$_dependencies=this._dependencies,lifeCycleManager=_this$_dependencies.lifeCycleManager,throwback=_this$_dependencies.throwback,namespace=this.metaInf().namespace;lifeCycleManager.notify({client:this,action:"beforeremove",formalName:"unit"});var layers=this.layers();return this.store().removeSubNamespace(namespace,formalName),throwback.removeSubNamespace(namespace,"VisualUnit"),renderer_utils_selectElement(this.mount()).remove(),this.firebolt().remove(),lifeCycleManager.notify({client:layers,action:"beforeremove",formalName:"layer"}),[].concat(visual_unit_toConsumableArray(layers),visual_unit_toConsumableArray(this._gridLines),visual_unit_toConsumableArray(this._gridBands)).forEach(function(layer){return layer.remove()}),lifeCycleManager.notify({client:layers,action:"removed",formalName:"layer"}),lifeCycleManager.notify({client:this,action:"removed",formalName:"unit"}),this}},{key:"getDataModelFromIdentifiers",value:function getDataModelFromIdentifiers(identifiers,mode,parentModel,hasBarLayer){if(!identifiers)return null;var dataModel=parentModel||this.data();return common_utils_getDataModelFromIdentifiers(dataModel,identifiers,mode,hasBarLayer)}},{key:"resetData",value:function resetData(){return this.data(this.cachedData()[0]),this}},{key:"getSourceInfo",value:function getSourceInfo(){return{dimensionMeasureMap:this._dimensionMeasureMap,fields:this.fields(),data:this.data(),axes:this.axes(),retinalFields:this.retinalFields(),layers:this.layers(),timeDiffs:this.timeDiffsByField()}}},{key:"dataDomain",value:function dataDomain(){var namespace=this.metaInf().namespace,store=this.store(),prop="".concat(namespace_namespaceObject.UNIT_GLOBAL_NAMESPACE,".").concat(reactive_props_namespaceObject.DOMAIN);if(arguments.length){var domain=arguments.length<=0?void 0:arguments[0];store.commit(prop,domain,namespace)}return store.get(prop,namespace)}},{key:"getDefaultTargetContainer",value:function getDefaultTargetContainer(){var _this$config2=this.config(),classPrefix=_this$config2.classPrefix,defClassName=_this$config2.defClassName;return[".".concat(classPrefix,"-").concat(defClassName)]}},{key:"getLayersByType",value:function getLayersByType(type){return getLayersBy(this.layers(),"type",type)}},{key:"getLayerByName",value:function getLayerByName(name){return getLayersBy(this.layers(),"name",name)[0]}},{key:"getNearestPoint",value:function getNearestPoint(x,y,config){var pointObj={id:null},dimValue=helper_getNearestDimensionalValue(this,{x:x,y:y});if(null!==dimValue&&config.getAllPoints){dimValue[0].push(reserved_fields.MEASURE_NAMES),pointObj.id=dimValue;var layers=this.layers(),pointInf=this.getMarkInfFromLayers(x,y,visual_unit_objectSpread({},config,{dimValue:dimValue}));return layers.forEach(function(layer){for(var measures=layer.data().getSchema().filter(function(d){return d.type===dist_datamodel.FieldType.MEASURE}).map(function(d){return d.name}),i=1,len=dimValue.length;i<len;i++)dimValue[i].push(measures.join())}),pointObj.target=pointInf&&pointInf.id?pointInf.id:null,pointObj}var markInf=this.getMarkInfFromLayers(x,y,visual_unit_objectSpread({},config,{dimValue:dimValue}))||{id:null};return(pointObj=Object.assign({},markInf)).target=markInf.id,pointObj}},{key:"getMarkInfFromLayers",value:function getMarkInfFromLayers(x,y,args){for(var layers=this.layers(),len=layers.length,point=null,i=0;i<len;i++){var layer=layers[i];if(!1!==layer.config().interactive&&(point=layer.getNearestPoint(x,y,args)),point)return point}return point}},{key:"getPlotPointsFromIdentifiers",value:function getPlotPointsFromIdentifiers(identifiers){var config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},points=[],parsedIdentifiers=identifiers;if(null===identifiers)return[];var layers=this.layers(),len=layers.length;isSimpleObject(identifiers)&&(parsedIdentifiers=[Object.keys(identifiers)],parsedIdentifiers=[].concat(visual_unit_toConsumableArray(parsedIdentifiers),visual_unit_toConsumableArray(transposeArray(Object.values(identifiers)))));for(var i=0;i<len;i++){var layer=layers[i];!1!==layer.config().interactive&&(points=[].concat(visual_unit_toConsumableArray(points),visual_unit_toConsumableArray(layer.getPointsFromIdentifiers(parsedIdentifiers,config))))}return points}},{key:"removeLayerByName",value:function removeLayerByName(name){return removeLayersBy("name",name),this}},{key:"removeLayersByType",value:function removeLayersByType(type){return removeLayersBy("type",type),this}},{key:"calculateDomainFromData",value:function calculateDomainFromData(){return helper_unionDomainFromLayers(this.layers(),this.fields(),this._layerAxisIndex,this.data().getFieldsConfig())}},{key:"getRangeFromIdentifiers",value:function getRangeFromIdentifiers(_ref2){var criteria=_ref2.criteria;return _ref2.fields.reduce(function(acc,v){return acc[v]=criteria[v],acc},{})}},{key:"getRangeFromPositions",value:function getRangeFromPositions(_ref3){var startPos=_ref3.startPos,endPos=_ref3.endPos,_this$fields=this.fields(),x=_this$fields.x,y=_this$fields.y,axes=this.axes(),xField=x[0],yField=y[0],xFieldType=x[0].type(),yFieldType=y[0].type(),dimensions=Object.keys(this.data().getFieldspace().getDimension());if(xFieldType===dist_datamodel.FieldType.MEASURE&&yFieldType===dist_datamodel.FieldType.MEASURE){var dom={x:axes.x[0].invertExtent(startPos.x,endPos.x).sort(function(a,b){return a-b}),y:axes.y[0].invertExtent(startPos.y,endPos.y).sort(function(a,b){return a-b})},range={};if("".concat(xField)==="".concat(yField)){var xdom=dom.x,ydom=dom.y,min=xdom[0]>ydom[0]?ydom:xdom,max=min===ydom?xdom:ydom;min[1]<max[0]?range[xField]=[]:range[xField]=[max[0],min[1]<max[1]?min[1]:max[1]]}else range[xField]=dom.x,range[yField]=dom.y;return range}if(xFieldType===dist_datamodel.FieldType.DIMENSION||yFieldType===dist_datamodel.FieldType.DIMENSION){var points=this._rtree.search({minX:startPos.x,minY:startPos.y,maxX:endPos.x,maxY:endPos.y}),criteria=[[]];return dimensions.forEach(function(field){criteria[0].push("".concat(field))}),points.forEach(function(point){var data=point.data,vals=[];dimensions.forEach(function(field){vals.push(data[field])}),criteria.push(vals)}),criteria}return null}}],[{key:"formalName",value:function formalName(){return"VisualUnit"}},{key:"getState",value:function getState(){return[{domain:null},Object.keys(this.localOptions()).reduce(function(acc,v){return acc[v]=local_options[v].value,acc},{})]}},{key:"getterSetters",value:function getterSetters(){return src_props_PROPS}},{key:"localOptions",value:function localOptions(){return local_options}},{key:"getQualifiedStateProps",value:function getQualifiedStateProps(){return VisualUnit.getState().map(function(state,i){return Object.keys(state).map(function(prop){return"".concat(unitNs[i],".").concat(prop)})})}},{key:"getListeners",value:function getListeners(){return{store:[].concat(visual_unit_toConsumableArray(listener_map_listenerMap.map(function(d){var o=Object.assign({},d),localNs=unitNs[1];return o.props=o.props.map(function(prop){return"".concat(localNs,".").concat(prop)}),o})),[{type:"registerImmediateListener",props:["".concat(namespace_namespaceObject.LAYER_GLOBAL_NAMESPACE,".domain")],listener:function listener(context){var domain=context.calculateDomainFromData();context.dataDomain(domain)}},{type:"registerImmediateListener",props:["".concat(unitNs[1],".").concat(reactive_props_WIDTH),"".concat(unitNs[1],".").concat(reactive_props_HEIGHT)].concat(visual_unit_toConsumableArray(["x","y"].map(function(type){return"".concat(visual_unit_groupNs,".domain.").concat(type)}))),listener:function listener(context,_ref4,_ref5){var width=visual_unit_slicedToArray(_ref4,2)[1],height=visual_unit_slicedToArray(_ref5,2)[1];width&&height&&attachDataToGridLineLayers(context)},subNamespace:function subNamespace(context){var _ref8,_context$metaInf=context.metaInf(),rowIndex=_context$metaInf.rowIndex,colIndex=_context$metaInf.colIndex,namespace=_context$metaInf.namespace;return visual_unit_defineProperty(_ref8={},"".concat(unitNs[1],".").concat(reactive_props_WIDTH),namespace),visual_unit_defineProperty(_ref8,"".concat(unitNs[1],".").concat(reactive_props_HEIGHT),namespace),visual_unit_defineProperty(_ref8,"".concat(visual_unit_groupNs,".domain.x"),"".concat(colIndex,"0")),visual_unit_defineProperty(_ref8,"".concat(visual_unit_groupNs,".domain.y"),"".concat(rowIndex,"0")),_ref8}}]),throwback:[{type:"registerChangeListener",props:[common_props.ON_LAYER_DRAW],listener:function listener(context,_ref9){if(visual_unit_slicedToArray(_ref9,2)[1]){context._rtree=helper_createRTree(context);var firebolt=context.firebolt();!function dispatchQueuedSideEffects(context){var queuedSideEffects=context._queuedSideEffects;Object.entries(queuedSideEffects).forEach(function(entry){var sideEffect=entry[1];context.dispatchSideEffect.apply(context,[sideEffect.name].concat(firebolt_helper_toConsumableArray(sideEffect.params)))}),context._queuedSideEffects={}}(firebolt),function clearActionHistory(context){var actionHistory=context._actionHistory;for(var key in actionHistory)actionHistory[key].isMutableAction&&delete context._actionHistory[key]}(firebolt)}context._renderedResolve(),context._lifeCycleManager.notify({client:context.layers(),action:"drawn",formalName:"layer"})}}]}}},{key:"create",value:function create(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return visual_unit_construct(this,params)}}]),VisualUnit}();function variable_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var variable_Variable=function(){function Variable(){!function variable_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Variable)}return function variable_createClass(Constructor,protoProps,staticProps){return protoProps&&variable_defineProperties(Constructor.prototype,protoProps),staticProps&&variable_defineProperties(Constructor,staticProps),Constructor}(Variable,[{key:"type",value:function type(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"toString",value:function toString(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}}]),Variable}();function composed_vars_typeof(obj){"@babel/helpers - typeof";return(composed_vars_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function composed_vars_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function composed_vars_possibleConstructorReturn(self,call){return!call||"object"!==composed_vars_typeof(call)&&"function"!=typeof call?function composed_vars_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function composed_vars_getPrototypeOf(o){return(composed_vars_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function composed_vars_setPrototypeOf(o,p){return(composed_vars_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var composed_vars=function(_Variable){function ComposedVars(){var _this;!function composed_vars_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ComposedVars),_this=composed_vars_possibleConstructorReturn(this,composed_vars_getPrototypeOf(ComposedVars).call(this));for(var _len=arguments.length,vars=new Array(_len),_key=0;_key<_len;_key++)vars[_key]=arguments[_key];return _this.vars(vars),_this}return function composed_vars_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&composed_vars_setPrototypeOf(subClass,superClass)}(ComposedVars,variable_Variable),function composed_vars_createClass(Constructor,protoProps,staticProps){return protoProps&&composed_vars_defineProperties(Constructor.prototype,protoProps),staticProps&&composed_vars_defineProperties(Constructor,staticProps),Constructor}(ComposedVars,[{key:"vars",value:function vars(){return arguments.length?(this._vars=arguments.length<=0?void 0:arguments[0],this):this._vars}},{key:"data",value:function data(){for(var _len2=arguments.length,dm=new Array(_len2),_key2=0;_key2<_len2;_key2++)dm[_key2]=arguments[_key2];return dm.length?(this.vars().forEach(function(d){return d.data(dm[0])}),this._data=dm[0],this):this._data}},{key:"getMembers",value:function getMembers(){return this.vars().map(function(member){return member.getMembers()[0]})}},{key:"type",value:function type(){return this.vars()[0].type()}},{key:"toString",value:function toString(){return this.vars().map(function(d){return d.toString()}).join(",")}},{key:"numberFormat",value:function numberFormat(){return this.vars()[0].numberFormat()}},{key:"format",value:function format(values){return this.vars()[0].format(values)}},{key:"getSchemaDef",value:function getSchemaDef(){return this.data().getFieldsConfig()[this.vars()[0]].def}},{key:"subtype",value:function subtype(){return this.vars()[0].subtype()}},{key:"getMinDiff",value:function getMinDiff(){return this.vars()[0].getMinDiff()}},{key:"displayName",value:function displayName(){return this.vars().map(function(d){return d.displayName()}).join(",")}}]),ComposedVars}();function simple_var_typeof(obj){"@babel/helpers - typeof";return(simple_var_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function simple_var_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function simple_var_possibleConstructorReturn(self,call){return!call||"object"!==simple_var_typeof(call)&&"function"!=typeof call?function simple_var_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function simple_var_getPrototypeOf(o){return(simple_var_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function simple_var_setPrototypeOf(o,p){return(simple_var_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var simple_var_SimpleVariable=function(_Variable){function SimpleVariable(name){var _this;return function simple_var_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SimpleVariable),(_this=simple_var_possibleConstructorReturn(this,simple_var_getPrototypeOf(SimpleVariable).call(this))).oneVar(name),_this}return function simple_var_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&simple_var_setPrototypeOf(subClass,superClass)}(SimpleVariable,variable_Variable),function simple_var_createClass(Constructor,protoProps,staticProps){return protoProps&&simple_var_defineProperties(Constructor.prototype,protoProps),staticProps&&simple_var_defineProperties(Constructor,staticProps),Constructor}(SimpleVariable,[{key:"oneVar",value:function oneVar(){return arguments.length?(this._oneVar=arguments.length<=0?void 0:arguments[0],this):this._oneVar}},{key:"data",value:function data(){return arguments.length?(this._data=arguments.length<=0?void 0:arguments[0],this):this._data}},{key:"toString",value:function toString(){return this.oneVar()}},{key:"numberFormat",value:function numberFormat(){return"measure"===this.type()?this.data().getFieldspace().getMeasure()[this.oneVar()].numberFormat():function(val){return val}}},{key:"format",value:function format(values){if(values&&"temporal"===this.subtype()){var formatter=this.data().getFieldspace().getDimension()[this.oneVar()].schema().format,dtFormat=new dist_datamodel.DateTimeFormatter(formatter);values=values.map(function(e){return dtFormat.getNativeDate(e)})}return values}},{key:"rawFormat",value:function rawFormat(){if(this.subtype()===dist_datamodel.DimensionSubtype.TEMPORAL){var dateFormat=this.data().getFieldspace().getDimension()[this.oneVar()].schema().format;return function(val){return dist_datamodel.DateTimeFormatter.formatAs(val,dateFormat)}}return function(val){return val}}},{key:"getMembers",value:function getMembers(){return[this.oneVar()]}},{key:"type",value:function type(){return this.data().getFieldsConfig()[this.oneVar()].def.type}},{key:"subtype",value:function subtype(){var fieldDef=this.data().getFieldsConfig()[this.oneVar()].def;return fieldDef.subtype||fieldDef.type}},{key:"getMinDiff",value:function getMinDiff(){return this.data().getFieldspace().fieldsObj()[this.oneVar()].minimumConsecutiveDifference()}},{key:"equals",value:function equals(varInst){return this.oneVar()===varInst.oneVar()}},{key:"displayName",value:function displayName(){return retrieveFieldDisplayName(this.data(),this.oneVar())}},{key:"getSchemaDef",value:function getSchemaDef(){return this.data().getFieldsConfig()[this.oneVar()].def}}]),SimpleVariable}();function field_sanitizer_slicedToArray(arr,i){return function field_sanitizer_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function field_sanitizer_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function field_sanitizer_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function field_sanitizer_toConsumableArray(arr){return function field_sanitizer_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function field_sanitizer_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function field_sanitizer_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var field_sanitizer_convertToVar=function convertToVar(datamodel,fields){var vars=[];return fields&&fields.forEach(function(field){field instanceof composed_vars?(vars.push(field),field.data(datamodel)):vars.push(new simple_var_SimpleVariable(field).data(datamodel))}),vars},field_sanitizer_transformFields=function transformFields(datamodel,config){var _map2=field_sanitizer_slicedToArray([ROWS,COLUMNS].map(function(fields){var normalizedFields=function normalizeFields(config,type){var fieldsArr=[],fields=config[type];return fields[0]instanceof Array?(fieldsArr[0]=fields[0]||[],fieldsArr[1]=fields[1]||[]):fieldsArr[0]=fields,fieldsArr}(config,fields),norFields=[field_sanitizer_convertToVar(datamodel,normalizedFields[0])];return normalizedFields[1]&&(norFields[1]=field_sanitizer_convertToVar(datamodel,normalizedFields[1])),function orderFields(fieldArray,type){var dimensionArr=[[],[]],measureArr=[[],[]],temporalArr=[[],[]],categoricalArr=[[],[]];fieldArray.forEach(function(fieldList,index){fieldList.forEach(function(field){field.type()===DIMENSION?(dimensionArr[index].push(field),field.subtype()===constants_TEMPORAL?temporalArr[index].push(field):categoricalArr[index].push(field)):measureArr[index].push(field)})});var numOfMeasures=measureArr[0].length+(measureArr[1]?measureArr[1].length:0);if(!fieldArray[1]&&(measureArr[1]=type===COLUMNS?measureArr[0]:[],measureArr[0]=type!==COLUMNS?measureArr[0]:[],dimensionArr[1]=[],dimensionArr[0]=dimensionArr[0],0===numOfMeasures)){var allDimensions=[].concat(field_sanitizer_toConsumableArray(dimensionArr[0]),field_sanitizer_toConsumableArray(dimensionArr[1]));type===COLUMNS?(dimensionArr[1]=allDimensions[allDimensions.length-1]?[allDimensions[allDimensions.length-1]]:[],allDimensions.splice(-1,1)):dimensionArr[1]=[],dimensionArr[0]=field_sanitizer_toConsumableArray(allDimensions)}return dimensionArr[0].length&&dimensionArr[1].length&&numOfMeasures>0&&(dimensionArr[0]=[].concat(field_sanitizer_toConsumableArray(dimensionArr[0]),field_sanitizer_toConsumableArray(dimensionArr[1])),dimensionArr[1]=[]),{fields:dimensionArr.map(function(list,i){return 1===i?measureArr[i].concat(dimensionArr[i]):dimensionArr[i].concat(measureArr[i])}),dimensions:[].concat(field_sanitizer_toConsumableArray(dimensionArr[0]),field_sanitizer_toConsumableArray(dimensionArr[1])),measures:[].concat(field_sanitizer_toConsumableArray(measureArr[0]),field_sanitizer_toConsumableArray(measureArr[1])),temporal:[].concat(field_sanitizer_toConsumableArray(temporalArr[0]),field_sanitizer_toConsumableArray(temporalArr[1])),categorical:[].concat(field_sanitizer_toConsumableArray(categoricalArr[0]),field_sanitizer_toConsumableArray(categoricalArr[1]))}}(norFields,fields)}),2),rowsInfo=_map2[0],columnsInfo=_map2[1],rows=rowsInfo.fields,rowDimensions=rowsInfo.dimensions,rowMeasures=rowsInfo.measures,rowTemporalFields=rowsInfo.temporal,rowCategoricalFields=rowsInfo.categorical,columns=columnsInfo.fields,columnDimensions=columnsInfo.dimensions,columnMeasures=columnsInfo.measures;return{rows:rows,rowDimensions:rowDimensions,rowMeasures:rowMeasures,rowTemporalFields:rowTemporalFields,rowCategoricalFields:rowCategoricalFields,columns:columns,columnTemporalFields:columnsInfo.temporal,columnCategoricalFields:columnsInfo.categorical,columnDimensions:columnDimensions,columnMeasures:columnMeasures}},BORDER_WIDTH={default:2,facet:1},cell_border_applier_handleBlankCell=function handleBlankCell(data){data.config().externalClassname.push("".concat(NONE,"-").concat(constants_LEFT)),data.config().externalClassname.push("".concat(NONE,"-").concat(constants_RIGHT))},cell_border_applier_sanitiseHeaderMatrix=function sanitiseHeaderMatrix(matrices,header){if(header)for(var i=0;i<matrices.length;i++)0!==i?matrices[i].config({externalClassname:["".concat(DARK)]}):matrices[i].config({externalClassname:["".concat(NONE,"-").concat(constants_LEFT),"".concat(DARK)]});else for(var _i=0;_i<matrices.length;_i++)for(var j=0;j<matrices[0].length;j++)matrices[_i][j].config({externalClassname:["".concat(DARK)]})},cell_border_applier_sanitiseFacetValues=function sanitiseFacetValues(matrices,type,blankCell){for(var normal=type==="".concat(constants_RIGHT)?"".concat(DARK):"".concat(NORMAL),length=matrices.length,latestSource=matrices[0][0].source(),lastSource=matrices[matrices.length-1][0].source(),arr={},i=0;i<matrices.length;i++){for(var j=0;j<matrices[0].length;j++)matrices[i][j].config({externalClassname:[normal]});matrices[i][0].source()!==latestSource&&(arr[i]=i,latestSource=matrices[i][0].source())}for(var _i2=0;_i2<matrices.length;_i2++)for(var _j=0;_j<matrices[0].length;_j++)0===_j?(matrices[_i2][0].config().externalClassname.push("".concat(NONE,"-").concat(type)),matrices[_i2][_j].source()===lastSource?matrices[_i2][_j].config().externalClassname.push("".concat(DARKER,"-").concat(enums_constants_BOTTOM)):matrices[_i2][0].config().externalClassname.push("".concat(DARK,"-").concat(enums_constants_BOTTOM)),matrices[_i2][_j]instanceof blankCell&&(matrices[_i2][_j].config().externalClassname.push("".concat(NONE,"-").concat(enums_constants_TOP)),matrices[_i2][_j].config().externalClassname.push("".concat(NONE,"-").concat(enums_constants_BOTTOM)))):_j!==matrices[_i2].length-1&&matrices[_i2][_j].config().externalClassname.push("".concat(DARK,"-").concat(type)),0===_i2?matrices[0][_j].config().externalClassname.push("".concat(DARKER,"-").concat(enums_constants_TOP)):_i2===length-1&&matrices[_i2][_j].config().externalClassname.push("".concat(DARKER,"-").concat(enums_constants_BOTTOM)),arr[_i2]&&matrices[_i2-1][_j].config().externalClassname.push("".concat(DARK,"-").concat(enums_constants_BOTTOM)),matrices[_i2][_j]instanceof blankCell&&cell_border_applier_handleBlankCell(matrices[_i2][_j]);return arr},group_utils_this=void 0;function group_utils_typeof(obj){"@babel/helpers - typeof";return(group_utils_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function group_utils_slicedToArray(arr,i){return function group_utils_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function group_utils_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function group_utils_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function group_utils_toConsumableArray(arr){return function group_utils_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function group_utils_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function group_utils_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function group_utils_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var group_utils_POLAR=COORD_TYPES.POLAR,group_utils_initStore=function initStore(){return new store_Store(group_utils_defineProperty({},0,0))},group_utils_isDistributionEqual=function isDistributionEqual(arr){return[].concat(group_utils_toConsumableArray(arr[0]),group_utils_toConsumableArray(arr[1])).reduce(function(isEqual,row){var rowType=row.type();return rowType!==MEASURE&&rowType!==constants_TEMPORAL||(isEqual=!0),isEqual},!1)},initializeCacheMaps=function initializeCacheMaps(){return{cellMap:new Map,xAxesMap:new Map,yAxesMap:new Map,entryCellMap:new Map,exitCellMap:new Map}},getAxisKey=function getAxisKey(axisName){for(var _len=arguments.length,params=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)params[_key-1]=arguments[_key];return"".concat(axisName,"-axis-").concat(params.join("-"))},getCellKey=function getCellKey(rowId,columnId){return"cell-".concat(rowId,"-").concat(columnId)},group_utils_extractUnitConfig=function extractUnitConfig(config){var unitConfig={};return[INTERACTION,GRID_LINES,GRID_BANDS].forEach(function(attr){void 0!==config[attr]&&(unitConfig[attr]=config[attr])}),unitConfig},hasOneField=function hasOneField(fields){return Object.keys(fields).some(function(d){return fields[d].length>0})},getHeaderText=function getHeaderText(headers,index,rowLength){var header="";if(index===rowLength-1&&headers.length>rowLength){for(var i=index;i<headers.length-1;i++)header+="".concat(headers[i].toString()," / ");return header+=headers[headers.length-1].toString()}return headers[index]?headers[index].toString():""},group_utils_headerCreator=function headerCreator(fields,fieldHeaders,TextCell,_ref2){var classPrefix=_ref2.classPrefix,labelManager=_ref2.labelManager,sanitizeCheck=_ref2.sanitizeCheck,headers=fields.length>0?fields[0].map(function(cell,i){return new TextCell({type:HEADER,className:"".concat(classPrefix,"-grid-headers")},{labelManager:labelManager}).source(getHeaderText(fieldHeaders,i,fields[0].length)).config({show:cell.config().show})}):[];return sanitizeCheck&&cell_border_applier_sanitiseHeaderMatrix(headers,!0),headers},group_utils_sanitizeCheck=function sanitizeCheck(){var isBorderPresent=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isBorderPresent;return!isBorderPresent||["color","showRowBorders","showColBorders","showValueBorders"].every(function(d){return!isBorderPresent[d]})},group_utils_findInGroup=function findInGroup(variable,allFields){var channel=null;return[enums_constants_COLOR,enums_constants_SIZE,enums_constants_SHAPE].forEach(function(e){group_utils_this.store.get(e)&&variable===group_utils_this.store.get(e)[0]&&(channel=e)}),channel?{channel:channel}:([ROW,COL].forEach(function(facetType){allFields["".concat(facetType,"Facets")].forEach(function(e){e.toString()===variable&&(channel={channel:FACET,type:facetType===COL?COLUMN:ROW})})}),channel||([ROW,COL].forEach(function(projType){allFields["".concat(projType,"Projections")].forEach(function(e){e.forEach(function(m){m.toString()===variable&&(channel=projType===COL?X:Y)})})}),channel?{channel:channel}:null))},group_utils_getAxisType=function getAxisType(fieldsConfig,field){var fieldType=enums_constants_ORDINAL;return field&&fieldsConfig[field].def.type!==DIMENSION&&(fieldType=enums_constants_LINEAR),fieldType},retriveDomainFromData=function retriveDomainFromData(datamodel,fieldName){return datamodel.getFieldspace().fields.find(function(d){return d.name()===fieldName.toString()}).domain()},mutateAxesFromMap=function mutateAxesFromMap(cacheMaps,axes){var xAxes=null,yAxes=null,xAxesMap=cacheMaps.xAxesMap,yAxesMap=cacheMaps.yAxesMap,xAxisSet=axes.x,yAxisSet=axes.y;return xAxisSet&&xAxisSet.forEach(function(axisId){var xAxis=xAxesMap.get(axisId);(xAxes=xAxes||[]).push(xAxis)}),yAxisSet&&yAxisSet.forEach(function(axisId){var yAxis=yAxesMap.get(axisId);(yAxes=yAxes||[]).push(yAxis)}),{xAxes:xAxes,yAxes:yAxes}},group_utils_getEncoder=function getEncoder(layers){var encoder=new cartesian_encoder_CartesianEncoder;return layers.length&&(encoder=layers.some(function(layerConf){return function hasPolarEncodings(layerConf){return layerConf.mark===ARC||[enums_constants_RADIUS,enums_constants_ANGLE].some(function(field){return getObjProp(layerConf.encoding,field)})}(layerConf)})?new polar_encoder_PolarEncoder:encoder),encoder},group_utils_getHeaderAxisFrom=function getHeaderAxisFrom(type,fields,userAxisFromConfig){var axisFrom=userAxisFromConfig[type],headerFrom="",options=type===ROW?[constants_LEFT,constants_RIGHT]:[enums_constants_BOTTOM,enums_constants_TOP],_fields=group_utils_slicedToArray(fields,2),firstField=_fields[0],secondField=_fields[1],firstFieldType=function firstFieldType(i){return firstField.length?firstField[i].type():null},secondFieldType=function secondFieldType(i){return secondField.length?secondField[i].type():null};return firstFieldType(firstField.length-1)===DIMENSION&&secondFieldType(0)===DIMENSION?(headerFrom=axisFrom?options[1-options.indexOf(axisFrom)]:options[1],axisFrom=type===COLUMN&&firstField[firstField.length-1].toString()===secondField[0].toString()?enums_constants_TOP:axisFrom||options[0]):secondFieldType(secondField.length-1)===DIMENSION?(headerFrom=type===ROW?constants_RIGHT:enums_constants_BOTTOM,axisFrom=type===ROW?constants_RIGHT:enums_constants_BOTTOM):(headerFrom=type===ROW?constants_LEFT:enums_constants_TOP,axisFrom=type===ROW?constants_LEFT:enums_constants_TOP),firstFieldType(firstField.length-1)===MEASURE&&secondFieldType(0)===MEASURE?axisFrom=type===ROW?constants_LEFT:enums_constants_TOP:secondFieldType(0)===MEASURE?axisFrom=type===ROW?constants_RIGHT:enums_constants_BOTTOM:firstFieldType(firstField.length-1)===MEASURE&&(axisFrom=type===ROW?constants_LEFT:enums_constants_TOP),[headerFrom,axisFrom]},setFacetsAndProjections=function setFacetsAndProjections(context,fieldInfo,encoder){var fields=fieldInfo.fields,type=fieldInfo.type,_encoder$simpleEncode=encoder.simpleEncoder.getFacetsAndProjections(fields,type),facets=_encoder$simpleEncode.facets,projections=_encoder$simpleEncode.projections;return context.facets(group_utils_defineProperty({},"".concat(type,"Facets"),facets)),context.projections(group_utils_defineProperty({},"".concat(type,"Projections"),projections)),{facets:facets,projections:projections,fields:fields}},getBorders=function getBorders(matrices,encoder){var showRowBorders={top:!1,bottom:!1,left:!1,right:!1},showColBorders={top:!1,bottom:!1,left:!1,right:!1},showValueBorders={top:!1,bottom:!1,left:!1,right:!1},rows=matrices.rows,columns=matrices.columns,valueMatrix=matrices.values,_rows=group_utils_slicedToArray(rows,2),leftRows=_rows[0],rightRows=_rows[1],_columns=group_utils_slicedToArray(columns,2),topColumns=_columns[0],bottomColumns=_columns[1],_encoder$fieldInfo=encoder.fieldInfo(),rowDimensions=_encoder$fieldInfo.rowDimensions,columnDimensions=_encoder$fieldInfo.columnDimensions,rowTemporalFields=_encoder$fieldInfo.rowTemporalFields,columnTemporalFields=_encoder$fieldInfo.columnTemporalFields,columnMeasures=_encoder$fieldInfo.columnMeasures,rowMeasures=_encoder$fieldInfo.rowMeasures,allDimensionLength=rowDimensions.length+columnDimensions.length,allMeasuresLength=rowMeasures.length+columnMeasures.length,allTemporalFieldsLength=rowTemporalFields.length+columnTemporalFields.length;if(encoder.constructor.type()===group_utils_POLAR){if(!allDimensionLength)return{showRowBorders:showRowBorders,showColBorders:showColBorders,showValueBorders:showValueBorders}}else if(!allMeasuresLength&&!allTemporalFieldsLength&&allDimensionLength<=2)return{showRowBorders:showRowBorders,showColBorders:showColBorders,showValueBorders:showValueBorders};return showRowBorders=function getRowBorders(left,right){var borders={top:!1,bottom:!1,left:!1,right:!1};return(left.length>1||right.length>1)&&(borders.top=!0,borders.bottom=!0,borders.left=!0,borders.right=!0),borders}(leftRows,rightRows),showColBorders=function getColumnsBorders(top,bottom){var borders={top:!1,bottom:!1,left:!1,right:!1};return(top.length||bottom.length)&&(top[0]&&top[0].length>1||bottom[0]&&bottom[0].length>1)&&(borders.top=!0,borders.bottom=!0,borders.left=!0,borders.right=!0),borders}(topColumns,bottomColumns),showValueBorders=function getValueBorders(rows,columns){var borders={top:!0,left:!0,bottom:!0,right:!0},borderTypeRow=[constants_LEFT,constants_RIGHT],borderTypeCol=[enums_constants_TOP,enums_constants_BOTTOM];return rows.forEach(function(e,i){e[0]&&e[0].length?borders[borderTypeRow[i]]=!0:borders[borderTypeRow[i]]=!1}),columns.forEach(function(e,i){e.length?borders[borderTypeCol[i]]=!0:borders[borderTypeCol[i]]=!1}),borders}([leftRows,rightRows],[topColumns,bottomColumns]),valueMatrix.length>1&&(showValueBorders.top=!0,showValueBorders.bottom=!0),valueMatrix.length&&valueMatrix[0].length>1&&(showValueBorders.left=!0,showValueBorders.right=!0),{showRowBorders:showRowBorders,showColBorders:showColBorders,showValueBorders:showValueBorders}},getFieldsFromSuppliedLayers=function getFieldsFromSuppliedLayers(suppliedLayerConfig){var _ref3,encodingArr=suppliedLayerConfig.map(function(conf){return conf.encoding||{}}),fields=(_ref3=[]).concat.apply(_ref3,group_utils_toConsumableArray(encodingArr.map(function(enc){return Object.values(enc).map(function(d){return"object"===group_utils_typeof(d)?d.field:d})})));return group_utils_toConsumableArray(new Set(fields.filter(function(d){return d})))},group_utils_extractFields=function extractFields(facetsAndProjections,layerFields){var _ref6,fields=Object.values(facetsAndProjections).map(function(arr){var _ref4,_ref5,flattenArray=(_ref4=[]).concat.apply(_ref4,group_utils_toConsumableArray(arr));return(_ref5=[]).concat.apply(_ref5,group_utils_toConsumableArray(flattenArray.map(function(field){return field instanceof variable_Variable?field.getMembers():field})))});return(_ref6=[]).concat.apply(_ref6,group_utils_toConsumableArray(fields).concat(group_utils_toConsumableArray(layerFields)))},group_utils_sortFacetFields=function sortFacetFields(facets,keys,config){var schema=[],facetNames=[],sortInfo=[],sortConfig=config.sort;return facets.forEach(function(facet){var name="".concat(facet);facetNames.push(name);var facetSortConfig=sortConfig[name];facetSortConfig?sortInfo.push([name,facetSortConfig]):sortInfo.push([name,null]),schema.push(facet.getSchemaDef())}),new datamodel_default.a([facetNames].concat(group_utils_toConsumableArray(keys)),schema).getData({sort:sortInfo}).data},group_utils_removeExitCells=function removeExitCells(resolver){var _ref7,exitCells=resolver.cacheMaps().exitCellMap,store=resolver.store(),qualifiedStateProps=(_ref7=[]).concat.apply(_ref7,group_utils_toConsumableArray(visual_unit_VisualUnit.getQualifiedStateProps()).concat(group_utils_toConsumableArray(base_layer_BaseLayer.getQualifiedStateProps())));store.lockCommits(qualifiedStateProps),exitCells.forEach(function(placeholder){placeholder.remove()}),store.unlockCommits(qualifiedStateProps)},encoder_props_PROPS={layers:{},data:{},globalConfig:{}};function visual_encoder_slicedToArray(arr,i){return function visual_encoder_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function visual_encoder_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function visual_encoder_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function visual_encoder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var visual_encoder_VisualEncoder=function(){function VisualEncoder(){!function visual_encoder_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VisualEncoder),generateGetterSetters(this,encoder_props_PROPS)}return function visual_encoder_createClass(Constructor,protoProps,staticProps){return protoProps&&visual_encoder_defineProperties(Constructor.prototype,protoProps),staticProps&&visual_encoder_defineProperties(Constructor,staticProps),Constructor}(VisualEncoder,[{key:"createAxis",value:function createAxis(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"setCommonDomain",value:function setCommonDomain(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"getLayerConfig",value:function getLayerConfig(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"fieldInfo",value:function fieldInfo(){return arguments.length?(this._fieldInfo=mergeRecursive(this._fieldInfo||{},arguments.length<=0?void 0:arguments[0]),this):this._fieldInfo}},{key:"fieldSanitizer",value:function fieldSanitizer(datamodel,config){return this.fieldInfo(field_sanitizer_transformFields(datamodel,config)),this.fieldInfo()}},{key:"axisFrom",value:function axisFrom(){return arguments.length?(this._axisFrom=arguments.length<=0?void 0:arguments[0],this):this._axisFrom}},{key:"headerFrom",value:function headerFrom(){return arguments.length?(this._headerFrom=arguments.length<=0?void 0:arguments[0],this):this.__headerFrom}},{key:"setAxisAndHeaders",value:function setAxisAndHeaders(){var axisFrom=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},fields=arguments.length>1?arguments[1]:void 0,_getHeaderAxisFrom2=visual_encoder_slicedToArray(group_utils_getHeaderAxisFrom(ROW,fields.rows,axisFrom),2),rowHeader=_getHeaderAxisFrom2[0],rowAxis=_getHeaderAxisFrom2[1],_getHeaderAxisFrom4=visual_encoder_slicedToArray(group_utils_getHeaderAxisFrom(COLUMN,fields.columns,axisFrom),2),colHeader=_getHeaderAxisFrom4[0],colAxis=_getHeaderAxisFrom4[1];return this.axisFrom({row:rowAxis,column:colAxis}),this.headerFrom({row:rowHeader,column:colHeader}),this}},{key:"getProjectionFields",value:function getProjectionFields(layers){return getFieldsFromSuppliedLayers(layers)}},{key:"hasMandatoryFields",value:function hasMandatoryFields(fields){return hasOneField(fields)}}]),VisualEncoder}(),scaleMaps={linear:continous_axis_ContinousAxis,band:band_axis_BandAxis,temporal:time_axis_TimeAxis,size:size_axis_SizeAxis,color:color_axis_ColorAxis,shape:shape_axis_ShapeAxis};function matrix_model_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function matrix_model_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?matrix_model_ownKeys(Object(source),!0).forEach(function(key){matrix_model_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):matrix_model_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function matrix_model_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function matrix_model_toConsumableArray(arr){return function matrix_model_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function matrix_model_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function matrix_model_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var getFieldNames=function getFieldNames(fieldVar){return fieldVar.reduce(function(acc,d){return acc=[].concat(matrix_model_toConsumableArray(acc),matrix_model_toConsumableArray(d.getMembers()))},[])},prepareHashMaps=function prepareHashMaps(context,facetNames,hashMap,keys,index){var rowKey=[];facetNames.forEach(function(name){var key=context._derivation[context._derivation.length-1].meta.keys[name];rowKey.push(key)});var joinedRowKey=rowKey.join(",");return void 0===hashMap[joinedRowKey]&&(hashMap[joinedRowKey]=index++,keys.push(rowKey)),rowKey},createJoinedKeys=function createJoinedKeys(keys){return keys.map(function(e){return{keyArr:e,joinedKey:e.join(",")}})},formatKeys=function formatKeys(keys,formatterList){var formattedKeys=[];return keys.forEach(function(rKeys,rIdx){formattedKeys[rIdx]=[],rKeys.forEach(function(key,idx){formattedKeys[rIdx][idx]=formatterList[idx](key)})}),formattedKeys},matrix_model_createColumnDataModels=function createColumnDataModels(colContext,fieldInfo,sourceDM){var context={},rowFacets=fieldInfo.rowFacets,colFacets=fieldInfo.colFacets,rowKeyArr=colContext.rowKeyArr,rowKey=colContext.rowKey,colKeyObj=colContext.colKeyObj,newRowIndex=colContext.newRowIndex,splitModelsHashMap=colContext.splitModelsHashMap,currentColumnIndex=colContext.currentColumnIndex,colKeyArr=colKeyObj.keyArr,colKey=colKeyObj.joinedKey,hashMapKey=splitModelsHashMap["".concat(rowKey,"-").concat(colKey)];hashMapKey?context={dataModel:hashMapKey}:context={dataModel:new datamodel_default.a([],sourceDM.getData().schema)};var dataModels=function splitByColumn(context,optionalProjections){var matrix=context.matrix,dataModel=context.dataModel,rowIndex=context.rowIndex,colIndex=context.colIndex,facetInfo=context.facetInfo,projectionInfo=context.projectionInfo,geomCellCreator=context.geomCellCreator,indices=projectionInfo.indices,uniqueFields=projectionInfo.uniqueFields,projections=projectionInfo.projections,commonFields=optionalProjections;dataModel.splitByColumn(uniqueFields,commonFields).forEach(function(model,i){var _indices$i=indices[i],row=_indices$i.rowIndex,col=_indices$i.colIndex;col+=colIndex,matrix[row+=rowIndex]=matrix[row]||[];var projectionIndexObject={indices:{rowIndex:row,columnIndex:col},projections:projections[i]};matrix[row][col]=geomCellCreator(model,projectionIndexObject,facetInfo)});var lastIndex=indices[indices.length-1];return{rowIndex:lastIndex.rowIndex+rowIndex,colIndex:lastIndex.colIndex+colIndex}}(context=matrix_model_objectSpread({},context,{},colContext,{facetInfo:{rowFacets:[rowFacets,rowKeyArr],colFacets:[colFacets,colKeyArr]},rowIndex:newRowIndex,colIndex:currentColumnIndex}),fieldInfo.optionalProjections);return{columnIndex:dataModels.colIndex+1,rowIndex:dataModels.rowIndex}},matrix_model_getMatrixModel=function getMatrixModel(dataModel,fieldInfo,geomCellCreator,globalConfig){var currentRowIndex=0,matrix=[],rowFacets=fieldInfo.rowFacets,colFacets=fieldInfo.colFacets,projectionInfo=function prepareProjectionInfo(fieldInfo){var colProjections=fieldInfo.colProjections,uniqueFields=[],indices=[],projections=[];return fieldInfo.rowProjections.forEach(function(rowProj,rIndex){var newRIndex=rIndex;colProjections.forEach(function(colProj,cIndex){var newCIndex=cIndex,newRowProj=getFieldNames(rowProj),newColProj=getFieldNames(colProj);uniqueFields.push([].concat(matrix_model_toConsumableArray(newRowProj),matrix_model_toConsumableArray(newColProj))),indices.push({rowIndex:newRIndex,colIndex:newCIndex}),projections.push({rowFields:rowProj,columnFields:colProj})})}),indices=indices.length?indices:[{rowIndex:0,colIndex:0}],projections=projections.length?projections:[{rowFields:[],columnFields:[]}],{uniqueFields:uniqueFields,indices:indices,projections:projections}}(fieldInfo),facetInfo=function prepareFacetInfo(fieldInfo){var rowFacets=fieldInfo.rowFacets,colFacets=fieldInfo.colFacets,rowFacetNames=getFieldNames(rowFacets),colFacetNames=getFieldNames(colFacets);return{rowFacetNames:rowFacetNames,colFacetNames:colFacetNames,allFacets:[].concat(matrix_model_toConsumableArray(rowFacetNames),matrix_model_toConsumableArray(colFacetNames)),rowFacets:rowFacets,colFacets:colFacets}}(fieldInfo),_getSplitModelHashMap=function getSplitModelHashMap(splitModels,facetInfo,config){var rowFacetNames=facetInfo.rowFacetNames,colFacetNames=facetInfo.colFacetNames,rowFacets=facetInfo.rowFacets,colFacets=facetInfo.colFacets,rowKeyHashMap={},colKeyHashMap={},rowKeys=[],colKeys=[],splitModelsHashMap={};return splitModels.forEach(function(splitContext){var rowKey=prepareHashMaps(splitContext,rowFacetNames,rowKeyHashMap,rowKeys,0),colKey=prepareHashMaps(splitContext,colFacetNames,colKeyHashMap,colKeys,1);splitModelsHashMap["".concat(rowKey,"-").concat(colKey)]=splitContext}),{splitModelsHashMap:splitModelsHashMap,rowKeys:createJoinedKeys(group_utils_sortFacetFields(rowFacets,rowKeys,config)),colKeys:createJoinedKeys(group_utils_sortFacetFields(colFacets,colKeys,config))}}(dataModel.splitByRow(facetInfo.allFacets),facetInfo,globalConfig),splitModelsHashMap=_getSplitModelHashMap.splitModelsHashMap,rowKeys=_getSplitModelHashMap.rowKeys,colKeys=_getSplitModelHashMap.colKeys,defaultConfig=function setDefaultConfigForFacet(facetInfo,projectionInfo,config){var conf={};if(config&&(facetInfo.allFacets.length||projectionInfo.indices.length>1)){var _config$facetsUserCon=config.facetsUserConfig,facetsUserConfig=void 0===_config$facetsUserCon?{}:_config$facetsUserCon,border=config.border,_facetsUserConfig$isB=facetsUserConfig.isBorderPresent,isBorderPresent=void 0===_facetsUserConfig$isB?{}:_facetsUserConfig$isB,_facetsUserConfig$isG=facetsUserConfig.isGridLinePresent,isGridLinePresent=void 0===_facetsUserConfig$isG?{}:_facetsUserConfig$isG,gridLinesShowLength=Object.keys(isGridLinePresent).length,borderWidth=border.width,borderColor=border.color,borderStyle=border.style,showValueBorders=border.showValueBorders,showRowBorders=border.showRowBorders,showColBorders=border.showColBorders,gridLines={},borderConf={};0!==Object.keys(isBorderPresent).length&&isBorderPresent.width?Object.assign(borderConf,borderWidth?{width:borderWidth}:null,borderColor?{color:borderColor}:null,showValueBorders?{showValueBorders:showValueBorders}:null,showRowBorders?{showRowBorders:showRowBorders}:null,showColBorders?{showColBorders:showColBorders}:null,borderStyle?{style:borderStyle}:null):borderConf={width:BORDER_WIDTH[FACET]},gridLinesShowLength<=0&&(gridLines={x:{show:!1}}),conf={border:borderConf,gridLines:gridLines}}return conf}(facetInfo,projectionInfo,globalConfig);globalConfig=mergeRecursive(globalConfig,defaultConfig);var generalContext={matrix:matrix,geomCellCreator:geomCellCreator,projectionInfo:projectionInfo,splitModelsHashMap:splitModelsHashMap,colKeys:colKeys};if(rowKeys.length)rowKeys.forEach(function(rowKeyObj){var rowIndex=function createRowDataModels(rowContext,fieldInfo,sourceDM){var currentColumnIndex=0,rowIndexForCurrentKey=0,colKeys=rowContext.colKeys,rowKeyObj=rowContext.rowKeyObj,currentRowIndex=rowContext.currentRowIndex,newRowIndex=currentRowIndex,colContext=matrix_model_objectSpread({},rowContext,{rowKeyArr:rowKeyObj.keyArr,rowKey:rowKeyObj.joinedKey,newRowIndex:newRowIndex});if(rowIndexForCurrentKey=currentRowIndex,colKeys.length)colKeys.forEach(function(colKeyObj){colContext.colKeyObj=colKeyObj,colContext.currentColumnIndex=currentColumnIndex;var _createColumnDataMode=matrix_model_createColumnDataModels(colContext,fieldInfo,sourceDM),columnIndex=_createColumnDataMode.columnIndex,rowIndex=_createColumnDataMode.rowIndex;currentColumnIndex=columnIndex,rowIndexForCurrentKey=rowIndex});else{colContext.colKeyObj={keyArr:[],joinedKey:""},colContext.currentColumnIndex=currentColumnIndex;var _createColumnDataMode2=matrix_model_createColumnDataModels(colContext,fieldInfo,sourceDM),columnIndex=_createColumnDataMode2.columnIndex,rowIndex=_createColumnDataMode2.rowIndex;currentColumnIndex=columnIndex,rowIndexForCurrentKey=rowIndex}return{rowIndex:++rowIndexForCurrentKey}}(matrix_model_objectSpread({},generalContext,{rowKeyObj:rowKeyObj,currentRowIndex:currentRowIndex}),fieldInfo,dataModel).rowIndex;currentRowIndex=rowIndex});else if(colKeys.length){var currentColumnIndex=0,newRowIndex=currentRowIndex;colKeys.forEach(function(colKeyObj){var colContext=matrix_model_objectSpread({},generalContext,{rowKeyArr:[],rowKey:"",colKeyObj:colKeyObj,newRowIndex:newRowIndex,currentColumnIndex:currentColumnIndex}),_createColumnDataMode3=matrix_model_createColumnDataModels(colContext,fieldInfo,dataModel),columnIndex=_createColumnDataMode3.columnIndex,rowIndex=_createColumnDataMode3.rowIndex;currentRowIndex=rowIndex,currentColumnIndex=columnIndex})}else{var _currentColumnIndex=0,colContext=matrix_model_objectSpread({},generalContext,{rowKeyArr:[],rowKey:"",colKeyObj:{keyArr:[],joinedKey:""},newRowIndex:currentRowIndex,currentColumnIndex:_currentColumnIndex}),_createColumnDataMode4=matrix_model_createColumnDataModels(colContext,fieldInfo,dataModel),columnIndex=_createColumnDataMode4.columnIndex,rowIndex=_createColumnDataMode4.rowIndex;currentRowIndex=rowIndex,_currentColumnIndex=columnIndex}var formattedColKeys=formatKeys(colKeys.map(function(e){return e.keyArr}),colFacets.map(function(facetField){return facetField.rawFormat()}));return{matrix:matrix,rowKeys:formatKeys(rowKeys.map(function(e){return e.keyArr}),rowFacets.map(function(facetField){return facetField.rawFormat()})),columnKeys:formattedColKeys.length>0?formattedColKeys[0].map(function(col,i){return formattedColKeys.map(function(row){return row[i]})}):formattedColKeys}};function cell_creator_slicedToArray(arr,i){return function cell_creator_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function cell_creator_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function cell_creator_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function cell_creator_toConsumableArray(arr){return function cell_creator_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function cell_creator_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function cell_creator_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var cell_creator_createValueCells=function createValueCells(context,datamodel,fieldInfo,facets){var projections=fieldInfo.projections,indices=fieldInfo.indices,rowFields=projections.rowFields,columnFields=projections.columnFields,rowIndex=indices.rowIndex,columnIndex=indices.columnIndex,suppliedLayers=context.suppliedLayers,GeomCell=context.cell,resolver=context.resolver,config=context.config,encoder=context.encoder,detailFields=context.detailFields,axes=resolver.axes(),cacheMaps=resolver.cacheMaps(),matrixLayers=resolver.matrixLayers(),labelManager=resolver.dependencies().smartlabel,horizontalAxis=resolver.horizontalAxis(),verticalAxis=resolver.verticalAxis(),datamodelTransform=resolver.datamodelTransform(),sortedFields=config.sort,entryCellMap=cacheMaps.entryCellMap,exitCellMap=cacheMaps.exitCellMap,layerConfigArr=encoder.getLayerConfig({columnFields:columnFields,rowFields:rowFields},suppliedLayers||[],context.retinalConfig),axesCreators={config:config,labelManager:labelManager,axes:axes,cacheMaps:cacheMaps};fieldInfo.normalizedColumns=verticalAxis.fields,fieldInfo.normalizedRows=horizontalAxis.fields;var allFacets=[[].concat(cell_creator_toConsumableArray(facets.rowFacets[0]),cell_creator_toConsumableArray(facets.colFacets[0])),[].concat(cell_creator_toConsumableArray(facets.rowFacets[1]),cell_creator_toConsumableArray(facets.colFacets[1]))],facetFields=allFacets.slice();facetFields[0]=facetFields[0].map(function(facetField){return facetField.oneVar()}),matrixLayers[rowIndex]=matrixLayers[rowIndex]?matrixLayers[rowIndex]:[],matrixLayers[rowIndex][columnIndex]=layerConfigArr;var geomCellKey=getCellKey(rowIndex,columnIndex),fields={y:rowFields,x:columnFields},geomCell=exitCellMap.has(geomCellKey)?exitCellMap.get(geomCellKey):new GeomCell,sortConfig=Object.keys(sortedFields).map(function(field){return[field,sortedFields[field]]});return sortConfig.length&&(datamodel=datamodel.sort(sortConfig,{saveChild:!0})),geomCell.data(datamodel).fields(fields).transform(datamodelTransform).detailFields(detailFields).facetByFields(allFacets),encoder.createAxis(axesCreators,fieldInfo,Object.assign({},context,{geomCell:geomCell,facetFields:facetFields})),entryCellMap.set(geomCellKey,geomCell),exitCellMap.delete(geomCellKey),function updateCells(resolver,facets,geomCell){[ROW,COL].forEach(function(field){var cells=resolver["".concat(field,"Cells")](),facetKey=facets["".concat(field,"Facets")][1].join();!cells[facetKey]&&(cells[facetKey]=[]),cells[facetKey].push(geomCell),resolver["".concat(field,"Cells")](cells)})}(resolver,facets,geomCell),entryCellMap.get(geomCellKey)},cell_creator_extractAxisIndex=function extractAxisIndex(id){return getObjProp(id.match(/^[0-9]*?(?=-)/g),0)},cell_creator_createAxisCells=function createAxisCells(selection,axes,axisIndex,cells){return common_utils_createSelection(selection,function(axis){return axis},axes,function(item,i){return i+item.reduce(function(e,n){var id=n.id+axisIndex;return"".concat(e,"-").concat(id)},"")}).map(function(currObj,axis){if(axis&&axis[axisIndex]){var axisInst=axis[axisIndex],_axisInst$config=axisInst.config(),orientation=_axisInst$config.orientation,show=_axisInst$config.show;return(new cells.AxisCell).source(axisInst).config({isOffset:orientation===axis_orientation_namespaceObject.LEFT||orientation===axis_orientation_namespaceObject.TOP,show:show})}return(new cells.BlankCell).config({show:!1})}).sort(function(a,b){return cell_creator_extractAxisIndex(a[0])-cell_creator_extractAxisIndex(b[0])})},extractFacetIndex=function extractFacetIndex(id){return id.split("-").pop()},cell_creator_headerPlaceholderGn=function headerPlaceholderGn(context,selectionObj,cells,labelManager){var axis=context.axis,keys=context.keys,type=context.type,facet=context.facet,counter=axis.length/keys.length,selectionKeys=keys.length?axis.map(function(d,i){return keys[Math.floor(i/counter)]}):[];return common_utils_createSelection(selectionObj["".concat(type,"Headers")],function(keySet){return keySet},selectionKeys,function(keySet,i){return"".concat(keySet.join(","),"-").concat(i)}).sort(function(a,b){return extractFacetIndex(a[0])-extractFacetIndex(b[0])}).map(function(keySet,data){var textCells=function createTextCells(selection,headers,cells,labelManager){return common_utils_createSelection(selection,function(label){var textCell=new cells.TextCell({},{labelManager:labelManager});return textCell.source(label),textCell},headers,function(key,i){return key+i})}(null,data,cells,labelManager);return textCells=textCells.map(function(cell,k){return cell.source(k).config(facet)})})},cell_creator_generatePlaceholders=function generatePlaceholders(context,cells,labelManager){var selectionObj,matrices=context.matrices,fields=context.fields,facetsAndProjections=context.facetsAndProjections,selection=context.selection,facet=context.facet,encoders=context.encoders,resolver=context.resolver,rows=fields.rows,columns=fields.columns,valuesMatrix=matrices.valuesMatrix,rowProjections=facetsAndProjections.rowProjections,colProjections=facetsAndProjections.colProjections,rowKeys=valuesMatrix.rowKeys,columnKeys=valuesMatrix.columnKeys,takeAxisFrom=encoders.simpleEncoder._axisFrom,takeHeaderFrom=encoders.simpleEncoder._headerFrom;selectionObj=selection||{},["pie",X,Y].forEach(function(axis){var axisFrom=axis===X?takeAxisFrom.column:takeAxisFrom.row;selectionObj=function axisPlaceholderGn(context,selObj,cells){var axesMatrix=context.matrices.axesMatrix;return function(type,axisFrom){var axes=axesMatrix["".concat(type)];if(axes&&axes.length)if(type===X||type===Y){var fieldNames=type===Y?ROWS:COLUMNS;[PRIMARY,SECONDARY].forEach(function(fieldType,index){var selObjProp="".concat(fieldNames).concat(fieldType),axisIndex=index,axesForDraw=axes;axisFrom!==constants_RIGHT&&axisFrom!==enums_constants_BOTTOM||(axisIndex=1-axisIndex),getObjProp(axes,0,axisIndex)||(axesForDraw=[]),selObj[selObjProp]=cell_creator_createAxisCells(selObj[selObjProp],axesForDraw,axisIndex,cells)})}else selObj.rowsPrimary=cell_creator_createAxisCells(selObj.rowPrime,axes.map(function(){return[]}),0,cells),selObj.rowsSecondary=cell_creator_createAxisCells(selObj.rowSec,axes.map(function(){return[]}),0,cells),selObj.columnsPrimary=cell_creator_createAxisCells(selObj.colPrime,axes[0],0,cells),selObj.columnsSecondary=cell_creator_createAxisCells(selObj.colSec,axes[0],0,cells);return selObj}}(context,selectionObj,cells)(axis,axisFrom)});var _selectionObj=selectionObj,rowsPrimary=_selectionObj.rowsPrimary,rowsSecondary=_selectionObj.rowsSecondary,columnsPrimary=_selectionObj.columnsPrimary,columnsSecondary=_selectionObj.columnsSecondary,rowAxis=rowsPrimary&&rowsPrimary.getObjects().length?rowsPrimary.getObjects():rowsSecondary&&rowsSecondary.getObjects().length?rowsSecondary.getObjects():[],colAxis=columnsPrimary&&columnsPrimary.getObjects().length?columnsPrimary.getObjects():columnsSecondary&&columnsSecondary.getObjects().length?columnsSecondary.getObjects():[];return[{type:constants_LEFT,section:rows[0],axis:rowAxis,headerFrom:takeHeaderFrom.row},{type:constants_RIGHT,section:rows[1],axis:rowAxis,headerFrom:takeHeaderFrom.row},{type:enums_constants_TOP,section:columns[0],axis:colAxis,headerFrom:takeHeaderFrom.column},{type:enums_constants_BOTTOM,section:columns[1],axis:colAxis,headerFrom:takeHeaderFrom.column}].forEach(function(config,index){var keys,length,type=config.type,section=config.section,axis=config.axis,headerFrom=config.headerFrom;if(index<2?(keys=rowKeys,length=rowProjections.length>0?rowProjections.length:1):(keys=columnKeys,length=colProjections.length>0?colProjections.length:1),keys=keys.map(function(arr){return arr.map(function(val){return resolver.valueParser()(val)})}),section.length&&headerFrom===type&&axis&&keys.length){var hContext={axis:axis,length:length,type:type},headers=[];index<2?(hContext.keys=keys,hContext.facet=facet.rows,headers=cell_creator_headerPlaceholderGn(hContext,selectionObj,cells,labelManager)):(hContext.facet=facet.columns,hContext.keys=keys[0].map(function(key,i){return keys.map(function(e){return e[i]})}),headers=cell_creator_headerPlaceholderGn(hContext,selectionObj,cells,labelManager)),selectionObj["".concat(type,"Headers")]=headers}else selectionObj["".concat(type,"Headers")]=null}),selectionObj},cell_creator_getAxisFields=function getAxisFields(projections){var fieldHolder=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return projections.reduce(function(acc,item){return[].concat(cell_creator_toConsumableArray(acc),cell_creator_toConsumableArray(item.reduce(function(ac,field){return field instanceof simple_var_SimpleVariable?[].concat(cell_creator_toConsumableArray(ac),[field.oneVar()]):ac},[])))},fieldHolder)},cell_creator_transformDataModel=function transformDataModel(dataModel,config,resolver){var groupedModel,fieldsConfig=dataModel.getFieldsConfig(),resolvedData=resolver.data(),groupBy=config.groupBy,suppliedLayers=config.suppliedLayers,facetsAndProjections=config.facetsAndProjections;resolvedData instanceof datamodel_default.a&&resolvedData.dispose();var fields=getFieldsFromSuppliedLayers(suppliedLayers).filter(function(field){return getObjProp(fieldsConfig,field,"def","type")===dist_datamodel.FieldType.DIMENSION}),allFields=group_utils_extractFields(facetsAndProjections,fields);if(groupedModel=dataModel.project(allFields),resolver.data(groupedModel),!groupBy.disabled){var newFieldsConfig=groupedModel.getFieldsConfig(),dimensions=allFields.filter(function(field){return getObjProp(newFieldsConfig,field,"def","type")===dist_datamodel.FieldType.DIMENSION}),aggregationFns=groupBy.measures,measureNames=Object.keys(groupedModel.getFieldspace().getMeasure()),nearestAggFns=common_utils_retrieveNearestGroupByReducers.apply(void 0,[groupedModel].concat(cell_creator_toConsumableArray(measureNames))),resolvedAggFns=mergeRecursive(nearestAggFns,aggregationFns);groupedModel=groupedModel.groupBy(dimensions.length?dimensions:[""],resolvedAggFns)}return groupedModel=function sortDmTemporalFields(resolver,datamodel){var axisFields=[],projections=resolver.projections();axisFields=cell_creator_getAxisFields(projections.rowProjections,cell_creator_getAxisFields(projections.colProjections));var fieldConfig=datamodel.getFieldsConfig(),temporalFields=axisFields.reduce(function(acc,field){return fieldConfig[field].def.subtype===constants_TEMPORAL?[].concat(cell_creator_toConsumableArray(acc),[[field]]):acc},[]);return temporalFields.length?datamodel.sort(temporalFields,{saveChild:!0}):datamodel}(resolver,groupedModel),resolver.transformedData(groupedModel),groupedModel},cell_creator_computeMatrices=function computeMatrices(resolverConfig){var datamodel=resolverConfig.datamodel,encoders=resolverConfig.encoders,resolver=resolverConfig.resolver,globalConfig=resolverConfig.globalConfig,selection=resolverConfig.selection,transform=resolverConfig.transform,componentRegistry=resolverConfig.componentRegistry,groupBy=resolverConfig.groupBy,labelManager=resolverConfig.labelManager,fieldMap=resolverConfig.fieldMap,layerConfig=resolverConfig.layerConfig,registry=resolverConfig.registry,normalizedRows=resolverConfig.normalizedRows,normalizedColumns=resolverConfig.normalizedColumns,otherEncodings=resolverConfig.otherEncodings,facetsAndProjections=resolverConfig.facetsAndProjections,simpleEncoder=resolverConfig.simpleEncoder,config=resolverConfig.config,rowFacets=facetsAndProjections.rowFacets,colFacets=facetsAndProjections.colFacets,isFacet=rowFacets.length>0||colFacets.length>0;isFacet&&(globalConfig.isFacet=!0);var matrixGnContext={normalizedColumns:normalizedColumns,normalizedRows:normalizedRows,facetsAndProjections:facetsAndProjections,layers:layerConfig,fieldMap:fieldMap,otherEncodings:otherEncodings,encoders:encoders,facet:globalConfig.facet||{},axisFrom:globalConfig.axisFrom||{},selection:selection,resolver:resolver},cells={GeomCell:resolver.getCellDef(registry.cells.GeomCell),AxisCell:resolver.getCellDef(registry.cells.AxisCell),BlankCell:resolver.getCellDef(registry.cells.BlankCell),TextCell:resolver.getCellDef(registry.cells.TextCell)},isRowSizeEqual=group_utils_isDistributionEqual(normalizedRows),isColumnSizeEqual=group_utils_isDistributionEqual(normalizedColumns);resolver.colCells({}),resolver.rowCells({}),resolver.datamodelTransform(transform||{}),resolver.resetSimpleAxes();var newCacheMap={exitCellMap:resolver.cacheMaps().entryCellMap,entryCellMap:new Map};resolver.cacheMaps(newCacheMap);var valueCellContext={config:globalConfig,suppliedLayers:simpleEncoder.serializeLayerConfig(resolver.layerConfig()),resolver:resolver,cell:cells.GeomCell,encoder:simpleEncoder,newCacheMap:newCacheMap,detailFields:config.detail,retinalConfig:{color:config.color,size:config.size,shape:config.shape}},groupedModel=cell_creator_transformDataModel(datamodel,{facetsAndProjections:facetsAndProjections,suppliedLayers:valueCellContext.suppliedLayers,groupBy:groupBy},resolver);simpleEncoder.data(groupedModel);var cellCreator=resolver.valueCellsCreator(valueCellContext),valueMatrixInfo=matrix_model_getMatrixModel(groupedModel,facetsAndProjections,cellCreator,globalConfig);group_utils_removeExitCells(resolver),resolver.cacheMaps().exitCellMap.clear(),resolver.valueMatrix(valueMatrixInfo.matrix);var _mutateAxesFromMap=mutateAxesFromMap(resolver.cacheMaps(),resolver.axes()),xAxes=_mutateAxesFromMap.xAxes,yAxes=_mutateAxesFromMap.yAxes;resolver.axes({x:xAxes,y:yAxes}),resolver.createUnits(componentRegistry,config);var _generateMatrices=function generateMatrices(context,matrices,cells,labelManager){var unitHeight=context.unitHeight,unitWidth=context.unitWidth,facetsAndProjections=context.facetsAndProjections,normalizedRows=context.normalizedRows,normalizedColumns=context.normalizedColumns,selection=context.selection,axisFrom=context.axisFrom,facet=context.facet,encoders=context.encoders,resolver=context.resolver,selectionObj=cell_creator_generatePlaceholders({fields:{rows:normalizedRows,columns:normalizedColumns},matrices:matrices,facetsAndProjections:facetsAndProjections,selection:selection,axisFrom:axisFrom,facet:facet,encoders:encoders,resolver:resolver},cells,labelManager),columnsPrimary=selectionObj.columnsPrimary,columnsSecondary=selectionObj.columnsSecondary,rowsPrimary=selectionObj.rowsPrimary,rowsSecondary=selectionObj.rowsSecondary,leftHeaders=selectionObj.leftHeaders,topHeaders=selectionObj.topHeaders,bottomHeaders=selectionObj.bottomHeaders,rightHeaders=selectionObj.rightHeaders,_map2=cell_creator_slicedToArray([rowsPrimary,rowsSecondary,columnsPrimary,columnsSecondary].map(function(d){return d?d.getObjects():[]}),4),rowPrime=_map2[0],rowSec=_map2[1],colPrime=_map2[2],colSec=_map2[3],_map4=cell_creator_slicedToArray([leftHeaders,rightHeaders].map(function(e){return e?e.getObjects().map(function(f){return f.getObjects()}):[]}),2),leftFacets=_map4[0],rightFacets=_map4[1],rowPriority=rowSec.length?1:-1;rowPrime.length&&rowPriority++;var colPriority=colSec.length?1:-1;colPrime.length&&colPriority++;var leftMatrix=leftFacets.length?leftFacets.map(function(d,i){return rowPrime[i]=rowPrime[i]?[rowPrime[i]]:[],[].concat(cell_creator_toConsumableArray(d),cell_creator_toConsumableArray(rowPrime[i]))}):rowPrime?rowPrime.map(function(d){return[d]}):[],rightMatrix=rowSec.length?rowSec.map(function(d,i){return[d].concat(cell_creator_toConsumableArray(rightFacets[i]||[]))}):rightFacets.length?rightFacets.map(function(d){return cell_creator_toConsumableArray(d)}):[],topMatrix=[];topHeaders&&topHeaders.getObjects().forEach(function(e){e.getObjects().forEach(function(x,i){topMatrix[i]=topMatrix[i]||[],topMatrix[i].push(x)})});colPrime.length&&topMatrix.push(colPrime);var bottomMatrix=[];colSec.length&&bottomMatrix.push(colSec);var currentBottomLength=bottomMatrix.length;bottomHeaders&&bottomHeaders.getObjects().forEach(function(e){e.getObjects().forEach(function(x,i){bottomMatrix[i+currentBottomLength]=bottomMatrix[i+currentBottomLength]||[],bottomMatrix[i+currentBottomLength].push(x)})});if(!leftMatrix.length&&!rightMatrix.length){var cell=new cells.BlankCell;cell.setAvailableSpace(unitWidth,unitHeight),leftMatrix=[[cell]]}if(!(topMatrix.length||bottomMatrix.length&&bottomMatrix[0].length)){var _cell=new cells.BlankCell;_cell.setAvailableSpace(unitWidth,unitHeight),bottomMatrix=[[_cell]]}return{rows:[leftMatrix,rightMatrix],columns:[topMatrix,bottomMatrix],selectionObj:selectionObj,colPriority:colPriority,rowPriority:rowPriority}}(matrixGnContext,{valuesMatrix:valueMatrixInfo,axesMatrix:resolver.axes()},cells,labelManager),rows=_generateMatrices.rows,columns=_generateMatrices.columns,selectionObj=_generateMatrices.selectionObj,rowPriority=_generateMatrices.rowPriority,colPriority=_generateMatrices.colPriority;if(resolver.rowMatrix(rows),resolver.columnMatrix(columns),isFacet){var sanitizeCheckBorder=group_utils_sanitizeCheck(globalConfig.facetsUserConfig),arr=sanitizeCheckBorder&&function sanitiseBorderMatrix(matrices,blankCell){var leftMatrix=matrices.leftMatrix,rightMatrix=matrices.rightMatrix,topMatrix=matrices.topMatrix,bottomMatrix=matrices.bottomMatrix,bottomBorderObj={};return rightMatrix.length&&(bottomBorderObj=cell_border_applier_sanitiseFacetValues(rightMatrix,"".concat(constants_RIGHT),blankCell)),leftMatrix.length&&(bottomBorderObj=cell_border_applier_sanitiseFacetValues(leftMatrix,"".concat(constants_LEFT),blankCell)),topMatrix.length&&cell_border_applier_sanitiseHeaderMatrix(topMatrix),bottomMatrix.length&&cell_border_applier_sanitiseHeaderMatrix(bottomMatrix),bottomBorderObj}({leftMatrix:rows[0],rightMatrix:rows[1],topMatrix:columns[0],bottomMatrix:columns[1]},registry.cells.BlankCell);valueMatrixInfo.matrix=sanitizeCheckBorder&&function sanitiseGeomMatrix(matrices){for(var arr=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=0;i<matrices.length;i++)for(var j=0;j<matrices[0].length;j++)matrices[i][j].config({externalClassname:["".concat(NORMAL)]}),0===i?matrices[i][j].config().externalClassname.push("".concat(DARKER,"-").concat(enums_constants_TOP)):i===matrices.length-1&&matrices[i][j].config().externalClassname.push("".concat(DARKER,"-").concat(enums_constants_BOTTOM)),j===matrices[i].length-1&&matrices[i][j].config().externalClassname.push("".concat(DARK,"-").concat(constants_RIGHT)),arr[i]&&matrices[i-1][j].config().externalClassname.push("".concat(DARK,"-").concat(enums_constants_BOTTOM))}(valueMatrixInfo.matrix,arr)}return{rows:resolver.rowMatrix(),columns:resolver.columnMatrix(),values:resolver.valueMatrix(),isColumnSizeEqual:isColumnSizeEqual,isRowSizeEqual:isRowSizeEqual,priority:{row:rowPriority,col:colPriority},selection:selectionObj,dataModels:{groupedModel:groupedModel,parentModel:datamodel}}},RESOLVER_PROPS={dependencies:{},units:{},datamodelTransform:{},layerConfig:{},matrixLayers:{},colCells:{},rowCells:{},rowMatrix:{},columnMatrix:{},valueMatrix:{},encoder:{},valueParser:{},data:{},transformedData:{},store:{}};function matrix_resolver_slicedToArray(arr,i){return function matrix_resolver_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function matrix_resolver_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function matrix_resolver_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function matrix_resolver_toConsumableArray(arr){return function matrix_resolver_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function matrix_resolver_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function matrix_resolver_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function matrix_resolver_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var data_type_scale_map_dataTypeScaleMap,matrix_resolver_MatrixResolver=function(){function MatrixResolver(dependencies){!function matrix_resolver_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MatrixResolver),this._registry={},this._layerConfig=[],this._matrixLayers=[],this._dependencies=dependencies,this._rowMatrix=[],this._columnMatrix=[],this._valueMatrix=[],this._facets={rowFacets:[],colFacets:[]},this._projections={rowProjections:[],colProjections:[]},this._datamodelTransform={},this._units=[],this._cacheMaps={},this._fireboltDeps={},this._axes={x:{},y:{},color:[],size:[],shape:[],radius:[],angle:[],angle0:[]},this._placeholderInfo={},generateGetterSetters(this,this.constructor.getterSetters()),this.cacheMaps(initializeCacheMaps())}return function matrix_resolver_createClass(Constructor,protoProps,staticProps){return protoProps&&matrix_resolver_defineProperties(Constructor.prototype,protoProps),staticProps&&matrix_resolver_defineProperties(Constructor,staticProps),Constructor}(MatrixResolver,[{key:"registry",value:function registry(){var _this=this;return arguments.length?(Object.entries(arguments.length<=0?void 0:arguments[0]).forEach(function(val){_this._registry[val[0]]=val[1]}),this):this._registry}},{key:"cacheMaps",value:function cacheMaps(){for(var _this2=this,_len=arguments.length,maps=new Array(_len),_key=0;_key<_len;_key++)maps[_key]=arguments[_key];return maps.length?([CELL,X_AXES,Y_AXES,ENTRY_CELLS,EXIT_CELLS].forEach(function(e){_this2._cacheMaps["".concat(e,"Map")]=maps[0]["".concat(e,"Map")]||_this2._cacheMaps["".concat(e,"Map")]}),this):this._cacheMaps}},{key:"axes",value:function axes(){return arguments.length?(this._axes=Object.assign({},this._axes,arguments.length<=0?void 0:arguments[0]),this):this._axes}},{key:"facets",value:function facets(){var _this3=this;return arguments.length?(Object.entries(arguments.length<=0?void 0:arguments[0]).forEach(function(e){_this3._facets[e[0]]=e[1]}),this):this._facets}},{key:"projections",value:function projections(){var _this4=this;return arguments.length?(Object.entries(arguments.length<=0?void 0:arguments[0]).forEach(function(e){_this4._projections[e[0]]=e[1]}),this):this._projections}},{key:"optionalProjections",value:function optionalProjections(config,layerConfig,schema){var otherEncodings={},optionalProjections=[];[enums_constants_SIZE,enums_constants_COLOR,enums_constants_SHAPE].forEach(function(type){if(config[type]&&config[type].field){var enc=config[type];otherEncodings[type]=enc.field,optionalProjections.push(enc.field)}}),config[DETAIL]&&optionalProjections.push.apply(optionalProjections,matrix_resolver_toConsumableArray(config.detail));var encoder=this.encoder();return optionalProjections.push.apply(optionalProjections,matrix_resolver_toConsumableArray(encoder.getProjectionFields(layerConfig,schema))),this.projections({optionalProjections:optionalProjections}),otherEncodings}},{key:"horizontalAxis",value:function horizontalAxis(rows,encoder){return rows?(this._horizontalAxis=setFacetsAndProjections(this,{type:ROW,fields:rows},encoder),this):this._horizontalAxis}},{key:"verticalAxis",value:function verticalAxis(columns,encoder){return columns?(this._verticalAxis=setFacetsAndProjections(this,{type:COL,fields:columns},encoder),this):this._verticalAxis}},{key:"getCellDef",value:function getCellDef(cell){var registry=this.registry().cells;return Object.values(registry).forEach(function(e){e.prototype instanceof cell&&(cell=e)}),cell}},{key:"valueCellsCreator",value:function valueCellsCreator(context){return this.matrixLayers([]),function(datamodel,fieldInfo,facets){return cell_creator_createValueCells(context,datamodel,fieldInfo,facets)}}},{key:"forEach",value:function forEach(matrixType,callback){this[matrixType]().forEach(function(row,rIndex){row.forEach(function(col,cIndex){callback(rIndex,cIndex,col)})})}},{key:"getAllFields",value:function getAllFields(){var retObj=this.projections();return Object.entries(this.facets()).forEach(function(e){retObj[e[0]]=e[1]}),retObj}},{key:"resetSimpleAxes",value:function resetSimpleAxes(){return this.axes({x:new Set,y:new Set,radius:[],angle:[],angle0:[],pie:[]})}},{key:"setFireboltDependencies",value:function setFireboltDependencies(prop,deps){return Object.assign(this._fireboltDeps,function matrix_resolver_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},prop,deps)),this}},{key:"createUnits",value:function createUnits(componentRegistry,config){var _this5=this,globalConfig=config.globalConfig,alias=config.alias,coord=config.coord,layerRegistry=componentRegistry.layerRegistry,interactions=componentRegistry.interactions,_this$dependencies=this.dependencies(),smartLabel=_this$dependencies.smartlabel,lifeCycleManager=_this$dependencies.lifeCycleManager,throwback=_this$dependencies.throwback,fireboltDeps=this._fireboltDeps,units=[[]],unitConfig=group_utils_extractUnitConfig(globalConfig||{}),store=this.store();store.lockModel();var VisualUnit=this.registry().VisualUnit;return this.forEach(VALUE_MATRIX,function(i,j,el){var unit=el.source();if(!unit){var namespace="unit".concat(i,"-").concat(j,"-").concat(getUniqueId());(unit=VisualUnit.create({layerRegistry:layerRegistry,interactions:interactions},{smartLabel:smartLabel,lifeCycleManager:lifeCycleManager,throwback:throwback,fireboltDeps:fireboltDeps})).metaInf({rowIndex:i,colIndex:j,namespace:namespace}),unit.store(store),unit.coord(coord),el.source(unit)}!units[i]&&(units[i]=[]),units[i][j]=unit,unit.parentAlias(alias).valueParser(_this5.valueParser()).coord(coord),el.config(unitConfig)}),store.unlockModel(),lifeCycleManager.notify({client:units,action:INITIALIZED,formalName:UNIT}),this.units(units)}},{key:"setRetinalAxisDomain",value:function setRetinalAxisDomain(config,datamodel,encoders){var color=config.color,shape=config.shape,size=config.size,groupBy=config.globalConfig.autoGroupBy,_this$getAllFields=this.getAllFields(),rowFacets=_this$getAllFields.rowFacets,colFacets=_this$getAllFields.colFacets,encoding={color:color,shape:shape,size:size},facetFields=[].concat(matrix_resolver_toConsumableArray(rowFacets.map(function(e){return e.toString()})),matrix_resolver_toConsumableArray(colFacets.map(function(e){return e.toString()}))),retContext={domains:encoders.simpleEncoder.getRetinalFieldsDomain(datamodel,encoding,facetFields,groupBy),axes:this.getRetinalAxes(),encoding:encoding};return encoders.retinalEncoder.setCommonDomain(retContext),this}},{key:"resetFacetsAndProjections",value:function resetFacetsAndProjections(){return this._facets={},this._projections={},this}},{key:"getRetinalAxes",value:function getRetinalAxes(){var _this$axes=this.axes(),color=_this$axes.color,shape=_this$axes.shape,size=_this$axes.size;return{color:matrix_resolver_toConsumableArray(color),shape:matrix_resolver_toConsumableArray(shape),size:matrix_resolver_toConsumableArray(size)}}},{key:"getSimpleAxes",value:function getSimpleAxes(type){return this.axes()["".concat(type)]}},{key:"createRetinalAxes",value:function createRetinalAxes(fieldsConfig,config,encoders){var retinalAxes=encoders.retinalEncoder.createAxis({fieldsConfig:fieldsConfig,config:config,axes:this.axes()});return this.axes(retinalAxes),this.updateVisualUnit(config),this}},{key:"createHeaders",value:function createHeaders(placeholders,fieldNames,config){var bottomLeft=[],bottomRight=[],rows=placeholders.rows,columns=placeholders.columns,_this$dependencies2=this.dependencies(),labelManager=_this$dependencies2.smartlabel,lifeCycleManager=_this$dependencies2.lifeCycleManager,showHeaders=config.showHeaders,classPrefix=config.classPrefix,_this$registry$cells=this.registry().cells,TextCell=_this$registry$cells.TextCell,BlankCell=_this$registry$cells.BlankCell,_rows=matrix_resolver_slicedToArray(rows,2),leftRows=_rows[0],rightRows=_rows[1],_columns=matrix_resolver_slicedToArray(columns,2),topCols=_columns[0],bottomCols=_columns[1],rowHeaders=fieldNames.rows,blankCellCreator=function blankCellCreator(cell){return(new BlankCell).config({show:cell.config().show})},sanitizeCheckBorder=group_utils_sanitizeCheck(config.facetsUserConfig),headers={left:group_utils_headerCreator(leftRows,rowHeaders[0],showHeaders?TextCell:BlankCell,{classPrefix:classPrefix,labelManager:labelManager,sanitizeCheckBorder:sanitizeCheckBorder}),right:group_utils_headerCreator(rightRows,rowHeaders[1],showHeaders?TextCell:BlankCell,{classPrefix:classPrefix,labelManager:labelManager,sanitizeCheckBorder:sanitizeCheckBorder})},footers={left:leftRows.length>0?leftRows[0].map(blankCellCreator):[],right:rightRows.length>0?rightRows[0].map(blankCellCreator):[]},_map2=matrix_resolver_slicedToArray([constants_LEFT,constants_RIGHT].map(function(type){return topCols.map(function(col,i){return i===topCols.length-1?headers[type]:footers[type]})}),2),topLeft=_map2[0],topRight=_map2[1];if(0===topCols.length){var _map4=matrix_resolver_slicedToArray([constants_LEFT,constants_RIGHT].map(function(type){return bottomCols.map(function(col,i){return 0===i?headers[type]:footers[type]})}),2);bottomLeft=_map4[0],bottomRight=_map4[1]}else bottomLeft=bottomCols.map(function(){return leftRows.length>0?leftRows[0].map(blankCellCreator):[]}),bottomRight=bottomCols.map(function(){return rightRows.length>0?rightRows[0].map(blankCellCreator):[]});return lifeCycleManager.notify({client:[topLeft,topRight,bottomLeft,bottomRight],action:INITIALIZED,formalName:FACET_HEADERS}),{topLeft:topLeft,topRight:topRight,bottomLeft:bottomLeft,bottomRight:bottomRight}}},{key:"updateVisualUnit",value:function updateVisualUnit(retinalConfig){var retinalAxes=this.getRetinalAxes(),lifeCycleManager=this.dependencies().lifeCycleManager;lifeCycleManager.notify({client:this.axes(),action:INITIALIZED,formalName:AXIS}),lifeCycleManager.notify({client:this.units(),action:BEFORE_UPDATE,formalName:UNIT});var units=[],matrixLayers=this.matrixLayers(),props=["".concat(namespace_namespaceObject.LAYER_GLOBAL_NAMESPACE,".domain"),"".concat(namespace_namespaceObject.UNIT_GLOBAL_NAMESPACE,".domain")],store=this.store();return store.lockCommits(props),store.lockModel(),this.forEach(VALUE_MATRIX,function(i,j,el){el.axes(Object.assign(el.axes(),retinalAxes)),el.source()&&el.source().retinalFields(retinalConfig),el.layerDef(matrixLayers[i][j]),el.updateModel(),units.push(el.source())}),store.unlockModel().unlockCommits([props[0]]).unlockCommits([props[1]]),lifeCycleManager.notify({client:units,action:UPDATED,formalName:UNIT}),this}},{key:"getMatrices",value:function getMatrices(resolverConfig){return this._placeholderInfo=cell_creator_computeMatrices(resolverConfig),this._placeholderInfo}},{key:"clear",value:function clear(){var cacheMaps=this._cacheMaps;for(var key in cacheMaps)cacheMaps[key].clear()}}],[{key:"getterSetters",value:function getterSetters(){return RESOLVER_PROPS}}]),MatrixResolver}();function src_data_type_scale_map_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var src_data_type_scale_map_dataTypeScaleMap=(src_data_type_scale_map_defineProperty(data_type_scale_map_dataTypeScaleMap={},dist_datamodel.FieldType.DIMENSION,scale_type_namespaceObject.BAND),src_data_type_scale_map_defineProperty(data_type_scale_map_dataTypeScaleMap,dist_datamodel.DimensionSubtype.CATEGORICAL,scale_type_namespaceObject.BAND),src_data_type_scale_map_defineProperty(data_type_scale_map_dataTypeScaleMap,dist_datamodel.DimensionSubtype.TEMPORAL,scale_type_namespaceObject.TIME),src_data_type_scale_map_defineProperty(data_type_scale_map_dataTypeScaleMap,dist_datamodel.FieldType.MEASURE,scale_type_namespaceObject.LINEAR),src_data_type_scale_map_defineProperty(data_type_scale_map_dataTypeScaleMap,dist_datamodel.MeasureSubtype.CONTINUOUS,scale_type_namespaceObject.LINEAR),src_data_type_scale_map_defineProperty(data_type_scale_map_dataTypeScaleMap,dist_datamodel.DimensionSubtype.BINNED,scale_type_namespaceObject.BAND),data_type_scale_map_dataTypeScaleMap);function encoder_helper_toConsumableArray(arr){return function encoder_helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function encoder_helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function encoder_helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var getAdjustedDomain=function getAdjustedDomain(max,min){var y1ratio=max[0]/(max[0]-min[0]),y2ratio=max[1]/(max[1]-min[1]),allSameSign=!1;return min[0]>0&&min[1]>0&&min[1]>0&&max[1]>0&&(allSameSign=!0,min[0]=0,min[1]=0),min[0]<0&&min[1]<0&&min[1]<0&&max[1]<0&&(allSameSign=!0,max[0]=0,max[1]=0),allSameSign||y1ratio===y2ratio||(y1ratio<y2ratio?min[1]=min[0]/max[0]*max[1]:min[0]=min[1]/max[1]*max[0]),[[min[0],max[0]],[min[1],max[1]]]},encoder_helper_generateAxisFromMap=function generateAxisFromMap(axisType,fieldInfo,axesCreators,axesInfo,indices,facetFields){var axisKey,groupAxes=axesInfo.groupAxes,valueParser=axesInfo.valueParser,currentAxes=[],fields=fieldInfo.fields,index=fieldInfo.index,map=axesCreators.cacheMaps["".concat(axisType,"AxesMap")],commonAxisKey=getAxisKey(axisType,index);return fields.forEach(function(field,axisIndex){axisKey=getAxisKey(axisType,index,axisIndex,src_data_type_scale_map_dataTypeScaleMap[field.subtype()]);var axis,axisConfig=function getAxisConfig(axisInfo,field,axesCreators,indices,facetFields){var axisOrientation,index=axisInfo.index,axisIndex=axisInfo.axisIndex,axisType=axisInfo.axisType,config=axesCreators.config,position=axesCreators.position,rowIndex=indices.rowIndex,columnIndex=indices.columnIndex,rawUserAxisConfig=config.axes&&config.axes[axisType]||{},userAxisConfig=("function"!=typeof rawUserAxisConfig?function(){return rawUserAxisConfig}:rawUserAxisConfig)(rowIndex,columnIndex,{axisFields:field.getMembers(),facetFields:facetFields});if(!userAxisConfig)return{};axisOrientation=position===BOTH?(axisType===Y?[axis_orientation_namespaceObject.LEFT,axis_orientation_namespaceObject.RIGHT]:[axis_orientation_namespaceObject.TOP,axis_orientation_namespaceObject.BOTTOM])[axisIndex]:position;var axisConfig={id:"".concat(axisType,"-").concat(index,"-").concat(axisIndex),name:field.displayName(),field:field.toString(),numberFormat:field.numberFormat(),orientation:axisOrientation,showAxisName:!0,show:!0,type:src_data_type_scale_map_dataTypeScaleMap[field.subtype()]};return userAxisConfig.tickValues=field.format(userAxisConfig.tickValues),userAxisConfig.domain=field.format(userAxisConfig.domain),mergeRecursive(axisConfig,userAxisConfig)}({index:index,axisIndex:axisIndex,axisType:axisType},field,axesCreators,indices,facetFields);map.has(axisKey)?((axis=map.get(axisKey))._rotationLock=!1,axis.config(axisConfig)):axis=function createSimpleAxis(axisConfig,field,axesCreators){var labelManager=axesCreators.labelManager;return new(0,scaleMaps[src_data_type_scale_map_dataTypeScaleMap[field.subtype()]])(axisConfig,{labelManager:labelManager})}(axisConfig,field,axesCreators),axis.valueParser(valueParser),currentAxes.push(axis),map.set(axisKey,axis)}),currentAxes.length&&(map.set(commonAxisKey,currentAxes),groupAxes.add(commonAxisKey)),currentAxes},encoder_helper_sanitizeIndividualLayerConfig=function sanitizeIndividualLayerConfig(encodingConfigs,def){[enums_constants_COLOR,enums_constants_SHAPE,enums_constants_SIZE].forEach(function(axis){encodingConfigs[axis]&&encodingConfigs[axis].field&&def.forEach(function(conf){conf.encoding=conf.encoding||{},!conf.encoding[axis]&&(conf.encoding[axis]={}),conf.encoding[axis].field=encodingConfigs[axis].field})})},encoder_helper_mutateAxesFromMap=function mutateAxesFromMap(cacheMaps,axes){var xAxesMap=cacheMaps.xAxesMap,yAxesMap=cacheMaps.yAxesMap,xAxisSet=axes.x,yAxisSet=axes.y,xAxes=[],yAxes=[];return xAxisSet.forEach(function(axisId){var xAxis=xAxesMap.get(axisId);xAxes.push(xAxis)}),yAxisSet.forEach(function(axisId){var yAxis=yAxesMap.get(axisId);yAxes.push(yAxis)}),{xAxes:xAxes,yAxes:yAxes}},encoder_helper_getDefaultMark=function getDefaultMark(colFieldType,rowFieldType){return colFieldType===constants_CATEGORICAL||rowFieldType===constants_CATEGORICAL?BAR:colFieldType===constants_TEMPORAL||rowFieldType===constants_TEMPORAL?LINE:POINT},encoder_helper_createRetinalAxis=function createRetinalAxis(axesCreators){var fieldProps=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},axisType=axesCreators.axisType,fieldsConfig=axesCreators.fieldsConfig,field=fieldProps.field,axis=[],Cls=scaleMaps[axisType];return fieldProps.type=fieldProps.type?fieldProps.type:group_utils_getAxisType(fieldsConfig,field||null),axis.push(new Cls(fieldProps)),axis},getIndex=function getIndex(arr,val){for(var i=0,arrIndex=-1;-1===arrIndex&&i<arr.length;)arr[i].toString()===val.toString()&&(arrIndex=i),i++;return arrIndex},getLayerConfFromFields=function getLayerConfFromFields(colFields,rowFields,userLayerConfig){return userLayerConfig.filter(function(conf){var _ref,_ref2,_ref3,userConf=conf instanceof Array?conf:[conf],encodingArr=(_ref=[]).concat.apply(_ref,encoder_helper_toConsumableArray(userConf.map(function(d){return d.encoding}).filter(function(d){return void 0!==d})));if(!encodingArr.length)return!0;var xFields=(_ref2=[]).concat.apply(_ref2,encoder_helper_toConsumableArray(encodingArr.map(function(d){return[d.x&&d.x.field,d.x0&&d.x0.field]}))).filter(function(d){return void 0!==d&&null!==d}),yFields=(_ref3=[]).concat.apply(_ref3,encoder_helper_toConsumableArray(encodingArr.map(function(d){return[d.y&&d.y.field,d.y0&&d.y0.field]}))).filter(function(d){return void 0!==d&&null!==d});if(!xFields.length&&!yFields.length)return!0;var colFieldExist=!!xFields.length&&xFields.every(function(d){return-1!==colFields.indexOf(d)}),rowFieldExist=!!yFields.length&&yFields.every(function(d){return-1!==rowFields.indexOf(d)});return xFields.length&&yFields.length?colFieldExist&&rowFieldExist:colFieldExist||rowFieldExist})},encoder_helper_resolveAxisConfig=function resolveAxisConfig(context,fieldInf,axisInfo){var rowIndex=axisInfo.rowIndex,columnIndex=axisInfo.columnIndex,axesObj=axisInfo.axesObj,config=context.config,facetFields=context.facetFields,resolverAxes=context.resolver.axes();[ENCODING.RADIUS,ENCODING.ANGLE,ANGLE0].forEach(function(enc){var axesArr=resolverAxes[enc];axesArr[rowIndex]||(axesArr[rowIndex]=[]),axesArr[rowIndex][columnIndex]=axesObj[enc];var axisConfig=getObjProp(config.axes,enc)||{};axesObj[enc].forEach(function(axis,i){var userConfig=axisConfig;axisConfig instanceof Function&&(userConfig=axisConfig(rowIndex,columnIndex,{axisFields:[fieldInf[enc][i]],facetFields:facetFields})),axis.config(userConfig)})})},getSortingConfig=function getSortingConfig(context,currentFieldName,axesConfig){var config=context.config(),dataModel=context.data(),lastSortConfig=null;if(0!==Object.keys(config.sort).length)return config.sort[currentFieldName];for(var operations=[].concat(encoder_helper_toConsumableArray(dataModel.getAncestorDerivations()),encoder_helper_toConsumableArray(dataModel.getDerivations()));(lastSortConfig=operations.pop())&&"sort"!==lastSortConfig.op;);return lastSortConfig&&lastSortConfig.criteria.length&&lastSortConfig.criteria[0][0]===currentFieldName?lastSortConfig.criteria[0][1]:axesConfig().defaultSort};function cartesian_encoder_typeof(obj){"@babel/helpers - typeof";return(cartesian_encoder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function cartesian_encoder_toConsumableArray(arr){return function cartesian_encoder_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function cartesian_encoder_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function cartesian_encoder_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function cartesian_encoder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function cartesian_encoder_possibleConstructorReturn(self,call){return!call||"object"!==cartesian_encoder_typeof(call)&&"function"!=typeof call?function cartesian_encoder_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function cartesian_encoder_get(target,property,receiver){return(cartesian_encoder_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function cartesian_encoder_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=cartesian_encoder_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function cartesian_encoder_getPrototypeOf(o){return(cartesian_encoder_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function cartesian_encoder_setPrototypeOf(o,p){return(cartesian_encoder_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _axesCls,cartesian_encoder_CARTESIAN=COORD_TYPES.CARTESIAN,cartesian_encoder_CartesianEncoder=function(_VisualEncoder){function CartesianEncoder(){return function cartesian_encoder_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CartesianEncoder),cartesian_encoder_possibleConstructorReturn(this,cartesian_encoder_getPrototypeOf(CartesianEncoder).apply(this,arguments))}return function cartesian_encoder_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&cartesian_encoder_setPrototypeOf(subClass,superClass)}(CartesianEncoder,visual_encoder_VisualEncoder),function cartesian_encoder_createClass(Constructor,protoProps,staticProps){return protoProps&&cartesian_encoder_defineProperties(Constructor.prototype,protoProps),staticProps&&cartesian_encoder_defineProperties(Constructor,staticProps),Constructor}(CartesianEncoder,[{key:"createAxis",value:function createAxis(axesCreators,fieldInfo,context){var _this=this,geomCellAxes={},axes=axesCreators.axes,projections=fieldInfo.projections,indices=fieldInfo.indices,rowFields=projections.rowFields,columnFields=projections.columnFields,axisFields=[{fields:rowFields,index:indices.rowIndex},{fields:columnFields,index:indices.columnIndex}],resolver=context.resolver,facetFields=context.facetFields,geomCell=context.geomCell,xAxes=axes.x||[],yAxes=axes.y||[];return[rowFields,columnFields].forEach(function(fields,i){var type=0===i?ROW:COLUMN,axis=0===i?Y:X;fields.length>1?axesCreators.position=BOTH:axesCreators.position=_this.axisFrom()[type],geomCellAxes[axis]=encoder_helper_generateAxisFromMap(axis,axisFields[i],axesCreators,{groupAxes:axis===X?xAxes:yAxes,valueParser:resolver.valueParser()},indices,facetFields)}),geomCell.axes(geomCellAxes),geomCellAxes}},{key:"unionUnitDomains",value:function unionUnitDomains(context){for(var store=context.store(),resolver=context.resolver(),units=resolver.units(),domains={0:{},1:{}},fieldsObj={0:{},1:{}},_loop=function _loop(rIdx,len){for(var unitsArr=units[rIdx],_loop2=function _loop2(cIdx,len2){var unit=unitsArr[cIdx],axisFields=unit.fields(),encodingDomains=unit.dataDomain();["x","y"].forEach(function(axisType,axisTypeIndex){axisFields[axisType].forEach(function(field,axisIndex){var key=axisTypeIndex?"".concat(rIdx,"0").concat(axisIndex):"0".concat(cIdx).concat(axisIndex),dom=encodingDomains[axisType],typeOfField=field.subtype();fieldsObj[axisTypeIndex][key]=field,dom&&0!==Object.keys(dom).length&&(domains[axisTypeIndex][key]=unionDomain([domains[axisTypeIndex]&&domains[axisTypeIndex][key]||[],dom["".concat(field)]],typeOfField))})})},cIdx=0,len2=unitsArr.length;cIdx<len2;cIdx++)_loop2(cIdx)},rIdx=0,len=units.length;rIdx<len;rIdx++)_loop(rIdx);var _resolver$axes=resolver.axes(),xAxes=_resolver$axes.x,yAxes=_resolver$axes.y;store.lockModel(),[xAxes,yAxes].forEach(function(axesArr,axisType){axesArr.forEach(function(axes,idx){var key,domain=[],adjustedDomain=[],min=[],max=[],typeOfAxis=axes[0].constructor.type();if(axes.length>1&&typeOfAxis===scale_type_namespaceObject.LINEAR&&axes[0].config().alignZeroLine)axes.forEach(function(axis,i){key=axisType?"".concat(idx,"0").concat(i):"0".concat(idx).concat(i),domain=domains[axisType][key],min[i]=domain[0],max[i]=domain[1]}),adjustedDomain=getAdjustedDomain(max,min);else if(typeOfAxis===scale_type_namespaceObject.BAND){key=axisType?"".concat(idx,"00"):"0".concat(idx,"0");var currentFieldName=fieldsObj[axisType][key].oneVar(),sortingOrder=getSortingConfig(context,currentFieldName,axes[0].config);sortingOrder&&domains[axisType][key]instanceof Array&&domains[axisType][key].sort(function(a,b){return sortCategoricalField(sortingOrder,a,b)})}axes.forEach(function(axis,index){key=axisType?"".concat(idx,"0").concat(index):"0".concat(idx).concat(index),(domain=adjustedDomain[index]||domains[axisType][key])&&axis.domain(domain);var type=axisType?"y":"x";store.commit("".concat(namespace_namespaceObject.GROUP_GLOBAL_NAMESPACE,".domain.").concat(type),domain,"".concat(idx).concat(index))})})}),store.unlockModel()}},{key:"getFacetsAndProjections",value:function getFacetsAndProjections(fields,type){for(var facets=[],projections=[],counter=0,primaryFacets=[],secondaryFacets=[],primaryFields=fields[0],secondaryFields=fields[1],primaryLen=primaryFields.length,secondaryLen=secondaryFields.length,axisFrom=this.axisFrom(),i=0;i<primaryLen;i++){var projArr=[primaryFields[i]],primaryField=primaryFields[i];if(primaryField.type()===MEASURE){var secondaryField=secondaryFields[counter];secondaryField&&secondaryField.type()===MEASURE&&(counter++,projArr=[primaryField,secondaryField]),projections.push(projArr)}else facets.push(primaryField),primaryFacets.push(primaryField)}if(secondaryLen>counter)for(var _i=counter;_i<secondaryLen;_i++){var _secondaryField=secondaryFields[_i],_projArr=[_secondaryField];_secondaryField.type()===MEASURE?projections.push(_projArr):(facets.push(_secondaryField),secondaryFacets.push(_secondaryField))}if((primaryFacets.length||secondaryFacets.length)&&!projections.length)if(axisFrom[type=type===COL?COLUMN:type]!==constants_LEFT&&axisFrom[type]!==enums_constants_TOP||!primaryFacets.length){var _facet=secondaryFacets[0];projections=[[_facet]];var _existIndex=getIndex(primaryFacets,_facet);_existIndex>-1&&(projections=[[_facet,_facet]],primaryFacets.splice(_existIndex,1)),secondaryFacets.splice(0,1)}else{var axisFromIndex=primaryFacets.length-1,facet=primaryFacets[axisFromIndex];projections=[[facet]];var existIndex=getIndex(secondaryFacets,facet);existIndex>-1&&(projections=[[facet,facet]],secondaryFacets.splice(existIndex,1)),primaryFacets.splice(axisFromIndex,1)}return{facets:facets=(facets=[].concat(primaryFacets,secondaryFacets)).filter(function(el,index,self){return index===self.findIndex(function(t){return t.toString()===el.toString()})}),projections:projections}}},{key:"fieldSanitizer",value:function fieldSanitizer(datamodel,config){return cartesian_encoder_get(cartesian_encoder_getPrototypeOf(CartesianEncoder.prototype),"fieldSanitizer",this).call(this,datamodel,config)}},{key:"getRetinalFieldsDomain",value:function getRetinalFieldsDomain(dataModels,encoding){var groupedModel=dataModels.groupedModel,domains={};for(var key in encoding)if({}.hasOwnProperty.call(encoding,key)){var encodingObj=encoding[key],field=encodingObj.field;if(!encodingObj.domain&&field){var domain=retriveDomainFromData(groupedModel,field),fieldInstance=groupedModel.getFieldspace().fieldsObj()[field];fieldInstance.schema().subtype===constants_TEMPORAL&&(domain=fieldInstance.data()),domains[field]=domain}}return domains}},{key:"serializeLayerConfig",value:function serializeLayerConfig(layerArray){var serializedLayers=[];return layerArray.length&&layerArray.forEach(function(layer,i){var def=src_layer_factory.sanitizeLayerConfig(layer);def.order=i,serializedLayers.push(def)}),serializedLayers}},{key:"sanitizeLayerConfig",value:function sanitizeLayerConfig(encodingConfigs,userLayerConfig){var layerConfig=[];return userLayerConfig.forEach(function(config){var def=toArray(config.def);encoder_helper_sanitizeIndividualLayerConfig(encodingConfigs,def),layerConfig.push(config)}),layerConfig}},{key:"getLayerConfig",value:function getLayerConfig(fields,userLayerConfig,retinalConfig){var layerConfig=[],columnFields=fields.columnFields,rowFields=fields.rowFields;return columnFields.forEach(function(colField){var colFieldName=colField.toString();rowFields.forEach(function(rowField){var configs=[],rowFieldName=rowField.toString(),encoding={x:{field:colFieldName},y:{field:rowFieldName}},rowFieldType=rowField.subtype(),colFieldType=colField.subtype(),mark=encoder_helper_getDefaultMark(colFieldType,rowFieldType),defConfigs=[{mark:mark,def:{mark:mark,encoding:encoding}}],layerConfigs=getLayerConfFromFields(colField.getMembers(),rowField.getMembers(),userLayerConfig||[]);configs=layerConfigs.length?layerConfigs.map(function(layerConf){var mergedLayerConf=mergeRecursive(mergeRecursive({},defConfigs[0].def),layerConf),serializedLayerConfig=src_layer_factory.getSerializedConf(mergedLayerConf.mark,mergedLayerConf);return{mark:mergedLayerConf.mark,order:mergedLayerConf.order,def:serializedLayerConfig}}):defConfigs,layerConfig.push.apply(layerConfig,cartesian_encoder_toConsumableArray(configs))})}),this.sanitizeLayerConfig(retinalConfig,layerConfig)}},{key:"hasMandatoryFields",value:function hasMandatoryFields(fields){var colProjections=fields.colProjections,rowProjections=fields.rowProjections,colFields=cartesian_encoder_get(cartesian_encoder_getPrototypeOf(CartesianEncoder.prototype),"hasMandatoryFields",this).call(this,{colProjections:colProjections}),rowFields=cartesian_encoder_get(cartesian_encoder_getPrototypeOf(CartesianEncoder.prototype),"hasMandatoryFields",this).call(this,{rowProjections:rowProjections});return colFields&&rowFields}}],[{key:"type",value:function type(){return cartesian_encoder_CARTESIAN}}]),CartesianEncoder}();function polar_encoder_typeof(obj){"@babel/helpers - typeof";return(polar_encoder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function polar_encoder_toConsumableArray(arr){return function polar_encoder_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function polar_encoder_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function polar_encoder_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function polar_encoder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function polar_encoder_possibleConstructorReturn(self,call){return!call||"object"!==polar_encoder_typeof(call)&&"function"!=typeof call?function polar_encoder_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function polar_encoder_get(target,property,receiver){return(polar_encoder_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function polar_encoder_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=polar_encoder_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function polar_encoder_getPrototypeOf(o){return(polar_encoder_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function polar_encoder_setPrototypeOf(o,p){return(polar_encoder_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function polar_encoder_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var polar_encoder_POLAR=COORD_TYPES.POLAR,polar_encoder_RADIUS=ENCODING.RADIUS,polar_encoder_ANGLE=ENCODING.ANGLE,polar_encoder_ANGLE0=ENCODING.ANGLE0,axesCls=(polar_encoder_defineProperty(_axesCls={},polar_encoder_RADIUS,radius_axis_RadiusAxis),polar_encoder_defineProperty(_axesCls,polar_encoder_ANGLE,angle_axis_AngleAxis),polar_encoder_defineProperty(_axesCls,polar_encoder_ANGLE0,angle_axis_AngleAxis),_axesCls),polar_encoder_PolarEncoder=function(_VisualEncoder){function PolarEncoder(){return function polar_encoder_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PolarEncoder),polar_encoder_possibleConstructorReturn(this,polar_encoder_getPrototypeOf(PolarEncoder).apply(this,arguments))}return function polar_encoder_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&polar_encoder_setPrototypeOf(subClass,superClass)}(PolarEncoder,visual_encoder_VisualEncoder),function polar_encoder_createClass(Constructor,protoProps,staticProps){return protoProps&&polar_encoder_defineProperties(Constructor.prototype,protoProps),staticProps&&polar_encoder_defineProperties(Constructor,staticProps),Constructor}(PolarEncoder,[{key:"createAxis",value:function createAxis(axesCreators,fieldInfo,context){var geomCellAxes=axesCreators.axes,indices=fieldInfo.indices,rowIndex=indices.rowIndex,columnIndex=indices.columnIndex,pieAxes=geomCellAxes.pie||[];pieAxes[rowIndex]=pieAxes[rowIndex]||[],pieAxes[rowIndex][columnIndex]=[];var axesObj={},geomCell=context.geomCell,resolver=context.resolver,layers=resolver.matrixLayers(),resolverAxes=resolver.axes(),fields={radius:{},angle:{},angle0:{}};layers[rowIndex][columnIndex].forEach(function(layerConf){var def=layerConf.def;[polar_encoder_ANGLE,polar_encoder_ANGLE0,polar_encoder_RADIUS].forEach(function(enc){var field=getObjProp(def.encoding,enc,"field");field&&(fields[enc][field]=0)})});var fieldInf={},varInstances={},_loop=function _loop(encType){fieldInf[encType]=Object.keys(fields[encType]),axesObj[encType]=[],varInstances[encType]=[],fieldInf[encType].forEach(function(field,i){varInstances[encType][i]=new simple_var_SimpleVariable(field),axesObj[encType][i]=new axesCls[encType]}),axesObj[encType][axesObj[encType].length]=new axesCls[encType]};for(var encType in fields)_loop(encType);return encoder_helper_resolveAxisConfig(context,fieldInf,{axesObj:axesObj,rowIndex:rowIndex,columnIndex:columnIndex}),geomCell.axes(axesObj).fields(Object.assign({},varInstances,geomCell.fields())),resolverAxes.pie=pieAxes,geomCellAxes}},{key:"getFacetsAndProjections",value:function getFacetsAndProjections(fields){for(var counter=0,facets=[],projections=[],primaryFields=fields[0],secondaryFields=fields[1],primaryLen=primaryFields.length,secondaryLen=secondaryFields.length,i=0;i<primaryLen;i++){var primaryField=primaryFields[i];if(primaryField.type()===MEASURE){var secondaryField=secondaryFields[counter++],projArr=secondaryField?[primaryField,secondaryField]:[primaryField];projections.push(projArr)}else facets.push(primaryField)}if(secondaryLen>counter)for(var _i=counter;_i<secondaryLen;_i++){var _secondaryField=secondaryFields[_i],_projArr=[_secondaryField];_secondaryField.type()===MEASURE?projections.push(_projArr):facets.push(_secondaryField)}return{facets:facets,projections:projections}}},{key:"unionUnitDomains",value:function unionUnitDomains(context){var store=context.store();store.lockModel();var domainProps={radius:[],angle:[],angle0:[]},axes=context.resolver().axes();context.matrixInstance().value.each(function(cell,rIdx,cIdx){var unit=cell.valueOf(),unitDomains=unit.dataDomain(),fields=unit.fields();!function setRadiusFactor(context){var data=context.data(),sizeField=context.retinalFields().size.field,_context$axes=context.axes(),radius=_context$axes.radius,size=_context$axes.size;if(sizeField&&radius&&radius.length){var sizeFieldIndex=data.getFieldsConfig()[sizeField].index,sizeMultiplier=function getSizeMultiplier(sizeVal,sizeAxis){var sizeAxisDomain=sizeAxis.domain();return sizeAxis.getSize(sizeVal)/(sizeAxisDomain?sizeAxis.range()[1]:sizeAxis.config().value)}(data.getData().data.reduce(function(acc,val){return acc+val[sizeFieldIndex]},1),size[0]);radius.forEach(function(axis){return axis.setRadiusFactor(sizeMultiplier)})}}(unit),[polar_encoder_RADIUS,polar_encoder_ANGLE,polar_encoder_ANGLE0].forEach(function(encType){var encodingFields=fields[encType],domains=unitDomains[encType]||{};encodingFields.forEach(function(field,i){!domainProps[encType][rIdx]&&(domainProps[encType][rIdx]=[]),!domainProps[encType][rIdx][cIdx]&&(domainProps[encType][rIdx][cIdx]=[]),domainProps[encType][rIdx][cIdx][i]=domains["".concat(field)]||[]})})});var _loop2=function _loop2(key){axes[key].forEach(function(axesArr,rIdx){axesArr.forEach(function(axisArr,cIdx){axisArr.forEach(function(axis,i){axis.domain(defaultValue(getObjProp(domainProps[key],rIdx,cIdx,i),[])),store.commit("".concat(namespace_namespaceObject.GROUP_GLOBAL_NAMESPACE,".domain.").concat(key),domainProps[key],"".concat(rIdx,"-").concat(cIdx))})})})};for(var key in domainProps)_loop2(key);store.unlockModel()}},{key:"setCommonDomain",value:function setCommonDomain(){return this}},{key:"layers",value:function layers(){return arguments.length?(this._layers=arguments.length<=0?void 0:arguments[0],this):this._layers}},{key:"fieldSanitizer",value:function fieldSanitizer(datamodel,config){var sanitizedRows=[[],[]],sanitizedColumns=[[],[]],fields=polar_encoder_get(polar_encoder_getPrototypeOf(PolarEncoder.prototype),"fieldSanitizer",this).call(this,datamodel,config),layers=config.layers,rows=fields.rows,columns=fields.columns,encoding=layers[0].encoding,radius=encoding&&encoding.radius?encoding.radius.field:null,angle=encoding&&encoding.angle?encoding.angle.field:null,sanitizedFields=[sanitizedRows,sanitizedColumns];return[rows,columns].forEach(function(fieldType,typeIndex){fieldType.forEach(function(fieldSet,i){return fieldSet.forEach(function(field){field.toString()!==radius&&field.toString()!==angle&&field.type()!==MEASURE&&sanitizedFields[typeIndex][i].push(field)})})}),sanitizedColumns=polar_encoder_toConsumableArray(new Set(sanitizedColumns)),sanitizedRows=polar_encoder_toConsumableArray(new Set(sanitizedRows)),this.fieldInfo({rows:sanitizedRows,columns:sanitizedColumns}),this.fieldInfo()}},{key:"getRetinalFieldsDomain",value:function getRetinalFieldsDomain(dataModels,encoding,facetFields,groupBy){var sizeField,colorField,fields=[],layers=this.layers(),dataModel=dataModels.groupedModel,fieldsConfig=dataModel.getFieldsConfig(),domains={};if(layers&&layers[0]){var layerEncoding=layers[0].def.encoding||{};[polar_encoder_RADIUS,polar_encoder_ANGLE,enums_constants_SIZE,enums_constants_COLOR].forEach(function(encType){var field=layerEncoding[encType]?layerEncoding[encType].field:"",measureField=fieldsConfig[field]&&fieldsConfig[field].def.type===MEASURE;encType===enums_constants_SIZE&&measureField&&(sizeField=field),encType===enums_constants_COLOR&&(colorField=field),fieldsConfig[field]&&!measureField&&fields.push(field)})}if(sizeField&&(domains[sizeField]=dataModel.groupBy(facetFields,polar_encoder_defineProperty({},sizeField,dist_datamodel.GROUP_BY_FUNCTIONS.SUM)).getFieldspace().fieldsObj()[sizeField].domain()),colorField){var dm=dataModel.groupBy([].concat(polar_encoder_toConsumableArray(facetFields),fields),groupBy.measures);domains[colorField]=dm.getFieldspace().fieldsObj()[colorField].domain()}return domains}},{key:"getLayerConfig",value:function getLayerConfig(fields,userLayerConfig,retinalConfig){var layerConfig=[],columnFields=fields.columnFields,rowFields=fields.rowFields;[].concat(polar_encoder_toConsumableArray(columnFields),polar_encoder_toConsumableArray(rowFields)).forEach(function(){var config={mark:ARC,def:{encoding:{}}};userLayerConfig&&userLayerConfig.length>0&&(config=mergeRecursive(config,userLayerConfig[0])),layerConfig.push(config)}),0===layerConfig.length&&(layerConfig=userLayerConfig);var sanitizedConfig=this.sanitizeLayerConfig(retinalConfig,layerConfig);return this.layers(sanitizedConfig),sanitizedConfig}},{key:"serializeLayerConfig",value:function serializeLayerConfig(layerArray){var serializedLayers=[];return layerArray.length&&layerArray.forEach(function(layer){var def=src_layer_factory.getSerializedConf(layer.mark,layer);serializedLayers.push({mark:layer.mark,def:def})}),serializedLayers}},{key:"sanitizeLayerConfig",value:function sanitizeLayerConfig(encodingConfigs,userLayerConfig){var layerConfig=[];return userLayerConfig.forEach(function(config){var def=toArray(config.def);encoder_helper_sanitizeIndividualLayerConfig(encodingConfigs,def),def.forEach(function(conf){var encoding=conf.encoding||(conf.encoding={});!encoding.angle&&(encoding.angle={});var angleField=getObjProp(encoding.angle,"field"),angle0Field=getObjProp(encoding.angle0,"field");angleField||Object.assign(encoding.angle,{field:encodingConfigs.color&&encodingConfigs.color.field}),angle0Field||(!encoding.angle0&&(encoding.angle0={}),Object.assign(encoding.angle0,{field:encoding.angle.field}))}),layerConfig.push(config)}),layerConfig}},{key:"hasMandatoryFields",value:function hasMandatoryFields(fields){var optionalProjections=fields.optionalProjections;return polar_encoder_get(polar_encoder_getPrototypeOf(PolarEncoder.prototype),"hasMandatoryFields",this).call(this,{optionalProjections:optionalProjections})}}],[{key:"type",value:function type(){return polar_encoder_POLAR}}]),PolarEncoder}();function retinal_encoder_typeof(obj){"@babel/helpers - typeof";return(retinal_encoder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function retinal_encoder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function retinal_encoder_possibleConstructorReturn(self,call){return!call||"object"!==retinal_encoder_typeof(call)&&"function"!=typeof call?function retinal_encoder_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function retinal_encoder_getPrototypeOf(o){return(retinal_encoder_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function retinal_encoder_setPrototypeOf(o,p){return(retinal_encoder_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _CONFIG$ROWS$COLUMNS$,retinal_encoder_RetinalEncoder=function(_VisualEncoder){function RetinalEncoder(){return function retinal_encoder_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RetinalEncoder),retinal_encoder_possibleConstructorReturn(this,retinal_encoder_getPrototypeOf(RetinalEncoder).apply(this,arguments))}return function retinal_encoder_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&retinal_encoder_setPrototypeOf(subClass,superClass)}(RetinalEncoder,visual_encoder_VisualEncoder),function retinal_encoder_createClass(Constructor,protoProps,staticProps){return protoProps&&retinal_encoder_defineProperties(Constructor.prototype,protoProps),staticProps&&retinal_encoder_defineProperties(Constructor,staticProps),Constructor}(RetinalEncoder,[{key:"createAxis",value:function createAxis(axesCreators){var fieldsConfig=axesCreators.fieldsConfig,config=axesCreators.config,newAxes={};return[enums_constants_COLOR,enums_constants_SHAPE,enums_constants_SIZE].forEach(function(axisType){newAxes["".concat(axisType)]=encoder_helper_createRetinalAxis({axisType:axisType,fieldsConfig:fieldsConfig},config[axisType])}),newAxes}},{key:"setCommonDomain",value:function setCommonDomain(context){var domains=context.domains,axes=context.axes,encoding=context.encoding;return Object.entries(encoding).forEach(function(enc){if(enc[1]&&enc[1].field){var encType=enc[0],field=enc[1].field;field&&axes[encType].forEach(function(axis){var domain=domains[field];!enc[1].domain&&axis.updateDomain(domain)})}}),axes}}],[{key:"type",value:function type(){return"retinal"}}]),RetinalEncoder}();function visual_group_local_options_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var visual_group_local_options=(visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$={},constants_CONFIG,{}),visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$,ROWS,{}),visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$,COLUMNS,{}),visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$,enums_constants_COLOR,{}),visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$,enums_constants_SHAPE,{}),visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$,enums_constants_SIZE,{}),visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$,DETAIL,{}),visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$,LAYERS,{}),visual_group_local_options_defineProperty(_CONFIG$ROWS$COLUMNS$,TRANSFORM,{}),_CONFIG$ROWS$COLUMNS$);function simple_group_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var simple_group=function(){function SimpleGroup(){!function simple_group_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SimpleGroup)}return function simple_group_createClass(Constructor,protoProps,staticProps){return protoProps&&simple_group_defineProperties(Constructor.prototype,protoProps),staticProps&&simple_group_defineProperties(Constructor,staticProps),Constructor}(SimpleGroup,[{key:"data",value:function data(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"config",value:function config(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"serialize",value:function serialize(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"measurement",value:function measurement(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}}]),SimpleGroup}();function value_matrix_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var value_matrix=function(){function ValueMatrix(matrixArr){!function value_matrix_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ValueMatrix);var instancesById={};this.matrix(matrixArr||[]),this.filter(function(){return!0}),this.each(function(el,rIdx,cIdx){var cellValue=el.valueOf();if(cellValue&&cellValue.id){var id=cellValue.id();instancesById[id]={instance:cellValue,rowIndex:rIdx,colIndex:cIdx}}}),this.instancesById(instancesById)}return function value_matrix_createClass(Constructor,protoProps,staticProps){return protoProps&&value_matrix_defineProperties(Constructor.prototype,protoProps),staticProps&&value_matrix_defineProperties(Constructor,staticProps),Constructor}(ValueMatrix,[{key:"instancesById",value:function instancesById(){return arguments.length?(this._instancesById=arguments.length<=0?void 0:arguments[0],this):this._instancesById}},{key:"matrix",value:function matrix(){return arguments.length?(this._matrix=arguments.length<=0?void 0:arguments[0],this):this._matrix}},{key:"filter",value:function filter(){return arguments.length?(this._filterFn=arguments.length<=0?void 0:arguments[0],this):this._filterFn}},{key:"width",value:function width(){var rowWidth=0;return this.matrix().forEach(function(row){var currentRowWidth=0;row.forEach(function(cell){currentRowWidth+=cell.getLogicalSpace().width}),rowWidth=Math.max(rowWidth,currentRowWidth)}),rowWidth}},{key:"height",value:function height(){var rowHeight=0;return this.matrix().forEach(function(row){var currentRowHeight=0;row.forEach(function(cell){currentRowHeight=Math.max(currentRowHeight,cell.getLogicalSpace().height)}),rowHeight+=currentRowHeight}),rowHeight}},{key:"each",value:function each(fn){var matrix=this.matrix(),filterFn=this.filter();return matrix.forEach(function(row,rIndex){row.forEach(function(col,cIndex){filterFn(col)&&fn(col,rIndex,cIndex,matrix)})}),this}},{key:"findPlaceHolderById",value:function findPlaceHolderById(id){return this.instancesById()[id]}},{key:"clear",value:function clear(){this.each(function(cell){return cell.remove()}),this.matrix([])}},{key:"data",value:function data(){}}]),ValueMatrix}();function visual_group_helper_slicedToArray(arr,i){return function visual_group_helper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function visual_group_helper_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function visual_group_helper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var visual_group_props_PROPS,helper_setMatrixInstances=function setMatrixInstances(context,placeholder){var values=placeholder.values,rows=placeholder.rows,columns=placeholder.columns;return values=values||[],rows=rows||[],columns=columns||[],context._composition.matrices={value:new value_matrix(values),left:new value_matrix(rows[0]),right:new value_matrix(rows[1]),top:new value_matrix(columns[0]),bottom:new value_matrix(columns[1])},context._dependencies.throwback.commit(common_props.MATRIX_CREATED,!0),context},helper_updateChecker=function updateChecker(context,props){return props.every(function(option){var val=context[option]();switch(option){case ROWS:case COLUMNS:return null!==val;case constants_DATA:return val&&!val.isEmpty()&&function hasValue(val){for(var hasOneValue=!1,i=0;i<val.length&&!hasOneValue;i++)for(var j=0;j<val[i].length;j++)if(!(val[i][j]instanceof src_InvalidAwareTypes)){hasOneValue=!0;break}return hasOneValue}(val.getData().data);default:return!0}})},helper_createMatrices=function createMatrices(context,sanitizedConfig){var groupConfig=sanitizedConfig.groupConfig,resolverConfig=sanitizedConfig.resolverConfig,config=groupConfig.config,resolver=groupConfig.resolver,matrixConfig=groupConfig.matrixConfig,encoders=groupConfig.encoders,retinalConfig=groupConfig.retinalConfig,fields=groupConfig.fields,placeholderInfo=resolver.getMatrices(resolverConfig);return context._originalGroupedData=context._groupedDataModel=placeholderInfo.dataModels.groupedModel,context.selection(placeholderInfo.selection),resolver.createRetinalAxes(placeholderInfo.dataModels.parentModel.getFieldsConfig(),retinalConfig,encoders),resolver.setRetinalAxisDomain(matrixConfig,placeholderInfo.dataModels,encoders),helper_setMatrixInstances(context,placeholderInfo),context.cornerMatrices(resolver.createHeaders(placeholderInfo,fields,config)),context.placeholderInfo(placeholderInfo),context._composition.axes=resolver.axes(),context.metaData({border:getBorders(placeholderInfo,encoders.simpleEncoder)}),resolver.encoder().unionUnitDomains(context),function registerDomainChangeListener(context){context.store().registerChangeListener(["".concat(namespace_namespaceObject.UNIT_GLOBAL_NAMESPACE,".domain")],function(){context.resolver().encoder().unionUnitDomains(context)},!1,{key:"unionDomain"})}(context),context};function visual_group_props_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var src_visual_group_props_PROPS=(visual_group_props_defineProperty(visual_group_props_PROPS={alias:{},data:{preset:function preset(context){context._prevData=null}},cornerMatrices:{defaultValue:{topLeft:[],topRight:[],bottomLeft:[],bottomRight:[]}},groupType:{},metaData:{defaultValue:{border:{}}},placeholderInfo:{defaultValue:{}},resolver:{},valueParser:{defaultValue:function defaultValue(val){return val}},registry:{sanitization:function sanitization(context,value){return context.resolver&&context.resolver().registry({cells:value.cellRegistry,VisualUnit:value.VisualUnit}),value}},selection:{}},constants_CONFIG,{}),visual_group_props_defineProperty(visual_group_props_PROPS,ROWS,{}),visual_group_props_defineProperty(visual_group_props_PROPS,COLUMNS,{}),visual_group_props_defineProperty(visual_group_props_PROPS,enums_constants_COLOR,{}),visual_group_props_defineProperty(visual_group_props_PROPS,enums_constants_SHAPE,{}),visual_group_props_defineProperty(visual_group_props_PROPS,enums_constants_SIZE,{}),visual_group_props_defineProperty(visual_group_props_PROPS,DETAIL,{}),visual_group_props_defineProperty(visual_group_props_PROPS,LAYERS,{}),visual_group_props_defineProperty(visual_group_props_PROPS,TRANSFORM,{}),visual_group_props_PROPS);function visual_group_typeof(obj){"@babel/helpers - typeof";return(visual_group_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function visual_group_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function visual_group_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function visual_group_getPrototypeOf(o){return(visual_group_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function visual_group_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function visual_group_setPrototypeOf(o,p){return(visual_group_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var visual_group=function(_SimpleGroup){function VisualGroup(registry,dependencies){var _this;!function visual_group_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VisualGroup),_this=function visual_group_possibleConstructorReturn(self,call){return!call||"object"!==visual_group_typeof(call)&&"function"!=typeof call?visual_group_assertThisInitialized(self):call}(this,visual_group_getPrototypeOf(VisualGroup).call(this));var components=registry.components,componentSubRegistry=registry.componentSubRegistry,interactions=registry.interactions;return _this._dependencies=dependencies,generateGetterSetters(visual_group_assertThisInitialized(_this),_this.constructor.getterSetters()),generateGetterSetters(visual_group_assertThisInitialized(_this),_this.constructor.localOptions()),_this._composition={},_this._data=[],_this._prevData=null,_this._groupedDataModel=[],_this._mount=null,_this._selection={},_this.createMatrixResolver(),helper_setMatrixInstances(visual_group_assertThisInitialized(_this),{}),_this.registry({layerRegistry:componentSubRegistry.layers.get(),cellRegistry:componentSubRegistry.cells.get(),VisualUnit:components.VisualUnit,interactions:interactions}),_this}return function visual_group_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&visual_group_setPrototypeOf(subClass,superClass)}(VisualGroup,simple_group),function visual_group_createClass(Constructor,protoProps,staticProps){return protoProps&&visual_group_defineProperties(Constructor.prototype,protoProps),staticProps&&visual_group_defineProperties(Constructor,staticProps),Constructor}(VisualGroup,[{key:"store",value:function store(){return arguments.length?(this._store=arguments.length<=0?void 0:arguments[0],function initializeGlobalState(context){var globalState=context.constructor.getState()[0];context.store().append(namespace_namespaceObject.GROUP_GLOBAL_NAMESPACE,globalState)}(this),function createUnitState(context){var _VisualUnit$getState2=visual_group_helper_slicedToArray(visual_unit_VisualUnit.getState(),2),globalState=_VisualUnit$getState2[0],localState=_VisualUnit$getState2[1];context.store().append(namespace_namespaceObject.UNIT_GLOBAL_NAMESPACE,globalState).append(namespace_namespaceObject.UNIT_LOCAL_NAMESPACE,localState)}(this),function createLayerState(context){var _BaseLayer$getState2=visual_group_helper_slicedToArray(base_layer_BaseLayer.getState(),2),globalState=_BaseLayer$getState2[0],localState=_BaseLayer$getState2[1];context.store().append(namespace_namespaceObject.LAYER_GLOBAL_NAMESPACE,globalState).append(namespace_namespaceObject.LAYER_LOCAL_NAMESPACE,localState)}(this),function setupChangeListeners(context){var store=context.store(),stores={throwback:context._dependencies.throwback,store:store};["x","y"].forEach(function(axisType){store.registerChangeListener(["".concat(namespace_namespaceObject.GROUP_GLOBAL_NAMESPACE,".domain.").concat(axisType)],function(){context.resolver().axes()[axisType].forEach(function(axes){return axes.forEach(function(axis){axis.render()})})})});var _context$registry=context.registry();[_context$registry.VisualUnit,_context$registry.layerRegistry.base].forEach(function(comp){var formalName=comp.formalName();["store","throwback"].forEach(function(type){var listeners=comp.getListeners()[type],storeInst=stores[type];listeners.forEach(function(listenerInf){storeInst[listenerInf.type](listenerInf.props,listenerInf.listener,!1,{namespace:formalName,subNamespace:listenerInf.subNamespace})})})})}(this),this):this._store}},{key:"matrixInstance",value:function matrixInstance(){return arguments.length?this:this.composition().matrices}},{key:"composition",value:function composition(){return arguments.length?this:this._composition}},{key:"lockModel",value:function lockModel(){return this.store().model.lock(),this}},{key:"unlockModel",value:function unlockModel(){return this.store().model.unlock(),this}},{key:"where",value:function where(variable){return group_utils_findInGroup(variable,this.resolver().getAllFields())}},{key:"getAxes",value:function getAxes(type){return type===RETINAL?this.resolver().getRetinalAxes():this.resolver().getSimpleAxes(type)}},{key:"getCells",value:function getCells(type){return this.resolver()["".concat(type,"Cells")]()}},{key:"getFieldsFromChannel",value:function getFieldsFromChannel(channel){var _this$resolver$getAll=this.resolver().getAllFields(),rowProjections=_this$resolver$getAll.rowProjections,colProjections=_this$resolver$getAll.colProjections;return channel===Y?rowProjections:colProjections}},{key:"getCellsByFacetKey",value:function getCellsByFacetKey(facetKey){var resolver=this.resolver();return resolver.rowCells()[facetKey]||resolver.colCells()[facetKey]||[]}},{key:"getAxesByFacetKey",value:function getAxesByFacetKey(axisType,facetKey){var resolver=this.resolver();return(resolver.rowCells()[facetKey]||resolver.colCells()[facetKey])[0].valueOf().axes()[axisType]||[]}},{key:"serialize",value:function serialize(){var _ref,store=this.store();return visual_group_defineProperty(_ref={},constants_CONFIG,store.get(constants_CONFIG)),visual_group_defineProperty(_ref,constants_MOUNT,store.get(constants_MOUNT)),_ref}},{key:"getGroupByData",value:function getGroupByData(){return this._groupedDataModel}},{key:"createMatrices",value:function createMatrices(sanitizedConfig){helper_createMatrices(this,sanitizedConfig)}},{key:"getMandatoryFields",value:function getMandatoryFields(){var sanitizedValue={groupConfig:{},resolverConfig:{},shouldRender:!1};if(helper_updateChecker(this,[ROWS,COLUMNS,constants_DATA])){var localFields=function initializeFields(context){var rows=context.rows(),columns=context.columns(),color=context.color(),datamodel=context.data(),size=context.size(),detail=context.detail(),layers=context.layers(),transform=context.transform(),config=context.config(),shape=context.shape(),resolver=context.resolver();resolver.store(context.store()),resolver.valueParser(context.valueParser());var matrixConfig={selection:context.selection(),alias:context.alias(),globalConfig:config||{},rows:rows,columns:columns,detail:detail,layers:layers,transform:transform};!function unsubscribeChangeListeners(context){context.store().unsubscribe({key:"unionDomain"})}(context);var retinalConfig=function sanitizeRetinalConfig(retinalConf){var conf={};for(var key in retinalConf){var confValue=retinalConf[key];conf[key]="string"!=typeof confValue&&confValue?confValue:{field:retinalConf[key]}}return conf}({color:color,shape:shape,size:size});matrixConfig=Object.assign(matrixConfig,retinalConfig);var encoders={};encoders.retinalEncoder=new retinal_encoder_RetinalEncoder,encoders.simpleEncoder=context.createEncoderInstance(),matrixConfig.coord=encoders.simpleEncoder.constructor.type(),resolver.encoder(encoders.simpleEncoder),context.groupType(encoders.simpleEncoder.constructor.type());var fields=encoders.simpleEncoder.fieldSanitizer(datamodel,matrixConfig);return encoders.simpleEncoder.setAxisAndHeaders(config?config.axisFrom:{},fields),layers&&resolver.layerConfig(layers),resolver.horizontalAxis(fields.rows,encoders).verticalAxis(fields.columns,encoders),{rows:rows,columns:columns,color:color,datamodel:datamodel,size:size,detail:detail,layers:layers,transform:transform,config:config,shape:shape,resolver:resolver,matrixConfig:matrixConfig,retinalConfig:retinalConfig,encoders:encoders,fields:fields}}(this),datamodel=localFields.datamodel,encoders=localFields.encoders,resolver=localFields.resolver,matrixConfig=localFields.matrixConfig,resolverFields=function initializeResolverFields(context,config){var datamodel=context.datamodel,encoders=context.encoders,resolver=context.resolver,componentRegistry=context.componentRegistry,globalConfig=config.globalConfig,selection=config.selection,transform=config.transform,groupBy=globalConfig.autoGroupBy,labelManager=resolver.dependencies().smartlabel,fieldMap=datamodel.getFieldsConfig(),layerConfig=resolver.layerConfig(),registry=resolver.registry(),normalizedRows=resolver.horizontalAxis().fields,normalizedColumns=resolver.verticalAxis().fields,otherEncodings=resolver.optionalProjections(config,layerConfig,datamodel.getSchema()),facetsAndProjections=resolver.getAllFields(),simpleEncoder=encoders.simpleEncoder;return{datamodel:datamodel,encoders:encoders,resolver:resolver,globalConfig:globalConfig,selection:selection,transform:transform,componentRegistry:componentRegistry,groupBy:groupBy,labelManager:labelManager,fieldMap:fieldMap,layerConfig:layerConfig,registry:registry,normalizedRows:normalizedRows,normalizedColumns:normalizedColumns,otherEncodings:otherEncodings,facetsAndProjections:facetsAndProjections,simpleEncoder:simpleEncoder,shouldRender:simpleEncoder.hasMandatoryFields(facetsAndProjections),config:config}}({datamodel:datamodel,componentRegistry:this.registry(),encoders:encoders,resolver:resolver},matrixConfig);sanitizedValue={groupConfig:localFields,resolverConfig:resolverFields,shouldRender:resolverFields.shouldRender}}return sanitizedValue}},{key:"remove",value:function remove(){this.matrixInstance().value.clear(),this.resolver().clear();var info=this.placeholderInfo();info.rows=null,info.columns=null,info.values=null}},{key:"createEncoderInstance",value:function createEncoderInstance(){var layers=this.layers();return group_utils_getEncoder(layers)}},{key:"createMatrixResolver",value:function createMatrixResolver(){return this.resolver(new matrix_resolver_MatrixResolver(this._dependencies)),this}},{key:"groupedData",value:function groupedData(){return arguments.length?(this._groupedDataModel=arguments.length<=0?void 0:arguments[0],this):this.getGroupByData()}},{key:"resetData",value:function resetData(){var oriData=this._originalGroupedData;return oriData&&(this._groupedDataModel=oriData),this}}],[{key:"getState",value:function getState(){return[{domain:{x:null,y:null,radius:null,angle:null,angle0:null}},{}]}},{key:"formalName",value:function formalName(){return"VisualGroup"}},{key:"localOptions",value:function localOptions(){return visual_group_local_options}},{key:"getterSetters",value:function getterSetters(){return src_visual_group_props_PROPS}}]),VisualGroup}(),muze_package=__webpack_require__(12);__webpack_require__(4);function behavioural_select_typeof(obj){"@babel/helpers - typeof";return(behavioural_select_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function select_toConsumableArray(arr){return function select_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function select_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function select_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function behavioural_select_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function behavioural_select_possibleConstructorReturn(self,call){return!call||"object"!==behavioural_select_typeof(call)&&"function"!=typeof call?function behavioural_select_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function behavioural_select_getPrototypeOf(o){return(behavioural_select_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function behavioural_select_setPrototypeOf(o,p){return(behavioural_select_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var action_behaviour_map_actionBehaviourMap,_propagationBehaviour,behavioural_select_SelectBehaviour=function(_PersistentBehaviour){function SelectBehaviour(){return function behavioural_select_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SelectBehaviour),behavioural_select_possibleConstructorReturn(this,behavioural_select_getPrototypeOf(SelectBehaviour).apply(this,arguments))}return function behavioural_select_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&behavioural_select_setPrototypeOf(subClass,superClass)}(SelectBehaviour,persistent_PersistentBehaviour),function behavioural_select_createClass(Constructor,protoProps,staticProps){return protoProps&&behavioural_select_defineProperties(Constructor.prototype,protoProps),staticProps&&behavioural_select_defineProperties(Constructor,staticProps),Constructor}(SelectBehaviour,[{key:"setSelectionSet",value:function setSelectionSet(addSet,selectionSet){if(null===addSet)selectionSet.reset();else if(addSet.length){var propagationInf=this.firebolt._propagationInf,existingRemoveSet=addSet.filter(function(d){return selectionSet._set[d]===enums_selection_namespaceObject.SELECTION_OLD_EXIT||selectionSet._set[d]===enums_selection_namespaceObject.SELECTION_NEW_EXIT});if(propagationInf.sourceId)selectionSet.reset(),selectionSet.add(addSet);else{existingRemoveSet.length?(selectionSet.updateEntry(),selectionSet.add(existingRemoveSet)):(selectionSet.updateExit(),selectionSet.remove(addSet));var exitSet=selectionSet.getSets({keys:!0}).exitSet,mergedExitSet=[].concat(select_toConsumableArray(new Set(exitSet[1])),select_toConsumableArray(new Set(exitSet[0]))),completeSetCount=selectionSet.getCompleteSet().length;exitSet[1].length!==completeSetCount&&mergedExitSet.length===completeSetCount&&selectionSet.reset()}}else selectionSet.remove(selectionSet.getCompleteSet());return this}}],[{key:"formalName",value:function formalName(){return"select"}}]),SelectBehaviour}();function firebolt_action_behaviour_map_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var firebolt_behaviour_effect_map_behaviourEffectMap,_propagationSideEffec,firebolt_action_behaviour_map_actionBehaviourMap=(firebolt_action_behaviour_map_defineProperty(action_behaviour_map_actionBehaviourMap={},actions_namespaceObject.DRAG,{target:".".concat("muze","-gradient-rect"),behaviours:[behaviours_namespaceObject.BRUSH]}),firebolt_action_behaviour_map_defineProperty(action_behaviour_map_actionBehaviourMap,actions_namespaceObject.HOVER,{target:[".".concat("muze","-legend-columns")],behaviours:[behaviours_namespaceObject.HIGHLIGHT]}),firebolt_action_behaviour_map_defineProperty(action_behaviour_map_actionBehaviourMap,actions_namespaceObject.CLICK,{target:[".".concat("muze","-legend-columns")],behaviours:[behaviours_namespaceObject.SELECT]}),action_behaviour_map_actionBehaviourMap),propagationBehaviourMap=(firebolt_action_behaviour_map_defineProperty(_propagationBehaviour={},behaviours_namespaceObject.SELECT,behaviours_namespaceObject.FILTER),firebolt_action_behaviour_map_defineProperty(_propagationBehaviour,behaviours_namespaceObject.BRUSH,behaviours_namespaceObject.HIGHLIGHT),_propagationBehaviour);function firebolt_behaviour_effect_map_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var src_firebolt_behaviour_effect_map_behaviourEffectMap=(firebolt_behaviour_effect_map_defineProperty(firebolt_behaviour_effect_map_behaviourEffectMap={},"brush",["selectionBox",{name:"highlighter",options:{strategy:"fade"}}]),firebolt_behaviour_effect_map_defineProperty(firebolt_behaviour_effect_map_behaviourEffectMap,"select",[{name:"highlighter",options:{strategy:"fade"}}]),firebolt_behaviour_effect_map_behaviourEffectMap),propagationSideEffects=(firebolt_behaviour_effect_map_defineProperty(_propagationSideEffec={},"brush",[{name:"highlighter",options:{strategy:"fade"}}]),firebolt_behaviour_effect_map_defineProperty(_propagationSideEffec,"highlight",[{name:"highlighter",options:{strategy:"fade"}}]),firebolt_behaviour_effect_map_defineProperty(_propagationSideEffec,"select",["filter"]),_propagationSideEffec);function src_firebolt_helper_toConsumableArray(arr){return function src_firebolt_helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function src_firebolt_helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function src_firebolt_helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var _POSITION_ALIGNMENT_M,_OPPOSITE_POSITION,helper_payloadGenerator={__default:function __default(selectionDataModel,propConfig){var propPayload=propConfig.payload,sourceIdentifiers=propConfig.sourceIdentifiers,dataObj=selectionDataModel.getData(),schema=dataObj.schema,payload=Object.assign({},propPayload);schema=dataObj.schema;var data=dataObj.data,sourceFields=schema.map(function(d){return d.name});return payload.criteria=!sourceIdentifiers&&selectionDataModel.isEmpty()?null:[sourceFields].concat(src_firebolt_helper_toConsumableArray(data)),payload.sourceFields=sourceIdentifiers?sourceIdentifiers.fields.map(function(d){return d.name}):[],payload},brush:function brush(dm,propConfig){var criteria=propConfig.criteria;return{criteria:criteria?criteria.range:criteria}}};function constants_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DEFAULTICONSIZE={circle:64,square:45.8,default:42.8},SCALE_FUNCTIONS={size:"getSize",shape:"getShape",color:"getColor"},HORIZONTAL="horizontal",VALUE="value",POSITION_ALIGNMENT_MAP=(constants_defineProperty(_POSITION_ALIGNMENT_M={},"left","vertical"),constants_defineProperty(_POSITION_ALIGNMENT_M,"right","vertical"),constants_defineProperty(_POSITION_ALIGNMENT_M,"top",HORIZONTAL),constants_defineProperty(_POSITION_ALIGNMENT_M,"bottom",HORIZONTAL),_POSITION_ALIGNMENT_M),OPPOSITE_POSITION=(constants_defineProperty(_OPPOSITE_POSITION={},"left","right"),constants_defineProperty(_OPPOSITE_POSITION,"right","left"),_OPPOSITE_POSITION);function legend_firebolt_typeof(obj){"@babel/helpers - typeof";return(legend_firebolt_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function legend_firebolt_toConsumableArray(arr){return function legend_firebolt_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function legend_firebolt_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function legend_firebolt_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function legend_firebolt_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function legend_firebolt_possibleConstructorReturn(self,call){return!call||"object"!==legend_firebolt_typeof(call)&&"function"!=typeof call?function legend_firebolt_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function legend_firebolt_getPrototypeOf(o){return(legend_firebolt_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function legend_firebolt_setPrototypeOf(o,p){return(legend_firebolt_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var legend_firebolt_LegendFireBolt=function(_Firebolt){function LegendFireBolt(){var _getPrototypeOf2,_this;!function legend_firebolt_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LegendFireBolt);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=legend_firebolt_possibleConstructorReturn(this,(_getPrototypeOf2=legend_firebolt_getPrototypeOf(LegendFireBolt)).call.apply(_getPrototypeOf2,[this].concat(params)))).initializeSideEffects(),_this}return function legend_firebolt_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&legend_firebolt_setPrototypeOf(subClass,superClass)}(LegendFireBolt,firebolt_Firebolt),function legend_firebolt_createClass(Constructor,protoProps,staticProps){return protoProps&&legend_firebolt_defineProperties(Constructor.prototype,protoProps),staticProps&&legend_firebolt_defineProperties(Constructor,staticProps),Constructor}(LegendFireBolt,[{key:"getPropagationSelectionSet",value:function getPropagationSelectionSet(selectionSet){return selectionSet[0]}},{key:"propagate",value:function propagate(behaviourName,payload,selectionSet){!function propagate(firebolt,action,identifiers){var context=firebolt.context,data=context.metaData(),propPayload={};propPayload.action=propagationBehaviourMap[action]||action,propPayload.sideEffects=propagationSideEffects[action],propPayload.sourceCanvas=context.canvasAlias();var isMutableAction=firebolt._actions.behavioural[propPayload.action].constructor.mutates(),propConfig={sourceId:firebolt.id(),payload:propPayload,criteria:null===propPayload.criteria?null:identifiers,isMutableAction:isMutableAction,action:propPayload.action};data.propagate(identifiers,propConfig,!0)}(this,behaviourName,selectionSet)}},{key:"getAddSetFromCriteria",value:function getAddSetFromCriteria(criteria){var values,uniqueIds,type=this.context.constructor.type();if(null===criteria)uniqueIds=null;else if("step"===type)values=Object.values(criteria),uniqueIds=this.context.data().filter(function(d){return-1!==values.indexOf(d.range)}).map(function(d){return d.id});else if("gradient"===type)uniqueIds=[];else{var _ref;if((values=criteria)instanceof Array)values=values.slice(1,criteria.length),uniqueIds=legend_firebolt_toConsumableArray(new Set((_ref=[]).concat.apply(_ref,legend_firebolt_toConsumableArray(values))));else values=Object.values(criteria),uniqueIds=this.context.data().filter(function(d){return-1!==values.indexOf(d.range)}).map(function(d){return d.id})}return{uids:uniqueIds,model:null}}},{key:"getFullData",value:function getFullData(){return null}},{key:"onDataModelPropagation",value:function onDataModelPropagation(){var _this2=this;return function(data,config){if(_this2.context.mount()){var payload=(helper_payloadGenerator[config.action]||helper_payloadGenerator.__default)(data,config),propagationInf={propagate:!1,data:data,sourceId:config.propagationSourceId};config.sourceId===_this2.id()||"highlight"!==config.action||_this2.dispatchBehaviour("highlight",payload,propagationInf)}}}},{key:"data",value:function data(){return this.context.metaData()}},{key:"id",value:function id(){return"legend-".concat(this.context._id)}},{key:"sourceCanvas",value:function sourceCanvas(){return this.context.canvasAlias()}},{key:"shouldApplySideEffects",value:function shouldApplySideEffects(){return!0}},{key:"shouldApplyHighlightEffect",value:function shouldApplyHighlightEffect(behaviour){var highlightedSet=this.getEntryExitSet("highlight"),selectionSet=this.getEntryExitSet("select");if(highlightedSet&&selectionSet){var _ref2,currentHighlightedSet=highlightedSet.mergedEnter.uids,deselectedLegendItemsSet=selectionSet.mergedExit.uids;if("highlight"===behaviour)if((_ref2=[]).concat.apply(_ref2,legend_firebolt_toConsumableArray(currentHighlightedSet)).filter(function(id){var _ref3;return(_ref3=[]).concat.apply(_ref3,legend_firebolt_toConsumableArray(deselectedLegendItemsSet)).includes(id)}).length)return!1}return!0}}]),LegendFireBolt}();function drag_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var physical_physicalActions,firebolt_physical_hover=function hover(firebolt){return function(targetEl){var dispatchBehaviour=function dispatchBehaviour(args){var event=renderer_utils_getEvent(),payload={criteria:firebolt.context.getCriteriaFromData(args)};firebolt.triggerPhysicalAction("hover",payload),event.stopPropagation()};targetEl.on("mouseover",dispatchBehaviour).on("mousemove",dispatchBehaviour).on("mouseout",function(){var event=renderer_utils_getEvent();firebolt.triggerPhysicalAction("hover",{criteria:null}),event.stopPropagation()})}},firebolt_physical_click=function click(firebolt){return function(targetEl,behaviours){targetEl.on("click",function dispatchBehaviour(args){var payload={criteria:firebolt.context.getCriteriaFromData(args)};behaviours.forEach(function(behaviour){return firebolt.dispatchBehaviour(behaviour,payload)})})}};function firebolt_physical_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var firebolt_physical_physicalActions=(firebolt_physical_defineProperty(physical_physicalActions={},"drag",function drag(firebolt){return function(targetEl,behaviours){var payload,startPos={},endPos={},d3Drag=renderer_utils_getD3Drag(),context=firebolt.context,boundingBox=context.measurement().gradientDimensions,axisType="horizontal"===context.config().align?"x":"y",axisScale=context.axis().source().scale(),rangeShifter=axisScale.range()["x"===axisType?0:1];targetEl.call(d3Drag().on("start",function(){var event=renderer_utils_getEvent();startPos={x:event.x,y:event.y}}).on("drag",function(){var event=renderer_utils_getEvent();(endPos={x:event.x,y:event.y}).x=Math.max(0,Math.min(endPos.x,boundingBox.width)),endPos.y=Math.max(0,Math.min(endPos.y,boundingBox.height)),payload={criteria:drag_defineProperty({},context.fieldName(),[axisScale.invert(startPos[axisType]+2*rangeShifter),axisScale.invert(endPos[axisType]+2*rangeShifter)].sort(function(a,b){return a-b}))},behaviours.forEach(function(behaviour){return firebolt.dispatchBehaviour(behaviour,payload)})}).on("end",function(){var event=renderer_utils_getEvent();(endPos={x:event.x,y:event.y}).x=Math.max(0,Math.min(endPos.x,boundingBox.width)),endPos.y=Math.max(0,Math.min(endPos.y,boundingBox.height)),payload=startPos[axisType]===endPos[axisType]?{criteria:null}:{criteria:drag_defineProperty({},context.fieldName(),[axisScale.invert(startPos[axisType]+2*rangeShifter),axisScale.invert(endPos[axisType]+2*rangeShifter)].sort(function(a,b){return a-b}))},behaviours.forEach(function(behaviour){return firebolt.dispatchBehaviour(behaviour,payload)})}))}}),firebolt_physical_defineProperty(physical_physicalActions,"hover",firebolt_physical_hover),firebolt_physical_defineProperty(physical_physicalActions,"click",firebolt_physical_click),physical_physicalActions);function selection_box_drag_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _buffer,getSelectionCriteria=function getSelectionCriteria(subject,axis,measures){var criteria=[],axisScale=axis.axisScale,axisType=axis.axisType,startPos=measures.startPos,endPos=measures.endPos,selectionBoxMeasure=measures.selectionBoxMeasure,drawingInfMeasure=measures.drawingInfMeasure,offset=measures.offset,subjectStartPoint=subject[axisType];return criteria=startPos[axisType]===endPos[axisType]?[]:subjectStartPoint+selectionBoxMeasure>=drawingInfMeasure+offset?[axisScale.invert(drawingInfMeasure+offset-selectionBoxMeasure),axisScale.invert(drawingInfMeasure+offset)]:subjectStartPoint-offset<offset?[axisScale.invert(2*offset),axisScale.invert(selectionBoxMeasure+2*offset)]:[axisScale.invert(subjectStartPoint),axisScale.invert(subjectStartPoint+selectionBoxMeasure)],"x"===axisType||criteria.reverse(),criteria};function legend_defaults_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var ALIGN_HORIZONTAL="horizontal",ALIGN_VERTICAL="vertical",DEFAULT_MEASUREMENT={height:30,width:30,maxWidth:1/0,maxHeight:1/0,padding:2,margin:2,marginHorizontal:3,paddingRight:4,border:1},LEGEND_TITLE={text:"",orientation:function orientation(pos){return"left"===pos||"right"===pos?"left":"center"}},legend_defaults_DEFAULT_CONFIG={buffer:(_buffer={},legend_defaults_defineProperty(_buffer,ALIGN_HORIZONTAL,10),legend_defaults_defineProperty(_buffer,ALIGN_VERTICAL,10),_buffer),classPrefix:"muze",borderStyle:"solid",borderColor:"rgba(0,0,0,0)",formatter:{bounds:{lower:"less than",upper:"more than"}},marker:{text:{formatter:function formatter(data){return data}}},item:{text:{orientation:"right",width:10,formatter:function formatter(val,i,data,context){return context.valueParser()(val)}},icon:{className:"legend-icon",height:20,width:20,color:"rgba(192,192,192,0.6)",type:"square"}}},tempConfig=mergeRecursive({},legend_defaults_DEFAULT_CONFIG),STEP_DEFAULT_CONFIG=mergeRecursive(tempConfig,{item:{text:{formatter:function formatter(val){return"".concat(val[0]," - ").concat(val[1])}}}}),defaults_ICON_MAP=function ICON_MAP(icon){return icon&&"string"==typeof icon?common_utils_getSymbol(icon):icon},LEGEND_MARKER_PROPS_size=8,LEGEND_MARKER_PROPS_BUFFER=4,LEGEND_MARKER_PROPS_ROTATE_HORIZONTAL=180,LEGEND_MARKER_PROPS_ROTATE_VERTICAL=90,LEGEND_MARKER_PROPS_shape="triangle";__webpack_require__(34);function side_effects_selection_box_typeof(obj){"@babel/helpers - typeof";return(side_effects_selection_box_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function side_effects_selection_box_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function side_effects_selection_box_possibleConstructorReturn(self,call){return!call||"object"!==side_effects_selection_box_typeof(call)&&"function"!=typeof call?function side_effects_selection_box_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function side_effects_selection_box_getPrototypeOf(o){return(side_effects_selection_box_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function side_effects_selection_box_setPrototypeOf(o,p){return(side_effects_selection_box_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var side_effects_selection_box=function(_SpawnableSideEffect){function SelectionBox(){var _getPrototypeOf2,_this;!function side_effects_selection_box_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SelectionBox);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=side_effects_selection_box_possibleConstructorReturn(this,(_getPrototypeOf2=side_effects_selection_box_getPrototypeOf(SelectionBox)).call.apply(_getPrototypeOf2,[this].concat(params))))._graphicElems={rect:null},_this}return function side_effects_selection_box_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&side_effects_selection_box_setPrototypeOf(subClass,superClass)}(SelectionBox,spawnable_SpawnableSideEffect),function side_effects_selection_box_createClass(Constructor,protoProps,staticProps){return protoProps&&side_effects_selection_box_defineProperties(Constructor.prototype,protoProps),staticProps&&side_effects_selection_box_defineProperties(Constructor,staticProps),Constructor}(SelectionBox,[{key:"apply",value:function apply(selectionSet,payload){var x,y,width,height,firebolt=this.firebolt,context=firebolt.context,config=this.config(),axis=context.axis().source(),className="".concat(config.classPrefix,"-").concat(config.className),criteria=payload.criteria,rect=this._graphicElems.rect;if(null===criteria)return rect&&rect.remove(),this;var domain=criteria[firebolt.context.fieldName()],axisScale=axis.scale(),range=domain?[axis.getScaleValue(domain[0]),axis.getScaleValue(domain[1])]:[],axisType=context.config().align===HORIZONTAL?"x":"y",gradientDimension=firebolt.context.measurement().gradientDimensions["x"===axisType?"height":"width"],rangeShifter=axisScale.range()["x"===axisType?0:1],legendGradContainer=context.getDrawingContext().svgContainer,legendSelGroup=makeElement(legendGradContainer,"g",[1],"".concat(config.classPrefix,"-selection-box-group")),size=LEGEND_MARKER_PROPS_size,BUFFER=LEGEND_MARKER_PROPS_BUFFER;firebolt.context.config().align===HORIZONTAL?(x=range[0]-rangeShifter||0,y=size+BUFFER,width=range[1]-range[0]||0,height=gradientDimension):(x=size+BUFFER,y=range[1]-rangeShifter||0,height=range[0]-range[1]||0,width=gradientDimension);var selBox=makeElement(legendSelGroup,"rect",[{domain:domain,x:x,y:y,width:width,height:height}],className,{enter:function enterFn(el){!function selectionBoxDrag(firebolt){return function(targetEl,behaviours){var payload,startPos={},endPos={},d3Drag=renderer_utils_getD3Drag(),context=firebolt.context,axisScale=context.axis().source().scale(),axisType=context.config().align===HORIZONTAL?"x":"y",measures={drawingInfMeasure:context.measurement().gradientDimensions["x"===axisType?"width":"height"],offset:axisScale.range()["x"===axisType?0:1]},subject={};targetEl.call(d3Drag().on("start",function(){var event=renderer_utils_getEvent();startPos=getMousePos(this,event.sourceEvent),subject=event.subject}).on("drag",function(){var event=renderer_utils_getEvent(),selectionBoxMeasure=subject["x"===axisType?"width":"height"];subject.x+=event.dx,subject.y+=event.dy,measures.selectionBoxMeasure=selectionBoxMeasure,measures.startPos=startPos,measures.endPos=endPos;var criteria=getSelectionCriteria(subject,{axisScale:axisScale,axisType:axisType},measures);payload={criteria:selection_box_drag_defineProperty({},context.fieldName(),criteria),fadeOut:!0},firebolt.dispatchBehaviour(behaviours[0],payload)}).on("end",function(){var event=renderer_utils_getEvent(),selectionBoxMeasure=subject["x"===axisType?"width":"height"];measures.selectionBoxMeasure=selectionBoxMeasure,measures.startPos=startPos,measures.endPos=endPos;var criteria=getSelectionCriteria(event,{axisScale:axisScale,axisType:axisType},measures);payload={criteria:selection_box_drag_defineProperty({},context.fieldName(),criteria),fadeOut:!0,config:{transition:{duration:200}}},firebolt.dispatchBehaviour(behaviours[0],payload)}))}}(firebolt)(el,["brush"])}});return selBox.attr("y",y).attr("x",x).attr("width",width).attr("height",height),this._graphicElems.rect=selBox,this}}],[{key:"formalName",value:function formalName(){return"selectionBox"}},{key:"defaultConfig",value:function defaultConfig(){return{className:"legend-selection-box",classPrefix:"muze"}}}]),SelectionBox}(),legend_highlighter_strategies_strategies=function strategies(firebolt){var context=firebolt.context,classed=function classed(set,className,change){var classPrefix=context.config().classPrefix,uids=set.uids.map(function(d){return d[0]});renderer_utils_selectElement(context.mount()).selectAll(".".concat(classPrefix,"-legend-columns")).filter(function(d){return-1!==uids.indexOf(d.id)}).selectAll("div").classed(className,change)};return{fade:function fade(set){var config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},classPrefix=context.config().classPrefix;set.mergedEnter.length||set.mergedExit.length?(classed(set.mergedExit,config.className||"".concat(classPrefix,"-legend-brighten"),!1),classed(set.mergedExit,config.className||"".concat(classPrefix,"-legend-fadeout"),!0),classed(set.mergedEnter,config.className||"".concat(classPrefix,"-legend-fadeout"),!1)):classed(set.completeSet,config.className||"".concat(classPrefix,"-legend-fadeout"),!1)},brighten:function brighten(set){var config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},classPrefix=context.config().classPrefix;set.mergedEnter.length||set.mergedExit.length?(classed(set.mergedEnter,config.className||"".concat(classPrefix,"-legend-brighten"),!0),classed(set.mergedExit,config.className||"".concat(classPrefix,"-legend-brighten"),!1)):classed(set.completeSet,config.className||"".concat(classPrefix,"-legend-brighten"),!1)}}};function legend_highlighter_typeof(obj){"@babel/helpers - typeof";return(legend_highlighter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function legend_highlighter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function legend_highlighter_possibleConstructorReturn(self,call){return!call||"object"!==legend_highlighter_typeof(call)&&"function"!=typeof call?function legend_highlighter_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function legend_highlighter_getPrototypeOf(o){return(legend_highlighter_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function legend_highlighter_setPrototypeOf(o,p){return(legend_highlighter_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var legend_highlighter_LegendHighlighter=function(_GenericSideEffect){function LegendHighlighter(){var _getPrototypeOf2,_this;!function legend_highlighter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LegendHighlighter);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=legend_highlighter_possibleConstructorReturn(this,(_getPrototypeOf2=legend_highlighter_getPrototypeOf(LegendHighlighter)).call.apply(_getPrototypeOf2,[this].concat(params))))._strategies=legend_highlighter_strategies_strategies(_this.firebolt),_this._strategy="brighten",_this}return function legend_highlighter_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&legend_highlighter_setPrototypeOf(subClass,superClass)}(LegendHighlighter,generic),function legend_highlighter_createClass(Constructor,protoProps,staticProps){return protoProps&&legend_highlighter_defineProperties(Constructor.prototype,protoProps),staticProps&&legend_highlighter_defineProperties(Constructor,staticProps),Constructor}(LegendHighlighter,[{key:"apply",value:function apply(selectionSet,payload){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,this._strategies[options.strategy||this._strategy])(selectionSet,this)}}],[{key:"formalName",value:function formalName(){return"highlighter"}}]),LegendHighlighter}();__webpack_require__(35);function legend_marker_typeof(obj){"@babel/helpers - typeof";return(legend_marker_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function legend_marker_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function legend_marker_possibleConstructorReturn(self,call){return!call||"object"!==legend_marker_typeof(call)&&"function"!=typeof call?function legend_marker_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function legend_marker_getPrototypeOf(o){return(legend_marker_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function legend_marker_setPrototypeOf(o,p){return(legend_marker_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var SYMBOL_PADDING=3*Math.sqrt(3),legend_marker_LegendMarker=function(_GenericSideEffect){function LegendMarker(){var _getPrototypeOf2,_this;!function legend_marker_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LegendMarker);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=legend_marker_possibleConstructorReturn(this,(_getPrototypeOf2=legend_marker_getPrototypeOf(LegendMarker)).call.apply(_getPrototypeOf2,[this].concat(params))))._graphicElements={markerElement:null,legendmarkerTextContainer:null,legendmarkerText:null},_this}return function legend_marker_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&legend_marker_setPrototypeOf(subClass,superClass)}(LegendMarker,generic),function legend_marker_createClass(Constructor,protoProps,staticProps){return protoProps&&legend_marker_defineProperties(Constructor.prototype,protoProps),staticProps&&legend_marker_defineProperties(Constructor,staticProps),Constructor}(LegendMarker,[{key:"apply",value:function apply(selectionSet,payload){var className="".concat(this.config().classPrefix,"-").concat(this.config().className);if(payload.criteria&&2===payload.criteria.length){var x,y,rotateAngle,firebolt=this.firebolt,labelManager=firebolt.context.labelManager,context=firebolt.context,legendConfig=firebolt.context.config(),legendScale=firebolt.context.scale(),pointerTextFormatter=legendConfig.marker.text.formatter,config=this.config(),axis=context.axis().source(),dm=context.metaData(),domain=legendScale.domain(),range=payload.criteria[0]?axis.getScaleValue(payload.criteria[1]):0,legendGradContainer=context.getDrawingContext().svgContainer,lableConfig={top:0,left:0,labelText:payload.criteria[1][0]%1!=0?payload.criteria[1][0].toFixed(2):payload.criteria[1][0]},_getRelativePosition=function getRelativePosition(canvas,legendContainer){return{top:legendContainer.getBoundingClientRect().top-canvas.getBoundingClientRect().top,left:legendContainer.getBoundingClientRect().left-canvas.getBoundingClientRect().left}}(context._canvasMount,legendGradContainer.node()),top=_getRelativePosition.top,left=_getRelativePosition.left,_labelManager$getSmar=labelManager().getSmartText(lableConfig.labelText),oriTextHeight=_labelManager$getSmar.oriTextHeight,oriTextWidth=_labelManager$getSmar.oriTextWidth,size=config.size,shape=config.shape;context.config().align===HORIZONTAL?(x=range-Math.sqrt(size/SYMBOL_PADDING)+1,y=5,rotateAngle=LEGEND_MARKER_PROPS_ROTATE_HORIZONTAL,lableConfig.top=top+y-30,lableConfig.left=x+left-oriTextWidth/2-5):(y=range+Math.sqrt(size/(2*SYMBOL_PADDING))-1,x=5,rotateAngle=LEGEND_MARKER_PROPS_ROTATE_VERTICAL,lableConfig.top=top+y-28+oriTextHeight/2,lableConfig.left=x+left-oriTextWidth-10);var legendmarkerGroup=makeElement(legendGradContainer,"g",[1],"".concat(config.classPrefix,"-").concat(config.className,"-group"));this._graphicElements.markerElement||(this._graphicElements.markerElement=makeElement(legendmarkerGroup,"path",[{value:null}],className,{enter:function physicalAction(){}})),this._graphicElements.legendmarkerTextContainer||(this._graphicElements.legendmarkerTextContainer=makeElement(context._canvasMount,"div",[1],"".concat(className,"-text-container")),this._graphicElements.legendmarkerText=makeElement(this._graphicElements.legendmarkerTextContainer,"div",[1],"".concat(className,"-text")));var textElement=function createTextCell(className,labelManagerRef,cells){var cell=new(0,cells.TextCell)({type:"text",className:"".concat(className,"-text")},{labelManager:labelManagerRef()}).config({maxLines:1});return cell._minTickDiff={height:0,width:0},cell}(className,labelManager,context._cells);this._graphicElements.markerElement.data([{value:payload.criteria}]).attr("transform","translate(".concat(x,",").concat(y,") rotate(").concat(rotateAngle,")")).attr("d",common_utils_getSymbol(shape).size(size*size)()).classed("".concat(className,"-show"),!0).classed("".concat(className,"-hide"),!1),textElement.source(pointerTextFormatter(lableConfig.labelText,domain,dm)),textElement.render(this._graphicElements.legendmarkerText.node()),this._graphicElements.legendmarkerText.attr("style","top: ".concat(lableConfig.top,"px; left:").concat(lableConfig.left,"px")).classed("".concat(className,"-show"),!0).classed("".concat(className,"-hide"),!1)}else this._graphicElements.markerElement&&this._graphicElements.legendmarkerText&&(this._graphicElements.markerElement.data([{value:null}]).classed("".concat(className,"-show"),!1).classed("".concat(className,"-hide"),!0),this._graphicElements.legendmarkerText.classed("".concat(className,"-show"),!1).classed("".concat(className,"-hide"),!0))}}],[{key:"formalName",value:function formalName(){return"marker"}},{key:"defaultConfig",value:function defaultConfig(){return{className:"legend-marker",classPrefix:"muze",size:LEGEND_MARKER_PROPS_size,shape:LEGEND_MARKER_PROPS_shape}}}]),LegendMarker}(),legend_props_PROPS={config:{sanitization:function sanitization(context,value){return mergeRecursive(context._config||{},value)}},data:{},fieldName:{},legendContainer:{},measurement:{sanitization:function sanitization(context,value){var measurement=mergeRecursive(context._measurement,value);return["padding","border","margin"].forEach(function(space){measurement[space]=Math.min(measurement[space]>0?measurement[space]:0,.1*measurement.maxWidth,.1*measurement.maxHeight)}),measurement}},logicalSpace:{},metaData:{onset:function onset(context,value){return context.firebolt().attachPropagationListener(value)}},range:{sanitization:function sanitization(context,value){return context.scale().range(value),context.resetLogicalSpace(),context.store().commit("range",value),value}},scale:{},smartTicks:{},store:{},title:{sanitization:function sanitization(context,value){return mergeRecursive(context._title||{},value)}},labelManager:{},minTickDistance:{},valueParser:{defaultValue:function defaultValue(val){return val}}};var legend_helper_getScaleInfo=function getScaleInfo(scale){var scaleType=scale.constructor.type();return{scaleType:scaleType,domain:scale.uniqueValues(),steps:scale.config().stops||1,scaleFn:SCALE_FUNCTIONS[scaleType]}},legend_helper_getInterpolatedArrayData=function getInterpolatedArrayData(domainForLegend,scaleParams){var requiredWidth,requiredHeight,upperBound=domainForLegend[domainForLegend.length-1],minTickDiff=Math.ceil(domainForLegend[1]-domainForLegend[0]),maxTickDiff=Math.ceil(upperBound-domainForLegend[0]),alignment=scaleParams.alignment,smartLabelCalc=scaleParams.smartLabel,availableSpace=scaleParams.measures,minimumTickSize=scaleParams.minTickDistance,_smartLabelCalc$getOr=smartLabelCalc.getOriSize(upperBound),tickDimHeight=_smartLabelCalc$getOr.height,tickDimWidth=_smartLabelCalc$getOr.width;return Number.isInteger(upperBound)||(upperBound=upperBound.toFixed(2)),minTickDiff=minTickDiff<1?1:minTickDiff,requiredWidth=Math.abs(maxTickDiff)/Math.abs(minTickDiff)*(tickDimWidth+minimumTickSize.width),requiredWidth-=Math.abs(maxTickDiff),requiredHeight=Math.abs(maxTickDiff)/Math.abs(minTickDiff)*tickDimHeight,requiredHeight-=Math.abs(maxTickDiff),domainForLegend=function getcomputedArray(computationhelper,requiredMeasure,availableMeasure,domainForLegend){var currentTickValue,nextTickValue,upperBound=domainForLegend[domainForLegend.length-1],param=computationhelper.measureParam,smartLabelCalc=computationhelper.smartLabelCalc,pixelPerTick=availableMeasure[param]/upperBound;if(availableMeasure[param]>=requiredMeasure[param])return domainForLegend;currentTickValue=smartLabelCalc.getOriSize(domainForLegend[0])[param];for(var i=1;i<domainForLegend.length-1;i++)nextTickValue=Math.floor(currentTickValue/pixelPerTick+domainForLegend[i-1]),domainForLegend[i]<nextTickValue&&(domainForLegend.splice(i,1),i-=1),currentTickValue=smartLabelCalc.getOriSize(domainForLegend[i])[param];return domainForLegend}({smartLabelCalc:smartLabelCalc,measureParam:"top"===alignment||"bottom"===alignment?"width":"height"},{height:requiredHeight,width:requiredWidth},{height:availableSpace.maxHeight,width:availableSpace.maxWidth},domainForLegend)},legend_helper_getInterpolatedData=function getInterpolatedData(domain,steps,scaleParams){var recomputeSteps=0,getTickMeasure=scaleParams.smartLabel,_scaleParams$measures=scaleParams.measures,maxWidth=_scaleParams$measures.maxWidth,maxHeight=_scaleParams$measures.maxHeight,alignment=scaleParams.alignment,tickValue=getTickMeasure.getOriSize(domain[1].toFixed(2));return steps=(steps=Math.round(steps))<1?steps+1:steps,recomputeSteps="top"===alignment||"bottom"===alignment?Math.floor(maxWidth/tickValue.width):Math.floor(maxHeight/tickValue.height),steps=Math.min(steps,recomputeSteps),common_utils_getReadableTicks(domain,steps)},getItemMeasures=function getItemMeasures(context,prop,formatter){var space=[],data=context.data(),labelManager=context._labelManager;return data.forEach(function(item,index){var value=prop?item[prop]:item,formattedData=formatter(value,index,context.metaData(),context),_labelManager$getOriS=labelManager.getOriSize(formattedData),height=_labelManager$getOriS.height,width=_labelManager$getOriS.width;space[index]={height:height,width:width}}),space},legend_helper_calculateTitleWidth=function calculateTitleWidth(measures,titleWidth,config){var maxItemSpaces=measures.maxItemSpaces,margin=measures.margin,itemSpaces=measures.itemSpaces,position=config.position,buffer=config.buffer,alignment=POSITION_ALIGNMENT_MAP[position],width=0;if(alignment===HORIZONTAL){var localBuffer=buffer[alignment];width=itemSpaces.reduce(function(acc,cur){return acc+cur.width+localBuffer},0)}else width=maxItemSpaces.width<titleWidth?titleWidth+2*margin:maxItemSpaces.width;return width};function simple_legend_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _legendOrientation,_positionConfig,_alignmentMap,_itemStack,simple_legend_SimpleLegend=function(){function SimpleLegend(dependencies){!function simple_legend_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SimpleLegend);var interactions=dependencies.registry.interactions;this._data=[],this._metaData=[],this._mount=null,this._fieldName=null,this._title=Object.assign({},LEGEND_TITLE),this._metaData=null,this._labelManager=dependencies.labelManager,this._cells=dependencies.cells,this._id=getUniqueId(),this._measurement=Object.assign({},this.constructor.defaultMeasurement()),this._config=mergeRecursive({},this.constructor.defaultConfig());var dist=dependencies.labelManager.getOriSize("w");this._minTickDistance={width:3*dist.width/4,height:dist.height/2},generateGetterSetters(this,legend_props_PROPS),this._computedStyle=renderer_utils_getSmartComputedStyle(renderer_utils_selectElement("body"),"".concat(this.config().classPrefix,"-legend-item-info")),this._firebolt=new legend_firebolt_LegendFireBolt(this,{behavioural:Object.assign({},interactions.behaviours.get(),firebolt_behavioural_namespaceObject),physical:firebolt_physical_physicalActions,physicalBehaviouralMap:firebolt_action_behaviour_map_actionBehaviourMap},firebolt_side_effects_namespaceObject,src_firebolt_behaviour_effect_map_behaviourEffectMap)}return function simple_legend_createClass(Constructor,protoProps,staticProps){return protoProps&&simple_legend_defineProperties(Constructor.prototype,protoProps),staticProps&&simple_legend_defineProperties(Constructor,staticProps),Constructor}(SimpleLegend,[{key:"id",value:function id(){return this._id}},{key:"firebolt",value:function firebolt(){return arguments.length?this:this._firebolt}},{key:"elemType",value:function elemType(){return"path"}},{key:"canvasAlias",value:function canvasAlias(){return arguments.length?(this._canvasAlias=arguments.length<=0?void 0:arguments[0],this):this._canvasAlias}},{key:"mount",value:function mount(){return arguments.length?(this._mount=arguments.length<=0?void 0:arguments[0],this.render(),this):this._mount}},{key:"getLabelSpaces",value:function getLabelSpaces(){var _this$config=this.config(),item=_this$config.item,classPrefix=_this$config.classPrefix;return this._labelManager.setStyle(renderer_utils_getSmartComputedStyle(renderer_utils_selectElement("body"),"".concat(classPrefix,"-legend-item-info"))),getItemMeasures(this,VALUE,item.text.formatter)}},{key:"setLegendMeasures",value:function setLegendMeasures(){var _this$measurement=this.measurement(),width=_this$measurement.width,height=_this$measurement.height,maxWidth=_this$measurement.maxWidth,maxHeight=_this$measurement.maxHeight,padding=_this$measurement.padding,margin=_this$measurement.margin,border=_this$measurement.border,align=this.config().align,effPadding=2*padding,effBorder=2*border,effMargin=2*margin;this.data(this.dataFromScale());var titleSpace=this.getTitleSpace(),titleHeight=titleSpace.height>0?titleSpace.height+effPadding:0,titleWidth=titleSpace.width+effPadding,labelSpaces=this.getLabelSpaces(effPadding,align),_computeItemSpaces=function computeItemSpaces(config,measures,data){var totalHeight=0,totalWidth=0,maxItemSpaces={width:0,height:0},effPadding=measures.effPadding,titleWidth=measures.titleWidth,labelSpaces=measures.labelSpaces,titleHeight=measures.titleHeight,maxWidth=measures.maxWidth,item=config.item,align=config.align,icon=item.icon,textOrientation=item.text.orientation,itemSpaces=[],iconSpaces=[],maxIconWidth=0;return labelSpaces.forEach(function(labelSpace,i){var itemSpace={width:0,height:0},iconSpace={width:0,height:0},datum=data[i]||{};"left"===textOrientation||"right"===textOrientation?(labelSpace.width+=effPadding,iconSpace.width=(datum.size?2*Math.sqrt(datum.size/Math.PI):icon.width)+effPadding,maxIconWidth=Math.max(iconSpace.width,maxIconWidth),itemSpace.width=labelSpace.width+maxIconWidth,labelSpace.height=Math.max(labelSpace.height,icon.height)+effPadding,iconSpace.height=labelSpace.height,itemSpace.height=labelSpace.height):(labelSpace.width=Math.max(labelSpace.width,datum.size?2*Math.sqrt(datum.size/Math.PI):icon.width)+effPadding,iconSpace.width=labelSpace.width,itemSpace.width=labelSpace.width,maxIconWidth=Math.max(iconSpace.width,maxIconWidth),labelSpace.height+=effPadding,iconSpace.height=icon.height+effPadding,itemSpace.height=labelSpace.height+iconSpace.height),"horizontal"===align?totalHeight=Math.max(totalHeight,itemSpace.height):(totalHeight+=itemSpace.height,totalWidth=Math.max(totalWidth,itemSpace.width,titleWidth)),maxItemSpaces={width:Math.max(itemSpace.width,maxItemSpaces.width),height:Math.max(itemSpace.height,maxItemSpaces.height)},itemSpaces.push(itemSpace),iconSpaces.push(iconSpace)}),itemSpaces.forEach(function(itemSpace,i){if("horizontal"===align)itemSpace.height=totalHeight,"left"===textOrientation||"right"===textOrientation?(labelSpaces[i].height=totalHeight,iconSpaces[i].height=totalHeight,itemSpaces[i].width=labelSpaces[i].width+iconSpaces[i].width+2*effPadding):(labelSpaces[i].width=iconSpaces[i].width,itemSpaces[i].width=iconSpaces[i].width,labelSpaces[i].width=iconSpaces[i].width),totalWidth+=itemSpaces[i].width;else if(itemSpace.width=Math.max(totalWidth,maxWidth),"top"===textOrientation||"bottom"===textOrientation)labelSpaces[i].width=totalWidth,iconSpaces[i].width=totalWidth,maxIconWidth=totalWidth;else{var labelWidth=labelSpaces[i].width,newLabelWidth=maxItemSpaces.width-maxIconWidth;iconSpaces[i].width=maxIconWidth,itemSpaces[i].width=labelWidth+maxIconWidth,labelSpaces[i].width=Math.max(labelWidth,newLabelWidth),totalWidth=Math.max(totalWidth,itemSpace.width)}}),totalWidth=Math.ceil(Math.max(totalWidth,titleWidth))+effPadding,totalHeight+=titleHeight+effPadding,{totalHeight:totalHeight=Math.ceil(totalHeight),totalWidth:totalWidth,itemSpaces:itemSpaces,iconSpaces:iconSpaces,maxItemSpaces:maxItemSpaces,maxIconWidth:maxIconWidth}}(this.config(),{effPadding:effPadding,titleWidth:titleWidth,labelSpaces:labelSpaces,titleHeight:titleHeight,maxWidth:maxWidth,maxHeight:maxHeight},this.data()),totalHeight=_computeItemSpaces.totalHeight,totalWidth=_computeItemSpaces.totalWidth,itemSpaces=_computeItemSpaces.itemSpaces,iconSpaces=_computeItemSpaces.iconSpaces,maxItemSpaces=_computeItemSpaces.maxItemSpaces,maxIconWidth=_computeItemSpaces.maxIconWidth;return this.measurement({width:Math.max(totalWidth,width)+effMargin+effBorder,height:Math.max(totalHeight,height)+effMargin+effBorder,labelSpaces:labelSpaces,iconSpaces:iconSpaces,itemSpaces:itemSpaces,maxItemSpaces:maxItemSpaces,maxIconWidth:maxIconWidth,titleSpaces:{width:Math.min(maxWidth,this.measurement().width)-effMargin-effBorder,height:titleHeight}}),this}},{key:"getTitleSpace",value:function getTitleSpace(){return this._labelManager.setStyle(renderer_utils_getSmartComputedStyle(renderer_utils_selectElement("body"),"".concat(this.config().classPrefix,"-legend-title"))),this._labelManager.getOriSize(this.title().text?this.title().text:"")}},{key:"renderTitle",value:function renderTitle(container){var _this$measurement2=this.measurement(),titleSpaces=_this$measurement2.titleSpaces,border=_this$measurement2.border,padding=_this$measurement2.padding,maxWidth=_this$measurement2.maxWidth,width=legend_helper_calculateTitleWidth(this.measurement(),this._labelManager.getOriSize(this._title.text).width,this.config()),_this$config3=this.config(),borderStyle=_this$config3.borderStyle,borderColor=_this$config3.borderColor;return function titleCreator(container,title,measurement,config){var orientation=config.item.text.orientation,textAlign="left",alignment=measurement.alignment,maxWidth=measurement.maxWidth,width=measurement.width,height=measurement.height,border=measurement.border,padding=measurement.padding;"top"!==orientation&&"bottom"!==orientation&&alignment!==HORIZONTAL||(textAlign="center");var titleWidth=Math.min(maxWidth,width),titleContainer=makeElement(container,"table",[1],"".concat(config.classPrefix,"-legend-title")).style("width","".concat(titleWidth,"px")).style("height","".concat(height,"px")).style("border-bottom","".concat(border,"px ").concat(config.borderStyle," ").concat(config.borderColor)).style("text-align",title.orientation instanceof Function?title.orientation(config.position):title.orientation);return makeElement(titleContainer,"td",[1],"".concat(config.classPrefix,"-legend-title-text")).style("width","".concat(titleWidth,"px")).style("max-width","".concat(maxWidth,"px")).style("height","100%").style("line-height",1).style("padding","".concat(padding,"px")).text(title.text).style("text-align",textAlign).style("overflow-x","scroll").node()}(container,this.title(),{height:titleSpaces.height,width:width,maxWidth:maxWidth,border:border,padding:padding,borderStyle:borderStyle,borderColor:borderColor,alignment:POSITION_ALIGNMENT_MAP[this.config().position]},this.config())}},{key:"render",value:function render(){var marginPosition,firebolt=this.firebolt(),_this$config4=this.config(),classPrefix=_this$config4.classPrefix,borderStyle=_this$config4.borderStyle,borderColor=_this$config4.borderColor,position=_this$config4.position,_this$measurement3=this.measurement(),border=_this$measurement3.border,marginHorizontal=_this$measurement3.marginHorizontal,maxHeight=_this$measurement3.maxHeight,height=_this$measurement3.height,width=_this$measurement3.width,maxWidth=_this$measurement3.maxWidth,margin=this.measurement().margin,legendContainer=makeElement(renderer_utils_selectElement(this.mount()),"div",[1],"".concat(classPrefix,"-legend-box"));switch(position){case"top":marginPosition="margin-".concat("bottom"),margin=marginHorizontal;break;case"left":marginPosition="margin-".concat("right");break;case"bottom":marginPosition="margin-".concat("top"),margin=marginHorizontal;break;default:marginPosition="margin-".concat("left")}legendContainer.classed("".concat(classPrefix,"-legend-box-").concat(this._id),!0),legendContainer.style("float","left");var widthBox=legend_helper_calculateTitleWidth(this.measurement(),this._labelManager.getOriSize(this._title.text).width,this.config()),titleWidth=Math.min(maxWidth,widthBox);return width<titleWidth&&renderer_utils_selectElement(this.mount()).style("width","".concat(titleWidth,"px")),legendContainer.style("width","".concat(titleWidth,"px")).style("height","".concat(Math.min(maxHeight,height),"px")).style("".concat(marginPosition),"".concat(margin,"px")).style("border","".concat(border,"px ").concat(borderStyle," ").concat(borderColor)),this.legendContainer(legendContainer.node()),this.renderTitle(legendContainer),firebolt.createSelectionSet(function prepareSelectionSetData(data,fieldName,dm){return dm.getFieldsConfig()[fieldName].def.type===dist_datamodel.FieldType.DIMENSION?{keys:data.reduce(function(acc,d){return acc[d.rawVal]={uid:d.id,dims:[d.rawVal]},acc},{}),fields:[fieldName]}:{keys:data.reduce(function(acc,d){return acc[d.id]={uid:d.id,dims:[d.id]},acc},{}),fields:[fieldName]}}(this.data(),this.fieldName(),this.metaData())),legendContainer}},{key:"getCriteriaFromData",value:function getCriteriaFromData(data){var fieldName=this.fieldName();return"measure"===this.metaData().getData().schema[0].type?function simple_legend_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},fieldName,data.range):[[fieldName],[data.rawVal]]}},{key:"getRangeFromIdentifiers",value:function getRangeFromIdentifiers(_ref2){var fields=_ref2.fields,entrySet=_ref2.entrySet,idRangeMap=this.data().reduce(function(acc,v){return acc[v.id]=v,acc},{});return fields.reduce(function(acc,v){return acc[v]=entrySet.reduce(function(ranges,id){return id in idRangeMap&&ranges.push(idRangeMap[id].range),ranges},[]),acc},{})}},{key:"setParentInfo",value:function setParentInfo(info){this._canvasMount=info.canvasRoot}}],[{key:"create",value:function create(dependencies){return new SimpleLegend(dependencies)}},{key:"defaultConfig",value:function defaultConfig(){return legend_defaults_DEFAULT_CONFIG}},{key:"defaultMeasurement",value:function defaultMeasurement(){return DEFAULT_MEASUREMENT}}]),SimpleLegend}();function position_config_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var legendOrientation=(position_config_defineProperty(_legendOrientation={},HORIZONTAL,{datasets:function datasets(data){return{row:[1],column:data}},itemContainerMeasures:function itemContainerMeasures(measurement,config){var itemSpaces=measurement.itemSpaces,width=measurement.width,buffer=config.buffer;return{row:{width:"".concat(width+itemSpaces.length*buffer.horizontal||1,"px"),padding:"".concat(0,"px")},column:{width:function width(d,i){return"".concat(itemSpaces[i].width+buffer.horizontal,"px")},padding:"".concat(0,"px")}}},getStepSpacesInfo:function getStepSpacesInfo(measurement){var maxItemSpaces=measurement.maxItemSpaces;return{iconHeight:measurement.height,iconWidth:maxItemSpaces.width,stepPadding:{horizontal:!0,vertical:!1}}}}),position_config_defineProperty(_legendOrientation,"vertical",{datasets:function datasets(data){return{row:data,column:function column(d){return[d]}}},itemContainerMeasures:function itemContainerMeasures(measurement,config){var width=measurement.width,padding=config.padding;return{row:{width:"".concat(width,"px"),padding:"".concat(padding,"px")},column:{width:"".concat(width,"px"),padding:"".concat(0,"px")}}},getStepSpacesInfo:function getStepSpacesInfo(measurement){var maxItemSpaces=measurement.maxItemSpaces,width=measurement.width;return{iconHeight:maxItemSpaces.height,iconWidth:width,stepPadding:{horizontal:!1,vertical:!0}}}}),_legendOrientation),positionConfig=(position_config_defineProperty(_positionConfig={},"left",legendOrientation.vertical),position_config_defineProperty(_positionConfig,"right",legendOrientation.vertical),position_config_defineProperty(_positionConfig,"top",legendOrientation.horizontal),position_config_defineProperty(_positionConfig,"bottom",legendOrientation.horizontal),_positionConfig),alignmentMap=(position_config_defineProperty(_alignmentMap={},"left","end"),position_config_defineProperty(_alignmentMap,"right","start"),position_config_defineProperty(_alignmentMap,"top","center"),position_config_defineProperty(_alignmentMap,"bottom","center"),_alignmentMap),itemStack=(position_config_defineProperty(_itemStack={},"left",[VALUE,"shape"]),position_config_defineProperty(_itemStack,"right",["shape",VALUE]),position_config_defineProperty(_itemStack,"top",[VALUE,"shape"]),position_config_defineProperty(_itemStack,"bottom",["shape",VALUE]),_itemStack),renderer_createLegendSkeleton=function createLegendSkeleton(context,container,classPrefix,data){var gradWidth,gradHeight,maxGradHeight,maxGradWidth,measurement=context.measurement(),margin=measurement.margin,border=measurement.border,titleSpaces=measurement.titleSpaces,width=measurement.width,height=measurement.height,maxWidth=measurement.maxWidth,maxHeight=measurement.maxHeight;gradHeight=height-(titleSpaces.height+2*margin+2*border),gradWidth=width-(2*margin+2*border),maxGradHeight=maxHeight-(titleSpaces.height+2*margin+2*border),maxGradWidth=maxWidth-(2*margin+2*border);var legendBody=makeElement(container,"div",[1],"".concat(classPrefix,"-legend-body"));return legendBody.style("width","".concat(gradWidth,"px")),legendBody.style("height","".concat(gradHeight,"px")),legendBody.select(".".concat(classPrefix,"-legend-overflow")).remove(),maxGradWidth&&maxGradWidth<gradWidth&&(legendBody=legendBody.style("width","".concat(maxGradWidth,"px")).style("overflow-x","scroll")),maxGradHeight&&maxGradHeight<gradHeight&&legendBody.style("height","".concat(maxGradHeight,"px")).style("overflow-y","scroll"),{legendItem:function getItemContainers(container,data,legendInstance){var measurement=legendInstance.measurement(),config=legendInstance.config(),itemSpaces=measurement.itemSpaces,classPrefix=config.classPrefix,position=config.position,positionObj=positionConfig[position],datasets=positionObj.datasets(data),measures=positionObj.itemContainerMeasures(measurement,config),rows=makeElement(container,"div",datasets.row,"".concat(classPrefix,"-legend-row"));rows.style("height",function(d,i){return"".concat(itemSpaces[i].height,"px")}),rows.style("width",measures.row.width),rows.style("padding",measures.row.padding);var columns=makeElement(rows,"div",datasets.column,"".concat(classPrefix,"-legend-columns"));return columns.style("width",measures.column.width),columns.style("padding",measures.column.padding),columns}(legendBody=makeElement(legendBody,"div",[1],"".concat(classPrefix,"-legend-overflow")),data,context)}},renderer_createItemSkeleton=function createItemSkeleton(context,container){var _context$config=context.config(),classPrefix=_context$config.classPrefix,textOrientation=_context$config.item.text.orientation,stack=itemStack[textOrientation],itemSkeleton=makeElement(container,"div",function(d,i){return stack.map(function(e){return[e,d[e],d.color,d.size,d.value,context.fieldName(),i]})},"".concat(classPrefix,"-legend-item-info")),alignClass=alignmentMap[textOrientation];return itemSkeleton.classed(alignClass,!0),{itemSkeleton:itemSkeleton}},renderer_applyItemStyle=function applyItemStyle(item,measureType,stepColorCheck,context){var _context$measurement=context.measurement(),padding=_context$measurement.padding,labelSpaces=_context$measurement.labelSpaces,iconSpaces=_context$measurement.iconSpaces,maxIconWidth=_context$measurement.maxIconWidth,align=context.config().align.align,diff=stepColorCheck?2*-padding:0;return item[0]===VALUE?"".concat(labelSpaces[item[6]][measureType],"px"):"".concat("width"!==measureType||stepColorCheck||"vertical"!==align?align===HORIZONTAL?maxIconWidth:iconSpaces[item[6]][measureType]-diff:maxIconWidth,"px")},renderer_renderIcon=function renderIcon(icon,container,datum,context){var classPrefix=context.classPrefix,iconHeight=context.iconHeight,padding=context.padding,color=context.color,iconWidth=context.iconWidth,align=context.align,maxIconWidth=context.maxIconWidth;align===HORIZONTAL&&(maxIconWidth=iconWidth+2*padding);var svg=makeElement(container,"svg",function(f){return[f]},"".concat(classPrefix,"-legend-icon-svg")).attr("width",maxIconWidth).attr("height",iconHeight).style("width","".concat(Math.ceil(maxIconWidth),"px")).style("height","".concat(iconHeight,"px")),transalate=maxIconWidth/2-padding;"rect"!==icon?function createShape(d,elem,defaultIcon){var groupElement=elem,shape=d[1]||defaultIcon,defaultIconSize=DEFAULTICONSIZE[shape]||DEFAULTICONSIZE.default,size=d[3]||defaultIconSize*Math.PI;if(shape instanceof Promise)shape.then(function(res){return d.shape=res,createShape(d,elem)});else{if(shape instanceof Element){var newShape=shape.cloneNode(!0);if("img"===newShape.nodeName.toLowerCase()){var src=newShape.src||newShape.href;(newShape=document.createElementNS("http://www.w3.org/2000/svg","image")).setAttribute("href",src)}return renderer_utils_selectElement(newShape).attr("transform","scale(".concat(size/100,")")),renderer_utils_selectElement(groupElement.node().appendChild(newShape))}var pathStr;if("string"==typeof shape)return pathStr=function checkPath(str){return!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(str)&&/[\dz]$/i.test(str)&&str.length>4)}(shape)?shape:defaults_ICON_MAP(shape).size(size)(),makeElement(groupElement,"path",function(data){return[data]}).attr("d",pathStr)}return d[1]="circle",createShape(d,elem,"circle")}(datum,makeElement(svg,"g",[datum[1]],"".concat(classPrefix,"-legend-icon")),icon).attr("transform","translate(".concat(transalate," ").concat(iconHeight/2,")")).attr("fill",datum[2]||color).attr("stroke",datum[2]||color):makeElement(svg,"rect",[datum[1]],"".concat(classPrefix,"-legend-icon")).attr("x",0).attr("y",0).attr("width",maxIconWidth).attr("height",iconHeight).attr("fill",datum[2]||color)};function discrete_legend_typeof(obj){"@babel/helpers - typeof";return(discrete_legend_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function discrete_legend_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function discrete_legend_toConsumableArray(arr){return function discrete_legend_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function discrete_legend_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function discrete_legend_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function discrete_legend_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function discrete_legend_possibleConstructorReturn(self,call){return!call||"object"!==discrete_legend_typeof(call)&&"function"!=typeof call?function discrete_legend_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function discrete_legend_get(target,property,receiver){return(discrete_legend_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function discrete_legend_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=discrete_legend_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function discrete_legend_getPrototypeOf(o){return(discrete_legend_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function discrete_legend_setPrototypeOf(o,p){return(discrete_legend_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var discrete_legend_DiscreteLegend=function(_SimpleLegend){function DiscreteLegend(){return function discrete_legend_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DiscreteLegend),discrete_legend_possibleConstructorReturn(this,discrete_legend_getPrototypeOf(DiscreteLegend).apply(this,arguments))}return function discrete_legend_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&discrete_legend_setPrototypeOf(subClass,superClass)}(DiscreteLegend,simple_legend_SimpleLegend),function discrete_legend_createClass(Constructor,protoProps,staticProps){return protoProps&&discrete_legend_defineProperties(Constructor.prototype,protoProps),staticProps&&discrete_legend_defineProperties(Constructor,staticProps),Constructor}(DiscreteLegend,[{key:"dataFromScale",value:function dataFromScale(){var scale=this.scale(),_getScaleInfo=legend_helper_getScaleInfo(scale),scaleType=_getScaleInfo.scaleType,domain=_getScaleInfo.domain,scaleFn=_getScaleInfo.scaleFn,steps=_getScaleInfo.steps,field=this.metaData().getFieldspace().fields[0],_field$schema=field.schema(),type=_field$schema.type,subtype=_field$schema.subtype,domainForLegend=[],len=(domainForLegend="size"===scaleType&&type===dist_datamodel.FieldType.MEASURE?steps instanceof Array?steps:common_utils_getReadableTicks(domain,domain.length):subtype===dist_datamodel.DimensionSubtype.TEMPORAL?discrete_legend_toConsumableArray(new Set(field.data())):discrete_legend_toConsumableArray(new Set(domain))).length;return domainForLegend=domainForLegend.map(function(ele,i){var _ref,value=0,range=0,rawVal=domainForLegend[i];if(type===dist_datamodel.FieldType.MEASURE){value=(+domainForLegend[i]).toFixed(0);var nextVal=domainForLegend[i+1]?+domainForLegend[i+1]:+value;range=[value,i===len-1?nextVal.toFixed(0):nextVal.toFixed(0)-1]}else{var domainVal=rawVal;subtype===dist_datamodel.DimensionSubtype.TEMPORAL&&(domainVal=common_utils_formatTemporal(domainForLegend[i],field.minimumConsecutiveDifference())),value=domainVal,range=[domainVal]}return discrete_legend_defineProperty(_ref={},scaleType,scale[scaleFn](ele)),discrete_legend_defineProperty(_ref,"value",value),discrete_legend_defineProperty(_ref,"id",i),discrete_legend_defineProperty(_ref,"range",range),discrete_legend_defineProperty(_ref,"rawVal",rawVal),_ref}).filter(function(d){return null!==d.value}),domainForLegend="size"===scaleType?domainForLegend.sort(function(a,b){return a[scaleType]-b[scaleType]}):domainForLegend.sort(function(a,b){return a.value instanceof src_InvalidAwareTypes||a.value instanceof src_InvalidAwareTypes?1:a.value.localeCompare(b.value)})}},{key:"render",value:function render(){var firebolt=this.firebolt(),data=this.data(),classPrefix=this.config().classPrefix,legendContainer=discrete_legend_get(discrete_legend_getPrototypeOf(DiscreteLegend.prototype),"render",this).call(this,this.mount()),legendItem=renderer_createLegendSkeleton(this,legendContainer,classPrefix,data).legendItem;return function renderDiscreteItem(context,container){var labelManager=context._labelManager,_context$config2=context.config(),item=_context$config2.item,classPrefix=_context$config2.classPrefix,shape=_context$config2.shape,align=_context$config2.align,_context$measurement2=context.measurement(),maxIconWidth=_context$measurement2.maxIconWidth,padding=_context$measurement2.padding,margin=_context$measurement2.margin,border=_context$measurement2.border,_item$icon=item.icon,iconWidth=_item$icon.width,iconHeight=_item$icon.height,color=_item$icon.color,className=_item$icon.className,textOrientation=item.text.orientation,formatter=item.text.formatter;labelManager.useEllipsesOnOverflow(!0),renderer_utils_applyStyle(container,{width:function width(d){return renderer_applyItemStyle(d,"width",!1,context)},height:function height(d){return renderer_applyItemStyle(d,"height",!1,context)},"text-align":"center",padding:"".concat(padding,"px")});var marginVerticalBuffer="top"!==textOrientation&&"bottom"!==textOrientation&&padding&&margin&&border?10:0;labelManager.setStyle(context._computedStyle);var dataArr=context.metaData(),position=OPPOSITE_POSITION[textOrientation]||"left";container.each(function(d,i){d[0]===VALUE?renderer_utils_selectElement(this).text(formatter(d[1],i,dataArr,context)).style("padding-".concat(position),"0px").style("margin-".concat(position),"".concat(align===HORIZONTAL?2:marginVerticalBuffer,"px")):(renderer_utils_selectElement(this).classed("".concat(classPrefix,"-").concat(className),!0),renderer_utils_selectElement(this).classed("".concat(classPrefix,"-").concat(className,"-").concat(i),!0),renderer_renderIcon(shape,renderer_utils_selectElement(this),d,{classPrefix:classPrefix,iconWidth:2*Math.sqrt(d[3]/Math.PI)||iconWidth,iconHeight:iconHeight,maxIconWidth:maxIconWidth,padding:padding,color:color,align:align}))})}(this,renderer_createItemSkeleton(this,legendItem).itemSkeleton),legendContainer.selectAll("div").filter(function(datum,i,allSelections){return!allSelections[i].classList.contains("".concat(classPrefix,"-legend-body"))}).style("float","left"),firebolt.mapActionsAndBehaviour(),legendContainer}}],[{key:"create",value:function create(dependencies){return new DiscreteLegend(dependencies)}},{key:"type",value:function type(){return"discrete"}}]),DiscreteLegend}(),getGradientDomain=function getGradientDomain(data){return"number"==typeof data[0].value?data.reduce(function(accumulator,currentValue){return[Math.min(currentValue.value,accumulator[0]),Math.max(currentValue.value,accumulator[1])]},[Number.MAX_VALUE,Number.MIN_VALUE]):data.map(function(e){return e.value})},gradient_helper_createLegendSkeleton=function createLegendSkeleton(container,classPrefix,data,id){var domain=getGradientDomain(data),legendContainer=makeElement(container,"div",[1],"".concat(classPrefix,"-legend-body")),legendGradSvg=makeElement(legendContainer,"svg",[1],"".concat(classPrefix,"-gradient")),legendGradCont=makeElement(legendGradSvg,"g",[1],"".concat(classPrefix,"-gradient-group"));return{legendContainer:legendContainer,legendGradCont:legendGradCont,legendGradSvg:legendGradSvg,linearGradient:function makeLinearGradient(container,data,domain,id){var defs=makeElement(container,"defs",[1]),linearGradient=makeElement(defs,"linearGradient",[1]).attr("id","linear-gradient-".concat(id)).attr("x1","0%").attr("y2","0%");return makeElement(linearGradient,"stop",data,"stop-gradient").attr("offset",function(d){return"".concat(100*(d.value-domain[0])/(domain[1]-domain[0])||1,"%")}).attr("stop-color",function(d){return d.color}),linearGradient}(legendGradSvg,data,domain,id),legendRect:makeElement(legendGradCont,"rect",[1],"".concat(classPrefix,"-gradient-rect"))}},gradient_helper_renderAxis=function renderAxis(context,container,height,width){var axis=context.axis();axis.source().config({tickFormat:function tickFormat(val,i){return context.config().item.text.formatter(val,i,context.metaData(),context)}}),axis.setAvailableSpace(width,height),axis.render(container.node()),axis.source().render()};function gradient_legend_typeof(obj){"@babel/helpers - typeof";return(gradient_legend_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function gradient_legend_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function gradient_legend_toConsumableArray(arr){return function gradient_legend_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function gradient_legend_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function gradient_legend_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function gradient_legend_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function gradient_legend_possibleConstructorReturn(self,call){return!call||"object"!==gradient_legend_typeof(call)&&"function"!=typeof call?function gradient_legend_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function gradient_legend_get(target,property,receiver){return(gradient_legend_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function gradient_legend_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=gradient_legend_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function gradient_legend_getPrototypeOf(o){return(gradient_legend_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function gradient_legend_setPrototypeOf(o,p){return(gradient_legend_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var gradient_legend_GradientLegend=function(_SimpleLegend){function GradientLegend(){return function gradient_legend_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GradientLegend),gradient_legend_possibleConstructorReturn(this,gradient_legend_getPrototypeOf(GradientLegend).apply(this,arguments))}return function gradient_legend_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&gradient_legend_setPrototypeOf(subClass,superClass)}(GradientLegend,simple_legend_SimpleLegend),function gradient_legend_createClass(Constructor,protoProps,staticProps){return protoProps&&gradient_legend_defineProperties(Constructor.prototype,protoProps),staticProps&&gradient_legend_defineProperties(Constructor,staticProps),Constructor}(GradientLegend,[{key:"axis",value:function axis(){return arguments.length?(this._axis=arguments.length<=0?void 0:arguments[0],this):this._axis}},{key:"dataFromScale",value:function dataFromScale(){var domainForLegend=[],scale=this.scale(),_getScaleInfo=legend_helper_getScaleInfo(scale),scaleType=_getScaleInfo.scaleType,domain=_getScaleInfo.domain,steps=_getScaleInfo.steps,scaleFn=_getScaleInfo.scaleFn,scaleParams={smartLabel:this.labelManager(),measures:this.measurement(),alignment:this.config().position,minTickDistance:this.minTickDistance()};return steps instanceof Array?(domain[0]<steps[0]&&(domainForLegend[0]=domain[0]),domainForLegend=[].concat(gradient_legend_toConsumableArray(domainForLegend),gradient_legend_toConsumableArray(steps)),domain[domain.length-1]>steps[steps.length-1]&&domainForLegend.push(domain[1]),domainForLegend=gradient_legend_toConsumableArray(new Set(domainForLegend)).sort(function(a,b){return a-b}),domainForLegend=legend_helper_getInterpolatedArrayData(domainForLegend,scaleParams)):domainForLegend=legend_helper_getInterpolatedData(domain,steps-1,scaleParams),(domainForLegend=gradient_legend_toConsumableArray(new Set(domainForLegend)).sort(function(a,b){return a-b})).map(function(ele,i){var _ref,value=domainForLegend[i];return gradient_legend_defineProperty(_ref={},scaleType,"size"===scaleType?scale[scaleFn](ele)*scale.getScaleFactor():scale[scaleFn](ele)),gradient_legend_defineProperty(_ref,"value",+value.toFixed(1)),gradient_legend_defineProperty(_ref,"id",i),_ref}).filter(function(d){return null!==d.value})}},{key:"getLabelSpaces",value:function getLabelSpaces(effPadding){this.config({item:{text:{orientation:this.config().position}}});var axis=function createAxis(context){var data=context.data(),align=context.config().align,AxisCell=context._cells.AxisCell,newAxis=new continous_axis_ContinousAxis({id:"legend-".concat(context._id),orientation:align===ALIGN_VERTICAL?"right":"bottom",style:context._computedStyle,nice:!1,showAxisName:!1,tickValues:data.map(function(d){return d.value}),fixedBaseline:!1,labels:{rotation:null}},{labelManager:context._labelManager});return newAxis.domain(getGradientDomain(data)),newAxis.range([1,1]),(new AxisCell).source(newAxis).config({margin:{left:0,bottom:0,top:0,right:0}})}(this),axisSpace=axis.getLogicalSpace(),space={width:axisSpace.width-effPadding,height:axisSpace.height-effPadding},axisDomainLength=axis.source().domain().length,labelSpaces=new Array(axisDomainLength).fill(space);return this.axis(axis),labelSpaces}},{key:"getDrawingContext",value:function getDrawingContext(){return{svgContainer:this._legendGradientSvg}}},{key:"render",value:function render(){var firebolt=this.firebolt(),legendContainer=gradient_legend_get(gradient_legend_getPrototypeOf(GradientLegend.prototype),"render",this).call(this,this.mount());return function renderGradient(context,container){var gradHeight,gradWidth,_context$config2=context.config(),align=_context$config2.align,classPrefix=_context$config2.classPrefix,item=_context$config2.item,data=context.data(),_createLegendSkeleton=gradient_helper_createLegendSkeleton(container,classPrefix,data,context._id),legendContainer=_createLegendSkeleton.legendContainer,legendGradSvg=_createLegendSkeleton.legendGradSvg,legendGradCont=_createLegendSkeleton.legendGradCont,linearGradient=_createLegendSkeleton.linearGradient,legendRect=_createLegendSkeleton.legendRect,labelDim=context.axis().source().getAxisDimensions().tickDimensions,_context$measurement=context.measurement(),padding=_context$measurement.padding,margin=_context$measurement.margin,border=_context$measurement.border,titleSpaces=_context$measurement.titleSpaces,maxItemSpaces=_context$measurement.maxItemSpaces,maxHeight=_context$measurement.maxHeight,maxWidth=_context$measurement.maxWidth,height=_context$measurement.height,width=_context$measurement.width,gradientDimensions={};gradHeight=Math.floor(Math.min(height,maxHeight)-(titleSpaces.height+2*margin+2*border)),gradWidth=Math.floor(Math.min(width,maxWidth)-(2*margin+2*border));var markerWithBuffer=LEGEND_MARKER_PROPS_size+LEGEND_MARKER_PROPS_BUFFER;align===ALIGN_HORIZONTAL?(gradientDimensions.height=item.icon.height,gradientDimensions.width=gradWidth-2*padding-labelDim.width/2,linearGradient.attr("x2","100%").attr("y1","0%"),legendGradCont.attr("transform","translate( ".concat(labelDim.width/2," ").concat(markerWithBuffer,")")),gradient_helper_renderAxis(context,legendContainer,gradHeight-item.icon.height-padding,gradWidth-2*padding-1),renderer_utils_applyStyle(legendContainer,{height:"".concat(maxItemSpaces.height+border+padding,"px"),width:"".concat(Math.min(width,maxWidth),"px"),padding:"".concat(padding,"px")}),legendRect.attr("height",gradientDimensions.height),legendRect.attr("width",gradientDimensions.width-labelDim.width/2)):(gradientDimensions.height=gradHeight-2*padding-labelDim.height/2,gradientDimensions.width=item.icon.width,linearGradient.attr("x2","0%").attr("y1","100%"),legendGradCont.attr("transform","translate(".concat(markerWithBuffer," ").concat(labelDim.height/2,")")),gradient_helper_renderAxis(context,legendContainer,gradHeight-2*padding-1,gradWidth-(gradientDimensions.width+markerWithBuffer)-2*padding),renderer_utils_applyStyle(legendContainer,{height:"".concat(Math.min(height,maxHeight),"px"),width:"".concat(maxWidth,"px"),padding:"".concat(padding,"px")}),legendRect.attr("height",gradientDimensions.height-labelDim.height/2),legendRect.attr("width",gradientDimensions.width)),renderer_utils_applyStyle(legendGradSvg,{height:"".concat(gradientDimensions.height+markerWithBuffer,"px"),width:"".concat(gradientDimensions.width+markerWithBuffer,"px")}),renderer_utils_applyStyle(legendRect,{fill:"url(#linear-gradient-".concat(context._id,")")}),legendGradSvg.attr("height",gradientDimensions.height+markerWithBuffer),legendGradSvg.attr("width",gradientDimensions.width+markerWithBuffer),context.measurement({gradientDimensions:gradientDimensions}),context._legendGradientSvg=legendGradSvg}(this,legendContainer),legendContainer.selectAll("div").style("float","left"),firebolt.mapActionsAndBehaviour(),firebolt.mapSideEffects(gradient_legend_defineProperty({},"highlight",["marker"])),legendContainer}},{key:"getCriteriaFromData",value:function getCriteriaFromData(data){return[[this.fieldName()],[data.value]]}},{key:"getRangeFromIdentifiers",value:function getRangeFromIdentifiers(_ref2){var fields=_ref2.fields,criteria=_ref2.criteria;return fields.reduce(function(range,v){return range[v]=criteria[v],range},{})}}],[{key:"create",value:function create(dependencies){return new GradientLegend(dependencies)}},{key:"type",value:function type(){return"gradient"}}]),GradientLegend}();function step_legend_typeof(obj){"@babel/helpers - typeof";return(step_legend_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function step_legend_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function step_legend_toConsumableArray(arr){return function step_legend_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function step_legend_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function step_legend_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function step_legend_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function step_legend_possibleConstructorReturn(self,call){return!call||"object"!==step_legend_typeof(call)&&"function"!=typeof call?function step_legend_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function step_legend_get(target,property,receiver){return(step_legend_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function step_legend_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=step_legend_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function step_legend_getPrototypeOf(o){return(step_legend_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function step_legend_setPrototypeOf(o,p){return(step_legend_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _LEGEND_TYPE_MAP,step_legend_StepLegend=function(_SimpleLegend){function StepLegend(){return function step_legend_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,StepLegend),step_legend_possibleConstructorReturn(this,step_legend_getPrototypeOf(StepLegend).apply(this,arguments))}return function step_legend_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&step_legend_setPrototypeOf(subClass,superClass)}(StepLegend,simple_legend_SimpleLegend),function step_legend_createClass(Constructor,protoProps,staticProps){return protoProps&&step_legend_defineProperties(Constructor.prototype,protoProps),staticProps&&step_legend_defineProperties(Constructor,staticProps),Constructor}(StepLegend,[{key:"dataFromScale",value:function dataFromScale(){var domainLeg=[],scale=this.scale(),_getScaleInfo=legend_helper_getScaleInfo(scale),scaleType=_getScaleInfo.scaleType,domain=_getScaleInfo.domain,steps=_getScaleInfo.steps,scaleFn=_getScaleInfo.scaleFn,isFraction=function isFraction(ele){return ele%1!=0},scaleParams={smartLabel:this.labelManager(),measures:this.measurement(),alignment:this.config().position,minTickDistance:this.minTickDistance()};return steps instanceof Array?(domain[0]<steps[0]&&(domainLeg[0]=domain[0]),domainLeg=[].concat(step_legend_toConsumableArray(domainLeg),step_legend_toConsumableArray(steps)),domain[domain.length-1]>steps[steps.length-1]&&domainLeg.push(domain[1]),domainLeg=step_legend_toConsumableArray(new Set(domainLeg)).sort(function(a,b){return a-b})):domainLeg=legend_helper_getInterpolatedData(domain,steps,scaleParams),domainLeg=(domainLeg=step_legend_toConsumableArray(new Set(domainLeg)).sort(function(a,b){return a-b})).map(function(ele,i){var _ref,range,value=null;if(i<domainLeg.length-1){var left=isFraction(ele)?ele.toFixed(1):ele,numRight=+domainLeg[i+1],right=isFraction(numRight)?numRight.toFixed(1):numRight;value="".concat(left," - ").concat(right),range=[left,right]}else if(1===domainLeg.length){value=isFraction(ele)?ele.toFixed(1):ele;var _numRight=+domainLeg[i+1];range=[value,isFraction(_numRight)?_numRight.toFixed(1):_numRight]}return step_legend_defineProperty(_ref={},scaleType,"size"===scaleType?scale[scaleFn](ele)*scale.getScaleFactor():scale[scaleFn](ele)),step_legend_defineProperty(_ref,"value",value),step_legend_defineProperty(_ref,"id",i+1),step_legend_defineProperty(_ref,"range",range),_ref}).filter(function(d){return null!==d.value})}},{key:"getLabelSpaces",value:function getLabelSpaces(){this.config({item:{text:{orientation:this.config().position}}});var item=this.config().item;return getItemMeasures(this,"range",item.text.formatter)}},{key:"elemType",value:function elemType(){return"rect"}},{key:"render",value:function render(){var firebolt=this.firebolt(),_this$config2=this.config(),classPrefix=_this$config2.classPrefix,position=_this$config2.position,data=function stepData(data){var _ref;return position_config_defineProperty(_ref={},"left",data.reverse()),position_config_defineProperty(_ref,"right",data.reverse()),position_config_defineProperty(_ref,"top",data),position_config_defineProperty(_ref,"bottom",data),_ref}(this.data())[position],legendContainer=step_legend_get(step_legend_getPrototypeOf(StepLegend.prototype),"render",this).call(this,this.mount()),legendItem=renderer_createLegendSkeleton(this,legendContainer,classPrefix,data).legendItem;return function renderStepItem(context,container){var labelManager=context._labelManager,_context$config3=context.config(),item=_context$config3.item,position=_context$config3.position,classPrefix=_context$config3.classPrefix,_context$measurement3=context.measurement(),maxItemSpaces=_context$measurement3.maxItemSpaces,maxIconWidth=_context$measurement3.maxIconWidth,padding=_context$measurement3.padding,_item$icon2=item.icon,width=_item$icon2.width,height=_item$icon2.height,color=_item$icon2.color,formatter=item.text.formatter;labelManager.useEllipsesOnOverflow(!0);var _positionConfig$posit=positionConfig[position].getStepSpacesInfo({maxItemSpaces:maxItemSpaces,height:height,width:width}),iconHeight=_positionConfig$posit.iconHeight,iconWidth=_positionConfig$posit.iconWidth,stepPadding=_positionConfig$posit.stepPadding;renderer_utils_applyStyle(container,{width:function width(d){return renderer_applyItemStyle(d,"width",stepPadding.horizontal,context)},height:function height(d){return renderer_applyItemStyle(d,"height",stepPadding.vertical,context)},"text-align":"center",padding:"".concat(padding,"px")}),labelManager.setStyle(context._computedStyle);var dataArr=context.metaData(),data=context.data();container.each(function(d,i){if(d[0]===VALUE){var formattedData=formatter([data[d[6]].range[0],data[d[6]].range[1]],i,dataArr,context);renderer_utils_selectElement(this).text(formattedData)}else renderer_renderIcon("rect",renderer_utils_selectElement(this),d,{classPrefix:classPrefix,iconWidth:iconWidth,iconHeight:iconHeight,maxIconWidth:maxIconWidth,color:color})})}(this,renderer_createItemSkeleton(this,legendItem).itemSkeleton),legendContainer.selectAll("div").style("float","left"),firebolt.mapActionsAndBehaviour(),legendContainer}},{key:"getCriteriaFromData",value:function getCriteriaFromData(data){return step_legend_defineProperty({},this.fieldName(),data.range)}}],[{key:"create",value:function create(dependencies){return new StepLegend(dependencies)}},{key:"type",value:function type(){return"step"}},{key:"defaultConfig",value:function defaultConfig(){return STEP_DEFAULT_CONFIG.buffer.horizontal=0,STEP_DEFAULT_CONFIG}}]),StepLegend}();function src_constants_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var PADDING="padding",BORDER="border",MARGIN="margin",TITLE_TEMPLATE_NOT_ALLOWED_TAGS=["script","style"],IS_POINT_MAP={true:"circle",false:"square"},LEGEND_TYPE_MAP=(src_constants_defineProperty(_LEGEND_TYPE_MAP={},"".concat("ordinal","-",!0,"-").concat("color"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("ordinal","-",!0,"-").concat("size"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("ordinal","-",!0,"-").concat("shape"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("ordinal","-",!1,"-").concat("color"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("ordinal","-",!1,"-").concat("shape"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("ordinal","-",!1,"-").concat("size"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("linear","-",!1,"-").concat("size"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("linear","-",!0,"-").concat("size"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("linear","-",!1,"-").concat("shape"),discrete_legend_DiscreteLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("linear","-",!0,"-").concat("color"),step_legend_StepLegend),src_constants_defineProperty(_LEGEND_TYPE_MAP,"".concat("linear","-",!1,"-").concat("color"),gradient_legend_GradientLegend),_LEGEND_TYPE_MAP),src_constants_LEFT="left",src_constants_RIGHT="right",src_constants_BOTTOM="bottom",src_constants_TOP="top",HORIZONTAL_CENTER="h-center",VERTICAL_CENTER="v-center";function operators_construct(Parent,args,Class){return(operators_construct=function operators_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&operators_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function operators_setPrototypeOf(o,p){return(operators_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function operators_toConsumableArray(arr){return function operators_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function operators_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function operators_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var operators_share=function share(){for(var _len=arguments.length,vars=new Array(_len),_key=0;_key<_len;_key++)vars[_key]=arguments[_key];return operators_construct(composed_vars,operators_toConsumableArray(vars.map(function(variable){return new simple_var_SimpleVariable(variable)})))};function operators_html(strings){for(var htmlCode="",expLn=arguments.length<=1?0:arguments.length-1,i=0;i<expLn;++i)htmlCode+=strings[i]+(i+1<1||arguments.length<=i+1?void 0:arguments[i+1]);htmlCode+=strings[i];var frag=document.createDocumentFragment(),wrapper=document.createElement("div");frag.appendChild(wrapper),wrapper.innerHTML=htmlCode,function treeShakeNode(node){if(node.nodeType===Node.ELEMENT_NODE)if(-1!==TITLE_TEMPLATE_NOT_ALLOWED_TAGS.indexOf(node.tagName.toLowerCase()))node.parentNode.removeChild(node);else{var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=node.childNodes[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0)treeShakeNode(_step.value)}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}}(wrapper);var innerHTML=wrapper.innerHTML;return function(){return innerHTML}}function action_model_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _localOptions,_canvasOptions,action_model_canvasIterator=function canvasIterator(canvases,iteratorFn,cFn){canvases.forEach(function(canvas){canvas.composition().visualGroup.matrixInstance().value.each(function(cell){return iteratorFn(cell.valueOf().firebolt())}),cFn&&cFn(canvas),canvas._throwback.registerImmediateListener([common_props.MATRIX_CREATED],function listenerFn(canvas,fn){return function(){canvas.composition().visualGroup.matrixInstance().value.each(function(cell){return fn(cell.valueOf().firebolt())})}}(canvas,iteratorFn))})},registerActions=function registerActions(context,type,fnName,deps){context._registrableComponents.forEach(function(canvas){canvas.composition().visualGroup.resolver().setFireboltDependencies(type,deps),canvas.firebolt()[fnName](deps)})},actionModel=new(function(){function ActionModel(){!function action_model_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ActionModel),this._registrableComponents=[]}return function action_model_createClass(Constructor,protoProps,staticProps){return protoProps&&action_model_defineProperties(Constructor.prototype,protoProps),staticProps&&action_model_defineProperties(Constructor,staticProps),Constructor}(ActionModel,[{key:"for",value:function _for(){for(var _len=arguments.length,components=new Array(_len),_key=0;_key<_len;_key++)components[_key]=arguments[_key];return this._registrableComponents=components,this}},{key:"registerPhysicalActions",value:function registerPhysicalActions(action){return registerActions(this,"physicalActions","registerPhysicalActions",action),this}},{key:"registerBehaviouralActions",value:function registerBehaviouralActions(){for(var _len2=arguments.length,actions=new Array(_len2),_key2=0;_key2<_len2;_key2++)actions[_key2]=arguments[_key2];return registerActions(this,"behaviouralActions","registerBehaviouralActions",actions),this}},{key:"registerPhysicalBehaviouralMap",value:function registerPhysicalBehaviouralMap(map){return action_model_canvasIterator(this._registrableComponents,function(firebolt){firebolt.registerPhysicalBehaviouralMap(map)},function(canvas){canvas.firebolt().registerPhysicalBehaviouralMap(map)}),this}},{key:"registerPropagationBehaviourMap",value:function registerPropagationBehaviourMap(map){return action_model_canvasIterator(this._registrableComponents,function(firebolt){firebolt.registerPropagationBehaviourMap(map)},function(canvas){canvas.firebolt().registerPropagationBehaviourMap(map)}),this}},{key:"mapSideEffects",value:function mapSideEffects(map){return action_model_canvasIterator(this._registrableComponents,function(firebolt){firebolt.mapSideEffects(map)},function(canvas){canvas.firebolt().mapSideEffects(map)}),this}},{key:"registerSideEffects",value:function registerSideEffects(){for(var _len3=arguments.length,sideEffects=new Array(_len3),_key3=0;_key3<_len3;_key3++)sideEffects[_key3]=arguments[_key3];return registerActions(this,"sideEffects","registerSideEffects",sideEffects),this}},{key:"dissociateBehaviour",value:function dissociateBehaviour(){for(var _len4=arguments.length,maps=new Array(_len4),_key4=0;_key4<_len4;_key4++)maps[_key4]=arguments[_key4];return action_model_canvasIterator(this._registrableComponents,function(firebolt){maps.forEach(function(val){return firebolt.dissociateBehaviour(val[0],val[1])})},function(canvas){maps.forEach(function(val){return canvas.firebolt().dissociateBehaviour(val[0],val[1])})}),this}},{key:"dissociateSideEffect",value:function dissociateSideEffect(){for(var _len5=arguments.length,maps=new Array(_len5),_key5=0;_key5<_len5;_key5++)maps[_key5]=arguments[_key5];return action_model_canvasIterator(this._registrableComponents,function(firebolt){maps.forEach(function(val){return firebolt.dissociateSideEffect(val[0],val[1])})},function(canvas){maps.forEach(function(val){return canvas.firebolt().dissociateSideEffect(val[0],val[1])})}),this}},{key:"enableCrossInteractivity",value:function enableCrossInteractivity(){var policy=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},registrableComponents=this._registrableComponents,mergedPolicy=mergeRecursive(mergeRecursive({},function defaultPolicy(registrableComponents){var aliases=registrableComponents.map(function(comp){return comp.alias()});return{behaviours:{"*":function _(propagationPayload){var propagationCanvas=propagationPayload.sourceCanvas;return!propagationCanvas||-1!==aliases.indexOf(propagationCanvas)}},sideEffects:{"*":function _(propagationPayload){var propagationCanvas=propagationPayload.sourceCanvas;return!propagationCanvas||-1!==aliases.indexOf(propagationCanvas)}}}}(registrableComponents)),policy);return registrableComponents.forEach(function(canvas){canvas.firebolt().crossInteractionPolicy(mergedPolicy)}),this}}]),ActionModel}()),TITLE_CONFIG={position:"top",align:"left",padding:4,className:"".concat("muze","-title-container")},SUB_TITLE_CONFIG={position:"top",align:"left",padding:16,maxLines:2,className:"".concat("muze","-subtitle-container")},MESSAGE_CONFIG={className:"".concat("muze","-message-container"),baseFontLimit:16,upperFontLimit:24,baseSizeLimit:100,upperSizeLimit:300,fractionImage:.8,fractionChild:.7};function local_options_typeof(obj){"@babel/helpers - typeof";return(local_options_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function local_options_slicedToArray(arr,i){return function local_options_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function local_options_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function local_options_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function canvas_local_options_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var canvas_local_options_localOptions=(canvas_local_options_defineProperty(_localOptions={},"rows",{value:null,meta:{typeCheck:"constructor",typeExpected:"Array"}}),canvas_local_options_defineProperty(_localOptions,"columns",{value:null,meta:{typeCheck:"constructor",typeExpected:"Array"}}),canvas_local_options_defineProperty(_localOptions,"color",{value:null,meta:{typeCheck:"constructor",typeExpected:"Object",sanitization:function sanitization(config){return"string"!=typeof config&&config?config:{field:config}}}}),canvas_local_options_defineProperty(_localOptions,"shape",{value:null,meta:{typeCheck:"constructor",typeExpected:"Object",sanitization:function sanitization(config){return"string"!=typeof config&&config?config:{field:config}}}}),canvas_local_options_defineProperty(_localOptions,"size",{value:null,meta:{typeCheck:"constructor",typeExpected:"Object",sanitization:function sanitization(config){return"string"!=typeof config&&config?config:{field:config}}}}),canvas_local_options_defineProperty(_localOptions,"detail",{value:[],meta:{typeCheck:"constructor",typeExpected:"Array"}}),canvas_local_options_defineProperty(_localOptions,"layers",{value:[],meta:{typeCheck:"constructor",typeExpected:"Array"}}),canvas_local_options_defineProperty(_localOptions,"transform",{value:null,meta:{typeCheck:"constructor",typeExpected:"Object"}}),_localOptions),canvasOptions=(canvas_local_options_defineProperty(_canvasOptions={},"title",{value:[null,null],meta:{takesMultipleParams:!0,typeCheck:function typeCheck(_ref){var _ref2=local_options_slicedToArray(_ref,2),arg1=_ref2[0],arg2=_ref2[1];return"function"==typeof arg1&&"object"===local_options_typeof(arg2)},sanitization:function sanitization(_ref3){var _ref4=local_options_slicedToArray(_ref3,2),title=_ref4[0],titleConfig=_ref4[1],t=title;"string"!=typeof title&&title||(t=function t(){return title});var defConfig=mergeRecursive({},TITLE_CONFIG);return[t,mergeRecursive(defConfig,titleConfig)]}}}),canvas_local_options_defineProperty(_canvasOptions,"subtitle",{value:[null,null],meta:{takesMultipleParams:!0,typeCheck:function typeCheck(_ref5){var _ref6=local_options_slicedToArray(_ref5,2),arg1=_ref6[0],arg2=_ref6[1];return"function"==typeof arg1&&"object"===local_options_typeof(arg2)},sanitization:function sanitization(_ref7){var _ref8=local_options_slicedToArray(_ref7,2),subtitle=_ref8[0],subtitleConfig=_ref8[1],sub=subtitle;"string"!=typeof subtitle&&subtitle||(sub=function sub(){return subtitle});var defConfig=mergeRecursive({},SUB_TITLE_CONFIG);return[sub,mergeRecursive(defConfig,subtitleConfig)]}}}),_canvasOptions);function layoutComponent_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var LayoutComponent=function(){function LayoutComponent(name,dimensions,seed){!function layoutComponent_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LayoutComponent),this._seed=seed,this._boundBox={height:dimensions.height,width:dimensions.width,top:null,left:null},this._renderAt=null,this._alignWith=null,this._alignment=null,this._target=null,this._position=null,this._componentName=name,this._className=null}return function layoutComponent_createClass(Constructor,protoProps,staticProps){return protoProps&&layoutComponent_defineProperties(Constructor.prototype,protoProps),staticProps&&layoutComponent_defineProperties(Constructor,staticProps),Constructor}(LayoutComponent,[{key:"getLogicalSpace",value:function getLogicalSpace(){throw new Error("getLogicalSpace is not defined")}},{key:"setSpatialConfig",value:function setSpatialConfig(){throw new Error("setSpatialSpace is not defined")}},{key:"name",value:function name(param){return param&&(this._componentName=param),this._componentName}},{key:"target",value:function target(param){return param&&(this._target=param),this._target}},{key:"position",value:function position(param){return param&&(this._position=param),this._position}},{key:"alignment",value:function alignment(param){return param&&(this._alignment=param),this._alignment}},{key:"alignWith",value:function alignWith(param){return param&&(this._alignWith=param),this._alignWith}},{key:"renderAt",value:function renderAt(param){return param&&(this._renderAt=param),this._renderAt}},{key:"boundBox",value:function boundBox(param){return param&&Object.assign(this._boundBox,param),this._boundBox}},{key:"className",value:function className(param){return param&&(this._className=param),this._className}},{key:"draw",value:function draw(){throw new Error("draw is not defined")}},{key:"attachListener",value:function attachListener(){return this}}]),LayoutComponent}();function dummy_component_typeof(obj){"@babel/helpers - typeof";return(dummy_component_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function dummy_component_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function dummy_component_possibleConstructorReturn(self,call){return!call||"object"!==dummy_component_typeof(call)&&"function"!=typeof call?function dummy_component_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function dummy_component_getPrototypeOf(o){return(dummy_component_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function dummy_component_setPrototypeOf(o,p){return(dummy_component_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var dummy_component=function(_LayoutComponent){function DummyComponent(){return function dummy_component_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DummyComponent),dummy_component_possibleConstructorReturn(this,dummy_component_getPrototypeOf(DummyComponent).apply(this,arguments))}return function dummy_component_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&dummy_component_setPrototypeOf(subClass,superClass)}(DummyComponent,LayoutComponent),function dummy_component_createClass(Constructor,protoProps,staticProps){return protoProps&&dummy_component_defineProperties(Constructor.prototype,protoProps),staticProps&&dummy_component_defineProperties(Constructor,staticProps),Constructor}(DummyComponent,[{key:"getLogicalSpace",value:function getLogicalSpace(){return{width:this.boundBox().width,height:this.boundBox().height}}},{key:"setSpatialConfig",value:function setSpatialConfig(conf){return this.boundBox({top:conf.y,left:conf.x}),this.newDimensions={width:conf.width,height:conf.height},this.renderAt(conf.renderAt),this}},{key:"draw",value:function draw(){if(!this.component)throw new Error("Component not set for ".concat(this.componentName));return this.component.mount(document.getElementById(this.renderAt)),this}}]),DummyComponent}(),src_defaults_DEFAULT_CONFIG={classPrefix:"muze",interaction:{sideEffects:{tooltip:"common"},behaviours:{highlight:"common",select:"common",brush:"common",filter:"common"},tooltip:{}},pagination:"scroll",scrollBar:{thickness:10,speed:2,vertical:{align:"right"},horizontal:{align:"bottom"}},legend:{position:"right",color:{show:!0,padding:1,margin:3,border:1,height:20,width:20},shape:{show:!0,padding:1,margin:3,border:1,height:20,width:20},size:{show:!0,padding:1,margin:3,border:1,height:20,width:20}},showHeaders:!1,minWidth:100,minHeight:100,facet:{rows:{minCharacters:3},columns:{maxLines:2,verticalAlign:"middle",minCharacters:1}},border:{style:"solid",color:"#d6d6d6",width:2,collapse:!0,spacing:0},autoGroupBy:{disabled:!1},invalidValues:{},sort:{}},EXCLUDE_CONFIG_KEYS=["sort"],DEFAULT_WIDTH=600,DEFAULT_HEIGHT=400,DEFAULT_CLASS_NAME="".concat(src_defaults_DEFAULT_CONFIG.classPrefix,"-layout-container-component"),NODE_PREFIX="".concat(src_defaults_DEFAULT_CONFIG.classPrefix,"-layout-container");function definitionModel_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var DefinitionModel=function(){function DefinitionModel(config){!function definitionModel_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DefinitionModel),this._host=config.host||null,this._cut=config.cut||null,this._ratioWeight=0===config.ratioWeight?0:config.ratioWeight||1,this._preferred=config.preferred||!1,this._lanes=config.lanes||[],this._remainingHeight=0,this._remainingWidth=0}return function definitionModel_createClass(Constructor,protoProps,staticProps){return protoProps&&definitionModel_defineProperties(Constructor.prototype,protoProps),staticProps&&definitionModel_defineProperties(Constructor,staticProps),Constructor}(DefinitionModel,[{key:"host",value:function host(_host){return _host&&(this._host=_host),this._host}},{key:"preferred",value:function preferred(_preferred){return _preferred&&(this._preferred=_preferred),this._preferred}},{key:"cut",value:function cut(_cut){return _cut&&(this._cut=_cut),this._cut}},{key:"ratioWeight",value:function ratioWeight(_ratioWeight){return _ratioWeight&&(this._ratioWeight=_ratioWeight),this._ratioWeight}},{key:"lanes",value:function lanes(_lanes){return _lanes&&(this._lanes=_lanes),this._lanes}},{key:"remainingHeight",value:function remainingHeight(_remainingHeight){return _remainingHeight&&(this._remainingHeight=_remainingHeight),this._remainingHeight}},{key:"remainingWidth",value:function remainingWidth(_remainingWidth){return _remainingWidth&&(this._remainingWidth=_remainingWidth),this._remainingWidth}}]),DefinitionModel}();var getNodeId=function(){var _uid=0;return function(){return"".concat(NODE_PREFIX,"-").concat(++_uid)}}();function yExtraSpace(node){var smallestHeight=0;if("v"===node.getCutType())smallestHeight=function smallestExtraHeightHorizontally(node){var smallestHeight=Number.MAX_SAFE_INTEGER;return node.children().forEach(function(child){var h=yExtraSpace(child);h<smallestHeight&&(smallestHeight=h)}),smallestHeight}(node);else if("h"===node.getCutType())node.children().forEach(function(child){smallestHeight+=yExtraSpace(child)});else if(node.model().host()&&node.model().host().getLogicalSpace){var containerHeight=node.boundBox().height,hostHeight=node.model().host().getLogicalSpace().height;(smallestHeight=containerHeight-hostHeight)<0&&(smallestHeight=0)}else smallestHeight=0;return smallestHeight}function xExtraSpace(node){var smallestWidth=0;if("h"===node.getCutType())smallestWidth=function smallestExtraWidthVertically(node){var smallestWidth=Number.MAX_SAFE_INTEGER;return node.children().forEach(function(child){var w=xExtraSpace(child);w<smallestWidth&&(smallestWidth=w)}),smallestWidth}(node);else if("v"===node.getCutType())node.children().forEach(function(child){smallestWidth+=xExtraSpace(child)});else if(node.model().host()&&node.model().host().getLogicalSpace){var containerWidth=node.boundBox().width,hostWidth=node.model().host().getLogicalSpace().width;(smallestWidth=containerWidth-hostWidth)<0&&(smallestWidth=0)}else smallestWidth=0;return smallestWidth}function createPlaceHolderComponent(height,width,position){var comp=new dummy_component(0,{height:height,width:width});return comp.name("placeHolder"),comp.position(position),comp}function placeComponent(definitionModel,component){var leftOvercomponentRationWidth,isPreferred=arguments.length>2&&void 0!==arguments[2]&&arguments[2],isGridComponent=arguments.length>3&&void 0!==arguments[3]&&arguments[3],cut="",componentRatioWidth=1,leftHeight=0,leftWidth=0;if(!component)return{first:definitionModel,second:definitionModel};var _component$getLogical=component.getLogicalSpace(),componentHeight=_component$getLogical.height,componentWidth=_component$getLogical.width,position=component.position();"top"===position||"bottom"===position?(cut="h",componentRatioWidth=componentHeight/definitionModel.remainingHeight(),leftHeight=definitionModel.remainingHeight()-componentHeight,leftWidth=definitionModel.remainingWidth()):(cut="v",componentRatioWidth=componentWidth/definitionModel.remainingWidth(),leftWidth=definitionModel.remainingWidth()-componentWidth,leftHeight=definitionModel.remainingHeight()),leftOvercomponentRationWidth=1-componentRatioWidth,definitionModel.cut(cut);var firstLaneConfig={host:component.name(),cut:null,ratioWeight:componentRatioWidth,preferred:!isGridComponent&&isPreferred,lanes:[]},firstLane=new DefinitionModel(firstLaneConfig);firstLane.remainingHeight(componentHeight),firstLane.remainingWidth(componentWidth);var secondLane=new DefinitionModel({host:null,cut:null,ratioWeight:leftOvercomponentRationWidth,preferred:!isGridComponent&&!isPreferred,lanes:[]});return secondLane.remainingHeight(leftHeight),secondLane.remainingWidth(leftWidth),isPreferred?definitionModel.lanes([firstLane]):"top"===position||"left"===position?definitionModel.lanes([firstLane,secondLane]):definitionModel.lanes([secondLane,firstLane]),{first:firstLane,second:secondLane}}function tree_toConsumableArray(arr){return function tree_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function tree_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function tree_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function tree_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var layout_definition_tree=function(){function Node(data){!function tree_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Node),this._model=data,this._parent=null,this._children=[],this._parentCut=null,this._boundBox={top:null,left:null,height:null,width:null},this._id=this._model.host()instanceof LayoutComponent&&this._model.host().renderAt()?this._model.host().renderAt():getNodeId()}return function tree_createClass(Constructor,protoProps,staticProps){return protoProps&&tree_defineProperties(Constructor.prototype,protoProps),staticProps&&tree_defineProperties(Constructor,staticProps),Constructor}(Node,[{key:"addChildren",value:function addChildren(entries){var _this$_children,_this=this;(_this$_children=this._children).push.apply(_this$_children,tree_toConsumableArray(entries)),entries.forEach(function(e){e.parent(_this)})}},{key:"isRoot",value:function isRoot(){return null===this._parent}},{key:"isLeaf",value:function isLeaf(){return!this._children.length}},{key:"getCutType",value:function getCutType(){return this._model.cut()}},{key:"isPreferred",value:function isPreferred(){return!!this._model.preferred()}},{key:"children",value:function children(_children){return _children&&(this._children=_children),this._children}},{key:"parent",value:function parent(_parent){return _parent&&(this._parent=_parent),this._parent}},{key:"parentCut",value:function parentCut(_parentCut){return _parentCut&&(this._parentCut=_parentCut),this._parentCut}},{key:"id",value:function id(_id){return _id&&(this._id=_id),this._id}},{key:"model",value:function model(_model){return _model&&(this._model=_model),this._model}},{key:"boundBox",value:function boundBox(bound){return bound&&(this._boundBox={top:bound.top,left:bound.left,height:bound.height,width:bound.width}),this._boundBox}},{key:"updateNode",value:function updateNode(nodeconfig){var _this2=this;this._id===nodeconfig._id?(this._model.cut(nodeconfig.cut),this._model.ratioWeight(nodeconfig.ratioWeight)):this._children.forEach(function(node){if(node._id===nodeconfig._id)return node.model.cut(nodeconfig.cut),void node.model.ratioWeight(nodeconfig.ratioWeight);_this2.searchNode(node,nodeconfig)})}},{key:"searchNode",value:function searchNode(node,nodeconfig){var _this3=this;node.children().forEach(function(childNode){childNode.id()===nodeconfig._id?(childNode.model().cut(nodeconfig.cut),childNode.model().ratioWeight(nodeconfig.ratioWeight)):_this3.searchNode(childNode,nodeconfig)})}},{key:"delete",value:function _delete(nodeId){var _this4=this;this._children.forEach(function(node){if(node.id()===nodeId){var index=_this4._children.indexOf(node);_this4._model.lanes().splice(index,1)}_this4.deleteSearchNode(node,nodeId)})}},{key:"deleteSearchNode",value:function deleteSearchNode(node,nodeId){var _this5=this;node.children().forEach(function(childNode){if(childNode.id()===nodeId){var index=node.children().indexOf(childNode);node.model().lanes().splice(index,1)}else _this5.deleteSearchNode(childNode,nodeId)})}}]),Node}();function layout_model_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var layout_model_LayoutModel=function(){function LayoutModel(measurements,config){!function layout_model_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LayoutModel),this._measurements=measurements,this._config=config,this._root=this.createTree(this._config,null),this.setBoundBox()}return function layout_model_createClass(Constructor,protoProps,staticProps){return protoProps&&layout_model_defineProperties(Constructor.prototype,protoProps),staticProps&&layout_model_defineProperties(Constructor,staticProps),Constructor}(LayoutModel,[{key:"createTree",value:function createTree(config,parent){var node=new layout_definition_tree(config);parent?(node.parentCut(parent.getCutType()),parent.addChildren([node])):this._root=node;var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=config.lanes()[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var lane=_step.value;this.createTree(lane,node)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{_iteratorNormalCompletion||null==_iterator.return||_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}return this._root}},{key:"setBoundBox",value:function setBoundBox(){this._root.boundBox({top:0,left:0,width:this._measurements.width,height:this._measurements.height}),function allocateBoundingBox(node){var totalWeight=node.children().map(function(child){return child.model().ratioWeight()}).reduce(function(carry,val){return carry+val},0);node.children().forEach(function(child,i,children){var lastSibling=children[i-1],ratio=child.model().ratioWeight()/totalWeight;"h"===child.parentCut()?child.boundBox({top:i?lastSibling.boundBox().top+lastSibling.boundBox().height:0,left:child.parent().boundBox().left,height:child.parent().boundBox().height*ratio,width:child.parent().boundBox().width}):child.boundBox({top:child.parent().boundBox().top,left:i?lastSibling.boundBox().left+lastSibling.boundBox().width:0,height:child.parent().boundBox().height,width:child.parent().boundBox().width*ratio}),allocateBoundingBox(child)})}(this._root)}},{key:"setHostPosition",value:function setHostPosition(node){var _this=this;node.children().forEach(function(child){LayoutModel.setHostSpatialConfig(child),_this.setHostPosition(child)})}},{key:"negotiate",value:function negotiate(){return function negotiateDimension(node){for(var preferred,alteredDim,nonAlteredDim,cumultiveExtraSpaceAmt=0,childrenLength=node.children().length,index=0;index<childrenLength;index++){var extraSpaceAmt,fn=void 0,child=node.children()[index];"h"===child.parentCut()?(fn=yExtraSpace,alteredDim="height",nonAlteredDim="width"):(fn=xExtraSpace,alteredDim="width",nonAlteredDim="height"),child.isPreferred()?preferred=child:(cumultiveExtraSpaceAmt+=extraSpaceAmt=fn(child),child.boundBox()[alteredDim]-=extraSpaceAmt,child.boundBox()[nonAlteredDim]=child.parent().boundBox()[nonAlteredDim],negotiateDimension(child))}preferred&&(preferred.boundBox()[alteredDim]+=cumultiveExtraSpaceAmt,preferred.boundBox()[nonAlteredDim]=preferred.parent().boundBox()[nonAlteredDim],negotiateDimension(preferred))}(this._root),function computePosition(node){node.children().forEach(function(child,i,children){var boundBox=function determineBoundBox(bb,i,arr,instance){if(i){var _lastSibling$boundBox=arr[i-1].boundBox(),_top2=_lastSibling$boundBox.top,_left2=_lastSibling$boundBox.left,_height=_lastSibling$boundBox.height,_width=_lastSibling$boundBox.width;return{width:bb.width,height:bb.height,top:"h"===instance.parentCut()?_top2+_height:_top2,left:"h"===instance.parentCut()?_left2:_left2+_width}}var _instance$parent$boun=instance.parent().boundBox(),_top=_instance$parent$boun.top,_left=_instance$parent$boun.left;return{width:bb.width,height:bb.height,top:_top,left:_left}}(child.boundBox(),i,children,child);child.boundBox(boundBox),computePosition(child)})}(this._root),this}},{key:"broadcast",value:function broadcast(){return this.setHostPosition(this._root),this}},{key:"tree",value:function tree(){return this._root}}],[{key:"setHostSpatialConfig",value:function setHostSpatialConfig(node){var bb=node.boundBox(),host=node.model().host();if(host&&host.setSpatialConfig){var conf={x:bb.left,y:bb.top,width:bb.width,height:bb.height,renderAt:node.id()};host.setSpatialConfig(conf)}}}]),LayoutModel}(),VIEW_INDEX={top:0,center:1,bottom:2},ROW_MATRIX_INDEX={0:"top",1:"center",2:"bottom"},COLUMN_MATRIX_INDEX={0:"left",1:"middle",2:"right"},enums_constants_HEIGHT="height",ROW_ROOT="rowRoot",COLUMN_ROOT="columnRoot",enums_constants_VERTICAL="vertical",enums_constants_HORIZONTAL="horizontal";function utils_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Utils=function(){function Utils(){!function utils_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Utils)}return function utils_createClass(Constructor,protoProps,staticProps){return protoProps&&utils_defineProperties(Constructor.prototype,protoProps),staticProps&&utils_defineProperties(Constructor,staticProps),Constructor}(Utils,null,[{key:"isDOMElement",value:function isDOMElement(element){return element instanceof Element}},{key:"getID",value:function getID(element){return element.id}},{key:"getElement",value:function getElement(id){return document.getElementById(id)}},{key:"findContainer",value:function findContainer(data){return data.filter(function(coordinate){return null==coordinate.parent})[0]}},{key:"removeDiv",value:function removeDiv(divId){null!==document.getElementById(divId)&&document.getElementById(divId).remove()}}]),Utils}();function data_point_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var data_point_DataPoint=function(){function DataPoint(node){!function data_point_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DataPoint),this._node=node,this._className=node.model().host()instanceof LayoutComponent?node.model().host().className():DEFAULT_CLASS_NAME}return function data_point_createClass(Constructor,protoProps,staticProps){return protoProps&&data_point_defineProperties(Constructor.prototype,protoProps),staticProps&&data_point_defineProperties(Constructor,staticProps),Constructor}(DataPoint,[{key:"node",value:function node(){return this._node}},{key:"hasHost",value:function hasHost(){return this._node.model().host()instanceof LayoutComponent}},{key:"className",value:function className(){return this._className||DEFAULT_CLASS_NAME}}]),DataPoint}();function data_parser_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var data_parser_DataParser=function(){function DataParser(data){!function data_parser_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DataParser),this._data=data}return function data_parser_createClass(Constructor,protoProps,staticProps){return protoProps&&data_parser_defineProperties(Constructor.prototype,protoProps),staticProps&&data_parser_defineProperties(Constructor,staticProps),Constructor}(DataParser,[{key:"defaultDataPointLogic",value:function defaultDataPointLogic(){var nodepoints=[];return function getnodePoints(node,nodepoints){var datapoint=new data_point_DataPoint(node);nodepoints.push(datapoint),node.children().forEach(function(child){getnodePoints(child,nodepoints)})}(this._data,nodepoints),nodepoints}}]),DataParser}();function html_data_typeof(obj){"@babel/helpers - typeof";return(html_data_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function html_data_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function html_data_possibleConstructorReturn(self,call){return!call||"object"!==html_data_typeof(call)&&"function"!=typeof call?function html_data_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function html_data_get(target,property,receiver){return(html_data_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function html_data_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=html_data_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function html_data_getPrototypeOf(o){return(html_data_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function html_data_setPrototypeOf(o,p){return(html_data_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var HTMLDataAdapter=function(_DataParser){function HTMLDataAdapter(){return function html_data_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,HTMLDataAdapter),html_data_possibleConstructorReturn(this,html_data_getPrototypeOf(HTMLDataAdapter).apply(this,arguments))}return function html_data_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&html_data_setPrototypeOf(subClass,superClass)}(HTMLDataAdapter,data_parser_DataParser),function html_data_createClass(Constructor,protoProps,staticProps){return protoProps&&html_data_defineProperties(Constructor.prototype,protoProps),staticProps&&html_data_defineProperties(Constructor,staticProps),Constructor}(HTMLDataAdapter,[{key:"getCoordinates",value:function getCoordinates(){return html_data_get(html_data_getPrototypeOf(HTMLDataAdapter.prototype),"defaultDataPointLogic",this).call(this)}}]),HTMLDataAdapter}();function renderer_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var Renderer=function(){function Renderer(){!function renderer_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Renderer)}return function renderer_createClass(Constructor,protoProps,staticProps){return protoProps&&renderer_defineProperties(Constructor.prototype,protoProps),staticProps&&renderer_defineProperties(Constructor,staticProps),Constructor}(Renderer,[{key:"initRenderer",value:function initRenderer(node,tree){node.__logicalTree=tree}}]),Renderer}();function html_renderer_typeof(obj){"@babel/helpers - typeof";return(html_renderer_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function html_renderer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function html_renderer_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?html_renderer_ownKeys(Object(source),!0).forEach(function(key){html_renderer_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):html_renderer_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function html_renderer_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function html_renderer_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function html_renderer_possibleConstructorReturn(self,call){return!call||"object"!==html_renderer_typeof(call)&&"function"!=typeof call?function html_renderer_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function html_renderer_get(target,property,receiver){return(html_renderer_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function html_renderer_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=html_renderer_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function html_renderer_getPrototypeOf(o){return(html_renderer_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function html_renderer_setPrototypeOf(o,p){return(html_renderer_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var html_renderer_HTMLRenderer=function(_Renderer){function HTMLRenderer(data){var _this;return function html_renderer_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,HTMLRenderer),(_this=html_renderer_possibleConstructorReturn(this,html_renderer_getPrototypeOf(HTMLRenderer).call(this)))._data=data,_this._coordinates=new HTMLDataAdapter(_this._data).getCoordinates(),_this}return function html_renderer_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&html_renderer_setPrototypeOf(subClass,superClass)}(HTMLRenderer,Renderer),function html_renderer_createClass(Constructor,protoProps,staticProps){return protoProps&&html_renderer_defineProperties(Constructor.prototype,protoProps),staticProps&&html_renderer_defineProperties(Constructor,staticProps),Constructor}(HTMLRenderer,[{key:"createhtml",value:function createhtml(mount,className){var _this2=this,mainDiv=mount;html_renderer_get(html_renderer_getPrototypeOf(HTMLRenderer.prototype),"initRenderer",this).call(this,mainDiv,this._data),this.parentDiv=this.createAndCustomiseParent(className),this._coordinates.forEach(function(node){if(node.hasHost()){var host=node.node();_this2.parentDiv.appendChild(_this2.createAndPositionDiv(html_renderer_objectSpread({},host.boundBox(),{id:host.id(),className:node.className()})))}}),mainDiv.appendChild(this.parentDiv)}},{key:"createAndPositionDiv",value:function createAndPositionDiv(config){var top=config.top,left=config.left,height=config.height,width=config.width,className=config.className,id=config.id,div=document.getElementById(id)||document.createElement("div");return div.style.position="absolute",div.style.left="".concat(left,"px"),div.style.top="".concat(top,"px"),div.style.height="".concat(height,"px"),div.style.width="".concat(width,"px"),div.id=id,div.className=className,div}},{key:"createAndCustomiseParent",value:function createAndCustomiseParent(className){var container=Utils.findContainer(this._coordinates),host=container.node(),parentDiv=this.createAndPositionDiv(html_renderer_objectSpread({},host.boundBox(),{id:host.id(),className:container.className()}));return parentDiv.className=className,parentDiv.style.position="relative",parentDiv}},{key:"coordinates",value:function coordinates(){return this._coordinates}}]),HTMLRenderer}(),findNode=function findNode(context,nodeID){return context.renderer().coordinates().find(function(point){return point.node().id()===nodeID})},drawLayout=function drawLayout(context){return function renderHTML(context){context.renderer(new html_renderer_HTMLRenderer(context.data())),context.renderer().createhtml(context.mount(),context.className())}(context)},helper_resolveAligment=function resolveAligment(context,componentData){componentData.children().forEach(function(component){var host=component.model().host();if(host instanceof LayoutComponent&&host.alignWith()){var componentToAlign=context.componentMap().get(host.alignWith());if(componentToAlign){var point=findNode(context,component.id()).node(),node=point.boundBox(),refNode=findNode(context,componentToAlign.renderAt()).node().boundBox(),newNodeConfig=function setAlignConfig(alignment,params){var newNodeConfig={},node=params.node,refNode=params.refNode;switch(alignment){case"left":newNodeConfig={top:node.top,left:refNode.left,height:node.height,width:Math.abs(node.width-Math.abs(refNode.left-node.left))};break;case"right":newNodeConfig={top:node.top,left:node.left,height:node.height,width:Math.abs(node.width-Math.abs(node.left+node.width-(refNode.left+refNode.width)))};break;case"top":newNodeConfig={top:refNode.top,left:node.left,height:Math.abs(node.height-Math.abs(refNode.top-node.top)),width:node.width};break;case"bottom":newNodeConfig={top:node.top,left:node.left,height:Math.abs(node.top-refNode.top+refNode.height),width:node.width};break;case"h-center":newNodeConfig={top:node.top,left:refNode.left,height:node.height,width:refNode.width};break;case"v-center":newNodeConfig={top:refNode.top,left:node.left,height:refNode.top,width:node.width}}return newNodeConfig}(host.alignment(),{node:node,refNode:refNode});Object.assign(newNodeConfig,{id:point.id(),className:host.className()}),context.renderer().createAndPositionDiv(newNodeConfig),context.componentMap().get(host.name()).setSpatialConfig({x:newNodeConfig.left,y:newNodeConfig.top,height:newNodeConfig.height,width:newNodeConfig.width})}}resolveAligment(context,component)})};function drawing_manager_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var drawing_manager_DrawingManager=function(){function DrawingManager(data,renderer,container){!function drawing_manager_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DrawingManager),this._data=data.tree,this._componentMap=data.componentMap,this._layoutClassName=data.layoutClassName,this._renderer=renderer,this._mount=Utils.isDOMElement(container)?container:Utils.getElement(container)}return function drawing_manager_createClass(Constructor,protoProps,staticProps){return protoProps&&drawing_manager_defineProperties(Constructor.prototype,protoProps),staticProps&&drawing_manager_defineProperties(Constructor,staticProps),Constructor}(DrawingManager,[{key:"draw",value:function draw(){return drawLayout(this),helper_resolveAligment(this,this._data),function drawComponent(componentData){componentData.children().forEach(function(node){var host=node.model().host();host instanceof LayoutComponent&&host.draw(),drawComponent(node)})}(this._data),this}},{key:"data",value:function data(_data){return _data&&(this._data=_data),this._data}},{key:"componentMap",value:function componentMap(param){return param&&(this._componentMap=param),this._componentMap}},{key:"className",value:function className(param){return param&&(this._layoutClassName=param),this._layoutClassName}},{key:"renderer",value:function renderer(param){return param&&(this._renderer=param),this._renderer}},{key:"mount",value:function mount(param){return param&&(this._mount=param),this._mount}}]),DrawingManager}();function definition_manager_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var definition_manager_DefinitionManager=function(){function DefinitionManager(componentMap,sequence,totalHeight,totalWidth){!function definition_manager_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DefinitionManager),this._componentMap=componentMap,this._prioritySequence=sequence,this._totalHeight=totalHeight,this._totalWidth=totalWidth,this._targetComponentMap=null}return function definition_manager_createClass(Constructor,protoProps,staticProps){return protoProps&&definition_manager_defineProperties(Constructor.prototype,protoProps),staticProps&&definition_manager_defineProperties(Constructor,staticProps),Constructor}(DefinitionManager,[{key:"generateConfigModel",value:function generateConfigModel(){!function prepareTargetComponentMap(context){context.targetComponentMap(new Map),context.componentMap().forEach(function(value){if(context.targetComponentMap().has(value.target()))context.targetComponentMap().get(value.target()).push(value);else{var temp=[];temp.push(value),context.targetComponentMap().set(value.target(),temp)}})}(this);var canvasComponent=this._targetComponentMap.get("canvas"),definitionModel=new DefinitionModel({}),tempDefModel=definitionModel;definitionModel.remainingHeight(this._totalHeight),definitionModel.remainingWidth(this._totalWidth);var componentRef=null;return this._prioritySequence.forEach(function(name){componentRef=function getComponent(canvasComponent,componentName){var comp=canvasComponent.find(function(component){return component.name()===componentName});return comp&&-1!==comp?comp:null}(canvasComponent,name),tempDefModel="grid"!==name?placeComponent(tempDefModel,componentRef).second:function placeGridComponent(definitionModel,gridComponents){for(var tempDefModel=definitionModel,rows=gridComponents.length,column=rows?gridComponents[0].length:0,height=gridComponents.reduce(function(acc,val){return acc+val[0].getLogicalSpace().height},0),i=0;i<column;i++){var iscolumnPreffered=i===column-1,_placeComponent=placeComponent(tempDefModel,createPlaceHolderComponent(height,gridComponents[0][i].getLogicalSpace().width,"left"),iscolumnPreffered),first=_placeComponent.first,second=_placeComponent.second;tempDefModel=first;for(var j=0;j<rows;j++){var rowpreffred=j===rows-1;tempDefModel=placeComponent(tempDefModel,gridComponents[j][i],rowpreffred,!0).second}tempDefModel=second}return tempDefModel}(tempDefModel,componentRef.component)}),definitionModel}},{key:"componentMap",value:function componentMap(param){return param&&(this._componentMap=param),this._componentMap}},{key:"targetComponentMap",value:function targetComponentMap(param){return param&&(this._targetComponentMap=param),this._targetComponentMap}}]),DefinitionManager}();function layout_def_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var layout_def_LayoutDef=function(){function LayoutDef(){!function layout_def_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LayoutDef),this._componentMap=new Map,this._layoutDefinition=null}return function layout_def_createClass(Constructor,protoProps,staticProps){return protoProps&&layout_def_defineProperties(Constructor.prototype,protoProps),staticProps&&layout_def_defineProperties(Constructor,staticProps),Constructor}(LayoutDef,[{key:"addComponent",value:function addComponent(component){this._componentMap.set(component.name(),component)}},{key:"layoutDefinition",value:function layoutDefinition(def){return def&&(this._layoutDefinition=def),this._layoutDefinition}},{key:"addMultipleComponent",value:function addMultipleComponent(componentArray){var _this=this;componentArray.forEach(function(comp){_this.addComponent(comp)})}},{key:"sanitizedDefinition",value:function sanitizedDefinition(){return function helper_sanitizeConfig(context,hostObj){var hostID=hostObj.host();hostObj.lanes()&&hostObj.lanes().length&&hostObj.lanes().forEach(function(childHost){return helper_sanitizeConfig(context,childHost)}),null!=hostID&&"string"==typeof hostID&&void 0!==context.componentMap().get(hostID)&&hostObj.host(context.componentMap().get(hostID))}(this,this._layoutDefinition),this.layoutDefinition()}},{key:"componentMap",value:function componentMap(){return this._componentMap}},{key:"resetComponentMap",value:function resetComponentMap(){this._componentMap.clear()}}]),LayoutDef}();function layout_manager_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var layout_manager_LayoutManager=function(){function LayoutManager(conf){!function layout_manager_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LayoutManager),this._renderAt=conf.renderAt,this._layoutClassName=conf.className,this._dimension={width:conf.width||DEFAULT_WIDTH,height:conf.height||DEFAULT_HEIGHT},this._skeletonType=conf.skeletonType||"html",this._layoutDefinition=null,this._layoutDef=new layout_def_LayoutDef,this._drawingManager=null,this._prioritySequence=[],this.tree=null,this._rootNodeID=null}return function layout_manager_createClass(Constructor,protoProps,staticProps){return protoProps&&layout_manager_defineProperties(Constructor.prototype,protoProps),staticProps&&layout_manager_defineProperties(Constructor,staticProps),Constructor}(LayoutManager,[{key:"layoutDef",value:function layoutDef(param){return param&&(this._layoutDef=param),this._layoutDef}},{key:"prioritySequence",value:function prioritySequence(param){return param&&(this._prioritySequence=param),this._prioritySequence}},{key:"dimension",value:function dimension(param){return param&&Object.assign(this._dimension,param),this._dimension}},{key:"addComponent",value:function addComponent(component){this._layoutDef.addComponent(component)}},{key:"addMultipleComponent",value:function addMultipleComponent(componentArray){this._layoutDef.addMultipleComponent(componentArray)}},{key:"resetNode",value:function resetNode(node){this.con&&this.con.resetNode(node)}},{key:"updateNode",value:function updateNode(config){this.tree.updateNode(config),this._layoutDefinition=this.tree.model,this.compute()}},{key:"compute",value:function compute(){Utils.isDOMElement(this._renderAt)?this._renderAt._layout=this:document.getElementById(this._renderAt)._layout=this,this._layoutDefinition=function calLayOutDef(context){var _context$dimension=context.dimension(),height=_context$dimension.height,width=_context$dimension.width;return new definition_manager_DefinitionManager(context.layoutDef().componentMap(),context.prioritySequence(),height,width).generateConfigModel()}(this),this._layoutDef.layoutDefinition(this._layoutDefinition),this._layoutDefinition=this._layoutDef.sanitizedDefinition(),this._layout=new layout_model_LayoutModel({width:this._dimension.width,height:this._dimension.height},this._layoutDefinition),this.tree=this._layout.negotiate().tree(),this._layout.broadcast(),this._drawingManager=new drawing_manager_DrawingManager({tree:this.tree,componentMap:this._layoutDef.componentMap(),layoutClassName:this._layoutClassName},this._skeletonType,this._renderAt),this._rootNodeID?this.tree.id(this._rootNodeID):this._rootNodeID=this.tree.id(),this._drawingManager.draw()}},{key:"getRootNodeId",value:function getRootNodeId(){return this._rootNodeID}},{key:"registerComponents",value:function registerComponents(layoutComponents){var _this=this;return this._prioritySequence.length=0,this._layoutDef.resetComponentMap(),layoutComponents.forEach(function(container){container&&(_this._prioritySequence.push(container.name()),_this.addComponent(container),"grid"===container.name()&&container.component.forEach(function(componentArr){componentArr.forEach(function(compo){_this.addComponent(compo)})}))}),this}},{key:"getComponent",value:function getComponent(componentName){return this._layoutDef.componentMap().get(componentName)}},{key:"deleteElement",value:function deleteElement(component,elementName){return this._layoutDef.componentMap().delete(elementName),function removeElement(elemID){elemID&&renderer_utils_selectElement("#".concat(elemID)).remove()}(component.renderAt())}},{key:"removeComponent",value:function removeComponent(name){var _this2=this,component=this.getComponent(name);return component?"grid"===name?component.component.map(function(comp){return comp.map(function(co){return _this2.deleteElement(co,co.name())})}):this.deleteElement(component,name):this}},{key:"renderAt",value:function renderAt(mount){return mount&&(this._renderAt=mount),this._renderAt}}]),LayoutManager}();function canvas_helper_slicedToArray(arr,i){return function canvas_helper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function canvas_helper_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function canvas_helper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function helper_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function canvas_helper_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function canvas_helper_toConsumableArray(arr){return function canvas_helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function canvas_helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function canvas_helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var helper_setupChangeListener=function setupChangeListener(context){var store=context._store,allOptions=Object.keys(context._allOptions),props=[].concat(canvas_helper_toConsumableArray(allOptions),canvas_helper_toConsumableArray(Object.keys(canvasOptions))),nameSpaceProps=[].concat(canvas_helper_toConsumableArray(allOptions),canvas_helper_toConsumableArray(Object.keys(canvasOptions))).map(function(prop){return"".concat(namespace_namespaceObject.CANVAS_LOCAL_NAMESPACE,".").concat(prop)});store.registerChangeListener(nameSpaceProps,function(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];(function equalityChecker(props,params){var checker=function checker(){return!1};return!props.every(function(option,i){switch(option){case"rows":case"columns":case"detail":checker=common_utils_isEqual("Array");break;case"shape":case"size":case"color":case"data":case"config":checker=common_utils_isEqual("Object");break;default:checker=function checker(){return!0}}var oldVal=params[i][0],newVal=params[i][1];return checker(oldVal,newVal)})})(props,params)&&context.mount()&&(!function dispatchProps(context){var lifeCycleManager=context.dependencies().lifeCycleManager;lifeCycleManager.notify({client:context,action:"beforeupdate"});var visualGroup=context.composition().visualGroup,allOptions=context._allOptions;for(var key in allOptions){var value=context[key]();null!==value&&visualGroup[key]&&visualGroup[key](value)}var invalidValues=context.config().invalidValues;visualGroup.valueParser(getValueParser(invalidValues));var sanitizedData=visualGroup.getMandatoryFields();sanitizedData.shouldRender?visualGroup.createMatrices(sanitizedData):visualGroup.remove(),context._cachedProps={},lifeCycleManager.notify({client:context,action:"initialized"}),lifeCycleManager.notify({client:context,action:"updated"})}(context),context.render()),function notifyAnimationEnd(context){var viewInfo=context.layout().viewInfo(),centerMatrix=viewInfo&&viewInfo.viewMatricesInfo.matrices.center[1]||[],promises=[];centerMatrix.forEach(function(cellArr){cellArr.forEach(function(cell){promises.push(cell.valueOf().done())})});var lifeCycleManager=context.lifeCycle();promises.length?Promise.all(promises).then(function(){lifeCycleManager.notify({client:context,action:"drawn"});var animDonePromises=[];centerMatrix.forEach(function(cellArr){cellArr.forEach(function(cell){cell.valueOf().layers().forEach(function(layer){animDonePromises.push(layer.animationDone())})})}),[context.xAxes(),context.yAxes()].forEach(function(axisArr){(axisArr=axisArr||[]).forEach(function(axes){axes.forEach(function(axisInst){animDonePromises.push(axisInst.animationDone())})})}),Promise.all(animDonePromises).then(function(){lifeCycleManager.notify({client:context,action:"animationend"})})}):lifeCycleManager.notify({client:context,action:"animationend"})}(context)},!0)},applyPropagationPolicy=function applyPropagationPolicy(firebolt,_ref){var behaviours=_ref.behaviours,sideEffects=_ref.sideEffects;for(var key in behaviours)firebolt.changeBehaviourStateOnPropagation(key,behaviours[key]);for(var _key2 in sideEffects)firebolt.changeSideEffectStateOnPropagation(_key2,sideEffects[_key2])},helper_isMeasure=function isMeasure(fields){return fields.every(function(field){return field.type()===dist_datamodel.FieldType.MEASURE})},helper_applyInteractionPolicy=function applyInteractionPolicy(firebolt){var visualGroup=firebolt.context.composition().visualGroup;if(visualGroup){var splom=function isSplom(fields){var rowProjections=fields.rowProjections,colProj=fields.colProjections.flat(),rowProj=rowProjections.flat();return!(!helper_isMeasure(colProj)||!helper_isMeasure(rowProj))}(visualGroup.resolver().getAllFields()),valueMatrix=visualGroup.matrixInstance().value;(0,firebolt._interactionPolicy)(valueMatrix,firebolt);var crossInteractionPolicy=firebolt._crossInteractionPolicy,behaviours=crossInteractionPolicy.behaviours,sideEffects=crossInteractionPolicy.sideEffects;valueMatrix.each(function(cell){var unitFireBolt=cell.valueOf().firebolt();applyPropagationPolicy(unitFireBolt,{behaviours:behaviours,sideEffects:sideEffects}),splom?(unitFireBolt.payloadGenerators(canvas_helper_defineProperty({},behaviours_namespaceObject.BRUSH,function(inst,dm,propConfig,facetFields){return payloadGenerator.brush(inst,dm,function helper_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?helper_ownKeys(Object(source),!0).forEach(function(key){canvas_helper_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):helper_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}({},propConfig,{},{includeMeasures:!1}),facetFields)})),unitFireBolt.sideEffects().selectionBox.config({persistent:!0})):(unitFireBolt.payloadGenerators(canvas_helper_defineProperty({},behaviours_namespaceObject.BRUSH,payloadGenerator.brush)),unitFireBolt.sideEffects().selectionBox.config({persistent:!1}))}),applyPropagationPolicy(firebolt,{behaviours:behaviours,sideEffects:sideEffects})}},helper_createLayoutManager=function createLayoutManager(){return new layout_manager_LayoutManager({className:"muze-group-container"})};function options_slicedToArray(arr,i){return function options_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function options_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function options_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var src_options={data:{value:null,meta:{typeCheck:function typeCheck(d){return d instanceof datamodel_default.a}}},width:{value:0,meta:{sanitization:intSanitizer,typeCheck:Number.isInteger}},height:{value:0,meta:{sanitization:intSanitizer,typeCheck:Number.isInteger}},minUnitWidth:{value:50,meta:{sanitization:intSanitizer,typeCheck:Number.isInteger}},minUnitHeight:{value:50,meta:{sanitization:intSanitizer,typeCheck:Number.isInteger}},config:{value:[null,null],meta:{typeCheck:"constructor",typeExpected:"Object",takesMultipleParams:!0,sanitization:function sanitization(_ref,oldConfig){var _ref2=options_slicedToArray(_ref,2),config=_ref2[0],_ref2$=_ref2[1],_auxConfig$reset=(void 0===_ref2$?{}:_ref2$).reset,reset=void 0!==_auxConfig$reset&&_auxConfig$reset,oldConf={},facetDefaultConfig=function fixFacetConfig(config){if(config){var isGridLinePresent={},border=config.border,gridLines=config.gridLines;return gridLines&&(isGridLinePresent.x=!!gridLines.x,isGridLinePresent.y=!!gridLines.y),{facetsUserConfig:{isBorderPresent:border||{},isGridLinePresent:isGridLinePresent},isFacet:!1}}return{}}(config);config=mergeRecursive(config,facetDefaultConfig),reset||(oldConf=mergeRecursive({},null===config?{}:oldConfig),oldConf=Object.assign(oldConf,function excludeKeys(config,keys){var emptyValueKeyObject={};return keys.forEach(function(key){config&&config[key]&&Object.keys(config[key]).length&&(emptyValueKeyObject[key]={})}),emptyValueKeyObject}(config,EXCLUDE_CONFIG_KEYS)));var defConfig=mergeRecursive(oldConf,src_defaults_DEFAULT_CONFIG);return function fixScrollBarConfig(config){return config.scrollBar.thickness=Math.min(50,Math.max(10,config.scrollBar.thickness)),config}(mergeRecursive(defConfig,config))}}}};function generic_layout_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _FieldNames$BORDER,_DEFAULT_CONFIGURATIO,_DEFAULT_MEASUREMENTS,generic_layout_GenericLayout=function(){function GenericLayout(mountPoint,measurement,config,dependencies){!function generic_layout_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GenericLayout),this._config={},this._measurement={},this._matrices=[],this._dependencies=dependencies,this.measurement(measurement),this.mountPoint(mountPoint),this.config(config)}return function generic_layout_createClass(Constructor,protoProps,staticProps){return protoProps&&generic_layout_defineProperties(Constructor.prototype,protoProps),staticProps&&generic_layout_defineProperties(Constructor,staticProps),Constructor}(GenericLayout,[{key:"serialize",value:function serialize(){return{measurement:this.measurement(),config:this.config(),matrices:this.matrices()}}},{key:"config",value:function config(_config){return _config?(this._config=mergeRecursive(this._config||{},_config),this._config.border.width=Math.max(0,this._config.border.width),this):this._config}},{key:"measurement",value:function measurement(_measurement){return _measurement?(this._measurement=mergeRecursive(this._measurement||{},_measurement),this):this._measurement}},{key:"matrices",value:function matrices(_matrices){return _matrices?(this._matrices=sanitizeIP.typeObj(["top","center","bottom"],_matrices),this):this._matrices}},{key:"rowMatrix",value:function rowMatrix(matrix){return matrix?(this._rowMatrix=matrix,this):this._rowMatrix}},{key:"columnMatrix",value:function columnMatrix(matrix){return matrix?(this._columnMatrix=matrix,this):this._columnMatrix}},{key:"centerMatrix",value:function centerMatrix(matrix){return matrix?(this._centerMatrix=matrix,this):this._centerMatrix}},{key:"mountPoint",value:function mountPoint(_mountPoint){return _mountPoint?(this._mountPoint=_mountPoint,this):this._mountPoint}}]),GenericLayout}();function grid_layout_defaults_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DEFAULT_CONFIGURATION=(grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO={},"border",(grid_layout_defaults_defineProperty(_FieldNames$BORDER={},"style","solid"),grid_layout_defaults_defineProperty(_FieldNames$BORDER,"color","#d6d6d6"),grid_layout_defaults_defineProperty(_FieldNames$BORDER,"width",2),grid_layout_defaults_defineProperty(_FieldNames$BORDER,"collapse",!0),grid_layout_defaults_defineProperty(_FieldNames$BORDER,"spacing",0),_FieldNames$BORDER)),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"pagination","scroll"),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"buffer",20),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"gutterSpace",{rows:[],columns:[]}),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"distribution",{rows:[],columns:[]}),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"breakPage",{rows:[],columns:[]}),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"isRowSizeEqual",!1),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"isColumnSizeEqual",!1),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"columnPointer",0),grid_layout_defaults_defineProperty(_DEFAULT_CONFIGURATIO,"rowPointer",0),_DEFAULT_CONFIGURATIO),DEFAULT_MEASUREMENTS=(grid_layout_defaults_defineProperty(_DEFAULT_MEASUREMENTS={},"width",100),grid_layout_defaults_defineProperty(_DEFAULT_MEASUREMENTS,"height",100),grid_layout_defaults_defineProperty(_DEFAULT_MEASUREMENTS,"unitWidth",100),grid_layout_defaults_defineProperty(_DEFAULT_MEASUREMENTS,"unitHeight",100),_DEFAULT_MEASUREMENTS);function utils_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function utils_toConsumableArray(arr){return function utils_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function utils_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function utils_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var utils_nest=Symbols.nest,findInPage=function findInPage(i,page){var count=0;for(var x in page)if(i<page[x]){count=x;break}return count},combineMatrices=function combineMatrices(matrix,config){var isTransposed=config.isTransposed,joinedMatrix=matrix[0].length>0?matrix[0]:matrix[1];return isTransposed?(joinedMatrix=matrix[0].length>0?utils_toConsumableArray(matrix[0]):[],joinedMatrix=matrix[1].length>0?[].concat(utils_toConsumableArray(joinedMatrix),utils_toConsumableArray(matrix[1])):joinedMatrix):joinedMatrix=joinedMatrix.map(function(row,rowIndex){var rowData=[];return matrix[0].length>0&&(rowData=utils_toConsumableArray(matrix[0][rowIndex])),matrix[1].length>0&&(rowData=[].concat(utils_toConsumableArray(rowData),utils_toConsumableArray(matrix[1][rowIndex]))),rowData}),joinedMatrix},utils_computeLogicalSpace=function computeLogicalSpace(){var item=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},config=arguments.length>1?arguments[1]:void 0,maxMeasures=arguments.length>2?arguments[2]:void 0,_config$isTransposed=config.isTransposed,isTransposed=void 0!==_config$isTransposed&&_config$isTransposed,unitMeasures=config.unitMeasures,_getMeasureInfo=function getMeasureInfo(isTransposed){return isTransposed?{firstMeasure:enums_constants_HEIGHT,secondMeasure:"width"}:{firstMeasure:"width",secondMeasure:enums_constants_HEIGHT}}(isTransposed),firstMeasure=_getMeasureInfo.firstMeasure,secondMeasure=_getMeasureInfo.secondMeasure,values=item.values,minMeasures=function getMinMeasures(isTransposed,unitMeasures){return isTransposed?{height:0,width:unitMeasures.width}:{height:unitMeasures.height,width:0}}(isTransposed,unitMeasures);if(values[0].key){var _logicalSpace,logicalSpace=(utils_defineProperty(_logicalSpace={},firstMeasure,0),utils_defineProperty(_logicalSpace,secondMeasure,0),_logicalSpace);return values.forEach(function(valueItem){var space=computeLogicalSpace(valueItem,config,maxMeasures);logicalSpace[firstMeasure]=Math.max(logicalSpace[firstMeasure],space[firstMeasure],minMeasures[firstMeasure]),logicalSpace[secondMeasure]+=+space[secondMeasure]}),item.space=logicalSpace,logicalSpace}return function getLogicalSpace(item,measures,minMeasures){var _ref,maxMeasure=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],firstMeasure=measures.firstMeasure,secondMeasure=measures.secondMeasure,firstMeasureValue=0,secondMeasureValue=0;return item.values.forEach(function(valueArray){var _item$space,fMeasure=0,sMeasure=0;valueArray.forEach(function(placeholder,colIndex){placeholder.setAvailableSpace();var space=placeholder.getLogicalSpace(),minSecondMeasure=placeholder.getMinMeasures(minMeasures[secondMeasure]);sMeasure=Math.max(sMeasure,+space[secondMeasure],minSecondMeasure),maxMeasure[colIndex]=Math.max(maxMeasure[colIndex]||0,space[firstMeasure]),fMeasure+=+maxMeasure[colIndex]}),secondMeasureValue+=sMeasure,firstMeasureValue=Math.max(firstMeasureValue,fMeasure),item.space=(utils_defineProperty(_item$space={},secondMeasure,Math.ceil(secondMeasureValue)),utils_defineProperty(_item$space,firstMeasure,Math.ceil(firstMeasureValue)),_item$space)}),utils_defineProperty(_ref={},secondMeasure,secondMeasureValue),utils_defineProperty(_ref,firstMeasure,firstMeasureValue),_ref}(item,{firstMeasure:firstMeasure,secondMeasure:secondMeasure},minMeasures,maxMeasures)},createMatrixEachLevel=function createMatrixEachLevel(item,isTransposed){if(item.values[0].key){var arr=[];return item.values.forEach(function(child){isTransposed?createMatrixEachLevel(child,isTransposed).forEach(function(e,i){var _arr$i;arr[i]=arr[i]||[],(_arr$i=arr[i]).push.apply(_arr$i,utils_toConsumableArray(e))}):arr.push.apply(arr,utils_toConsumableArray(createMatrixEachLevel(child,isTransposed)))}),item.matrix=arr,arr}return item.matrix=isTransposed?item.values[0].map(function(col,colIndex){return item.values.map(function(row){return row[colIndex]})}):item.values,item.matrix},extraCellsRemover=function extraCellsRemover(arr,beg,end){return arr.slice(beg,-end)},visual_matrix_props_PROPS={config:{sanitization:function sanitization(context,value){return mergeRecursive(context._config||{},value)}},maxMeasures:{},availableSpace:{},logicalSpace:{}},visual_matrix_default_config_defaultConfig={distribution:[],classPrefix:"muze",isDistributionEqual:!0,unitMeasures:{height:100,width:100,border:1},isTransposed:!1,facet:"primary",extraCellLengths:[]};function visual_matrix_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var visual_matrix_VisualMatrix=function(){function VisualMatrix(matrix){var config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function visual_matrix_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VisualMatrix),this._lastLevelKey=0,this._primaryMatrix=matrix[0]||[],this._secondaryMatrix=matrix[1]||[],this._maxMeasures=[],this._availableSpace={},generateGetterSetters(this,visual_matrix_props_PROPS);var defCon=Object.assign({},this.constructor.defaultConfig());this.config(mergeRecursive(defCon,config)),this._layoutMatrix=combineMatrices([matrix[0]||[],matrix[1]||[]],this.config())}return function visual_matrix_createClass(Constructor,protoProps,staticProps){return protoProps&&visual_matrix_defineProperties(Constructor.prototype,protoProps),staticProps&&visual_matrix_defineProperties(Constructor,staticProps),Constructor}(VisualMatrix,[{key:"computeLogicalSpace",value:function computeLogicalSpace(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"computeViewableSpaces",value:function computeViewableSpaces(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"removeExtraCells",value:function removeExtraCells(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"getPriorityDistribution",value:function getPriorityDistribution(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"calculateDepth",value:function calculateDepth(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"redistributeSpaces",value:function redistributeSpaces(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"redistributeViewSpaces",value:function redistributeViewSpaces(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"getCellDimensions",value:function getCellDimensions(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"primaryMatrix",value:function primaryMatrix(){return arguments.length?this:this._primaryMatrix}},{key:"secondaryMatrix",value:function secondaryMatrix(){return arguments.length?this:this._secondaryMatrix}},{key:"tree",value:function tree(){return arguments.length?this:this._tree}},{key:"createTree",value:function createTree(){var _createTree2=function createTree(context){var matrixTree={},lastLevelKey=0,facet="primary",nestFn=utils_nest(),keys=[],layoutMatrix=context._layoutMatrix,primaryMatrix=context.primaryMatrix(),secondaryMatrix=context.secondaryMatrix(),_context$config=context.config(),isTransposed=_context$config.isTransposed,breakPage=_context$config.breakPage;if(isTransposed){if(facet=0===primaryMatrix.length?"primary":0===secondaryMatrix.length?"secondary":primaryMatrix.length>=secondaryMatrix.length?"primary":"secondary",primaryMatrix.length>0){for(var _i2=0;_i2<primaryMatrix.length-1;_i2++)keys.push(_i2);keys.push(primaryMatrix.length-1),"secondary"===facet&&(lastLevelKey=primaryMatrix.length-1)}if(secondaryMatrix.length>0){for(var primaryMatrixLength=primaryMatrix.length,_i3=secondaryMatrix.length-1;_i3>0;_i3--)keys.push(_i3+primaryMatrixLength);keys.push(primaryMatrixLength),"primary"===facet&&(lastLevelKey=primaryMatrixLength)}var newMatrix;keys.forEach(function(key){var counter=-1;return nestFn.key(function(d){return counter++,"".concat(d[key].valueOf(),"-").concat(findInPage(counter,breakPage))})}),newMatrix=layoutMatrix[0].map(function(col,colIndex){return layoutMatrix.map(function(row){return row[colIndex]})}),matrixTree=nestFn.entries(newMatrix)}else{if(facet=0===primaryMatrix.length?"primary":0===secondaryMatrix.length?"secondary":primaryMatrix.length>=secondaryMatrix.length?"primary":"secondary",primaryMatrix.length>0){for(var i=0;i<primaryMatrix[0].length-1;i++)keys.push(i);keys.push(primaryMatrix[0].length-1),"secondary"!==facet&&0!==secondaryMatrix.length||(lastLevelKey=primaryMatrix[0].length-1)}if(secondaryMatrix.length>0){for(var keyLength=primaryMatrix.length>0?primaryMatrix[0].length:0,_i=secondaryMatrix[0].length-1;_i>0;_i--)keys.push(_i+keyLength);keys.push(keyLength),"primary"===facet&&(lastLevelKey=keyLength)}else lastLevelKey=primaryMatrix.length>0?primaryMatrix[0].length-1:0;keys.forEach(function(key){var counter=-1;return nestFn.key(function(d){return counter++,"".concat(d[key].valueOf(),"-").concat(findInPage(counter,breakPage))})}),matrixTree=nestFn.entries(layoutMatrix)}return{tree:matrixTree,lastLevelKey:lastLevelKey}}(this),tree=_createTree2.tree,lastLevelKey=_createTree2.lastLevelKey;return this._lastLevelKey=lastLevelKey,tree}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()}},{key:"setAvailableSpace",value:function setAvailableSpace(width,height){this.availableSpace({width:width,height:height});var tree=this.tree(),heightMeasures=this.populateMaxMeasures(enums_constants_HEIGHT,tree),widthMeasures=this.populateMaxMeasures("width",tree),depth=this.calculateDepth(widthMeasures,heightMeasures);return this.viewableMatrix=this.createViewPortMatrix(depth),this.viewableMeasures=this.redistributeSpaces(width,height),this}},{key:"populateMaxMeasures",value:function populateMaxMeasures(type,matrixTree){var _this=this,depth=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,measures=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(measures[depth]=Math.max(measures[depth]||0,matrixTree.space[type]),matrixTree.values){var childDepth=depth+1;matrixTree.values.forEach(function(child){child.space&&(measures=_this.populateMaxMeasures(type,child,childDepth,measures))})}return measures}},{key:"getViewableSpaces",value:function getViewableSpaces(){return this.viewableMeasures}},{key:"getViewableMatrices",value:function getViewableMatrices(){return this.viewableMatrix}},{key:"createViewPortMatrix",value:function createViewPortMatrix(depth){var arr=[];return function createMatrixInstances(){var arr=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],depth=arguments.length>1?arguments[1]:void 0,matrixInfo=arguments.length>2?arguments[2]:void 0,layout=arguments.length>3?arguments[3]:void 0,breakPointer=layout._breakPointer,isTransposed=layout.config().isTransposed,tree=matrixInfo.tree,layoutMatrix=matrixInfo.layoutMatrix;if(0===depth){var brokenMatrix=function breakMatrix(matrix,isTransposed,breakPointer){var primaryMatrix=[],secondaryMatrix=[];return isTransposed?matrix.forEach(function(row,rowIndex){rowIndex>=breakPointer?secondaryMatrix.push(row):primaryMatrix.push(row)}):matrix.forEach(function(row,rowIndex){row.forEach(function(column,columnIndex){columnIndex>=breakPointer?(secondaryMatrix[rowIndex]=secondaryMatrix[rowIndex]||[],secondaryMatrix[rowIndex].push(column)):(primaryMatrix[rowIndex]=primaryMatrix[rowIndex]||[],primaryMatrix[rowIndex].push(column))})}),[primaryMatrix,secondaryMatrix]}(tree.matrix,isTransposed,breakPointer);return arr.push({matrix:tree.matrix,primaryMatrix:brokenMatrix[0],secondaryMatrix:brokenMatrix[1],space:tree.space}),arr}var nextLevel=depth-1;return tree.values.forEach(function(e){createMatrixInstances(arr,nextLevel,{tree:e,layoutMatrix:layoutMatrix},layout)}),arr}(arr,depth,this.removeExtraCells(),this),arr}}],[{key:"defaultConfig",value:function defaultConfig(){return visual_matrix_default_config_defaultConfig}}]),VisualMatrix}();function row_matrix_typeof(obj){"@babel/helpers - typeof";return(row_matrix_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function row_matrix_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function row_matrix_possibleConstructorReturn(self,call){return!call||"object"!==row_matrix_typeof(call)&&"function"!=typeof call?function row_matrix_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function row_matrix_getPrototypeOf(o){return(row_matrix_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function row_matrix_setPrototypeOf(o,p){return(row_matrix_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var row_matrix_RowVisualMatrix=function(_VisualMatrix){function RowVisualMatrix(matrix){var _this,config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function row_matrix_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RowVisualMatrix),(_this=row_matrix_possibleConstructorReturn(this,row_matrix_getPrototypeOf(RowVisualMatrix).call(this,matrix,config)))._breakPointer=matrix[0].length>0?matrix[0][0].length:0,_this._layoutMatrix=combineMatrices([matrix[0]||[],matrix[1]||[]],_this.config()),_this._tree={key:ROW_ROOT,values:_this.createTree()},_this._logicalSpace=_this.computeLogicalSpace(),_this}return function row_matrix_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&row_matrix_setPrototypeOf(subClass,superClass)}(RowVisualMatrix,visual_matrix_VisualMatrix),function row_matrix_createClass(Constructor,protoProps,staticProps){return protoProps&&row_matrix_defineProperties(Constructor.prototype,protoProps),staticProps&&row_matrix_defineProperties(Constructor,staticProps),Constructor}(RowVisualMatrix,[{key:"computeLogicalSpace",value:function computeLogicalSpace(){var matrixTree=this.tree();return createMatrixEachLevel(matrixTree,!1),utils_computeLogicalSpace(matrixTree,this.config(),this.maxMeasures())}},{key:"computeViewableSpaces",value:function computeViewableSpaces(measures){var _this2=this,maxHeights=measures.maxHeights,maxWidths=measures.maxWidths,height=measures.height;return this.viewableMatrix.map(function(matrixInst,i){var cellDimOptions={matrixInst:matrixInst,maxWidths:maxWidths,maxHeights:maxHeights,matrixIndex:i},_this2$getCellDimensi=_this2.getCellDimensions(cellDimOptions),widths=_this2$getCellDimensi.widths,rowHeights=_this2$getCellDimensi.rowHeights,columnWidths=_this2$getCellDimensi.columnWidths,heightMeasures=[height,height],columnMeasures=widths;return{rowHeights:{primary:rowHeights[0],secondary:rowHeights[1]},columnWidths:{primary:columnWidths[0],secondary:columnWidths[1]},height:{primary:heightMeasures[0],secondary:heightMeasures[1]},width:{primary:columnMeasures[0],secondary:columnMeasures[1]}}})}},{key:"removeExtraCells",value:function removeExtraCells(){var _this$config=this.config(),isTransposed=_this$config.isTransposed,extraCellLengths=_this$config.extraCellLengths,matrix=this._layoutMatrix,tree=mergeRecursive({},this.tree()),begCellLen=extraCellLengths[0],endCellLen=extraCellLengths[1]||Number.NEGATIVE_INFINITY,layoutMatrix=isTransposed?matrix.slice(0).map(function(e){return extraCellsRemover(e,begCellLen,endCellLen)}):extraCellsRemover(matrix,begCellLen,endCellLen);return tree.values=extraCellsRemover(tree.values,begCellLen,endCellLen),tree.matrix=extraCellsRemover(tree.matrix,begCellLen,endCellLen),{tree:tree,layoutMatrix:layoutMatrix}}},{key:"getPriorityDistribution",value:function getPriorityDistribution(measures){var remainingAvailWidth,remainingWidth,cWidths=[],conditions=[],maxPrioritySpace=0,matrix=measures.matrix,availableWidth=measures.width,maxWidths=measures.maxMeasures,currentWidth=measures.maxWidth,height=measures.height,priority=this.config().priority,primaryMatrixLength=this.primaryMatrix().length?this.primaryMatrix()[0].length:0,dist=[];remainingAvailWidth=availableWidth,remainingWidth=currentWidth,(conditions=2===priority?[primaryMatrixLength-1,primaryMatrixLength]:0===priority?[primaryMatrixLength-1]:[primaryMatrixLength]).forEach(function(i){dist[i]=maxWidths[i],maxPrioritySpace+=maxWidths[i],remainingAvailWidth-=dist[i],remainingWidth-=dist[i]}),matrix[0].forEach(function(e,i){-1===conditions.indexOf(i)&&(dist[i]=remainingAvailWidth*(maxWidths[i]/remainingWidth))}),matrix.forEach(function(row){return row.forEach(function(col,cIdx){-1===conditions.indexOf(cIdx)?(col.setAvailableSpace(dist[cIdx],height),cWidths[cIdx]=Math.max(cWidths[cIdx]||0,Math.floor(col.getLogicalSpace().width))):cWidths[cIdx]=0})});var prioritySpace=availableWidth-cWidths.reduce(function(t,n){return t+n});return prioritySpace<0?cWidths=cWidths.map(function(){return 0}):conditions.forEach(function(i){cWidths[i]=Math.floor(prioritySpace*(dist[i]/maxPrioritySpace||1))}),cWidths}},{key:"calculateDepth",value:function calculateDepth(widthMeasures,heightMeasures){var i,height=this.availableSpace().height;for(i=0;i<heightMeasures.length&&!(heightMeasures[i]<=height);i++);return Math.min(widthMeasures.length-1,i)}},{key:"redistributeSpaces",value:function redistributeSpaces(width,height){var _this3=this,maxHeights=[],maxWidths=[],maxMeasures=this.maxMeasures(),maxWidth=maxMeasures.reduce(function(t,n){return t+=n}),logicalWidths=this.getPriorityDistribution({matrix:this._layoutMatrix,maxWidth:maxWidth,maxMeasures:maxMeasures,width:width,height:height});return this.viewableMatrix.forEach(function(matrixInst){var options={mWidth:0,mHeight:0,matrix:matrixInst.matrix,width:width,height:height,maxHeights:maxHeights,maxWidths:maxWidths,logicalWidths:logicalWidths},measures=_this3.redistributeViewSpaces(options);maxWidths=measures.maxWidths,maxHeights=measures.maxHeights}),this.computeViewableSpaces({height:height,width:width,maxHeights:maxHeights,maxWidths:maxWidths})}},{key:"redistributeViewSpaces",value:function redistributeViewSpaces(measures){var rHeights,mHeight,cWidths=[],maxMeasures=this.maxMeasures(),_this$config2=this.config(),isDistributionEqual=_this$config2.isDistributionEqual,distribution=_this$config2.distribution,isTransposed=_this$config2.isTransposed,gutter=_this$config2.gutter,matrix=measures.matrix,height=measures.height,maxHeights=measures.maxHeights,maxWidths=measures.maxWidths,logicalWidths=measures.logicalWidths;mHeight=function spaceTakenByColumn(matrix,colIndex){var height=0,width=0;return matrix.forEach(function(row){var spaces=row[colIndex].getLogicalSpace();width=Math.max(width,spaces.width),height+=spaces.height}),{width:width,height:height}}(matrix,this._lastLevelKey).height;var maxWidth=maxMeasures.reduce(function(t,n){return t+=n});measures.maxMeasures=maxMeasures,measures.maxWidth=maxWidth,cWidths=maxWidth>0?logicalWidths:maxMeasures.map(function(){return 0}),rHeights=function getDistributedHeight(context){var heightWithoutGutter,distSum=0,gutterSum=0,isTransposed=context.isTransposed,distribution=context.distribution,availableHeight=context.availableHeight,height=context.height,isDistributionEqual=context.isDistributionEqual,gutter=context.gutter,matrix=context.matrix,cIdx=context.cIdx;distribution&&void 0!==distribution[0]&&(distSum=distribution.reduce(function(t,n){return t+=n})),gutter&&void 0!==gutter[0]&&(gutterSum=gutter.reduce(function(t,n){return t+=n})),heightWithoutGutter=availableHeight-Math.floor(availableHeight*gutterSum);var colLen=matrix.length;return matrix.map(function(row,rIdx){var space=row[cIdx].getLogicalSpace().height,distHeight=space+space/height*(heightWithoutGutter-height);return isTransposed||(distribution.length>0&&colLen===distribution.length?distHeight=heightWithoutGutter*distribution[rIdx]/distSum:(isDistributionEqual||0===context.height)&&(distHeight=heightWithoutGutter/colLen)),Math.floor(distHeight)})}({matrix:matrix,cIdx:this._lastLevelKey,height:mHeight,availableHeight:height,isDistributionEqual:isDistributionEqual,distribution:distribution,isTransposed:isTransposed,gutter:gutter}),maxWidths.length>0&&(cWidths=cWidths.map(function(e,i){return Math.max(e,maxWidths[0][i]||0)})),maxWidths.push(cWidths);for(var x=0;x<maxWidths.length;x++)maxWidths[x]=cWidths;return maxHeights.push(rHeights),{maxWidths:maxWidths,maxHeights:maxHeights}}},{key:"getCellDimensions",value:function getCellDimensions(measures){var _this4=this,borderWidth=this.config().unitMeasures.border,matrixInst=measures.matrixInst,maxWidths=measures.maxWidths,maxHeights=measures.maxHeights,matrixIndex=measures.matrixIndex,matrix=matrixInst.matrix,rowHeights=[[0],[0]],columnWidths=[[0],[0]],widths=[0,0],breakPointer=this._breakPointer;return matrix.forEach(function(row,rIdx){row.forEach(function(cell,cIdx){var colHeight=maxHeights[matrixIndex][rIdx]||0,colWidth=maxWidths[matrixIndex][cIdx];cell.setAvailableSpace(colWidth,colHeight-borderWidth),0===rIdx&&cIdx<breakPointer?(columnWidths[0][cIdx]=colWidth,widths[0]=(widths[0]||0)+colWidth):0===rIdx&&cIdx>=breakPointer&&(columnWidths[1][cIdx-breakPointer]=colWidth,widths[1]=(widths[1]||0)+colWidth),cIdx===_this4._lastLevelKey&&(rowHeights[0][rIdx]=colHeight,rowHeights[1][rIdx]=colHeight)})}),{heights:[0,0],widths:widths,rowHeights:rowHeights,columnWidths:columnWidths}}}]),RowVisualMatrix}();function column_matrix_typeof(obj){"@babel/helpers - typeof";return(column_matrix_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function column_matrix_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function column_matrix_possibleConstructorReturn(self,call){return!call||"object"!==column_matrix_typeof(call)&&"function"!=typeof call?function column_matrix_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function column_matrix_getPrototypeOf(o){return(column_matrix_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function column_matrix_setPrototypeOf(o,p){return(column_matrix_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var column_matrix_ColumnVisualMatrix=function(_VisualMatrix){function ColumnVisualMatrix(matrix){var _this,config=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function column_matrix_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ColumnVisualMatrix),(_this=column_matrix_possibleConstructorReturn(this,column_matrix_getPrototypeOf(ColumnVisualMatrix).call(this,matrix,config)))._breakPointer=matrix[0].length,_this._tree={key:COLUMN_ROOT,values:_this.createTree()},_this._logicalSpace=_this.computeLogicalSpace(),_this}return function column_matrix_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&column_matrix_setPrototypeOf(subClass,superClass)}(ColumnVisualMatrix,visual_matrix_VisualMatrix),function column_matrix_createClass(Constructor,protoProps,staticProps){return protoProps&&column_matrix_defineProperties(Constructor.prototype,protoProps),staticProps&&column_matrix_defineProperties(Constructor,staticProps),Constructor}(ColumnVisualMatrix,[{key:"computeLogicalSpace",value:function computeLogicalSpace(){var matrixTree=this.tree();return createMatrixEachLevel(matrixTree,!0),utils_computeLogicalSpace(matrixTree,this.config(),this.maxMeasures())}},{key:"computeViewableSpaces",value:function computeViewableSpaces(measures){var _this2=this,maxHeights=measures.maxHeights,maxWidths=measures.maxWidths,height=measures.height,width=measures.width;return this.viewableMatrix.map(function(matrixInst,i){var cellDimOptions={matrixInst:matrixInst,maxWidths:maxWidths,maxHeights:maxHeights,matrixIndex:i,height:height},_this2$getCellDimensi=_this2.getCellDimensions(cellDimOptions),heights=_this2$getCellDimensi.heights,rowHeights=_this2$getCellDimensi.rowHeights,columnWidths=_this2$getCellDimensi.columnWidths,heightMeasures=heights,columnMeasures=[width,width];return{rowHeights:{primary:rowHeights[0],secondary:rowHeights[1]},columnWidths:{primary:columnWidths[0],secondary:columnWidths[1]},height:{primary:heightMeasures[0],secondary:heightMeasures[1]},width:{primary:columnMeasures[0],secondary:columnMeasures[1]}}})}},{key:"removeExtraCells",value:function removeExtraCells(){var _this$config=this.config(),isTransposed=_this$config.isTransposed,extraCellLengths=_this$config.extraCellLengths,matrix=this._layoutMatrix,tree=mergeRecursive({},this.tree()),begCellLen=extraCellLengths[0],endCellLen=extraCellLengths[1]||Number.NEGATIVE_INFINITY,layoutMatrix=isTransposed?matrix.slice(0).map(function(e){return extraCellsRemover(e,begCellLen,endCellLen)}):extraCellsRemover(matrix,begCellLen,endCellLen);return tree.values=extraCellsRemover(tree.values,begCellLen,endCellLen),tree.matrix=tree.matrix.map(function(e){return extraCellsRemover(e,begCellLen,endCellLen)}),{tree:tree,layoutMatrix:layoutMatrix}}},{key:"getPriorityDistribution",value:function getPriorityDistribution(measures){var height=measures.height,maxHeights=measures.maxHeights,remainingHeight=height,heightDist=[],conditions=[],divider=2,priority=this.config().priority,primaryMatrixLength=this.primaryMatrix().length;return 2===priority?(conditions=[primaryMatrixLength-1,primaryMatrixLength],divider=2):(conditions=0===priority?[primaryMatrixLength-1]:[primaryMatrixLength],divider=1),maxHeights.forEach(function(heights,index){-1===conditions.indexOf(index)&&(heightDist[index]=heights,remainingHeight-=heights)}),remainingHeight<0?heightDist=heightDist.map(function(){return 0}):conditions.forEach(function(condition){heightDist[condition]=Math.min(maxHeights[condition],remainingHeight/divider)}),heightDist}},{key:"calculateDepth",value:function calculateDepth(widthMeasures){var j,width=this.availableSpace().width;for(j=0;j<widthMeasures.length&&!(widthMeasures[j]<=width);j++);return Math.min(widthMeasures.length-1,j)}},{key:"redistributeSpaces",value:function redistributeSpaces(width,height){var _this3=this,maxHeights=[],maxWidths=[];return this.viewableMatrix.forEach(function(matrixInst){var options={mWidth:0,mHeight:0,matrix:matrixInst.matrix,width:width,height:height,maxHeights:maxHeights,maxWidths:maxWidths},maxMeasures=_this3.redistributeViewSpaces(options);maxWidths=maxMeasures.maxWidths,maxHeights=maxMeasures.maxHeights}),this.computeViewableSpaces({height:height,width:width,maxHeights:maxHeights,maxWidths:maxWidths})}},{key:"redistributeViewSpaces",value:function redistributeViewSpaces(measures){var rHeights=[],matrix=measures.matrix,width=measures.width,maxHeights=measures.maxHeights,maxWidths=measures.maxWidths,borderWidth=this.config().unitMeasures.border,mWidth=function spaceTakenByRow(row){var height=0,width=0;return row.forEach(function(col){var spaces=col.getLogicalSpace();height=Math.max(height,spaces.height),width+=spaces.width}),{width:width,height:height}}(matrix[this._lastLevelKey]).width,cWidths=function getDistributedWidth(context,layoutConfig){var availableWidth=context.availableWidth,width=context.width,row=context.row,isDistributionEqual=layoutConfig.isDistributionEqual,isTransposed=layoutConfig.isTransposed,distribution=layoutConfig.distribution,distSum=0;return distribution&&distribution[0]&&(distSum=distribution.reduce(function(t,n){return t+=n})),row.map(function(col,colIndex){var space=col.getLogicalSpace().width,distWidth=space+space/width*(availableWidth-width);if(isTransposed)if(distribution.length>0)distWidth=availableWidth*distribution[colIndex]/distSum;else if(isDistributionEqual||0===width){var rowLen=row.length;distWidth=availableWidth/rowLen}return Math.floor(distWidth)})}({row:matrix[this._lastLevelKey],width:mWidth,availableWidth:width},this.config());matrix.forEach(function(row,rIdx){return row.forEach(function(col,cIdx){var oldLogicalSpace=col.getLogicalSpace();col.setAvailableSpace(cWidths[cIdx]-borderWidth,oldLogicalSpace.height),rHeights[rIdx]=Math.max(rHeights[rIdx]||0,Math.floor(col.getLogicalSpace().height))})}),maxHeights.length>0&&(rHeights=rHeights.map(function(e,i){return Math.max(e,maxHeights[0][i])})),maxHeights.push(rHeights);for(var x=0;x<maxHeights.length;x++)maxHeights[x]=rHeights;return maxWidths.push(cWidths),{maxHeights:maxHeights,maxWidths:maxWidths}}},{key:"getCellDimensions",value:function getCellDimensions(measures){var _this4=this,borderWidth=this.config().unitMeasures.border,matrixInst=measures.matrixInst,height=measures.height,maxWidths=measures.maxWidths,maxHeights=measures.maxHeights,matrixIndex=measures.matrixIndex,matrix=matrixInst.matrix,rowHeights=[[0],[0]],columnWidths=[[0],[0]],heights=[0,0],breakPointer=this._breakPointer,heightDistribution=this.getPriorityDistribution({height:height,maxHeights:maxHeights[0]||[]});return matrix.forEach(function(row,rIdx){row.forEach(function(cell,cIdx){var colHeight=heightDistribution[rIdx]||0,colWidth=maxWidths[matrixIndex][cIdx];cell.setAvailableSpace(colWidth-borderWidth,colHeight),0===cIdx&&rIdx<breakPointer?(rowHeights[0][rIdx]=colHeight,heights[0]=(heights[0]||0)+colHeight):0===cIdx&&rIdx>=breakPointer&&(rowHeights[1][rIdx-breakPointer]=colHeight,heights[1]=(heights[1]||0)+colHeight),rIdx===_this4._lastLevelKey&&(columnWidths[0][cIdx]=colWidth,columnWidths[1][cIdx]=colWidth)})}),{heights:heights,widths:[0,0],rowHeights:rowHeights,columnWidths:columnWidths}}}]),ColumnVisualMatrix}();function layout_helper_toConsumableArray(arr){return function layout_helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function layout_helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function layout_helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function layout_helper_slicedToArray(arr,i){return function layout_helper_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function layout_helper_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function layout_helper_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function computations_slicedToArray(arr,i){return function computations_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function computations_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function computations_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function computations_toConsumableArray(arr){return function computations_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function computations_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function computations_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function computations_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function getMatrixMeasurement(matrix,type){return matrix?matrix.getLogicalSpace()[type]:0}var computations_setAvailableSpace=function setAvailableSpace(matrix,widths,heights){matrix.forEach(function(row,rIdx){row.forEach(function(placeholder,cIdx){placeholder.setAvailableSpace(widths[cIdx],heights[rIdx])})})},setViewSpaces=function setViewSpaces(layout,pointerType,viewSpaces){var pointer=layout.config()["".concat(pointerType,"Pointer")];return viewSpaces.length-1<pointer&&(pointer=0,layout.config(computations_defineProperty({},"".concat(pointerType,"Pointer"),pointer))),pointer},paginationDetailsMap={column:{maxMeasure:"maxWidthAvailableForColumnMatrix",matrix:"columnMatrix",measureType:"width",scrollType:enums_constants_HORIZONTAL},row:{maxMeasure:"maxHeightAvailableForRowMatrix",matrix:"rowMatrix",measureType:enums_constants_HEIGHT,scrollType:enums_constants_VERTICAL}},paginationMeasureGetter=function paginationMeasureGetter(layout,matrixType,relatedMaxMeasure,buffer){return function getMatrixMeasureForPagination(layout,measureDetails,maxMeasure,buffer){var pagination=layout.config().pagination,matrix=measureDetails.matrix,measureType=measureDetails.measureType,scrollType=measureDetails.scrollType;switch(pagination){case"holistic":return maxMeasure;default:var actualMeasure=getMatrixMeasurement(layout[matrix](),measureType)+buffer;return actualMeasure>maxMeasure&&layout.scrollInfo(computations_defineProperty({},scrollType,!0)),Math.max(maxMeasure,actualMeasure)}}(layout,paginationDetailsMap[matrixType],relatedMaxMeasure,buffer)},computations_getMatrixHeightDetails=function getMatrixHeightDetails(layout,columnMatrixWidth){var height=layout.measurement().height,buffer=layout.config().buffer,_getHeightRequiredByC=function getHeightRequiredByColMatrix(layout,columnMatrixWidth){var height=layout.measurement().height,columnMatrix=layout.columnMatrix(),maxColumnMatrixHeight=Math.min(columnMatrix.getLogicalSpace().height,height/2);columnMatrix.setAvailableSpace(columnMatrixWidth,maxColumnMatrixHeight);var columnViewSpace=columnMatrix.getViewableSpaces()[layout.config().columnPointer];return{columnMatrixHeight:columnViewSpace.height.primary+columnViewSpace.height.secondary,maxColumnMatrixHeight:maxColumnMatrixHeight}}(layout,columnMatrixWidth),columnMatrixHeight=_getHeightRequiredByC.columnMatrixHeight,maxColumnMatrixHeight=_getHeightRequiredByC.maxColumnMatrixHeight,maxHeightAvailableForRowMatrix=height-Math.min(maxColumnMatrixHeight,columnMatrixHeight);return{columnMatrixHeight:columnMatrixHeight,maxColumnMatrixHeight:maxColumnMatrixHeight,rowMatrixHeight:paginationMeasureGetter(layout,"row",maxHeightAvailableForRowMatrix,buffer),maxHeightAvailableForRowMatrix:maxHeightAvailableForRowMatrix}},computations_bufferCondition={isScroll:!0,pagination:"scroll"},computations_getActualBufferFromConfig=function getActualBufferFromConfig(layout){var buffer=layout.config().buffer,_map2=computations_slicedToArray([enums_constants_HORIZONTAL,enums_constants_VERTICAL].map(function(type){return function getBufferFromCondition(layout,type){var scrollInfo=layout.scrollInfo(),currentBufferType={pagination:layout.config().pagination,isScroll:scrollInfo[type]};return Object.keys(computations_bufferCondition).every(function(e){return computations_bufferCondition[e]===currentBufferType[e]})}(layout,type)?buffer:0}),2);return{horizontalBuffer:_map2[0],verticalBuffer:_map2[1]}},computations_computeLayoutMeasurements=function computeLayoutMeasurements(layout){var rowMatrix=layout.rowMatrix(),columnMatrix=layout.columnMatrix(),_getMatrixWidthDetail=function getMatrixWidthDetails(layout){var rowMatrix=layout.rowMatrix(),width=layout.measurement().width,_layout$config3=layout.config(),border=_layout$config3.border,buffer=_layout$config3.buffer,borderWidth=border.width,rowMatrixWidth=getMatrixMeasurement(rowMatrix,"width"),maxRowMatrixWidth=Math.min(rowMatrixWidth+buffer,width/2),maxWidthAvailableForColumnMatrix=width-maxRowMatrixWidth-borderWidth;return{rowMatrixWidth:rowMatrixWidth,maxRowMatrixWidth:maxRowMatrixWidth,columnMatrixWidth:paginationMeasureGetter(layout,"column",maxWidthAvailableForColumnMatrix,0),maxWidthAvailableForColumnMatrix:maxWidthAvailableForColumnMatrix}}(layout),rowMatrixWidth=_getMatrixWidthDetail.rowMatrixWidth,maxRowMatrixWidth=_getMatrixWidthDetail.maxRowMatrixWidth,maxWidthAvailableForColumnMatrix=_getMatrixWidthDetail.maxWidthAvailableForColumnMatrix,columnMatrixWidth=_getMatrixWidthDetail.columnMatrixWidth,_getMatrixHeightDetai=computations_getMatrixHeightDetails(layout,columnMatrixWidth),columnMatrixHeight=_getMatrixHeightDetai.columnMatrixHeight,rowMatrixHeight=_getMatrixHeightDetai.rowMatrixHeight,maxHeightAvailableForRowMatrix=_getMatrixHeightDetai.maxHeightAvailableForRowMatrix,_getActualBufferFromC=computations_getActualBufferFromConfig(layout),horizontalBuffer=_getActualBufferFromC.horizontalBuffer,verticalBuffer=_getActualBufferFromC.verticalBuffer;rowMatrix.setAvailableSpace(maxRowMatrixWidth-verticalBuffer,rowMatrixHeight-horizontalBuffer);var rowViewableSpaces=rowMatrix.getViewableSpaces(),columnViewableSpaces=columnMatrix.getViewableSpaces();return setViewSpaces(layout,"row",rowViewableSpaces),setViewSpaces(layout,"column",columnViewableSpaces),function setValueMatrixMeasurements(layout,rowViewableSpaces,columnViewableSpaces){var _ref,_ref2,_ref3,_ref4,_ref5,centerMatrix=layout.centerMatrix(),border=layout.config().border,matrices=layout.matrices(),top=matrices.top,bottom=matrices.bottom,borderWidth=border.width,rowHeights=(_ref=[]).concat.apply(_ref,computations_toConsumableArray(rowViewableSpaces.map(function(e){return e.rowHeights.primary}))),rowWidthsPrimary=(_ref2=[]).concat.apply(_ref2,computations_toConsumableArray(rowViewableSpaces.map(function(e){return e.columnWidths.primary}))),rowWidthsSecondary=(_ref3=[]).concat.apply(_ref3,computations_toConsumableArray(rowViewableSpaces.map(function(e){return e.columnWidths.secondary}))),columnWidths=(_ref4=[]).concat.apply(_ref4,computations_toConsumableArray(columnViewableSpaces.map(function(e){return e.columnWidths.primary}))),columnHeightsPrimary=columnViewableSpaces[0].rowHeights.primary,columnHeightsSecondary=(_ref5=[]).concat.apply(_ref5,computations_toConsumableArray(columnViewableSpaces.map(function(e){return e.rowHeights.secondary})));centerMatrix.forEach(function(matrix,rIdx){matrix.forEach(function(placeholder,cIdx){placeholder.setAvailableSpace(columnWidths[cIdx]-borderWidth,rowHeights[rIdx]-borderWidth)})}),computations_setAvailableSpace(top[0],rowWidthsPrimary,columnHeightsPrimary),computations_setAvailableSpace(top[2],rowWidthsSecondary,columnHeightsPrimary),computations_setAvailableSpace(bottom[0],rowWidthsPrimary,columnHeightsSecondary),computations_setAvailableSpace(bottom[2],rowWidthsSecondary,columnHeightsSecondary)}(layout,rowViewableSpaces,columnViewableSpaces),{rowMatrixHeight:rowMatrixHeight-horizontalBuffer,rowMatrixWidth:rowMatrixWidth-verticalBuffer,maxHeightAvailableForRowMatrix:maxHeightAvailableForRowMatrix-horizontalBuffer,columnMatrixHeight:columnMatrixHeight,columnMatrixWidth:columnMatrixWidth,maxWidthAvailableForColumnMatrix:maxWidthAvailableForColumnMatrix}},measureSum=function measureSum(measureArr){return measureArr.reduce(function(total,measure){return total+measure},0)};function layout_typeof(obj){"@babel/helpers - typeof";return(layout_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function layout_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function layout_possibleConstructorReturn(self,call){return!call||"object"!==layout_typeof(call)&&"function"!=typeof call?function layout_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function layout_get(target,property,receiver){return(layout_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function layout_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=layout_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function layout_getPrototypeOf(o){return(layout_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function layout_setPrototypeOf(o,p){return(layout_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var layout_GridLayout=function(_GenericLayout){function GridLayout(matrices,mountPoint,measurement,config){var _this;return function layout_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GridLayout),(_this=layout_possibleConstructorReturn(this,layout_getPrototypeOf(GridLayout).call(this,mountPoint,measurement,config))).matrices(matrices),_this.config(_this.constructor.defaultConfig()),_this._layoutId=getUniqueId(),_this._scrollInfo={horizontal:!1,vertical:!1},_this}return function layout_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&layout_setPrototypeOf(subClass,superClass)}(GridLayout,generic_layout_GenericLayout),function layout_createClass(Constructor,protoProps,staticProps){return protoProps&&layout_defineProperties(Constructor.prototype,protoProps),staticProps&&layout_defineProperties(Constructor,staticProps),Constructor}(GridLayout,[{key:"matrices",value:function matrices(_matrices){return _matrices?(this._matrices=function generateVisualMatrices(context,matrices){var begColCells,endColCells,leftMatrix=[],rightMatrix=[],topMatrix=[],bottomMatrix=[],_context$config=context.config(),isRowSizeEqual=_context$config.isRowSizeEqual,isColumnSizeEqual=_context$config.isColumnSizeEqual,gutterSpace=_context$config.gutterSpace,distribution=_context$config.distribution,border=_context$config.border,breakPage=_context$config.breakPage,priority=_context$config.priority,_context$measurement=context.measurement(),minUnitHeight=_context$measurement.minUnitHeight,minUnitWidth=_context$measurement.minUnitWidth,top=matrices.top,center=matrices.center,bottom=matrices.bottom,_top=layout_helper_slicedToArray(top,3),topLeft=_top[0],topColumns=_top[1],topRight=_top[2],_center=layout_helper_slicedToArray(center,3),leftRows=_center[0],valueMatrix=_center[1],rightRows=_center[2],_bottom=layout_helper_slicedToArray(bottom,3),bottomLeft=_bottom[0],bottomColumns=_bottom[1],bottomRight=_bottom[2];return leftRows.length>0&&(leftMatrix=[].concat(layout_helper_toConsumableArray(topLeft),layout_helper_toConsumableArray(leftRows),layout_helper_toConsumableArray(bottomLeft))),rightRows.length>0&&(rightMatrix=[].concat(layout_helper_toConsumableArray(topRight),layout_helper_toConsumableArray(rightRows),layout_helper_toConsumableArray(bottomRight))),topColumns.length>0&&topColumns[0].length>0&&(topMatrix=topColumns.map(function(d,i){return[].concat(layout_helper_toConsumableArray(topLeft[i]),layout_helper_toConsumableArray(d),layout_helper_toConsumableArray(topRight[i]))})),bottomColumns.length>0&&bottomColumns[0].length>0&&(bottomMatrix=bottomColumns.map(function(d,i){return[].concat(layout_helper_toConsumableArray(bottomLeft[i]),layout_helper_toConsumableArray(d),layout_helper_toConsumableArray(bottomRight[i]))})),context.rowMatrix(new row_matrix_RowVisualMatrix([leftMatrix,rightMatrix],{isDistributionEqual:isRowSizeEqual,distribution:distribution.rows,gutter:gutterSpace.rows,unitMeasures:{width:minUnitWidth,height:minUnitHeight,border:border.width},priority:priority.row,breakPage:breakPage.rows.map(function(e){return e+Math.max(topLeft.length,topRight.length)}),extraCellLengths:[topLeft.length,bottomLeft.length]})),begColCells=topLeft.length>0?topLeft[0].length:bottomLeft.length>0?bottomLeft[0].length:0,endColCells=topRight.length>0?topRight[0].length:bottomRight.length>0?bottomRight[0].length:0,context.columnMatrix(new column_matrix_ColumnVisualMatrix([topMatrix,bottomMatrix],{isDistributionEqual:isColumnSizeEqual,distribution:distribution.columns,gutter:gutterSpace.columns,isTransposed:!0,unitMeasures:{width:minUnitWidth,height:minUnitHeight,border:border.width},priority:priority.col,breakPage:breakPage.columns,extraCellLengths:[begColCells,endColCells]})),context.centerMatrix(valueMatrix),matrices}(this,_matrices),this):layout_get(layout_getPrototypeOf(GridLayout.prototype),"matrices",this).call(this,_matrices)}},{key:"triggerReflow",value:function triggerReflow(){this.scrollInfo({horizontal:!1,vertical:!1});var _computeLayoutMeasure=computations_computeLayoutMeasurements(this),maxHeightAvailableForRowMatrix=_computeLayoutMeasure.maxHeightAvailableForRowMatrix,maxWidthAvailableForColumnMatrix=_computeLayoutMeasure.maxWidthAvailableForColumnMatrix;return this.setViewInformation(maxHeightAvailableForRowMatrix,maxWidthAvailableForColumnMatrix),this}},{key:"gotoPage",value:function gotoPage(type,pageNumber){var pageType=type.toLowerCase(),totalPages=this.viewInfo().viewMatricesInfo["".concat(pageType,"Pages")],pointer=Math.min(Math.max(1,pageNumber),totalPages);return this.config(function layout_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},"".concat(pageType,"Pointer"),pointer-1)),this.setViewInformation(),this.renderGrid(),this}},{key:"pages",value:function pages(type){var viewMatricesInfo=this.viewInfo().viewMatricesInfo,pageType=type.toLowerCase();return{totalPages:viewMatricesInfo["".concat(pageType,"Pages")],currentPage:this.config()["".concat(pageType,"Pointer")]+1}}},{key:"viewInfo",value:function viewInfo(){return arguments.length?(this._viewInfo=arguments.length<=0?void 0:arguments[0],this):this._viewInfo}},{key:"scrollInfo",value:function scrollInfo(){return arguments.length?(this._scrollInfo=mergeRecursive(this._scrollInfo,arguments.length<=0?void 0:arguments[0]),this):this._scrollInfo}},{key:"setViewInformation",value:function setViewInformation(maxRowHeight,maxColWidth){var _this$config2=this.config(),rowPointer=_this$config2.rowPointer,columnPointer=_this$config2.columnPointer,border=_this$config2.border,viewMatricesInfo=function getViewMatrices(layout,rowPointer,columnPointer){for(var rowMatrix=layout.rowMatrix(),columnMatrix=layout.columnMatrix(),centerMatrix=layout.centerMatrix(),matrices=layout.matrices(),rowMatrices=rowMatrix.getViewableMatrices(),columnMatrices=columnMatrix.getViewableMatrices(),centralMatrixPointer={row:0,column:0},i=rowPointer-1;i>=0;i--){var length=Math.max(rowMatrices[i].primaryMatrix.length,rowMatrices[i].secondaryMatrix.length);centralMatrixPointer.row+=length}for(var _i=columnPointer-1;_i>=0;_i--){var matrix=columnMatrices[_i],primaryMatrix=matrix.primaryMatrix,secondaryMatrix=matrix.secondaryMatrix,_length=Math.max(primaryMatrix[0]?primaryMatrix[0].length:0,secondaryMatrix[0]?secondaryMatrix[0].length:0);centralMatrixPointer.column+=_length}matrices.top[1]=columnMatrices[columnPointer].primaryMatrix,matrices.bottom[1]=columnMatrices[columnPointer].secondaryMatrix,matrices.center[0]=rowMatrices[rowPointer].primaryMatrix,matrices.center[2]=rowMatrices[rowPointer].secondaryMatrix;var rowMatrixLen=Math.max(matrices.center[0].length,matrices.center[2].length),columnMatrixLen=Math.max(matrices.top[1][0]?matrices.top[1][0].length:0,matrices.bottom[1][0]?matrices.bottom[1][0].length:0);return matrices.center[1]=centerMatrix.slice(centralMatrixPointer.row,centralMatrixPointer.row+rowMatrixLen).map(function(matrix){return matrix.slice(centralMatrixPointer.column,centralMatrixPointer.column+columnMatrixLen)}),{matrices:matrices,rowPages:rowMatrices.length,columnPages:columnMatrices.length}}(this,rowPointer,columnPointer),layoutDimensions=function getViewMeasurements(layout,maxRowHeight,maxColWidth){var rowMatrix=layout.rowMatrix(),columnMatrix=layout.columnMatrix(),_layout$config=layout.config(),columnPointer=_layout$config.columnPointer,rowPointer=_layout$config.rowPointer,rowSpaces=rowMatrix.getViewableSpaces()[rowPointer],colSpaces=columnMatrix.getViewableSpaces()[columnPointer],rowHeights=rowSpaces.rowHeights,rowMatrixWidth=rowSpaces.width,columnWidths=colSpaces.columnWidths,columnMatrixHeight=colSpaces.height,leftWidth=rowMatrixWidth.primary,rightWidth=rowMatrixWidth.secondary,topHeight=columnMatrixHeight.primary,bottomHeight=columnMatrixHeight.secondary,centerHeight=measureSum(rowHeights.primary),centerWidth=measureSum(columnWidths.primary),viewWidth=[leftWidth,Math.min(centerWidth,maxColWidth),rightWidth],viewHeight=[topHeight,Math.min(centerHeight,maxRowHeight),bottomHeight];return{viewWidth:viewWidth,viewHeight:viewHeight,actualCenterMeasures:{height:centerHeight,width:centerWidth},totalMeasures:{width:measureSum(viewWidth),height:measureSum(viewHeight)},unitHeights:rowHeights,unitWidths:columnWidths}}(this,maxRowHeight,maxColWidth);return layoutDimensions.border=border,this.viewInfo({viewMatricesInfo:viewMatricesInfo,layoutDimensions:layoutDimensions}),this}}],[{key:"defaultViewInfo",value:function defaultViewInfo(){return Object.assign({},{layoutDimensions:{border:this.defaultConfig().border,viewHeight:[0,0,0],viewWidth:[0,0,0]},viewMatricesInfo:{columnPages:0,rowPages:0,matrices:{top:[],center:[],bottom:[]}}})}},{key:"defaultMeasurement",value:function defaultMeasurement(){return DEFAULT_MEASUREMENTS}},{key:"defaultConfig",value:function defaultConfig(){return DEFAULT_CONFIGURATION}},{key:"create",value:function create(){return new GridLayout(null,null,this.defaultMeasurement(),this.defaultConfig())}}]),GridLayout}();function border_helper_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var _matrixSpanGeneratorM,_spanApplierMap,specificBorderApplier=function specificBorderApplier(params){var borderTypes=params.borderTypes,showBorders=params.showBorders,cells=params.cells,borderInfo=params.borderInfo,name=params.name,isFacet=params.isFacet,color=borderInfo.color,style=borderInfo.style,width=borderInfo.width;borderTypes.forEach(function(borderType){!function applySpecificBorder(params){var type=params.type,borderWidth=params.borderWidth,borderStyle=params.borderStyle,cells=params.cells,color=params.color;cells.style("border-".concat(type),"".concat(borderWidth,"px ").concat(borderStyle," ").concat(color))}({cells:cells,color:showBorders[borderType]?color:"transparent",type:borderType,borderWidth:width,borderStyle:style,name:name,isFacet:isFacet})})},border_helper_applyBorders=function applyBorders(params){var cells=params.cells,border=params.border,row=params.row,column=params.column,isFacet=params.isFacet,showHeaders=params.showHeaders,name="".concat(ROW_MATRIX_INDEX[VIEW_INDEX[row]],"-").concat(COLUMN_MATRIX_INDEX[column]),borderApplierFn=function borderApplier(cells,borderInfo,name,isFacet){var _ref2,showRowBorders=borderInfo.showRowBorders,showColBorders=borderInfo.showColBorders,showValueBorders=borderInfo.showValueBorders;return border_helper_defineProperty(_ref2={},"row",function(){return specificBorderApplier({borderTypes:["top","bottom"],showBorders:showRowBorders,cells:cells,borderInfo:borderInfo,name:name,isFacet:isFacet})}),border_helper_defineProperty(_ref2,"column",function(){return specificBorderApplier({borderTypes:["left","right"],showBorders:showColBorders,cells:cells,borderInfo:borderInfo,name:name,isFacet:isFacet})}),border_helper_defineProperty(_ref2,"center",function(){return specificBorderApplier({borderTypes:["left","right","top","bottom"],showBorders:showValueBorders,cells:cells,borderInfo:borderInfo,name:name,isFacet:isFacet})}),border_helper_defineProperty(_ref2,"left",function(){return specificBorderApplier({borderTypes:["left"],showBorders:showRowBorders,cells:cells,borderInfo:borderInfo,name:name,isFacet:isFacet})}),border_helper_defineProperty(_ref2,"right",function(){return specificBorderApplier({borderTypes:["right"],showBorders:showRowBorders,cells:cells,borderInfo:borderInfo,name:name,isFacet:isFacet})}),border_helper_defineProperty(_ref2,"".concat("center").concat("left"),function _(){return specificBorderApplier({borderTypes:["left","top","bottom"],showBorders:showRowBorders,cells:cells,borderInfo:borderInfo,name:name,isFacet:isFacet})}),border_helper_defineProperty(_ref2,"".concat("center").concat("right"),function _(){return specificBorderApplier({borderTypes:["right","top","bottom"],showBorders:showRowBorders,cells:cells,borderInfo:borderInfo,name:name,isFacet:isFacet})}),_ref2}(cells,border,name,isFacet),borderMapVal=function borderMap(isFacet,showHeaders){var _ref;return border_helper_defineProperty(_ref={},"".concat("top","-").concat("left"),isFacet&&showHeaders?"left":null),border_helper_defineProperty(_ref,"".concat("top","-").concat("middle"),"column"),border_helper_defineProperty(_ref,"".concat("top","-").concat("right"),isFacet&&showHeaders?"right":null),border_helper_defineProperty(_ref,"".concat("center","-").concat("left"),isFacet?"".concat("center").concat("left"):"row"),border_helper_defineProperty(_ref,"".concat("center","-").concat("middle"),"center"),border_helper_defineProperty(_ref,"".concat("center","-").concat("right"),isFacet?"".concat("center").concat("right"):"row"),border_helper_defineProperty(_ref,"".concat("bottom","-").concat("left"),null),border_helper_defineProperty(_ref,"".concat("bottom","-").concat("middle"),"column"),border_helper_defineProperty(_ref,"".concat("bottom","-").concat("right"),null),_ref}(isFacet,showHeaders)[name];borderMapVal&&borderApplierFn[borderMapVal]()};function span_maker_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var orderMaker=function orderMaker(arr){return Array.from(Array(arr.length).keys())},nestByStack=function nestByStack(stack,updateArr){var optionalParams=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},order=optionalParams.order,keyFn=optionalParams.keyFn,arr=updateArr.slice(),currStack=stack.slice(),prevStack=currStack.slice();if(order=order||Array.from(Array(arr.length).keys()),keyFn=keyFn||function(v){return v},0===currStack.length){var _newArr=[];return order.forEach(function(e){_newArr.push(arr[e])}),{prevStack:prevStack,currStack:arr,arr:_newArr}}for(var arrVal="",stackVal="",newArr=[],i=order.length-1;i>=0;i--){var currElemIndex=order[i];if((arrVal+=keyFn(arr[currElemIndex]))===(stackVal+=keyFn(currStack[currElemIndex])))newArr[currElemIndex]=null;else{stackVal="";for(var j=i;j<order.length;j++){var newElem=order[j],arrElem=arr[newElem];newArr[newElem]=arrElem,currStack[newElem]=arrElem,stackVal=arrVal}}}var returnArr=[];return order.forEach(function(e){returnArr.push(newArr[e])}),{prevStack:prevStack,currStack:currStack,arr:returnArr}},spanCalculator=function spanCalculator(colData,colIdx,matrix,rIdx){if(!colData)return function(){return null};var conditions={row:function row(count){return matrix[rIdx+count]&&matrix[rIdx+count][colIdx]},column:function column(count){return matrix[rIdx][colIdx+count]}};return function(type){for(var count=1,isNull=!1;!isNull;)null===conditions[type](count)?count+=1:isNull=!0;return count}},maskCreator=function maskCreator(matrix,order){return{row:function row(){var stack=[];return matrix.map(function(e){var _nestByStack=nestByStack(stack,e,{keyFn:function keyFn(val){return val.valueOf()},order:order}),currStack=_nestByStack.currStack,arr=_nestByStack.arr;return stack=currStack,arr})},column:function column(){var stack=[],viewMatrix=[];return matrix.length&&matrix[0].forEach(function(cell,colIndex){var hierarchy=[];matrix.forEach(function(row){hierarchy.push(row[colIndex])});var _nestByStack2=nestByStack(stack,hierarchy,{keyFn:function keyFn(val){return val.valueOf()},order:order}),currStack=_nestByStack2.currStack,arr=_nestByStack2.arr;stack=currStack,matrix.forEach(function(row,rowIndex){viewMatrix[rowIndex]=viewMatrix[rowIndex]||[],viewMatrix[rowIndex][colIndex]=arr[rowIndex]})}),viewMatrix}}},spanGenerator=function spanGenerator(viewMatrix){return{row:function row(){var spans=[];return viewMatrix.forEach(function(row,ridx){spans[ridx]=spans[ridx]||[],row.forEach(function(col,i){if(viewMatrix[ridx][i]){var currSpan=spanCalculator(col,i,viewMatrix,ridx)("row");currSpan&&spans[ridx].push(currSpan)}})}),spans},column:function column(){return viewMatrix.map(function(row,ridx){return row.map(function(col,i){return spanCalculator(col,i,viewMatrix,ridx)("column")}).filter(function(col){return null!==col})})}}},getOrder=function getOrder(){return{row:function row(matrix){return orderMaker(matrix[0])},column:function column(matrix){return orderMaker(matrix)}}},matrixSpanGeneratorMap=(span_maker_defineProperty(_matrixSpanGeneratorM={},"".concat("top","-1"),{orderGetter:getOrder().column,viewMatrixMaker:function viewMatrixMaker(){return maskCreator.apply(void 0,arguments).column},spanMaker:function spanMaker(){return spanGenerator.apply(void 0,arguments).column}}),span_maker_defineProperty(_matrixSpanGeneratorM,"".concat("bottom","-1"),{orderGetter:getOrder().column,viewMatrixMaker:function viewMatrixMaker(){return maskCreator.apply(void 0,arguments).column},spanMaker:function spanMaker(){return spanGenerator.apply(void 0,arguments).column}}),span_maker_defineProperty(_matrixSpanGeneratorM,"".concat("center","-0"),{orderGetter:getOrder().row,viewMatrixMaker:function viewMatrixMaker(){return maskCreator.apply(void 0,arguments).row},spanMaker:function spanMaker(){return spanGenerator.apply(void 0,arguments).row}}),span_maker_defineProperty(_matrixSpanGeneratorM,"".concat("center","-2"),{orderGetter:getOrder().row,viewMatrixMaker:function viewMatrixMaker(){return maskCreator.apply(void 0,arguments).row},spanMaker:function spanMaker(){return spanGenerator.apply(void 0,arguments).row}}),_matrixSpanGeneratorM),matrixSpanGenerator=function matrixSpanGenerator(type){var generator=matrixSpanGeneratorMap[type];return generator||{orderGetter:function orderGetter(){return null},viewMatrixMaker:function viewMatrixMaker(matrix){return function(){return matrix}},spanMaker:function spanMaker(){return function(){return null}}}};var spanApplier=function spanApplier(cells,spans,config,type){var cellCounter=0;cells.attr(type,function(cell,colIndex){0===colIndex&&(cellCounter=0);var span=spans[cell.rowIndex][colIndex],placeholder=cell.placeholder,index={row:cell.rowIndex,col:cellCounter};return function spaceAllocationDueToSpan(){var _ref,span=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,placeholder=arguments.length>1?arguments[1]:void 0,config=arguments.length>2?arguments[2]:void 0,index=arguments.length>3?arguments[3]:void 0,height=placeholder.availHeight(),width=placeholder.availWidth(),borderWidth=config.border.width,unitWidths=config.dimensions.unitWidths,col=index.col;return span_maker_defineProperty(_ref={},"rowSpan",function(){placeholder.setAvailableSpace(width,height*span),1===span&&renderer_utils_selectElement(this).style("height","".concat(height*span+borderWidth,"px"))}),span_maker_defineProperty(_ref,"colSpan",function(){var primaryUnitWidth=unitWidths.primary[col];if(span>1){for(var cumulativeWidth=0,i=col;i<col+span;i++)cumulativeWidth+=unitWidths.primary[i]-borderWidth;placeholder.setAvailableSpace(cumulativeWidth+borderWidth,height)}else primaryUnitWidth&&placeholder.setAvailableSpace(primaryUnitWidth-borderWidth,height);renderer_utils_selectElement(this).style("height","".concat(height,"px"))}),_ref}(span,placeholder,config,index)[type].bind(this)(),cellCounter+=span,span})},spanApplierMap=(span_maker_defineProperty(_spanApplierMap={},"".concat("top","-0"),null),span_maker_defineProperty(_spanApplierMap,"".concat("top","-1"),function _(){for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return spanApplier.apply(void 0,params.concat(["colSpan"]))}),span_maker_defineProperty(_spanApplierMap,"".concat("top","-2"),null),span_maker_defineProperty(_spanApplierMap,"".concat("center","-0"),function _(){for(var _len2=arguments.length,params=new Array(_len2),_key2=0;_key2<_len2;_key2++)params[_key2]=arguments[_key2];return spanApplier.apply(void 0,params.concat(["rowSpan"]))}),span_maker_defineProperty(_spanApplierMap,"".concat("center","-1"),null),span_maker_defineProperty(_spanApplierMap,"".concat("center","-2"),function _(){for(var _len3=arguments.length,params=new Array(_len3),_key3=0;_key3<_len3;_key3++)params[_key3]=arguments[_key3];return spanApplier.apply(void 0,params.concat(["rowSpan"]))}),span_maker_defineProperty(_spanApplierMap,"".concat("bottom","-0"),null),span_maker_defineProperty(_spanApplierMap,"".concat("bottom","-1"),function _(){for(var _len4=arguments.length,params=new Array(_len4),_key4=0;_key4<_len4;_key4++)params[_key4]=arguments[_key4];return spanApplier.apply(void 0,params.concat(["colSpan"]))}),span_maker_defineProperty(_spanApplierMap,"".concat("bottom","-2"),null),_spanApplierMap);function transaction_support_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var transaction_support_TransactionSupport=function(){function TransactionSupport(){!function transaction_support_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TransactionSupport)}return function transaction_support_createClass(Constructor,protoProps,staticProps){return protoProps&&transaction_support_defineProperties(Constructor.prototype,protoProps),staticProps&&transaction_support_defineProperties(Constructor,staticProps),Constructor}(TransactionSupport,[{key:"data",value:function data(){throw new Error(ERROR_MSG.INTERFACE_IMPl)}},{key:"width",value:function width(){throw new Error(ERROR_MSG.INTERFACE_IMPl)}},{key:"height",value:function height(){throw new Error(ERROR_MSG.INTERFACE_IMPl)}},{key:"config",value:function config(){throw new Error(ERROR_MSG.INTERFACE_IMPl)}}]),TransactionSupport}();function component_resolver_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var visual_cell_src_enums_constants_LEFT="left",visual_cell_src_enums_constants_RIGHT="right",visual_cell_src_enums_constants_BOTTOM="bottom",visual_cell_src_enums_constants_TOP="top",visual_cell_src_enums_constants_CLASSPREFIX="muze",constants_HEADER="header",enums_constants_DATA="data",enums_constants_AXES="axes",constants_FACET_BY_FIELDS="facetByFields",constants_FIELDS="fields",enums_constants_TRANSFORM="transform",LAYER_DEF="layerDef",src_enums_constants_CONFIG="config",DETAIL_FIELDS="detailFields",cell_type_TEXT="text",cell_type_AXIS="axis",GEOM="geom",BLANK="blank";function simple_cell_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var _CONSTANTS$MARGIN,_CONSTANTS$PADDING,_CONSTANTS$HEADER_PAD,_CONSTANTS$TITLE_PADD,_DEFAULT_CONFIG,simple_cell=function(){function SimpleCell(config){!function simple_cell_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SimpleCell),this._id=getUniqueId();var defConfig=mergeRecursive({},this.constructor.defaultConfig());this._config=mergeRecursive(defConfig,config||{}),this._mount=null}return function simple_cell_createClass(Constructor,protoProps,staticProps){return protoProps&&simple_cell_defineProperties(Constructor.prototype,protoProps),staticProps&&simple_cell_defineProperties(Constructor,staticProps),Constructor}(SimpleCell,[{key:"valueOf",value:function valueOf(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"id",value:function id(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"serialize",value:function serialize(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"getLogicalSpace",value:function getLogicalSpace(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"setAvailableSpace",value:function setAvailableSpace(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"render",value:function render(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"remove",value:function remove(){throw new Error(ERROR_MSG.INTERFACE_IMPL)}},{key:"getMinMeasures",value:function getMinMeasures(){return arguments.length>0&&void 0!==arguments[0]?arguments[0]:0}},{key:"type",get:function get(){return"simple"}}],[{key:"formalName",value:function formalName(){return"SimpleCell"}},{key:"defaultConfig",value:function defaultConfig(){return{}}}]),SimpleCell}();function enums_defaults_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var visual_cell_src_props_PROPS,enums_defaults_DEFAULT_CONFIG=(enums_defaults_defineProperty(_DEFAULT_CONFIG={},"margin",(enums_defaults_defineProperty(_CONSTANTS$MARGIN={},visual_cell_src_enums_constants_LEFT,0),enums_defaults_defineProperty(_CONSTANTS$MARGIN,visual_cell_src_enums_constants_RIGHT,0),enums_defaults_defineProperty(_CONSTANTS$MARGIN,visual_cell_src_enums_constants_TOP,0),enums_defaults_defineProperty(_CONSTANTS$MARGIN,visual_cell_src_enums_constants_BOTTOM,0),_CONSTANTS$MARGIN)),enums_defaults_defineProperty(_DEFAULT_CONFIG,"spaceFixer",2),enums_defaults_defineProperty(_DEFAULT_CONFIG,"isOffset",!1),enums_defaults_defineProperty(_DEFAULT_CONFIG,"verticalAlign",null),enums_defaults_defineProperty(_DEFAULT_CONFIG,"textAlign","center"),enums_defaults_defineProperty(_DEFAULT_CONFIG,"show",!0),enums_defaults_defineProperty(_DEFAULT_CONFIG,"maxLines",0),enums_defaults_defineProperty(_DEFAULT_CONFIG,"minCharacters",0),enums_defaults_defineProperty(_DEFAULT_CONFIG,"rotation",null),enums_defaults_defineProperty(_DEFAULT_CONFIG,"padding",(enums_defaults_defineProperty(_CONSTANTS$PADDING={},visual_cell_src_enums_constants_LEFT,8),enums_defaults_defineProperty(_CONSTANTS$PADDING,visual_cell_src_enums_constants_RIGHT,8),enums_defaults_defineProperty(_CONSTANTS$PADDING,visual_cell_src_enums_constants_TOP,10),enums_defaults_defineProperty(_CONSTANTS$PADDING,visual_cell_src_enums_constants_BOTTOM,0),_CONSTANTS$PADDING)),enums_defaults_defineProperty(_DEFAULT_CONFIG,"headerPadding",(enums_defaults_defineProperty(_CONSTANTS$HEADER_PAD={},visual_cell_src_enums_constants_LEFT,8),enums_defaults_defineProperty(_CONSTANTS$HEADER_PAD,visual_cell_src_enums_constants_RIGHT,5),enums_defaults_defineProperty(_CONSTANTS$HEADER_PAD,visual_cell_src_enums_constants_TOP,2),enums_defaults_defineProperty(_CONSTANTS$HEADER_PAD,visual_cell_src_enums_constants_BOTTOM,5),_CONSTANTS$HEADER_PAD)),enums_defaults_defineProperty(_DEFAULT_CONFIG,"titlePadding",(enums_defaults_defineProperty(_CONSTANTS$TITLE_PADD={},visual_cell_src_enums_constants_LEFT,0),enums_defaults_defineProperty(_CONSTANTS$TITLE_PADD,visual_cell_src_enums_constants_RIGHT,0),enums_defaults_defineProperty(_CONSTANTS$TITLE_PADD,visual_cell_src_enums_constants_TOP,0),enums_defaults_defineProperty(_CONSTANTS$TITLE_PADD,visual_cell_src_enums_constants_BOTTOM,0),_CONSTANTS$TITLE_PADD)),_DEFAULT_CONFIG);function visual_cell_src_props_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DEFAULT_PROPS={mount:{},availHeight:{},availWidth:{},config:{sanitization:function sanitization(context,value){return mergeRecursive(context._config,value)}},logicalSpace:{},minSpacing:{},source:{}},packages_visual_cell_src_props_PROPS=(visual_cell_src_props_defineProperty(visual_cell_src_props_PROPS={},GEOM,mergeRecursive({data:{},caption:{},config:{},axes:{},facetByFields:{},fields:{},transform:{},layerDef:{},detailFields:{}},DEFAULT_PROPS)),visual_cell_src_props_defineProperty(visual_cell_src_props_PROPS,cell_type_TEXT,mergeRecursive({smartText:{}},DEFAULT_PROPS)),visual_cell_src_props_defineProperty(visual_cell_src_props_PROPS,cell_type_AXIS,DEFAULT_PROPS),visual_cell_src_props_defineProperty(visual_cell_src_props_PROPS,BLANK,DEFAULT_PROPS),visual_cell_src_props_PROPS);function axis_cell_typeof(obj){"@babel/helpers - typeof";return(axis_cell_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function axis_cell_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function axis_cell_getPrototypeOf(o){return(axis_cell_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function axis_cell_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function axis_cell_setPrototypeOf(o,p){return(axis_cell_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var axis_cell=function(_SimpleCell){function AxisCell(config){var _this;return function axis_cell_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AxisCell),(_this=function axis_cell_possibleConstructorReturn(self,call){return!call||"object"!==axis_cell_typeof(call)&&"function"!=typeof call?axis_cell_assertThisInitialized(self):call}(this,axis_cell_getPrototypeOf(AxisCell).call(this,config)))._axis=null,_this._availHeight=null,_this._availWidth=null,_this._logicalSpace=null,generateGetterSetters(axis_cell_assertThisInitialized(_this),packages_visual_cell_src_props_PROPS[cell_type_AXIS]),_this}return function axis_cell_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&axis_cell_setPrototypeOf(subClass,superClass)}(AxisCell,simple_cell),function axis_cell_createClass(Constructor,protoProps,staticProps){return protoProps&&axis_cell_defineProperties(Constructor.prototype,protoProps),staticProps&&axis_cell_defineProperties(Constructor,staticProps),Constructor}(AxisCell,[{key:"valueOf",value:function valueOf(){return this.source().id}},{key:"serialize",value:function serialize(){return{type:cell_type_AXIS,axis:this.source().serialize()}}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||this.logicalSpace(function computeAxisSpace(context){var logicalWidth,logicalHeight,axis=context.source(),_context$config=context.config(),spaceFixer=_context$config.spaceFixer,margin=_context$config.margin,_axis$getLogicalSpace=axis.getLogicalSpace(),width=_axis$getLogicalSpace.width,height=_axis$getLogicalSpace.height;return!0===axis.config().show?(logicalHeight=Math.floor(height+margin.top+margin.bottom+spaceFixer),logicalWidth=Math.floor(width+margin.left+margin.right+spaceFixer)):(logicalWidth=width,logicalHeight=height),{width:logicalWidth,height:logicalHeight}}(this)),this.logicalSpace()}},{key:"setAvailableSpace",value:function setAvailableSpace(width,height){this.availWidth(width),this.availHeight(height);var _this$config=this.config(),margin=_this$config.margin,isOffset=_this$config.isOffset;return width||height?(this.source().setAvailableSpace(width,height,margin,isOffset),this.source().logicalSpace(null)):this.source().resetLogicalSpace(),this.logicalSpace(null),this}},{key:"render",value:function render(mount){if(!mount)return this;var actualWidth=0,actualHeight=0,axis=this.source(),availHeight=this.availHeight(),availWidth=this.availWidth(),margin=this.config().margin,top=margin.top,bottom=margin.bottom,left=margin.left,right=margin.right,_axis$config2=axis.config(),show=_axis$config2.show,orientation=_axis$config2.orientation,wrapperDiv=makeElement(renderer_utils_selectElement(mount),"div",[this],"".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-").concat("axis-cell")),selection=makeElement(wrapperDiv,"svg",[1],"".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-axis-container"));return selection.classed("".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-axis-container-").concat(orientation),!0),this.mount(mount),availWidth||selection.attr("width","".concat(0,"px")),availHeight||selection.attr("height","".concat(0,"px")),actualWidth=availWidth,actualHeight=availHeight,show||(actualWidth=orientation===visual_cell_src_enums_constants_TOP||orientation===visual_cell_src_enums_constants_BOTTOM?availWidth:0,actualHeight=orientation===visual_cell_src_enums_constants_TOP||orientation===visual_cell_src_enums_constants_BOTTOM?0:availHeight),wrapperDiv.style("width","".concat(actualWidth,"px")).style("height","".concat(actualHeight,"px")).style("margin-top",top).style("margin-bottom",bottom).style("margin-left",left).style("margin-right",right),axis.mount(selection.node()),selection}},{key:"remove",value:function remove(){return this.source()&&this.source().remove(),this.mount()&&this.mount().remove(),this}},{key:"type",get:function get(){return cell_type_AXIS}},{key:"id",get:function get(){return this._id}}],[{key:"formalName",value:function formalName(){return"AxisCell"}},{key:"defaultConfig",value:function defaultConfig(){return enums_defaults_DEFAULT_CONFIG}}]),AxisCell}();function blank_cell_typeof(obj){"@babel/helpers - typeof";return(blank_cell_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function blank_cell_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function blank_cell_getPrototypeOf(o){return(blank_cell_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function blank_cell_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function blank_cell_setPrototypeOf(o,p){return(blank_cell_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var blank_cell=function(_SimpleCell){function BlankCell(config){var _this;return function blank_cell_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,BlankCell),_this=function blank_cell_possibleConstructorReturn(self,call){return!call||"object"!==blank_cell_typeof(call)&&"function"!=typeof call?blank_cell_assertThisInitialized(self):call}(this,blank_cell_getPrototypeOf(BlankCell).call(this,config)),generateGetterSetters(blank_cell_assertThisInitialized(_this),packages_visual_cell_src_props_PROPS[BLANK]),_this}return function blank_cell_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&blank_cell_setPrototypeOf(subClass,superClass)}(BlankCell,simple_cell),function blank_cell_createClass(Constructor,protoProps,staticProps){return protoProps&&blank_cell_defineProperties(Constructor.prototype,protoProps),staticProps&&blank_cell_defineProperties(Constructor,staticProps),Constructor}(BlankCell,[{key:"valueOf",value:function valueOf(){return this.id}},{key:"serialize",value:function serialize(){return{type:BLANK}}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()?this.logicalSpace():{width:this.width||0,height:this.height||0}}},{key:"setAvailableSpace",value:function setAvailableSpace(width,height){return this.availWidth(width),this.availHeight(height),this.logicalSpace(null),this}},{key:"render",value:function render(mount){if(mount){var style=this.config().style;this.mount(mount);var container=renderer_utils_selectElement(mount),elem=makeElement(container,"div",[this.id]);elem.classed("".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-").concat("blank-cell"),!0),elem.style("width","".concat(this.availWidth(),"px")),elem.style("height","".concat(this.availHeight(),"px")),elem.html(""),style&&renderer_utils_applyStyle(elem,style)}return this}},{key:"remove",value:function remove(){return this.mount()&&this.mount().remove(),this}},{key:"getMinMeasures",value:function getMinMeasures(){return 0}},{key:"type",get:function get(){return BLANK}},{key:"id",get:function get(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return enums_defaults_DEFAULT_CONFIG}},{key:"formalName",value:function formalName(){return"BlankCell"}}]),BlankCell}(),setSmartText=(__webpack_require__(36),function setSmartText(context){var source=context.source(),_context$minSpacing=context.minSpacing(),minHeightSpace=_context$minSpacing.height,minWidthSpace=_context$minSpacing.width,_context$config=context.config(),margin=_context$config.margin,rotation=_context$config.rotation,left=margin.left,right=margin.right,paddedHeight=margin.top+margin.bottom+minHeightSpace,paddedWidth=left+right+minWidthSpace,availHeight=context.availHeight()-paddedHeight,availWidth=context.availWidth()-paddedWidth,labelManager=context.dependencies().labelManager;return labelManager.setStyle(context._computedStyle),!rotation&&context.smartText(labelManager.getSmartText(source,availWidth,availHeight,!1)),rotation&&context.smartText(labelManager.getSmartText(source,availHeight,availWidth,!0)),context}),text_cell_helper_isTitleSubtitle=function isTitleSubtitle(subType){var returnVal=!1;return subType!=="".concat("title")&&subType!=="".concat("subtitle")||(returnVal=!0),returnVal},text_cell_helper_computeTextSpace=function computeTextSpace(context){var labelManager=context.dependencies().labelManager,_context$minSpacing2=context.minSpacing(),minHeightSpace=_context$minSpacing2.height,minWidthSpace=_context$minSpacing2.width,_context$config2=context.config(),margin=_context$config2.margin,show=_context$config2.show,maxLines=_context$config2.maxLines,minCharacters=_context$config2.minCharacters,left=margin.left,right=margin.right,paddedHeight=margin.top+margin.bottom+minHeightSpace,paddedWidth=left+right+minWidthSpace,availHeight=context.availHeight()-paddedHeight,availWidth=context.availWidth()-paddedWidth,source=context.source(),space=context.smartText(),minText=new Array(minCharacters).fill("W").join(""),_minTextSpace=labelManager.getOriSize(minText);if(context.config({rotation:!1}),space.width>(availWidth||0)&&maxLines&&(space.height=space.oriTextHeight*maxLines),availWidth&&availWidth<space.width&&(space.width=_minTextSpace.width),availWidth&&availWidth<Math.min(_minTextSpace.width,space.oriTextWidth)){var smartSpace=labelManager.getSmartText(source,availHeight,_minTextSpace.height,!0),smHeight=smartSpace.height,smWidth=smartSpace.width;space.width=smWidth,space.height=smHeight,context.config({rotation:!0}),context.smartText(smartSpace)}var _context$config3=context.config(),subType=_context$config3.subType,headerPadding=_context$config3.headerPadding;return text_cell_helper_isTitleSubtitle(subType)||(space.width+=headerPadding[visual_cell_src_enums_constants_LEFT]+headerPadding[visual_cell_src_enums_constants_RIGHT]),show?{width:Math.ceil(space.width)+paddedWidth,height:Math.ceil(space.height)+paddedHeight}:{width:0,height:0}};function text_cell_typeof(obj){"@babel/helpers - typeof";return(text_cell_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function text_cell_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function text_cell_getPrototypeOf(o){return(text_cell_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function text_cell_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function text_cell_setPrototypeOf(o,p){return(text_cell_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var src_text_cell=function(_SimpleCell){function TextCell(config,dependencies){var _this;!function text_cell_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TextCell),(_this=function text_cell_possibleConstructorReturn(self,call){return!call||"object"!==text_cell_typeof(call)&&"function"!=typeof call?text_cell_assertThisInitialized(self):call}(this,text_cell_getPrototypeOf(TextCell).call(this,config)))._dependencies=dependencies,_this._className=_this._config.className||(_this._config.type===constants_HEADER?"".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-").concat(constants_HEADER,"-cell"):"".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-").concat(cell_type_TEXT,"-cell")),_this._computedStyle=renderer_utils_getSmartComputedStyle(renderer_utils_selectElement("body"),_this._className),_this._dependencies.labelManager.setStyle(_this._computedStyle),generateGetterSetters(text_cell_assertThisInitialized(_this),packages_visual_cell_src_props_PROPS[cell_type_TEXT]);var space=_this._dependencies.labelManager.getOriSize("w");return _this.minSpacing({width:Math.floor(3*space.width/4),height:Math.floor(space.height/2)}),setSmartText(text_cell_assertThisInitialized(_this)),_this}return function text_cell_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&text_cell_setPrototypeOf(subClass,superClass)}(TextCell,simple_cell),function text_cell_createClass(Constructor,protoProps,staticProps){return protoProps&&text_cell_defineProperties(Constructor.prototype,protoProps),staticProps&&text_cell_defineProperties(Constructor,staticProps),Constructor}(TextCell,[{key:"valueOf",value:function valueOf(){return this.source()}},{key:"dependencies",value:function dependencies(){return this._dependencies}},{key:"serialize",value:function serialize(){return{text:this.source(),type:cell_type_TEXT}}},{key:"getLogicalSpace",value:function getLogicalSpace(){this.logicalSpace()||this.logicalSpace(text_cell_helper_computeTextSpace(this));var space=text_cell_helper_computeTextSpace(this);return this.logicalSpace(space),this.logicalSpace()}},{key:"setAvailableSpace",value:function setAvailableSpace(width,height){return this.availWidth(width),this.availHeight(height),setSmartText(this),this.logicalSpace(null),this}},{key:"render",value:function render(mount){var availWidth=this.availWidth(),availHeight=this.availHeight(),_this$config=this.config(),margin=_this$config.margin,show=_this$config.show,verticalAlign=_this$config.verticalAlign,textAlign=_this$config.textAlign,rotation=_this$config.rotation,padding=_this$config.padding,type=_this$config.type,headerPadding=_this$config.headerPadding,className=_this$config.className,titlePadding=_this$config.titlePadding;if(this.mount(mount),show){var container=renderer_utils_selectElement(mount),elem=makeElement(container,"div",[this.id],"".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-").concat("text-cell")),vAlign=verticalAlign||rotation?"middle":"top",_this$smartText=this.smartText(),width=_this$smartText.width,height=_this$smartText.height,minHeightSpace=this.minSpacing().height,translation={top:width+minHeightSpace/2,middle:width/2+minHeightSpace,bottom:minHeightSpace};container.style("vertical-align",vAlign),elem.classed(this._className,!0),elem.style("display","inline"),elem.style("transform",rotation?"translate(".concat(height/2,"px,\n                ").concat(translation[vAlign],"px) rotate(-90deg)"):""),elem.style("width",availWidth?"".concat(availWidth,"px"):"100%"),[visual_cell_src_enums_constants_TOP,visual_cell_src_enums_constants_BOTTOM,visual_cell_src_enums_constants_LEFT,visual_cell_src_enums_constants_RIGHT].forEach(function(position){container.style("margin-".concat(position),"".concat(margin[position],"px"))}),elem=function setPadding(measures){var localPadding,elem=measures.elem,className=measures.className,headerPadding=measures.headerPadding,padding=measures.padding,type=measures.type,titlePadding=measures.titlePadding;return localPadding=text_cell_helper_isTitleSubtitle(className)?titlePadding:type===constants_HEADER?headerPadding:padding,[visual_cell_src_enums_constants_TOP,visual_cell_src_enums_constants_BOTTOM,visual_cell_src_enums_constants_LEFT,visual_cell_src_enums_constants_RIGHT].forEach(function(position){elem.style("padding-".concat(position),"".concat(localPadding[position],"px"))}),elem}({elem:elem,className:className,headerPadding:headerPadding,padding:padding,type:type,titlePadding:titlePadding}),"muze-grid-headers"===this._className&&elem.style("text-align",textAlign),elem.style("display","inline"),this._dependencies.labelManager.setStyle(this._computedStyle),elem.html(this._dependencies.labelManager.getSmartText(this.source(),availWidth,availHeight,!0).text)}return this}},{key:"remove",value:function remove(){return this.mount()&&this.mount().remove(),this}},{key:"type",get:function get(){return cell_type_TEXT}},{key:"id",get:function get(){return this._id}}],[{key:"defaultConfig",value:function defaultConfig(){return enums_defaults_DEFAULT_CONFIG}},{key:"formalName",value:function formalName(){return"TextCell"}}]),TextCell}();function geom_cell_typeof(obj){"@babel/helpers - typeof";return(geom_cell_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function geom_cell_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function geom_cell_getPrototypeOf(o){return(geom_cell_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function geom_cell_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function geom_cell_setPrototypeOf(o,p){return(geom_cell_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _DEFAULT_PLACEHOLDERS,geom_cell=function(_SimpleCell){function GeomCell(config){var _this;return function geom_cell_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GeomCell),(_this=function geom_cell_possibleConstructorReturn(self,call){return!call||"object"!==geom_cell_typeof(call)&&"function"!=typeof call?geom_cell_assertThisInitialized(self):call}(this,geom_cell_getPrototypeOf(GeomCell).call(this,config)))._unit=null,_this._layers=null,_this._axes={},_this._datamodel={},_this._facetByFields={},_this._fields=null,_this._transform=null,_this._caption=null,generateGetterSetters(geom_cell_assertThisInitialized(_this),packages_visual_cell_src_props_PROPS[GEOM]),_this}return function geom_cell_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&geom_cell_setPrototypeOf(subClass,superClass)}(GeomCell,simple_cell),function geom_cell_createClass(Constructor,protoProps,staticProps){return protoProps&&geom_cell_defineProperties(Constructor.prototype,protoProps),staticProps&&geom_cell_defineProperties(Constructor,staticProps),Constructor}(GeomCell,[{key:"valueOf",value:function valueOf(){return this.source()}},{key:"serialize",value:function serialize(){return{type:GEOM,unit:this.source().serialize(),caption:this.caption()}}},{key:"updateModel",value:function updateModel(){var _this2=this,unit=this.source();return unit.clearCaching(),[LAYER_DEF,enums_constants_TRANSFORM,enums_constants_AXES,constants_FIELDS,src_enums_constants_CONFIG,enums_constants_DATA,enums_constants_AXES,constants_FACET_BY_FIELDS,DETAIL_FIELDS].forEach(function(prop){_this2[prop]()&&unit[prop](_this2[prop]())}),this}},{key:"getCaptionSpace",value:function getCaptionSpace(){var caption=this.caption(),captionSpace={width:0,height:0};return caption&&(captionSpace=caption.getLogicalSpace()),captionSpace}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()||this.logicalSpace(function computeGeomSpace(context){var config=context.source().config(),width=config.width,height=config.height;return{width:Math.ceil(width),height:Math.ceil(height+context.getCaptionSpace().height)}}(this)),this.logicalSpace()}},{key:"setAvailableSpace",value:function setAvailableSpace(width,height){var unit=this.source();return this.availWidth(width),this.availHeight(height),unit.lockModel().width(width).height(height-this.getCaptionSpace().height).unlockModel(),this.logicalSpace(null),this}},{key:"render",value:function render(mount){if(mount){this.mount(mount);var availHeight=this.availHeight(),availWidth=this.availWidth(),caption=this.caption(),wrapperDiv=makeElement(renderer_utils_selectElement(mount),"div",[1],"".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-").concat("geom-cell"));if(caption){var captionDom=makeElement(wrapperDiv,"div",[caption],"".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-unit-caption")).node();caption.render(captionDom)}var selection=makeElement(wrapperDiv,"div",[1],"".concat(visual_cell_src_enums_constants_CLASSPREFIX,"-unit"));wrapperDiv.style("width","".concat(availWidth,"px")).style("height","".concat(availHeight,"px")),selection.style("width","".concat(availWidth,"px")).style("height","".concat(availHeight-this.getCaptionSpace().height,"px")),this.source().mount(selection.node())}return this}},{key:"remove",value:function remove(){return this.mount()&&this.mount().remove(),this.source().remove(),this}},{key:"type",get:function get(){return GEOM}},{key:"id",get:function get(){return this.source().id()}}],[{key:"formalName",value:function formalName(){return"GeomCell"}},{key:"defaultConfig",value:function defaultConfig(){return enums_defaults_DEFAULT_CONFIG}}]),GeomCell}();function src_defaults_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var DEFAULT_PLACEHOLDERS=(src_defaults_defineProperty(_DEFAULT_PLACEHOLDERS={},"SimpleCell",simple_cell),src_defaults_defineProperty(_DEFAULT_PLACEHOLDERS,"TextCell",src_text_cell),src_defaults_defineProperty(_DEFAULT_PLACEHOLDERS,"AxisCell",axis_cell),src_defaults_defineProperty(_DEFAULT_PLACEHOLDERS,"GeomCell",geom_cell),src_defaults_defineProperty(_DEFAULT_PLACEHOLDERS,"BlankCell",blank_cell),_DEFAULT_PLACEHOLDERS),cell_registry=function cellRegistry(){var reg=DEFAULT_PLACEHOLDERS;return{register:function register(def){var key=def.formalName();return key in reg&&(reg[key]=def),cellRegistry},get:function get(){return reg}}},title_maker_resolveTitleSubTitleContent=function resolveTitleSubTitleContent(rawContent){return"function"!=typeof rawContent||rawContent._sanitize?escapeHTML(rawContent()):rawContent()},createHeading=function createHeading(config,type,labelManager,prevCell){return config?function headerCreator(config,cellType,labelManager,prevCell){var margin={},content=config.content,classPrefix=config.classPrefix,maxLines=config.maxLines,cell=prevCell||new src_text_cell({type:"title"===cellType?"header":"text",className:"".concat(classPrefix,"-").concat(cellType,"-cell"),subType:cellType},{labelManager:labelManager}).config({maxLines:maxLines}).minSpacing({width:0,height:0});return cell.source(content),cell._minTickDiff={height:0,width:0},margin=config.position===src_constants_TOP?{top:0,bottom:config.padding}:{top:config.padding,bottom:0},cell.config({margin:margin}),{height:cell.getLogicalSpace().height,cell:cell}}(config,type,labelManager,prevCell):""},legend_maker_legendInitializer=function legendInitializer(legendConfig,canvas,measurement,prevLegends){var legends=[],height=measurement.height,width=measurement.width,headerHeight=measurement.headerHeight,position=legendConfig.position,align=legendConfig.align,legendInfo=function legendCreator(canvas){var LegendCls,dataset=[],axes=canvas.getRetinalAxes();return Object.entries(axes).forEach(function(axisInfo){var scale=axisInfo[1][0],scaleType=axisInfo[0],scaleProps=canvas[scaleType]();if(scaleProps.field&&scale){var _scale$config=scale.config(),type=_scale$config.type,step=_scale$config.step,stepMapper="boolean"==typeof step&&step;LegendCls=LEGEND_TYPE_MAP["".concat(type,"-").concat(stepMapper,"-").concat(scaleType)],dataset.push({scale:scale,canvas:canvas,fieldName:scaleProps.field,title:retrieveFieldDisplayName(canvas.data(),scaleProps.field),LegendCls:LegendCls,scaleType:scaleType})}}),dataset}(canvas),invalidValues=canvas.config().invalidValues,interactionRegistry=canvas.registry().interactions,parser=getValueParser(invalidValues);return legendInfo.forEach(function(dataInfo,index){var legendMeasures={},LegendCls=dataInfo.LegendCls,scale=dataInfo.scale,fieldName=dataInfo.fieldName,titleText=dataInfo.title,scaleType=dataInfo.scaleType,config=legendConfig[scaleType]||{},title=config.title||{};if(title.text=title.text||titleText,config.show){config.position=position,config.align=align;var legend=getObjProp(prevLegends[scaleType],index);legend||(legend=LegendCls.create({labelManager:canvas._dependencies.smartlabel,cells:{AxisCell:axis_cell,TextCell:src_text_cell},registry:{interactions:interactionRegistry}})),legendMeasures.maxHeight="vertical"===align?height-headerHeight:.2*height,legendMeasures.maxWidth="horizontal"===align?width:.2*width,legendMeasures.width=Math.min(legendMeasures.maxWidth,config.width),legendMeasures.height=Math.min(legendMeasures.maxHeight,config.height),[PADDING,BORDER,MARGIN].forEach(function(e){legendMeasures[e]=config[e]});var metaData=legend.metaData();metaData instanceof datamodel_default.a&&metaData.dispose();var mark=canvas.composition().visualGroup.resolver().matrixLayers()[0][0];config.shape=function legendIconShapeMapper(layers,scaleType){var layerMarks=layers.map(function(el){return el.mark});return IS_POINT_MAP[("color"===scaleType||"size"===scaleType)&&layerMarks.includes("point")]}(mark,scaleType),legend.scale(scale).valueParser(parser).title(title).fieldName(fieldName).config(config).metaData(canvas.composition().visualGroup.getGroupByData().project([fieldName])).measurement(legendMeasures).canvasAlias(canvas.alias()).setLegendMeasures(),legends.push({canvas:canvas,legend:legend,scaleType:scaleType})}}),legends};function muze_chart_component_typeof(obj){"@babel/helpers - typeof";return(muze_chart_component_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function muze_chart_component_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function muze_chart_component_possibleConstructorReturn(self,call){return!call||"object"!==muze_chart_component_typeof(call)&&"function"!=typeof call?function muze_chart_component_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function muze_chart_component_getPrototypeOf(o){return(muze_chart_component_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function muze_chart_component_setPrototypeOf(o,p){return(muze_chart_component_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var MuzeComponent=function(_LayoutComponent){function MuzeComponent(){return function muze_chart_component_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MuzeComponent),muze_chart_component_possibleConstructorReturn(this,muze_chart_component_getPrototypeOf(MuzeComponent).apply(this,arguments))}return function muze_chart_component_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&muze_chart_component_setPrototypeOf(subClass,superClass)}(MuzeComponent,LayoutComponent),function muze_chart_component_createClass(Constructor,protoProps,staticProps){return protoProps&&muze_chart_component_defineProperties(Constructor.prototype,protoProps),staticProps&&muze_chart_component_defineProperties(Constructor,staticProps),Constructor}(MuzeComponent,[{key:"getLogicalSpace",value:function getLogicalSpace(){var _this$boundBox=this.boundBox();return{width:_this$boundBox.width,height:_this$boundBox.height}}},{key:"setSpatialConfig",value:function setSpatialConfig(conf){this.boundBox({top:conf.y,left:conf.x}),this.newDimensions={width:conf.width,height:conf.height},this.renderAt(conf.renderAt)}},{key:"getBoundBox",value:function getBoundBox(){return this.boundBox()}},{key:"updateWrapper",value:function updateWrapper(){throw Error("Update is not implemented")}},{key:"setParams",value:function setParams(){throw Error("set params is not implemented")}},{key:"setComponentInfo",value:function setComponentInfo(){throw Error("setComponentInfo is not implemented")}}]),MuzeComponent}();function headerComponent_typeof(obj){"@babel/helpers - typeof";return(headerComponent_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function headerComponent_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function headerComponent_possibleConstructorReturn(self,call){return!call||"object"!==headerComponent_typeof(call)&&"function"!=typeof call?function headerComponent_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function headerComponent_getPrototypeOf(o){return(headerComponent_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function headerComponent_setPrototypeOf(o,p){return(headerComponent_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var headerComponent_HeaderComponent=function(_MuzeComponent){function HeaderComponent(params){var _this;return function headerComponent_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,HeaderComponent),(_this=headerComponent_possibleConstructorReturn(this,headerComponent_getPrototypeOf(HeaderComponent).call(this,params.name,params.component.getLogicalSpace(),0))).setParams(params),_this}return function headerComponent_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&headerComponent_setPrototypeOf(subClass,superClass)}(HeaderComponent,MuzeComponent),function headerComponent_createClass(Constructor,protoProps,staticProps){return protoProps&&headerComponent_defineProperties(Constructor.prototype,protoProps),staticProps&&headerComponent_defineProperties(Constructor,staticProps),Constructor}(HeaderComponent,[{key:"renderHeader",value:function renderHeader(container){var layoutConfig=this.params.config;container=renderer_utils_selectElement(container);var align=layoutConfig.align,sel=container.selectAll(".".concat(layoutConfig.classPrefix,"-inner-container")).data([this.name]);sel.exit().remove();var cont=sel.enter().append("div").merge(sel);cont.classed("".concat(layoutConfig.classPrefix,"-inner-container"),!0);var _this$boundBox=this.boundBox(),height=_this$boundBox.height,width=_this$boundBox.width;this.component.setAvailableSpace(width,height),this.component&&this.component.render(cont.node()),cont.selectAll("div").classed("".concat(layoutConfig.classPrefix,"-inner-content"),!0),cont.style("width","".concat(100,"%")),layoutConfig&&this.component&&cont.style("float",src_constants_LEFT).style("text-align",align)}},{key:"draw",value:function draw(container){this.renderHeader(container||document.getElementById(this.renderAt()))}},{key:"updateWrapper",value:function updateWrapper(params){return this.setParams(params),this.name(params.name),this.boundBox(params.component.getLogicalSpace()),this}},{key:"setParams",value:function setParams(params){this.component=params.component,this.params=params,this.target(params.config.target),this.position(params.config.position),this.className(params.config.className),this.alignWith(params.config.alignWith),this.alignment(params.config.alignment)}},{key:"setSpatialConfig",value:function setSpatialConfig(conf){this.boundBox({top:conf.y,left:conf.x,width:conf.width,height:conf.height}),this.renderAt(conf.renderAt)}}]),HeaderComponent}();function legendComponent_typeof(obj){"@babel/helpers - typeof";return(legendComponent_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function legendComponent_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function legendComponent_possibleConstructorReturn(self,call){return!call||"object"!==legendComponent_typeof(call)&&"function"!=typeof call?function legendComponent_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function legendComponent_getPrototypeOf(o){return(legendComponent_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function legendComponent_setPrototypeOf(o,p){return(legendComponent_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var legendComponent_LegendComponent=function(_MuzeComponent){function LegendComponent(params){var _this;return function legendComponent_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LegendComponent),(_this=legendComponent_possibleConstructorReturn(this,legendComponent_getPrototypeOf(LegendComponent).call(this,params.name,params.config.measurement.legendSpace,0))).setParams(params),_this}return function legendComponent_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&legendComponent_setPrototypeOf(subClass,superClass)}(LegendComponent,MuzeComponent),function legendComponent_createClass(Constructor,protoProps,staticProps){return protoProps&&legendComponent_defineProperties(Constructor.prototype,protoProps),staticProps&&legendComponent_defineProperties(Constructor,staticProps),Constructor}(LegendComponent,[{key:"renderLegend",value:function renderLegend(container){container=renderer_utils_selectElement(container);var sectionComponents=[],_this$params$config=this.params.config,position=_this$params$config.position,classPrefix=_this$params$config.classPrefix,legendMount=makeElement(container,"div",[this.components],"".concat(classPrefix,"-inner-content"),{},function(d){return d});legendMount.classed("".concat(classPrefix,"-legend"),!0);var align=position===src_constants_LEFT||position===src_constants_RIGHT?"vertical":"horizontal",legWidth=this.newDimensions.width,legHeight=this.newDimensions.height;if([container,legendMount].forEach(function(elem){elem.style("width","".concat(Math.floor(legWidth),"px")).style("height","".concat(legHeight,"px")).style("float",src_constants_LEFT)}),"vertical"===align){var sections=-1,currHeight=legHeight,currWidth=0;this.components.forEach(function(legendInfo){var leg=legendInfo.legend;leg.measurement().height>currHeight?(sections++,currWidth=0,currHeight=legHeight):sections<0&&sections++,sectionComponents[sections]=sectionComponents[sections]||[],currHeight-=Math.min(leg.measurement().height,currHeight),currWidth=Math.max(Math.min(leg.measurement().width,leg.measurement().maxWidth),currWidth),sectionComponents[sections].push({legend:leg,legendHeight:legHeight,legendWidth:currWidth})});var mount=makeElement(legendMount,["div"],sectionComponents,"".concat(classPrefix,"-legend-section"));mount.classed("".concat(classPrefix,"-legend-vertical-section"),!0).style("width",function(d){return"".concat(d[0].legendWidth,"px")}),makeElement(mount,["div"],function(d){return d},"".concat(classPrefix,"-legend-components"),{},function(d){return d.legend.id()}).each(function(d){d.legend.mount(this)}).style("width",function(d){return"".concat(d.legendWidth,"px")})}else{var _mount=makeElement(legendMount,"div",[1],"".concat(classPrefix,"-legend-section"));_mount.classed("".concat(classPrefix,"-legend-horizontal-section"),!0),_mount.classed("".concat(classPrefix,"-legend-section-",0),!0).style("width","".concat(legWidth,"px")),makeElement(_mount,"div",this.components,"".concat(classPrefix,"-legend-components"),{},function(d){return d.legend.id()}).style("width",function(d){return"".concat(d.legend.measurement().width,"px")}).each(function(d){d.legend.mount(this)})}}},{key:"draw",value:function draw(container){this.renderLegend(container||document.getElementById(this.renderAt()))}},{key:"updateWrapper",value:function updateWrapper(params){return this.name(params.name),this.boundBox(params.config.measurement.legendSpace),this.setParams(params),this}},{key:"setParams",value:function setParams(params){this.components=params.component,this.params=params,this.target(params.config.target),this.position(params.config.position);var _defaultAlignmentHelp=function defaultAlignmentHelper(position){var alignment=null,alignWith="".concat(ROW_MATRIX_INDEX[1],"-").concat(COLUMN_MATRIX_INDEX[1]);switch(position){case src_constants_TOP:case src_constants_BOTTOM:alignment=HORIZONTAL_CENTER;break;case src_constants_LEFT:case src_constants_RIGHT:alignment=VERTICAL_CENTER;break;default:alignment=VERTICAL_CENTER}return{alignment:alignment,alignWith:alignWith}}(params.config.position),alignWith=_defaultAlignmentHelp.alignWith,alignment=_defaultAlignmentHelp.alignment;this.className(params.config.className),this.alignWith(params.config.alignWith||alignWith),this.alignment(params.config.alignment||alignment)}},{key:"setComponentInfo",value:function setComponentInfo(params){var rootNode=params.rootNode;this.components.forEach(function(legendInfo){legendInfo.legend.setParentInfo({canvasRoot:rootNode})})}}]),LegendComponent}(),helper_d3Drag=(__webpack_require__(37),renderer_utils_getD3Drag()),arrowSizeMap={left:"width",right:"width",top:"height",bottom:"height"},getUnitPositions=function getUnitPositions(unitMeasures,totalLength,viewLength){var currentLen=0;return(unitMeasures.primary&&unitMeasures.primary.length?unitMeasures.primary:unitMeasures.secondary).map(function(e){var unitPosition=100*currentLen/(totalLength-viewLength);return currentLen+=e,unitPosition})},helper_createScrollBarArrow=function createScrollBarArrow(mount,type,config){var classPrefix=config.classPrefix,thickness=config.thickness,arrow=makeElement(mount,"div",[type],"".concat(classPrefix,"-scroll-arrow-").concat(type));return arrow.classed("".concat(classPrefix,"-scroll-arrow"),!0),arrow.style(arrowSizeMap[type],"".concat(thickness,"px")),makeElement(arrow,"div",[1],"".concat(classPrefix,"-scroll-arrow-chevron")).attr("id","".concat(classPrefix,"-scroll-arrow-chevron-").concat(type)),arrow},helper_createScrollBarRect=function createScrollBarRect(mount,config){var classPrefix=config.classPrefix,rect=makeElement(mount,"div",[1],"".concat(classPrefix,"-scroll-rect"));return{rect:rect,mover:makeElement(rect,"div",[1],"".concat(classPrefix,"-scroll-mover"))}},applyScrollMouseDownAction=function applyScrollMouseDownAction(moverRect,scrollMaker,speed){var mover=moverRect.mover,rect=moverRect.rect,_mover$node$getBoundi=mover.node().getBoundingClientRect(),x=_mover$node$getBoundi.x,y=_mover$node$getBoundi.y,_rect$node$getBoundin=rect.node().getBoundingClientRect(),rectX=_rect$node$getBoundin.x,rectY=_rect$node$getBoundin.y;scrollMaker.changeMoverPosition({x:x-rectX+speed,y:y-rectY+speed})},helper_registerListenerOnArrow=function registerListenerOnArrow(scrollMaker,moverRect,arrowType,speed){var timer="",arrow=scrollMaker._components[arrowType],isTouchDevice=hasTouch();arrow.on(isTouchDevice?"touchstart":"mousedown",function(){renderer_utils_getEvent().preventDefault(),timer=setInterval(function(){applyScrollMouseDownAction(moverRect,scrollMaker,speed)},100)}).on(isTouchDevice?"touchend":"mouseup",function(){renderer_utils_getEvent().preventDefault(),clearInterval(timer)}).on("click",function(){applyScrollMouseDownAction(moverRect,scrollMaker,speed)})},helper_registerListeners=function registerListeners(scrollMaker){var moverRect=scrollMaker._components.moverRect,speed=scrollMaker.config().speed;helper_registerListenerOnArrow(scrollMaker,moverRect,"prevArrow",-speed),function applyMoverDrag(scrollMaker,moverRect){var startPos={},moverStartPos=0,rectStartPos=0,endPos={},mover=moverRect.mover,rect=moverRect.rect;mover.call(helper_d3Drag().on("start",function(){var event=renderer_utils_getEvent();moverStartPos=mover.node().getBoundingClientRect(),rectStartPos=rect.node().getBoundingClientRect(),startPos={x:event.x,y:event.y}}).on("drag",function(){var event=renderer_utils_getEvent(),window=getWindow(),distanceMoved_x=(endPos={x:event.x,y:event.y}).x-startPos.x,distanceMoved_y=endPos.y-startPos.y,actualPosition={x:moverStartPos.x+distanceMoved_x-rectStartPos.x+window.pageXOffset,y:moverStartPos.y+distanceMoved_y-rectStartPos.y+window.pageYOffset};scrollMaker.changeMoverPosition(actualPosition)}))}(scrollMaker,moverRect),function applyRectClick(scrollMaker,moverRect){moverRect.rect.on("click",function(){var event=renderer_utils_getEvent();scrollMaker.emptyScrollAreaClick(event)})}(scrollMaker,moverRect),helper_registerListenerOnArrow(scrollMaker,moverRect,"nextArrow",speed)},scroll_bar_maker_props_PROPS={config:{sanitization:function sanitization(context,value){return value=mergeRecursive(context._config,value)}},manager:{},unitPositions:{},logicalSpace:{}};function scroll_maker_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var scroll_maker_ScrollMaker=function(){function ScrollMaker(){!function scroll_maker_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ScrollMaker),this._components={},this._logicalSpace={},this._attachedScrollAction=function(){},this._config={thickness:10,speed:2},this._unitPositions=null,generateGetterSetters(this,scroll_bar_maker_props_PROPS)}return function scroll_maker_createClass(Constructor,protoProps,staticProps){return protoProps&&scroll_maker_defineProperties(Constructor.prototype,protoProps),staticProps&&scroll_maker_defineProperties(Constructor,staticProps),Constructor}(ScrollMaker,[{key:"emptyScrollAreaClick",value:function emptyScrollAreaClick(){throw new ERROR_MSG("Method not implemented")}},{key:"changeMoverPosition",value:function changeMoverPosition(){throw new ERROR_MSG("Method not implemented")}},{key:"scrollTo",value:function scrollTo(){throw new ERROR_MSG("Method not implemented")}},{key:"scrollDeltaTo",value:function scrollDeltaTo(){throw new ERROR_MSG("Method not implemented")}},{key:"createScroll",value:function createScroll(mountPoint){return{scrollBarContainer:function scrollContainerHelper(mountPoint,config,dimensions,type){var classPrefix=config.classPrefix,scrollBarContainer=makeElement(renderer_utils_selectElement(mountPoint),"div",[1],"#".concat(classPrefix,"-scroll-bar-").concat(type));return scrollBarContainer.classed("".concat(classPrefix,"-scroll-bar"),!0),scrollBarContainer.style("width","".concat(dimensions.width,"px")),scrollBarContainer.style("height","".concat(dimensions.height,"px")),scrollBarContainer}(mountPoint,this.config(),this.logicalSpace(),this.constructor.type())}}},{key:"attachScrollAction",value:function attachScrollAction(externalScrollAction){return this._attachedScrollAction=externalScrollAction,this}},{key:"detachScrollAction",value:function detachScrollAction(){return this._attachedScrollAction=function(){},this}},{key:"getLogicalSpace",value:function getLogicalSpace(){return this.logicalSpace()}},{key:"registerListeners",value:function registerListeners(){return helper_registerListeners(this),this}},{key:"remove",value:function remove(){return this._components.scrollBarContainer.remove(),this}}],[{key:"type",value:function type(){throw new ERROR_MSG("Method not implemented")}}]),ScrollMaker}();function horizontal_scroll_maker_typeof(obj){"@babel/helpers - typeof";return(horizontal_scroll_maker_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function horizontal_scroll_maker_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function horizontal_scroll_maker_possibleConstructorReturn(self,call){return!call||"object"!==horizontal_scroll_maker_typeof(call)&&"function"!=typeof call?function horizontal_scroll_maker_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function horizontal_scroll_maker_get(target,property,receiver){return(horizontal_scroll_maker_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function horizontal_scroll_maker_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=horizontal_scroll_maker_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function horizontal_scroll_maker_getPrototypeOf(o){return(horizontal_scroll_maker_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function horizontal_scroll_maker_setPrototypeOf(o,p){return(horizontal_scroll_maker_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function vertical_scroll_maker_typeof(obj){"@babel/helpers - typeof";return(vertical_scroll_maker_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function vertical_scroll_maker_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function vertical_scroll_maker_possibleConstructorReturn(self,call){return!call||"object"!==vertical_scroll_maker_typeof(call)&&"function"!=typeof call?function vertical_scroll_maker_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function vertical_scroll_maker_get(target,property,receiver){return(vertical_scroll_maker_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function vertical_scroll_maker_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=vertical_scroll_maker_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function vertical_scroll_maker_getPrototypeOf(o){return(vertical_scroll_maker_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function vertical_scroll_maker_setPrototypeOf(o,p){return(vertical_scroll_maker_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function scroll_component_typeof(obj){"@babel/helpers - typeof";return(scroll_component_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function scroll_component_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function scroll_component_possibleConstructorReturn(self,call){return!call||"object"!==scroll_component_typeof(call)&&"function"!=typeof call?function scroll_component_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function scroll_component_getPrototypeOf(o){return(scroll_component_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function scroll_component_setPrototypeOf(o,p){return(scroll_component_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var scrollMakerMap={horizontal:function(_ScrollMaker){function HorizontalScrollMaker(){return function horizontal_scroll_maker_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,HorizontalScrollMaker),horizontal_scroll_maker_possibleConstructorReturn(this,horizontal_scroll_maker_getPrototypeOf(HorizontalScrollMaker).apply(this,arguments))}return function horizontal_scroll_maker_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&horizontal_scroll_maker_setPrototypeOf(subClass,superClass)}(HorizontalScrollMaker,scroll_maker_ScrollMaker),function horizontal_scroll_maker_createClass(Constructor,protoProps,staticProps){return protoProps&&horizontal_scroll_maker_defineProperties(Constructor.prototype,protoProps),staticProps&&horizontal_scroll_maker_defineProperties(Constructor,staticProps),Constructor}(HorizontalScrollMaker,[{key:"createScroll",value:function createScroll(mountPoint){var dimensions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.logicalSpace(),config=this.config(),scrollBarContainer=horizontal_scroll_maker_get(horizontal_scroll_maker_getPrototypeOf(HorizontalScrollMaker.prototype),"createScroll",this).call(this,mountPoint,config,dimensions).scrollBarContainer,prevArrow=helper_createScrollBarArrow(scrollBarContainer,"left",config),moverRect=helper_createScrollBarRect(scrollBarContainer,config),nextArrow=helper_createScrollBarArrow(scrollBarContainer,"right",config),mover=moverRect.mover,rect=moverRect.rect,_this$logicalSpace=this.logicalSpace(),height=_this$logicalSpace.height,width=_this$logicalSpace.width,totalLength=_this$logicalSpace.totalLength,viewLength=_this$logicalSpace.viewLength,unitWidths=_this$logicalSpace.unitWidths,scrollBarWithouArrowLength=width-2*height;rect.style("width","".concat(dimensions.width-2*height,"px")),rect.style("height","".concat(100,"%")),mover.style("width","".concat(viewLength*scrollBarWithouArrowLength/totalLength,"px")),mover.style("height","".concat(100,"%")),mover.style(src_constants_LEFT,"".concat(0,"px")),this._components={prevArrow:prevArrow,nextArrow:nextArrow,moverRect:moverRect,scrollBarContainer:scrollBarContainer},this._scrollBarWithouArrowLength=scrollBarWithouArrowLength,this.unitPositions(getUnitPositions(unitWidths,totalLength,viewLength)),this.registerListeners()}},{key:"emptyScrollAreaClick",value:function emptyScrollAreaClick(event){var _this$_components$mov=this._components.moverRect,mover=_this$_components$mov.mover,rect=_this$_components$mov.rect,speed=this.config().speed,_mover$node$getBoundi=mover.node().getBoundingClientRect(),x=_mover$node$getBoundi.x,y=_mover$node$getBoundi.y,_rect$node$getBoundin=rect.node().getBoundingClientRect(),rectX=_rect$node$getBoundin.x,rectY=_rect$node$getBoundin.y,positionAdjuster=10*speed;event.x<x&&(positionAdjuster=10*-speed),this.changeMoverPosition({x:x-rectX+positionAdjuster,y:y-rectY+positionAdjuster})}},{key:"changeMoverPosition",value:function changeMoverPosition(newPosition){var currentPos,_this$_components$mov2=this._components.moverRect,mover=_this$_components$mov2.mover,rectStartPos=_this$_components$mov2.rect.node().getBoundingClientRect(),moverPos=mover.node().getBoundingClientRect(),totalLength=this.logicalSpace().totalLength;currentPos=newPosition.x<0?0:newPosition.x+moverPos.width>rectStartPos.width?rectStartPos.width-moverPos.width:newPosition.x,mover.style(src_constants_LEFT,"".concat(currentPos,"px"));var movedViewLength=currentPos*totalLength/this._scrollBarWithouArrowLength;this.manager().performAttachedScrollFunction(this.constructor.type(),movedViewLength)}},{key:"scrollDeltaTo",value:function scrollDeltaTo(delta){var _this$_components$mov3=this._components.moverRect,mover=_this$_components$mov3.mover,rect=_this$_components$mov3.rect,moverPos=mover.node().getBoundingClientRect(),rectStartPos=rect.node().getBoundingClientRect();return this.changeMoverPosition({y:0,x:moverPos.x-rectStartPos.x-delta}),this}},{key:"scrollTo",value:function scrollTo(scrollPercentage){var moverPos=this._components.moverRect.mover.node().getBoundingClientRect(),movement=scrollPercentage*(this._scrollBarWithouArrowLength-moverPos.width)/100;return this.changeMoverPosition({y:0,x:movement}),this}}],[{key:"type",value:function type(){return"horizontal"}}]),HorizontalScrollMaker}(),vertical:function(_ScrollMaker){function VerticalScrollMaker(){return function vertical_scroll_maker_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VerticalScrollMaker),vertical_scroll_maker_possibleConstructorReturn(this,vertical_scroll_maker_getPrototypeOf(VerticalScrollMaker).apply(this,arguments))}return function vertical_scroll_maker_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&vertical_scroll_maker_setPrototypeOf(subClass,superClass)}(VerticalScrollMaker,scroll_maker_ScrollMaker),function vertical_scroll_maker_createClass(Constructor,protoProps,staticProps){return protoProps&&vertical_scroll_maker_defineProperties(Constructor.prototype,protoProps),staticProps&&vertical_scroll_maker_defineProperties(Constructor,staticProps),Constructor}(VerticalScrollMaker,[{key:"createScroll",value:function createScroll(mountPoint){var dimensions=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.logicalSpace(),config=this.config(),scrollBarContainer=vertical_scroll_maker_get(vertical_scroll_maker_getPrototypeOf(VerticalScrollMaker.prototype),"createScroll",this).call(this,mountPoint,dimensions).scrollBarContainer,prevArrow=helper_createScrollBarArrow(scrollBarContainer,"top",config),moverRect=helper_createScrollBarRect(scrollBarContainer,config),nextArrow=helper_createScrollBarArrow(scrollBarContainer,"bottom",config),mover=moverRect.mover,rect=moverRect.rect,_this$logicalSpace=this.logicalSpace(),height=_this$logicalSpace.height,width=_this$logicalSpace.width,totalLength=_this$logicalSpace.totalLength,viewLength=_this$logicalSpace.viewLength,unitHeights=_this$logicalSpace.unitHeights,scrollBarWithouArrowLength=height-2*width;rect.style("height","".concat(scrollBarWithouArrowLength,"px")),rect.style("width","".concat(100,"%")),mover.style("width","".concat(100,"%")),mover.style("height","".concat(viewLength*scrollBarWithouArrowLength/totalLength,"px")),mover.style(src_constants_TOP,"".concat(0,"px")),this._components={prevArrow:prevArrow,nextArrow:nextArrow,moverRect:moverRect,scrollBarContainer:scrollBarContainer},this._scrollBarWithouArrowLength=scrollBarWithouArrowLength,this.unitPositions(getUnitPositions(unitHeights,totalLength,viewLength)),this.registerListeners()}},{key:"emptyScrollAreaClick",value:function emptyScrollAreaClick(event){var _this$_components$mov=this._components.moverRect,mover=_this$_components$mov.mover,rect=_this$_components$mov.rect,speed=this.config().speed,_mover$node$getBoundi=mover.node().getBoundingClientRect(),x=_mover$node$getBoundi.x,y=_mover$node$getBoundi.y,_rect$node$getBoundin=rect.node().getBoundingClientRect(),rectX=_rect$node$getBoundin.x,rectY=_rect$node$getBoundin.y,positionAdjuster=10*speed;event.y<y&&(positionAdjuster=10*-speed),this.changeMoverPosition({x:x-rectX+positionAdjuster,y:y-rectY+positionAdjuster})}},{key:"changeMoverPosition",value:function changeMoverPosition(newPosition){var currentPos,_this$_components$mov2=this._components.moverRect,mover=_this$_components$mov2.mover,rect=_this$_components$mov2.rect,totalLength=this.logicalSpace().totalLength,rectStartPos=rect.node().getBoundingClientRect(),moverPos=mover.node().getBoundingClientRect();currentPos=newPosition.y<0?0:newPosition.y+moverPos.height>rectStartPos.height?rectStartPos.height-moverPos.height:newPosition.y,mover.style(src_constants_TOP,"".concat(currentPos,"px"));var movedViewLength=currentPos*totalLength/this._scrollBarWithouArrowLength;this.manager().performAttachedScrollFunction(this.constructor.type(),movedViewLength)}},{key:"scrollDeltaTo",value:function scrollDeltaTo(delta){var _this$_components$mov3=this._components.moverRect,mover=_this$_components$mov3.mover,rect=_this$_components$mov3.rect,moverPos=mover.node().getBoundingClientRect(),rectStartPos=rect.node().getBoundingClientRect();return this.changeMoverPosition({y:moverPos.y-rectStartPos.y-delta,x:0}),this}},{key:"scrollTo",value:function scrollTo(scrollPercentage){var moverPos=this._components.moverRect.mover.node().getBoundingClientRect(),movement=scrollPercentage*(this._scrollBarWithouArrowLength-moverPos.height)/100;return this.changeMoverPosition({x:0,y:movement}),this}}],[{key:"type",value:function type(){return"vertical"}}]),VerticalScrollMaker}()},ScrollComponent=function(_MuzeComponent){function ScrollComponent(params){var _this;!function scroll_component_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ScrollComponent);var ScrollMaker=scrollMakerMap[params.config.type];return params.component=new ScrollMaker,params.component.config(params.config.scrollBarComponentConfig),params.component.logicalSpace(params.dimensions),(_this=scroll_component_possibleConstructorReturn(this,scroll_component_getPrototypeOf(ScrollComponent).call(this,params.name,params.component.getLogicalSpace(),0))).setParams(params),_this}return function scroll_component_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&scroll_component_setPrototypeOf(subClass,superClass)}(ScrollComponent,MuzeComponent),function scroll_component_createClass(Constructor,protoProps,staticProps){return protoProps&&scroll_component_defineProperties(Constructor.prototype,protoProps),staticProps&&scroll_component_defineProperties(Constructor,staticProps),Constructor}(ScrollComponent,[{key:"manager",value:function manager(){return arguments.length?(this.component.manager(arguments.length<=0?void 0:arguments[0]),this):this.component.manager()}},{key:"scrollDeltaTo",value:function scrollDeltaTo(delta){return this.component.scrollDeltaTo(delta),this}},{key:"scrollTo",value:function scrollTo(scrollPercentage){return this.component.scrollTo(scrollPercentage),this}},{key:"scrollToUnitIndex",value:function scrollToUnitIndex(unitIndex){var unitPositions=this.component.unitPositions(),sanitizedUnitIndex=Math.min(Math.max(0,unitIndex),unitPositions.length-1);return this.component.scrollTo(unitPositions[sanitizedUnitIndex]),this}},{key:"getScrollPositionsForUnits",value:function getScrollPositionsForUnits(){return this.component.unitPositions()}},{key:"draw",value:function draw(container){return this.component.createScroll(container||document.getElementById(this.renderAt())),this}},{key:"attachScrollAction",value:function attachScrollAction(externalAction){return this.component.attachScrollAction(externalAction),this}},{key:"detachScrollAction",value:function detachScrollAction(){return this.component.detachScrollAction(),this}},{key:"updateWrapper",value:function updateWrapper(params){return this.name(params.name),this.component.config(params.config.scrollBarComponentConfig),this.component.logicalSpace(params.dimensions),this.boundBox(this.component.getLogicalSpace()),this.setParams(params),this}},{key:"setParams",value:function setParams(params){this.component=params.component||this.component,this.params=params,this.target(params.config.target),this.position(params.config.position),this.className(params.config.className),this.alignWith(params.config.alignWith),this.alignment(params.config.alignment)}},{key:"remove",value:function remove(){this.component.remove()}}]),ScrollComponent}();__webpack_require__(38);function matrix_component_typeof(obj){"@babel/helpers - typeof";return(matrix_component_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function matrix_component_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function matrix_component_possibleConstructorReturn(self,call){return!call||"object"!==matrix_component_typeof(call)&&"function"!=typeof call?function matrix_component_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function matrix_component_getPrototypeOf(o){return(matrix_component_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function matrix_component_setPrototypeOf(o,p){return(matrix_component_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var matrix_component_MatrixComponent=function(_MuzeComponent){function MatrixComponent(params){var _this;return function matrix_component_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MatrixComponent),(_this=matrix_component_possibleConstructorReturn(this,matrix_component_getPrototypeOf(MatrixComponent).call(this,params.name,params.config.dimensions,0))).setParams(params),_this.className(params.config.className),_this}return function matrix_component_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&matrix_component_setPrototypeOf(subClass,superClass)}(MatrixComponent,MuzeComponent),function matrix_component_createClass(Constructor,protoProps,staticProps){return protoProps&&matrix_component_defineProperties(Constructor.prototype,protoProps),staticProps&&matrix_component_defineProperties(Constructor,staticProps),Constructor}(MatrixComponent,[{key:"applyScroll",value:function applyScroll(container){var row=this.params.config.row,column=this.params.config.column,_this$params$config$s=this.params.config.scrollInfo,horizontal=_this$params$config$s.horizontal,vertical=_this$params$config$s.vertical;container.style("overflow","visible"),container.style("width","auto"),container.style("height","auto"),horizontal&&1===column&&(container.style("overflow","hidden"),container.style("width","100%")),vertical&&"center"===row&&(container.style("overflow","hidden"),container.style("height","100%"))}},{key:"renderMatrix",value:function renderMatrix(mountPoint){var _this$params$config=this.params.config,classPrefix=_this$params$config.classPrefix,row=_this$params$config.row,column=_this$params$config.column,dimensions=_this$params$config.dimensions,border=_this$params$config.border,isFacet=_this$params$config.isFacet,showHeaders=_this$params$config.showHeaders,containerForMatrix=makeElement(mountPoint,"div",[1],"".concat(classPrefix,"-grid-").concat(row,"-").concat(column+1)).classed("".concat(classPrefix,"-grid-").concat(row),!0).classed("".concat(classPrefix,"-grid"),!0);this.applyScroll(containerForMatrix);var _cellSpanMaker=function cellSpanMaker(matrix,type,index){var spans=null,viewMatrix=matrix,_matrixSpanGenerator=matrixSpanGenerator("".concat(type,"-").concat(index)),orderGetter=_matrixSpanGenerator.orderGetter,viewMatrixMaker=_matrixSpanGenerator.viewMatrixMaker,spanMaker=_matrixSpanGenerator.spanMaker;return matrix.length&&(spans=spanMaker(viewMatrix=viewMatrixMaker(matrix,orderGetter(matrix))())()),{viewMatrix:viewMatrix,spans:spans}}(this.component,row,column),viewMatrix=_cellSpanMaker.viewMatrix,spans=_cellSpanMaker.spans,cells=this.renderTable(containerForMatrix,"".concat(classPrefix,"-grid"),viewMatrix).cells;!function applySpans(cells,spans,config,type){var applier=spanApplierMap[type];applier&&applier(cells,spans,config)}(cells,spans,{dimensions:dimensions,border:border},"".concat(row,"-").concat(column)),function renderPlaceholders(cells){cells.each(function(cell){cell.placeholder.render(this)})}(cells),cells.exit().each(function(cell){cell.placeholder.remove()}),border_helper_applyBorders({cells:cells,border:border,row:row,column:column,isFacet:isFacet,showHeaders:showHeaders})}},{key:"renderTable",value:function renderTable(mount,className,rowData){var table=makeElement(mount,"table",["layout"],"".concat(className,"-table")),body=makeElement(table,"tbody",["layout"],"".concat(className,"-body")),rows=makeElement(body,"tr",rowData,"".concat(className,"-tr"));return{table:table,body:body,rows:rows,cells:makeElement(rows,"td",function(d,i){return d.filter(function(e){return null!==e}).map(function(e){return{placeholder:e,rowIndex:i}})},"".concat(className,"-td"),{update:function update(elem,cell){var externalClassname=cell.placeholder.config().externalClassname;externalClassname&&externalClassname.map(function(d){return elem.classed("".concat(className,"-").concat(d),!0)})}},function(key){return key.placeholder.id})}}},{key:"draw",value:function draw(container){this.renderMatrix(container||document.getElementById(this.renderAt()))}},{key:"updateWrapper",value:function updateWrapper(params){return this.name(params.name),this.boundBox(params.config.dimensions),this.setParams(params),this}},{key:"setParams",value:function setParams(params){this.component=params.component,this.params=params,this.target(params.config.target),this.position("top"),this.className(params.config.className)}}]),MatrixComponent}();function grid_component_typeof(obj){"@babel/helpers - typeof";return(grid_component_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function grid_component_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function grid_component_possibleConstructorReturn(self,call){return!call||"object"!==grid_component_typeof(call)&&"function"!=typeof call?function grid_component_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function grid_component_getPrototypeOf(o){return(grid_component_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function grid_component_setPrototypeOf(o,p){return(grid_component_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var grid_component_applyScrollAction=function applyScrollAction(elem,classPrefix,scollDistance,type){renderer_utils_selectElement(elem).selectAll(".".concat(classPrefix,"-grid")).property(type,scollDistance)},grid_component_GridComponent=function(_MuzeComponent){function GridComponent(params){var _this;return function grid_component_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GridComponent),(_this=grid_component_possibleConstructorReturn(this,grid_component_getPrototypeOf(GridComponent).call(this,params.name,params.config.dimensions,0))).gridComponents=[],_this.setParams(params),_this}return function grid_component_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&grid_component_setPrototypeOf(subClass,superClass)}(GridComponent,MuzeComponent),function grid_component_createClass(Constructor,protoProps,staticProps){return protoProps&&grid_component_defineProperties(Constructor.prototype,protoProps),staticProps&&grid_component_defineProperties(Constructor,staticProps),Constructor}(GridComponent,[{key:"sanitizeGrid",value:function sanitizeGrid(){for(var height=0,width=0,_this$component$viewI=this.component.viewInfo(),viewMatricesInfo=_this$component$viewI.viewMatricesInfo,layoutDimensions=_this$component$viewI.layoutDimensions,scrollInfo=this.component.scrollInfo(),viewHeight=layoutDimensions.viewHeight,viewWidth=layoutDimensions.viewWidth,unitHeights=layoutDimensions.unitHeights,unitWidths=layoutDimensions.unitWidths,i=0;i<3;i++){this.gridComponents.length&&this.gridComponents[i]instanceof Array||(this.gridComponents[i]=[]);for(var j=0;j<3;j++){var matrixDim={height:viewHeight[i],width:viewWidth[j],unitHeights:unitHeights,unitWidths:unitWidths},matrix=viewMatricesInfo.matrices["".concat(ROW_MATRIX_INDEX[i])][j],matrixName="".concat(ROW_MATRIX_INDEX[i],"-").concat(COLUMN_MATRIX_INDEX[j]),matrixConfig={dimensions:matrixDim,border:layoutDimensions.border,classPrefix:this.params.config.classPrefix,scrollInfo:scrollInfo,row:ROW_MATRIX_INDEX[i],column:j};if(this.gridComponents[i][j]instanceof MuzeComponent){var _this$params$componen=this.params.component.config(),isFacet=_this$params$componen.isFacet,showHeaders=_this$params$componen.showHeaders;matrixConfig.isFacet=isFacet,matrixConfig.showHeaders=showHeaders,this.gridComponents[i][j].updateWrapper({name:matrixName,component:matrix,config:matrixConfig})}else{var _this$params$componen2=this.params.component.config(),_isFacet=_this$params$componen2.isFacet,_showHeaders=_this$params$componen2.showHeaders;matrixConfig.isFacet=_isFacet,matrixConfig.showHeaders=_showHeaders;var matrixWrapper=new matrix_component_MatrixComponent({name:matrixName,component:matrix,config:matrixConfig});this.gridComponents[i].push(matrixWrapper)}0===i&&(width+=matrixDim.width),0===j&&(height+=matrixDim.height)}}this.boundBox({height:height,width:width}),this.component=this.gridComponents,this.allComponents=this.gridComponents}},{key:"scrollBarManager",value:function scrollBarManager(){return arguments.length?(this._scrollBarManager=arguments.length<=0?void 0:arguments[0],this):this._scrollBarManager}},{key:"attachScrollListener",value:function attachScrollListener(){var scrollBarManager=this.scrollBarManager();return renderer_utils_selectElement("#".concat(this.component[1][1].renderAt())).on("wheel",function(){var event=renderer_utils_getEvent(),wheelDeltaX=event.wheelDeltaX,wheelDeltaY=event.wheelDeltaY;0!==wheelDeltaX&&Math.abs(wheelDeltaX)>Math.abs(wheelDeltaY)&&scrollBarManager.preventBrowserScroll("horizontal",event).triggerScrollBarAction("horizontal",wheelDeltaX/30),0!==wheelDeltaY&&Math.abs(wheelDeltaX)<Math.abs(wheelDeltaY)&&scrollBarManager.preventBrowserScroll("vertical",event).triggerScrollBarAction("vertical",wheelDeltaY/30)}),this}},{key:"performScrollAction",value:function performScrollAction(direction,movedView){return function scrollActionApplier(movement,context){var classPrefix=context.params.config.classPrefix;return{horizontal:function horizontal(){[0,1,2].forEach(function(e){return grid_component_applyScrollAction("#".concat(context.component[e][1].renderAt()),classPrefix,movement,"scrollLeft")})},vertical:function vertical(){[0,1,2].forEach(function(e){return grid_component_applyScrollAction("#".concat(context.component[1][e].renderAt()),classPrefix,movement,"scrollTop")})}}}(movedView,this)[direction](),this}},{key:"getBoundBox",value:function getBoundBox(){var _this$component$0$0$b=this.component[0][0].boundBox(),top=_this$component$0$0$b.top,left=_this$component$0$0$b.left,_this$boundBox=this.boundBox();return{top:top,left:left,height:_this$boundBox.height,width:_this$boundBox.width}}},{key:"updateWrapper",value:function updateWrapper(params){return this.name(params.name),this.boundBox(params.config.dimensions),this.setParams(params),this}},{key:"setParams",value:function setParams(params){return this.component=params.component,this.params=params,this.target(params.config.target),this.className(params.config.className),this.sanitizeGrid(),this}},{key:"attachListener",value:function attachListener(){return this.attachScrollListener(),this}}]),GridComponent}();function message_component_typeof(obj){"@babel/helpers - typeof";return(message_component_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function message_component_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function message_component_possibleConstructorReturn(self,call){return!call||"object"!==message_component_typeof(call)&&"function"!=typeof call?function message_component_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function message_component_getPrototypeOf(o){return(message_component_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function message_component_setPrototypeOf(o,p){return(message_component_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _headerAlignmentMap,message_component_MessageComponent=function(_MuzeComponent){function MessageComponent(params){var _this;return function message_component_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,MessageComponent),(_this=message_component_possibleConstructorReturn(this,message_component_getPrototypeOf(MessageComponent).call(this,params.name,params.config.dimensions,0))).setParams(params),_this}return function message_component_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&message_component_setPrototypeOf(subClass,superClass)}(MessageComponent,MuzeComponent),function message_component_createClass(Constructor,protoProps,staticProps){return protoProps&&message_component_defineProperties(Constructor.prototype,protoProps),staticProps&&message_component_defineProperties(Constructor,staticProps),Constructor}(MessageComponent,[{key:"render",value:function render(container){var parent=renderer_utils_selectElement(container),config=this.params.config,className=config.classPrefix.className,node=makeElement(parent,"div",[1],className),_config$dimensions=config.dimensions,height=_config$dimensions.height,width=_config$dimensions.width,childHeight=height>MESSAGE_CONFIG.baseSizeLimit?MESSAGE_CONFIG.fractionChild*height:0,message=config.message;renderer_utils_applyStyle(node,{width:"".concat(width,"px"),height:"".concat(height,"px")});var childNode=makeElement(node,"div",[1],"".concat(className,"-child")),imageNode=makeElement(childNode,"div",[1],"".concat(className,"-child-img")),messageNode=makeElement(childNode,"div",[1],"".concat(className,"-child-message"));renderer_utils_applyStyle(childNode,{width:width,height:"".concat(childHeight,"px")}),renderer_utils_applyStyle(imageNode,{width:width,height:"".concat(childHeight*MESSAGE_CONFIG.fractionImage,"px")}),imageNode.html('<svg width="215px" height="199px" viewBox="0 0 215 199" \nversion="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n\x3c!-- Generator: Sketch 60.1 (88133) - https://sketch.com --\x3e\n\n<title>Group 23</title>\n    <desc>Created with Sketch.</desc>\n    <defs>\n        <polygon id="path-1" points="0.149161328 0.420711883 72.119 0.420711883 \n        72.119 71.9995421 0.149161328 71.9995421"></polygon>\n        <polygon id="path-3" points="0 0.08 186.190753 0.08 186.190753 88.592 0 88.592"></polygon>\n    </defs>\n    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="Group-23" transform="translate(0.000000, -1.000000)">\n            <g id="Group-3" transform="translate(142.000000, 127.920000)">\n                <mask id="mask-2" fill="white">\n                    <use xlink:href="#path-1"></use>\n                </mask>\n                <g id="Clip-2"></g>\n                <path d="M0.163,36.1555 C0.163,28.8495 0.126,21.5445 0.173,14.2395 \n                C0.226,6.1165 4.776,0.7895 12.76,0.6405 C28.362,0.3505 43.979,0.3335 \n                59.58,0.6735 C67.574,0.8475 72.079,6.2375 72.096,14.3735 C72.125,28.9835 \n                72.129,43.5935 72.094,58.2045 C72.074,66.4205 67.223,71.7225 58.955,71.8405 \n                C43.682,72.0565 28.4,72.0515 13.128,71.8315 C4.928,71.7135 0.221,66.4315 \n                0.172,58.0705 C0.129,50.7655 0.163,43.4605 0.163,36.1555" id="Fill-1" \n                fill="#8c8d8e" mask="url(#mask-2)"></path>\n            </g>\n            <g id="Group-6" transform="translate(0.000000, 0.920000)">\n                <mask id="mask-4" fill="white">\n                    <use xlink:href="#path-3"></use>\n                </mask>\n                <g id="Clip-5"></g>\n                <path d="M183.4677,4.615 C174.5697,3.72 165.6917,2.607 156.8037,1.597 C152.7477,1.136 \n                147.5417,-0.986 144.9347,0.755 C142.0737,2.664 143.7187,8.515 142.6187,12.488 C141.7057,\n                15.785 143.1607,16.531 146.0297,16.716 C149.3127,16.928 152.5717,17.483 156.6277,17.987 \n                C137.8927,32.589 119.9087,46.473 102.1267,60.61 C99.4257,62.757 98.2077,62.204 96.1947,\n                60.05 C85.5357,48.644 74.6947,37.409 64.0607,25.979 C61.8547,23.608 60.5757,23.002 57.8627,\n                25.586 C51.9777,31.188 45.6137,36.286 39.4547,41.6 C26.7597,52.553 14.0947,63.54 1.3487,\n                74.433 C-0.2963,75.838 -0.4833,76.732 1.0457,78.354 C4.1127,81.609 6.9717,85.061 10.0567,\n                88.592 C26.7507,74.17 43.3037,59.87 59.9757,45.469 C71.5287,57.708 82.9977,69.719 94.2677,\n                81.914 C96.5347,84.368 98.0097,84.604 100.6707,82.492 C116.3907,70.016 132.2397,57.704 \n                148.0587,45.353 C153.9727,40.736 159.9197,36.162 165.9517,31.491 C167.0647,36.458 163.2367,\n                42.055 165.8357,44.513 C168.4597,46.994 174.2387,46.065 178.6037,46.814 C180.5447,47.148 \n                181.1657,46.627 181.4047,44.671 C182.9067,32.336 184.5297,20.016 186.1377,7.696 C186.4127,\n                5.593 185.6327,4.833 183.4677,4.615" id="Fill-4" fill="#8c8d8e" mask="url(#mask-4)"></path>\n            </g>\n            <path d="M68.7436,89.5418 C63.2716,89.6988 57.7836,89.7768 52.3196,89.5178 C49.1866,89.3688 \n            48.3926,90.4028 48.4386,93.4328 C48.6076,104.5468 48.5056,115.6668 48.5056,126.7838 C48.5056,\n            138.0668 48.5916,149.3518 48.4436,160.6328 C48.4076,163.4118 49.1436,164.3578 52.0056,164.2518 \n            C57.8066,164.0398 63.6226,164.0938 69.4276,164.2338 C71.7586,164.2898 72.5516,163.6408 72.5416,\n            161.1938 C72.4536,138.4608 72.4326,115.7288 72.556775,92.9968 C72.5736,89.9318 71.3526,89.4668 \n            68.7436,89.5418" id="Fill-7" fill="#8c8d8e"></path>\n            <path d="M144.3769,91.2962 C138.9019,91.4772 133.4019,91.5912 127.9409,91.2652 C124.4229,91.0562 \n            123.8999,92.4662 123.9449,95.5182 C124.1039,106.3102 124.0069,117.1072 124.0069,127.9012 C124.0079,\n            137.3672 124.0079,146.8332 124.0079,156.3002 C124.0079,164.4422 124.0079,164.3082 132.1549,\n            164.2632 C134.9749,164.2472 135.8559,163.4702 135.7569,160.6292 C135.5449,154.6582 135.6479,\n            148.6742 135.6999,142.6952 C135.7679,135.0662 138.3559,128.6922 145.3599,124.8822 C147.2959,\n            123.8292 147.7519,122.5322 147.7349,120.5452 C147.6649,111.9092 147.6109,103.2722 147.7569,\n            94.6382 C147.8009,92.0132 146.9799,91.2102 144.3769,91.2962" id="Fill-9" fill="#8c8d8e"></path>\n            <path d="M110.3095,117.074 C110.3265,114.616 109.4485,113.950948 107.1345,113.998 C101.3365,\n            114.117 95.5265,114.204 89.7365,113.96 C86.7245,113.833 86.2185,115.041 86.2735,117.672 C86.4225,\n            124.795 86.3255,131.923 86.3245,139.049 C86.3245,146.34 86.4355,153.634 86.2645,160.922 C86.2035,\n            163.546 86.9745,164.336 89.6015,164.249 C95.3955,164.057 101.2015,164.133 107.0005,164.217 C109.1175,\n            164.247 110.3385,163.986 110.3185,161.321 C110.2015,146.573 110.2115,131.823 110.3095,117.074" \n            id="Fill-11" fill="#8c8d8e"></path>\n            <path d="M31.1347,116.1951 C25.3367,116.4001 19.5237,116.3591 13.7217,116.2131 C11.2637,116.1521 \n            10.6717,117.0871 10.6857,119.3921 C10.7747,133.3221 10.7877,147.2541 10.6847,161.1851 C10.6667,163.6601 \n            11.5637,164.2771 13.8597,164.2291 C19.6617,164.1061 25.4757,164.0161 31.2717,164.2601 C34.2827,164.3871 \n            34.7937,163.2071 34.7267,160.5531 C34.5597,153.9241 34.6717,147.2871 34.6717,140.6531 C34.6717,133.6881 \n            34.5377,126.7181 34.7367,119.7581 C34.8177,116.9131 33.9317,116.0961 31.1347,116.1951" id="Fill-13" \n            fill="#8c8d8e"></path>\n            <path d="M182.5937,62.2083 C175.8157,62.4493 169.0307,62.4883 162.2477,62.6073 L162.2467,62.6073 \n            C161.0087,63.1583 161.4327,64.2813 161.4317,65.1903 C161.4087,83.2963 161.4087,101.4033 161.4347,\n            119.5103 C161.4357,120.4033 160.9787,121.5473 162.2837,122.0423 C169.0747,122.1203 175.8697,122.1063 \n            182.6567,122.3223 C185.0277,122.3973 185.2947,121.3543 185.2887,119.3853 C185.2347,101.3103 \n            185.2377,83.2343 185.290773,65.1593 C185.2967,63.1633 184.9367,62.1253 182.5937,62.2083" \n            id="Fill-15" fill="#8c8d8e"></path>\n            <path d="M178.6747,133.095 C186.1527,133.096 193.6297,133.02 201.1057,133.12 C206.6837,133.197 \n            209.9207,136.107 209.9837,141.656 C210.1537,156.606 210.1427,171.56 209.9877,186.51 C209.9317,\n            192.015 206.6527,195.159 201.1977,195.197 C185.9127,195.303 170.6257,195.306 155.3397,195.216 \n            C149.4057,195.182 146.3497,192.185 146.3107,186.367 C146.2127,171.582 146.2197,156.795 146.3047,\n            142.01 C146.3387,136.149 149.3577,133.194 155.2477,133.118 C163.0557,133.019 170.8657,133.094 \n            178.6747,133.095" id="Fill-17" fill="#fbc0af"></path>\n            <path d="M186.1288,150.0833 C184.6798,156.9563 182.9098,165.3223 181.1508,173.6913 C180.7868,\n            175.4293 179.7388,176.1553 177.9798,176.1143 C176.1458,176.0713 175.3328,175.0033 174.9608,\n            173.4093 C173.0558,165.2363 171.0608,157.0593 170.2818,148.6993 C169.8138,143.6663 173.1078,\n            140.3553 177.7748,140.2323 C182.7748,140.1013 186.1058,143.4083 186.1288,150.0833" \n            id="Fill-19" fill="#FDFDFC"></path>\n            <path d="M177.7314,188.0823 C175.7614,187.9153 174.3044,186.6683 174.3184,184.3533 C174.3334,\n            182.0403 175.8334,180.6253 178.1304,180.6793 C180.3624,180.7313 182.0564,182.0443 181.9314,\n            184.4023 C181.8194,186.5383 180.5864,188.1203 177.7314,188.0823" id="Fill-21" fill="#FCF6F3"></path>\n        </g>\n    </g>\n    </svg>');var textElement=makeElement(messageNode,"text",[1]);renderer_utils_applyStyle(messageNode,{"font-size":"".concat(function formatFontSize(width,height){var baseFontLimit=MESSAGE_CONFIG.baseFontLimit,upperFontLimit=MESSAGE_CONFIG.upperFontLimit,baseSizeLimit=MESSAGE_CONFIG.baseSizeLimit,upperSizeLimit=MESSAGE_CONFIG.upperSizeLimit,fontSize=upperFontLimit,dim=width<height&&0!==width?width:height;return 0===dim?fontSize=0:dim<=baseSizeLimit?fontSize=baseFontLimit:dim>baseSizeLimit&&dim<upperSizeLimit&&(fontSize=baseFontLimit+(upperSizeLimit-dim)/((upperSizeLimit-baseSizeLimit)/(upperFontLimit-baseFontLimit))),fontSize}(width,height),"px")}),textElement.html(message)}},{key:"draw",value:function draw(container){this.render(container||document.getElementById(this.renderAt()))}},{key:"updateWrapper",value:function updateWrapper(params){return this.name(params.name),this.boundBox(params.config.dimensions),this.setParams(params),this}},{key:"setParams",value:function setParams(params){var _params$config=params.config,target=_params$config.target,className=_params$config.className;return this.component=params.component,this.params=params,this.target(target),this.className(className),this.position(params.config.position),this}}]),MessageComponent}();function component_wrapper_maker_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function component_wrapper_maker_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?component_wrapper_maker_ownKeys(Object(source),!0).forEach(function(key){component_wrapper_maker_defineProperty(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):component_wrapper_maker_ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function component_wrapper_maker_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var headerMap={title:{headerCell:"titleCell",configType:TITLE_CONFIG},subtitle:{headerCell:"subtitleCell",configType:SUB_TITLE_CONFIG}},headerAlignmentMap=(component_wrapper_maker_defineProperty(_headerAlignmentMap={},src_constants_LEFT,src_constants_LEFT),component_wrapper_maker_defineProperty(_headerAlignmentMap,src_constants_RIGHT,src_constants_RIGHT),component_wrapper_maker_defineProperty(_headerAlignmentMap,"center",HORIZONTAL_CENTER),_headerAlignmentMap),isGridPresent=function isGridPresent(renderDetails){var _renderDetails$compon=renderDetails.components;return function checkParamsValidation(params){return Object.keys(params).every(function(param){return params[param]})}({rows:_renderDetails$compon.rows,columns:_renderDetails$compon.columns,values:_renderDetails$compon.values})},component_wrapper_maker_createHeaderWrapper=function createHeaderWrapper(headerType,layoutManager,renderDetails){var wrapper=null,components=renderDetails.components,layoutConfig=renderDetails.layoutConfig,_headerMap$headerType=headerMap[headerType],headerCell=_headerMap$headerType.headerCell,configType=_headerMap$headerType.configType,target={target:"canvas"};if(components.headers&&components.headers[headerCell]){var headerConfig=layoutConfig[headerType],wrapperParams={name:headerType,component:components.headers[headerCell],config:headerConfig=Object.assign({},headerConfig,component_wrapper_maker_objectSpread({classPrefix:layoutConfig.classPrefix},target,{alignWith:"".concat(ROW_MATRIX_INDEX[0],"-").concat(COLUMN_MATRIX_INDEX[1]),alignment:headerAlignmentMap[headerConfig.align],className:configType.className}))},existingComponent=layoutManager.getComponent(headerType);wrapper=existingComponent?existingComponent.updateWrapper(wrapperParams):new headerComponent_HeaderComponent(wrapperParams)}return wrapper},component_wrapper_maker_createScrollBarWrapper=function createScrollBarWrapper(scrollBarType,layoutManager,renderDetails,grid,renderGrid){if(renderGrid){var layoutConfig=renderDetails.layoutConfig,target={target:"canvas"},scrollBar=layoutConfig.scrollBar,layoutDimensions=grid.viewInfo().layoutDimensions,actualCenterMeasures=layoutDimensions.actualCenterMeasures,unitHeights=layoutDimensions.unitHeights,unitWidths=layoutDimensions.unitWidths,_scrollBarMap$scrollB=function scrollBarMap(config){return{vertical:{componentName:"verticalScrollBar",width:"thickness",height:"layoutBasedMeasure",layoutBasedMeasure:"height",viewMeasure:"viewHeight",rowAlign:1,colAlign:"right"===config.align?2:0,position:config.align,alignment:src_constants_TOP},horizontal:{componentName:"horizontalScrollBar",width:"layoutBasedMeasure",layoutBasedMeasure:"width",viewMeasure:"viewWidth",height:"thickness",rowAlign:"top"===config.align?0:2,colAlign:1,position:config.align,alignment:src_constants_LEFT}}}(scrollBar[scrollBarType])[scrollBarType],componentName=_scrollBarMap$scrollB.componentName,layoutBasedMeasure=_scrollBarMap$scrollB.layoutBasedMeasure,width=_scrollBarMap$scrollB.width,height=_scrollBarMap$scrollB.height,rowAlign=_scrollBarMap$scrollB.rowAlign,colAlign=_scrollBarMap$scrollB.colAlign,viewMeasure=_scrollBarMap$scrollB.viewMeasure,position=_scrollBarMap$scrollB.position,alignment=_scrollBarMap$scrollB.alignment,dimensions={thickness:scrollBar.thickness,layoutBasedMeasure:layoutDimensions[viewMeasure][1]},isScroll=grid.scrollInfo()[scrollBarType],totalLength=actualCenterMeasures[layoutBasedMeasure],viewLength=layoutDimensions[viewMeasure][1],wrapperParams={name:componentName,config:Object.assign({},component_wrapper_maker_objectSpread({classPrefix:layoutConfig.classPrefix},target,{scrollBarComponentConfig:component_wrapper_maker_objectSpread({},scrollBar,{classPrefix:layoutConfig.classPrefix}),type:scrollBarType,alignWith:"".concat(ROW_MATRIX_INDEX[rowAlign],"-").concat(COLUMN_MATRIX_INDEX[colAlign]),alignment:alignment,position:position})),dimensions:{width:dimensions[width],height:dimensions[height],totalLength:totalLength,viewLength:viewLength,unitHeights:unitHeights,unitWidths:unitWidths}},existingComponent=layoutManager.getComponent(componentName);return isScroll?existingComponent?existingComponent.updateWrapper(wrapperParams):new ScrollComponent(wrapperParams):(existingComponent&&existingComponent.remove(),null)}return null},component_wrapper_maker_componentWrapperMaker=function componentWrapperMaker(canvas,grid,renderDetails){var layoutManager=canvas._layoutManager,renderGrid=isGridPresent(renderDetails);return{title:component_wrapper_maker_createHeaderWrapper("title",layoutManager,renderDetails),subtitle:component_wrapper_maker_createHeaderWrapper("subtitle",layoutManager,renderDetails),message:function createMessageWrapper(layoutManager,renderDetails,renderGrid){for(var components=renderDetails.components,measurement=renderDetails.measurement,sum=0,_i=0,_headerValues=Object.values(components.headers);_i<_headerValues.length;_i++)sum+=_headerValues[_i].logicalSpace().height;if(!renderGrid){var defaultDimensions={height:measurement.canvasHeight-sum,width:measurement.canvasWidth},gridComponent=layoutManager.getComponent("grid"),_ref=gridComponent&&gridComponent.getBoundBox()||defaultDimensions,wrapperParams={name:"message",component:null,config:component_wrapper_maker_objectSpread({},{target:"canvas"},{dimensions:{height:_ref.height,width:_ref.width},message:"Insufficient data or incorrect configurations",classPrefix:MESSAGE_CONFIG,position:src_constants_TOP})},existingComponent=layoutManager.getComponent("message");return existingComponent?existingComponent.updateWrapper(wrapperParams):new message_component_MessageComponent(wrapperParams)}return null}(layoutManager,renderDetails,renderGrid),legend:function createLegendWrapper(layoutManager,renderDetails,renderGrid){if(renderGrid){var legendWrapper=null,components=renderDetails.components,layoutConfig=renderDetails.layoutConfig,measurement=renderDetails.measurement,target={target:"canvas"};if(components.legends&&components.legends.length){var legendConfig=component_wrapper_maker_objectSpread({},layoutConfig.legend,{},target,{measurement:measurement}),wrapperParams={name:"legend",component:components.legends,config:legendConfig},existingComponent=layoutManager.getComponent("legend");legendWrapper=existingComponent?existingComponent.updateWrapper(wrapperParams):new legendComponent_LegendComponent(wrapperParams)}return legendWrapper}return null}(layoutManager,renderDetails,renderGrid),grid:function gridLayoutWrapper(layoutManager,renderDetails,grid,renderGrid){if(renderGrid){var target={target:"canvas"},layoutConfig=renderDetails.layoutConfig,wrapperParams={name:"grid",component:grid,config:component_wrapper_maker_objectSpread({},target,{pagination:layoutConfig.pagination,classPrefix:layoutConfig.classPrefix,dimensions:{height:0,width:0}})},existingComponent=layoutManager.getComponent("grid");return existingComponent?existingComponent.updateWrapper(wrapperParams):new grid_component_GridComponent(wrapperParams)}return null}(layoutManager,renderDetails,grid,renderGrid),verticalScrollBar:component_wrapper_maker_createScrollBarWrapper("vertical",layoutManager,renderDetails,grid,renderGrid),horizontalScrollBar:component_wrapper_maker_createScrollBarWrapper("horizontal",layoutManager,renderDetails,grid,renderGrid)}};function scroll_manager_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var ScrollManager=function(){function ScrollManager(){!function scroll_manager_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ScrollManager),this._scrollBarComponents={},this._attachedComponents={}}return function scroll_manager_createClass(Constructor,protoProps,staticProps){return protoProps&&scroll_manager_defineProperties(Constructor.prototype,protoProps),staticProps&&scroll_manager_defineProperties(Constructor,staticProps),Constructor}(ScrollManager,[{key:"scrollBarComponents",value:function scrollBarComponents(){return arguments.length?(this._scrollBarComponents=arguments.length<=0?void 0:arguments[0],this):this._scrollBarComponents}},{key:"attachedComponents",value:function attachedComponents(){return arguments.length?(this._attachedComponents=arguments.length<=0?void 0:arguments[0],this):this._attachedComponents}},{key:"preventBrowserScroll",value:function preventBrowserScroll(type,event){return this.scrollBarComponents()[type]&&(event.preventDefault(),event.stopPropagation()),this}},{key:"performAttachedScrollFunction",value:function performAttachedScrollFunction(type,movedViewLength){return Object.values(this.attachedComponents()).forEach(function(e){e.performScrollAction(type,movedViewLength)}),this}},{key:"triggerScrollBarAction",value:function triggerScrollBarAction(type,delta){return this.scrollBarComponents()[type]&&this.scrollBarComponents()[type].scrollDeltaTo(delta),this}}]),ScrollManager}(),layout_maker_getRenderDetails=function getRenderDetails(context,mount){var layoutConfig=mergeRecursive({},context.config()),_mount$getBoundingCli=mount.getBoundingClientRect(),height=_mount$getBoundingCli.height,width=_mount$getBoundingCli.width,heightAttr=context.height(),widthAttr=context.width(),visGroup=context.composition().visualGroup,_visGroup$placeholder=visGroup.placeholderInfo(),isColumnSizeEqual=_visGroup$placeholder.isColumnSizeEqual,isRowSizeEqual=_visGroup$placeholder.isRowSizeEqual,priority=_visGroup$placeholder.priority,rows=_visGroup$placeholder.rows,columns=_visGroup$placeholder.columns,values=_visGroup$placeholder.values,_context$config=context.config(),minWidth=_context$config.minWidth,minHeight=_context$config.minHeight,classPrefix=_context$config.classPrefix,showHeaders=_context$config.showHeaders,legend=_context$config.legend,pagination=_context$config.pagination,scrollBar=_context$config.scrollBar,titleConfig=context.title()[1],subtitleConfig=context.subtitle()[1],legendPosition=legend.position,layoutArrangement=function arrangeComponents(context){var _titleLayouts,legendConfig=context.config().legend,titleConfig=context.title()[1],subtitleConfig=context.subtitle()[1],titleLayouts=(component_resolver_defineProperty(_titleLayouts={},"".concat(src_constants_TOP,"-").concat(src_constants_TOP),["title","subtitle","group"]),component_resolver_defineProperty(_titleLayouts,"".concat(src_constants_BOTTOM,"-").concat(src_constants_BOTTOM),["group","subtitle","title"]),component_resolver_defineProperty(_titleLayouts,"".concat(src_constants_TOP,"-").concat(src_constants_BOTTOM),["title","group","subtitle"]),component_resolver_defineProperty(_titleLayouts,"".concat(src_constants_BOTTOM,"-").concat(src_constants_TOP),["subtitle","group","title"]),_titleLayouts),legendLayouts=[["legend","layout"],["layout","legend"]],titlePosition=titleConfig.position||src_constants_TOP,subtitlePosition=subtitleConfig.position||src_constants_TOP;return{headers:titleLayouts["".concat(titlePosition,"-").concat(subtitlePosition)],legends:legendConfig.position===src_constants_LEFT||legendConfig.position===src_constants_TOP?legendLayouts[0]:legendLayouts[1]}}(context);height=Math.floor(height),width=Math.floor(width);var availableHeightForCanvas=Math.max(heightAttr>0?heightAttr:height,minHeight),availableWidthForCanvas=Math.max(widthAttr>0?widthAttr:width,minWidth),_createHeaders=function createHeaders(context,canvasHeight,canvasWidth){var headerHeight=0,headers={},subtitle=context.subtitle(),isSubtitle=title_maker_resolveTitleSubTitleContent(subtitle[0]);return canvasHeight>=200&&canvasWidth>=200&&["title","subtitle"].forEach(function(type){var headerOptions=context[type](),content=title_maker_resolveTitleSubTitleContent(headerOptions[0]);if(content){var config=headerOptions[1];config.width=context.width(),config.height=context.height(),config.classPrefix=context.config().classPrefix,config.content=content,config.padding="title"!==type||isSubtitle.length?config.padding:subtitle[1].padding;var _createHeading=createHeading(config,type,context.dependencies().smartlabel,context["".concat(type,"Cell")]),height=_createHeading.height,cell=_createHeading.cell;headers["".concat(type,"Cell")]=cell,context._composition[type]=cell,headerHeight+=height}}),{headerHeight:headerHeight,headers:headers}}(context,availableHeightForCanvas,availableWidthForCanvas),headers=_createHeaders.headers,headerHeight=_createHeaders.headerHeight,legends=function createLegend(context,headerHeight,height,width){var measurement={height:height,width:width,headerHeight:headerHeight},legend=context.config().legend,show=legend.show,position=legend.position;legend.classPrefix=context.config().classPrefix;var align=position===src_constants_LEFT||position===src_constants_RIGHT?"vertical":"horizontal";return legend.show=show?"vertical"===align&&width>200||"horizontal"===align&&height>200:show,legend.align=align,legend_maker_legendInitializer(legend,context,measurement,context.composition().legend||{})}(context,headerHeight,availableHeightForCanvas,availableWidthForCanvas);context._composition.legend={},legends.forEach(function(e){context._composition.legend[e.scaleType]=e.legend});var legendSpace=function getLegendSpace(legends,legendConfig,availableHeight,availableWidth){var legendSpace={width:0,height:0};return legends.map(function(legendInfo){return legendInfo.legend.measurement()}).forEach(function(space){var height,width;width=Math.min(space.width,space.maxWidth),height=Math.min(space.height,space.maxHeight),"horizontal"===legendConfig.align?legendSpace.width+width>availableWidth?(legendSpace.width=availableWidth,legendSpace.height+=height):(legendSpace.width+=width,legendSpace.height=Math.max(legendSpace.height,height)):legendSpace.height+height>availableHeight?(legendSpace.height=height,legendSpace.width+=width):(legendSpace.height+=height,legendSpace.width=Math.max(legendSpace.width,width))}),"horizontal"===legendConfig.align&&(legendSpace.width=availableWidth),legendSpace}(legends,legend,availableHeightForCanvas,availableWidthForCanvas),legendWidth=legendPosition===src_constants_LEFT||legendPosition===src_constants_RIGHT?legendSpace.width:0,legendHeight=legendPosition===src_constants_TOP||legendPosition===src_constants_BOTTOM?legendSpace.height:0,components={headers:headers,legends:legends,canvases:[context],rows:rows,columns:columns,values:values,cornerMatrices:visGroup.cornerMatrices()},measurement={mountSpace:{height:height,width:width},headerHeight:headerHeight,legendSpace:legendSpace,canvasWidth:availableWidthForCanvas,canvasHeight:availableHeightForCanvas,width:availableWidthForCanvas-legendWidth,height:availableHeightForCanvas-headerHeight-legendHeight,minUnitHeight:context.minUnitHeight(),minUnitWidth:context.minUnitWidth()};return{layoutConfig:layoutConfig=mergeRecursive(layoutConfig,{classPrefix:classPrefix,showHeaders:showHeaders,border:mergeRecursive(visGroup.metaData().border,context.config().border),layoutArrangement:layoutArrangement,legend:legend,buffer:scrollBar.thickness,pagination:pagination,title:titleConfig,subtitle:subtitleConfig,isColumnSizeEqual:isColumnSizeEqual,isRowSizeEqual:isRowSizeEqual,mount:mount,priority:priority}),components:components,measurement:measurement}},componentIndexes={title:0,subtitle:1,legend:2,verticalScrollBar:3,horizontalScrollBar:4,grid:5,message:6},componentNames={0:"title",1:"subtitle",2:"legend",3:"verticalScrollBar",4:"horizontalScrollBar",5:"grid",6:"message"},layout_maker_renderLayout=function renderLayout(canvas,renderDetails){var layoutManager=canvas._layoutManager,gridLayout=canvas.layout(),grid=componentIndexes.grid,compWrappers=component_wrapper_maker_componentWrapperMaker(canvas,gridLayout,renderDetails),componentWrappers=Object.keys(componentIndexes).map(function(e){return compWrappers[e]});componentWrappers[grid]&&function createScrollManager(componentWrappers,canvas){var verticalScrollBar=componentIndexes.verticalScrollBar,grid=componentIndexes.grid,horizontalScrollWrapper=componentWrappers[componentIndexes.horizontalScrollBar],verticalScrollWrapper=componentWrappers[verticalScrollBar],gridWrapper=componentWrappers[grid],scrollBarManager=new ScrollManager,scrollBarComponents={};verticalScrollWrapper&&(scrollBarComponents.vertical=verticalScrollWrapper),horizontalScrollWrapper&&(scrollBarComponents.horizontal=horizontalScrollWrapper),scrollBarManager.scrollBarComponents(scrollBarComponents).attachedComponents({grid:gridWrapper}),canvas.composition().hScrollBar=horizontalScrollWrapper,canvas.composition().vScrollBar=verticalScrollWrapper,[horizontalScrollWrapper,verticalScrollWrapper].forEach(function(wrapper){wrapper&&wrapper.manager(scrollBarManager)}),gridWrapper.scrollBarManager(scrollBarManager)}(componentWrappers,canvas),componentWrappers.forEach(function(componentWrapper,index){if(!componentWrapper){var deleteElementName=componentNames[index];layoutManager.removeComponent(deleteElementName)}}),layoutManager.registerComponents(componentWrappers).compute(),function attachListeners(componentWrappers){componentWrappers.forEach(function(componentWrapper){componentWrapper&&componentWrapper.attachListener()})}(componentWrappers)};function canvas_firebolt_helper_toConsumableArray(arr){return function canvas_firebolt_helper_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function canvas_firebolt_helper_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function canvas_firebolt_helper_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var helper_addFacetDataAndMeasureNames=function addFacetDataAndMeasureNames(data,facetData,measureNames){if(null===data)return data;var facets=Object.keys(facetData),facetVals=Object.values(facetData);if(isSimpleObject(data))return Object.assign({},Object.keys(facetData).reduce(function(acc,v){return acc[v]=[facetData[v]],acc},{}),data,function firebolt_helper_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},reserved_fields.MEASURE_NAMES,measureNames));for(var criteriaFields=data[0],hasMeasureNameField=criteriaFields.find(function(field){return field===reserved_fields.MEASURE_NAMES}),dataWithFacets=[[].concat(canvas_firebolt_helper_toConsumableArray(facets),canvas_firebolt_helper_toConsumableArray(criteriaFields),canvas_firebolt_helper_toConsumableArray(hasMeasureNameField?[]:[reserved_fields.MEASURE_NAMES]))],i=1,len=data.length;i<len;i++){var measureNameArr=[];!hasMeasureNameField&&measureNames&&(measureNameArr=measureNames);var row=[].concat(canvas_firebolt_helper_toConsumableArray(facetVals),canvas_firebolt_helper_toConsumableArray(data[i]),canvas_firebolt_helper_toConsumableArray(measureNameArr));dataWithFacets.push(row)}return dataWithFacets},helper_isDimension=function isDimension(fields){return fields.some(function(field){return field.type()===dist_datamodel.FieldType.DIMENSION})},isCrosstab=function isCrosstab(fields){var rowFacets=fields.rowFacets,colFacets=fields.colFacets,rowProjections=fields.rowProjections,colProjections=fields.colProjections;if(rowFacets.length||colFacets.length)return!0;var colProj=colProjections.flat(),rowProj=rowProjections.flat();return!(!helper_isDimension(colProj)&&!helper_isDimension(rowProj)||!(colProj.length>1||rowProj.length>1))},helper_dispatchBehaviours=function dispatchBehaviours(firebolt,_ref){var payload=_ref.payload,unit=_ref.unit;_ref.behaviours.forEach(function(action){var actions=firebolt._actions.behavioural;payload.criteria=helper_addFacetDataAndMeasureNames(payload.criteria,unit.facetFieldsMap(),unit.layers().map(function(layer){return Object.keys(layer.data().getFieldspace().getMeasure())})),function addSelectedMeasuresInPayload(firebolt,unit,payload){var groupFields=firebolt.context.composition().visualGroup.resolver().getAllFields();if(isCrosstab(groupFields)){var measureFields,_unit$fields=unit.fields(),x=_unit$fields.x,y=_unit$fields.y;x.length&&y.length&&(x[0].type()===dist_datamodel.FieldType.MEASURE?measureFields=["".concat(x[0])]:y[0].type()===dist_datamodel.FieldType.MEASURE&&(measureFields=["".concat(y[0])]),payload.selectedMeasures=measureFields)}}(firebolt,unit,payload),payload.sourceCanvas=firebolt.sourceCanvas(),firebolt.dispatchBehaviour(action,payload,{propagate:!1,unit:unit});var identifiers=actions[action].propagationIdentifiers();firebolt.propagate(action,payload,identifiers,{sideEffects:getSideEffects(action,firebolt._behaviourEffectMap),sourceUnitId:unit.id(),sourceId:firebolt.id(),propagationDataSource:firebolt.getPropagationSource()})})},helper_attachBehaviours=function attachBehaviours(group){var allFields=group.resolver().getAllFields(),valueMatrix=group.matrixInstance().value,crosstab=isCrosstab(allFields);valueMatrix.each(function(cell){var firebolt=cell.valueOf().firebolt(),behaviours=crosstab?["pseudoSelect"]:[];firebolt._connectedBehaviours[behaviours_namespaceObject.SELECT]=behaviours})};function group_firebolt_typeof(obj){"@babel/helpers - typeof";return(group_firebolt_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function group_firebolt_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function group_firebolt_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function group_firebolt_get(target,property,receiver){return(group_firebolt_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(target,property,receiver){var base=function group_firebolt_superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=group_firebolt_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function group_firebolt_getPrototypeOf(o){return(group_firebolt_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function group_firebolt_setPrototypeOf(o,p){return(group_firebolt_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function group_firebolt_toConsumableArray(arr){return function group_firebolt_arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}(arr)||function group_firebolt_iterableToArray(iter){if(Symbol.iterator in Object(iter)||"[object Arguments]"===Object.prototype.toString.call(iter))return Array.from(iter)}(arr)||function group_firebolt_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var group_firebolt_setSideEffectConfig=function setSideEffectConfig(firebolt){var tooltipSideEffect=firebolt.sideEffects().tooltip,allFields=firebolt.context.composition().visualGroup.resolver().getAllFields();isCrosstab(allFields)?tooltipSideEffect.config({selectionSummary:{order:1,className:"tooltip-content-container-selectionSummary-crosstab",showMultipleMeasures:!0},highlightSummary:{order:0,className:"tooltip-content-container-highlightSummary-crosstab"}}):tooltipSideEffect.config({selectionSummary:{order:0,className:"tooltip-content-container-selectionSummary-default",showMultipleMeasures:!1},highlightSummary:{order:1,className:"tooltip-content-container-highlightSummary-default"}})},_defaultCrossInteractionPolicy={behaviours:{"*":function _(propagationPayload,firebolt){var propagationCanvasAlias=propagationPayload.sourceCanvas,canvasAlias=firebolt.sourceCanvas();return!propagationCanvasAlias||canvasAlias===propagationCanvasAlias}},sideEffects:{"*":function _(propagationPayload,firebolt){var propagationCanvasAlias=propagationPayload.sourceCanvas,canvasAlias=firebolt.sourceCanvas();return!propagationCanvasAlias||canvasAlias===propagationCanvasAlias},selectionBox:function selectionBox(){return!1}}},canvas_firebolt=function(_Firebolt){function GroupFireBolt(){var _getPrototypeOf2,_this;!function group_firebolt_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,GroupFireBolt);for(var _len=arguments.length,params=new Array(_len),_key=0;_key<_len;_key++)params[_key]=arguments[_key];return(_this=function group_firebolt_possibleConstructorReturn(self,call){return!call||"object"!==group_firebolt_typeof(call)&&"function"!=typeof call?group_firebolt_assertThisInitialized(self):call}(this,(_getPrototypeOf2=group_firebolt_getPrototypeOf(GroupFireBolt)).call.apply(_getPrototypeOf2,[this].concat(params)))).payloadGenerators(payloadGenerator),_this._interactionPolicy=_this.constructor.defaultInteractionPolicy(),_this.crossInteractionPolicy(_this.constructor.defaultCrossInteractionPolicy()),_this.context._throwback.registerImmediateListener([common_props.MATRIX_CREATED],function(){_this.config(_this.context.config().interaction),helper_applyInteractionPolicy(group_firebolt_assertThisInitialized(_this));var group=_this.context.composition().visualGroup;group&&(group_firebolt_setSideEffectConfig(group_firebolt_assertThisInitialized(_this)),_this.createSelectionSet(group.groupedData()),group.getGroupByData().on("propagation",function(data,config){_this.handleDataModelPropagation(data,config)}),helper_attachBehaviours(group))}),_this}return function group_firebolt_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&group_firebolt_setPrototypeOf(subClass,superClass)}(GroupFireBolt,firebolt_Firebolt),function group_firebolt_createClass(Constructor,protoProps,staticProps){return protoProps&&group_firebolt_defineProperties(Constructor.prototype,protoProps),staticProps&&group_firebolt_defineProperties(Constructor,staticProps),Constructor}(GroupFireBolt,[{key:"interactionPolicy",value:function interactionPolicy(){return arguments.length?(this._interactionPolicy=(arguments.length<=0?void 0:arguments[0])||this.constructor.defaultInteractionPolicy(),this):this._interactionPolicy}},{key:"crossInteractionPolicy",value:function crossInteractionPolicy(){return arguments.length?(this._crossInteractionPolicy=mergeRecursive(mergeRecursive({},this.constructor.defaultCrossInteractionPolicy()),(arguments.length<=0?void 0:arguments[0])||{}),helper_applyInteractionPolicy(this),this):this._crossInteractionPolicy}},{key:"handleDataModelPropagation",value:function handleDataModelPropagation(data,config){var _this2=this,group=this.context.composition().visualGroup,valueMatrix=group.matrixInstance().value,units=group.resolver().units(),propagationData=data;if(config.propagationSourceId===this.id())return this;var enabledFn=config.enabled,sourceIdentifiers=config.sourceIdentifiers,action=config.action,propPayload=config.payload,_this$context$config$=this.context.config().interaction.behaviours;if("common"!==(void 0===_this$context$config$?{}:_this$context$config$)[action])return this;var payload=this.getPayloadGeneratorFor(action)(this,propagationData,config),behaviourPolicies=this._behaviourPolicies,enabled=Object.values(behaviourPolicies[action]||behaviourPolicies["*"]||{}).every(function(fn){return fn(propPayload||{},_this2,{sourceIdentifiers:sourceIdentifiers,propagationData:propagationData})});if(enabledFn&&(enabled=enabledFn(config,this)&&enabled),enabled){var _ref$instance=(valueMatrix.findPlaceHolderById(propPayload.sourceUnit)||{}).instance,unit=void 0===_ref$instance?units[0][0]:_ref$instance,propagationInf={propagate:!1,data:propagationData,propPayload:propPayload,sourceIdentifiers:sourceIdentifiers,sourceId:config.propagationSourceId,isMutableAction:config.isMutableAction,unit:unit};this.dispatchBehaviour(action,payload,propagationInf)}return this}},{key:"registerSideEffects",value:function registerSideEffects(sideEffects){for(var key in sideEffects)this._sideEffectDefinitions[sideEffects[key].formalName()]=sideEffects[key];return this.initializeSideEffects(),this}},{key:"target",value:function target(){return"visual-group"}},{key:"mapActionsAndBehaviour",value:function mapActionsAndBehaviour(){this.context.composition().visualGroup.matrixInstance().value.each(function(unit){unit.source().firebolt().mapActionsAndBehaviour()}),this.registerPhysicalActionHandlers()}},{key:"registerPhysicalActionHandlers",value:function registerPhysicalActionHandlers(){var _this3=this;return this.context.composition().visualGroup.matrixInstance().value.each(function(cell){var unit=cell.source();unit.firebolt().onPhysicalAction("*",function(event,payload){_this3.handlePhysicalAction(event,payload,unit)},_this3.context.constructor.formalName())}),this}},{key:"handlePhysicalAction",value:function handlePhysicalAction(event,payload,unit){var behaviours=unit.firebolt()._actionBehaviourMap[event].behaviours;helper_dispatchBehaviours(this,{behaviours:behaviours,payload:payload,unit:unit}),function resetSelectAction(firebolt,_ref2){var unit=_ref2.unit,payload=_ref2.payload;_ref2.behaviours[0]===behaviours_namespaceObject.BRUSH&&payload.dragging&&payload.dragDiff<5&&helper_dispatchBehaviours(firebolt,{behaviours:[behaviours_namespaceObject.SELECT],payload:{criteria:null},unit:unit})}(this,{behaviours:behaviours,payload:payload,unit:unit})}},{key:"createSelectionSet",value:function createSelectionSet(data){var _prepareSelectionSetD=function prepareSelectionSetData(group,dataModel){var valueMatrix=group.matrixInstance().value,fieldsConfig=dataModel.getFieldsConfig(),dimensions=Object.values(fieldsConfig).filter(function(d){return d.def.type===dist_datamodel.FieldType.DIMENSION}),measureName=Object.keys(dataModel.getFieldspace().getMeasure()).length?[reserved_fields.MEASURE_NAMES]:[],keys={},dimensionsMap={},groupDataMap={};return dataModel.getData({withUid:!0}).data.forEach(function(row){row[row.length-1].values().reduce(function(acc,id){return acc[id]=row,acc},groupDataMap)}),valueMatrix.each(function(cell){var unit=cell.source(),dm=unit.cachedData()[0],layers=unit.layers(),linkedRows=[],uids=[];dm.getData().uids.forEach(function(uid){var id=uid.values().find(function(idValue){return groupDataMap[idValue]}),linkedRow=groupDataMap[id];linkedRow&&(linkedRows.push(linkedRow),uids.push(linkedRow[linkedRow.length-1]))}),prepareSelectionSetMap({data:linkedRows,uids:uids,dimensions:dimensions},layers,{keys:keys,dimensionsMap:dimensionsMap})}),{keys:keys,dimensionsMap:dimensionsMap,dimensions:dimensions,allFields:[].concat(group_firebolt_toConsumableArray(dimensions),measureName)}}(this.context.composition().visualGroup,data),keys=_prepareSelectionSetD.keys,dimensions=_prepareSelectionSetD.dimensions,dimensionsMap=_prepareSelectionSetD.dimensionsMap,allFields=_prepareSelectionSetD.allFields;return this._metaData={dimensionsMap:dimensionsMap,dimensions:dimensions,allFields:allFields},group_firebolt_get(group_firebolt_getPrototypeOf(GroupFireBolt.prototype),"createSelectionSet",this).call(this,{keys:keys,fields:dimensions.map(function(d){return d.def.name})}),this._dimsMapGetter=createMapByDimensions(this,this.data()),this}},{key:"id",value:function id(){return this.context.alias()}},{key:"shouldApplySideEffects",value:function shouldApplySideEffects(propInf){return!1!==propInf.applySideEffect}},{key:"data",value:function data(){var group=this.context.composition().visualGroup;if(arguments.length){var model=arguments.length<=0?void 0:arguments[0];return group.groupedData(model),this.createSelectionSet(group.groupedData()),this}return group.getGroupByData()}},{key:"resetData",value:function resetData(){var group=this.context.composition().visualGroup;return group.resetData(),this.createSelectionSet(group.groupedData()),this}},{key:"getRangeFromIdentifiers",value:function getRangeFromIdentifiers(_ref2){var criteria=_ref2.criteria;return _ref2.fields.reduce(function(acc,v){return acc[v]=criteria[v],acc},{})}},{key:"propagate",value:function propagate(behaviour,payload,identifiers){var auxConfig=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function propagateValues(instance,action){var config=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},payload=config.payload,identifiers=config.identifiers,sourceUnitId=config.sourceUnitId,sourceCanvasId=config.sourceCanvasId,dataModel=config.propagationDataSource,sideEfffects=instance._sideEffectDefinitions,behaviourEffectMap=instance._behaviourEffectMap,propagationBehaviour=instance._propagationBehaviourMap[action]||action;payload.sourceUnit=sourceUnitId,payload.action=action,payload.sourceCanvas=sourceCanvasId;var groupId=sourceCanvasId,sourceBehaviour=instance._actions.behavioural[action],isMutableAction=!!sourceBehaviour&&sourceBehaviour.constructor.mutates(),propConfig={payload:payload,action:action,criteria:identifiers,isMutableAction:isMutableAction,groupId:groupId,sourceId:config.sourceId,filterFn:function filterFn(entry,propagationConf){var effects=behaviourEffectMap[entry.config.action],mutates=!entry.config.groupId||!!effects&&effects.some(function(d){return sideEfffects[d.name||d].mutates()});return entry.config.groupId!==propagationConf.groupId&&mutates},enabled:function enabled(propConf,firebolt){return action===propagationBehaviour||propConf.payload.sourceCanvas===firebolt.sourceCanvas()}};if(dataModel.propagate(identifiers,propConfig,!0),action!==propagationBehaviour){var behaviourInstance=instance._actions.behavioural[propagationBehaviour];isMutableAction=!!behaviourInstance&&behaviourInstance.constructor.mutates(),dataModel.propagate(identifiers,Object.assign({},propConfig,{isMutableAction:isMutableAction,applyOnSource:!1,action:propagationBehaviour,sourceId:isMutableAction?groupId:sourceUnitId,enabled:function enabled(propConf,firebolt){return propConf.payload.sourceCanvas!==firebolt.sourceCanvas()}}),!0,{filterImmutableAction:function filterImmutableAction(actionInf,propInf){return actionInf.groupId!==propInf.groupId}})}}(this,behaviour,Object.assign({payload:payload,identifiers:identifiers,propagationFields:this._propagationFields,sourceId:this.id(),sourceCanvasId:this.id(),propagationDataSource:this.data()},auxConfig))}},{key:"getPropagationSource",value:function getPropagationSource(){return this.context.composition().visualGroup._originalGroupedData}},{key:"sourceCanvas",value:function sourceCanvas(){return this.context.alias()}},{key:"getApplicableSideEffects",value:function getApplicableSideEffects(sideEffects,payload,propagationInf){var _this4=this;if(payload.sideEffects)return[{effects:payload.sideEffects,behaviours:[payload.action]}];var mode=this.context.config().interaction.tooltip.mode;return propagationInf.propPayload=propagationInf.propPayload||payload,sideEffects.forEach(function(d){var mappedEffects=d.effects;mappedEffects=mappedEffects.filter(function(se){return(se.name!==side_effects_TOOLTIP||"fragmented"!==mode)&&isSideEffectEnabled(_this4,{se:se,propagationInf:propagationInf})}),d.effects=mappedEffects}),sideEffects}},{key:"dispatchBehaviour",value:function dispatchBehaviour(action,payload){var propagationInf=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},units=this.context.composition().visualGroup.resolver().units(),_propagationInf$unit=propagationInf.unit,unit=void 0===_propagationInf$unit?units[0][0]:_propagationInf$unit,behaviourEffectMap=this._behaviourEffectMap,sideEffects=getSideEffects(action,behaviourEffectMap),sideEffectInstances=this.sideEffects();sideEffects.forEach(function(_ref3){_ref3.effects.forEach(function(effect){var name=effect.name,inst=sideEffectInstances[name];inst&&(inst.sourceInfo(function(){return unit.getSourceInfo()}),inst.layers(function(){return unit.layers()}),inst.plotPointsFromIdentifiers(function(){return unit.getPlotPointsFromIdentifiers.apply(unit,arguments)}),inst instanceof spawnable_SpawnableSideEffect&&inst.drawingContext(function(){return unit.getDrawingContext()}),inst.valueParser(unit.valueParser()))})}),group_firebolt_get(group_firebolt_getPrototypeOf(GroupFireBolt.prototype),"dispatchBehaviour",this).call(this,action,payload,propagationInf)}}],[{key:"defaultInteractionPolicy",value:function defaultInteractionPolicy(){return function(){}}},{key:"defaultCrossInteractionPolicy",value:function defaultCrossInteractionPolicy(){return _defaultCrossInteractionPolicy}}]),GroupFireBolt}(),APP_INITIAL_STATE={app:{group:{},units:{},layers:{},canvas:{}},local:{canvas:{},group:{},units:{},layers:{}}};function canvas_typeof(obj){"@babel/helpers - typeof";return(canvas_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(obj){return typeof obj}:function _typeof(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function canvas_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function canvas_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function canvas_getPrototypeOf(o){return(canvas_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function canvas_assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function canvas_setPrototypeOf(o,p){return(canvas_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}var _COMPONENTS,canvas_Canvas=function(_TransactionSupport){function Canvas(globalDependencies){var _ref,_this;!function canvas_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Canvas),(_this=function canvas_possibleConstructorReturn(self,call){return!call||"object"!==canvas_typeof(call)&&"function"!=typeof call?canvas_assertThisInitialized(self):call}(this,canvas_getPrototypeOf(Canvas).call(this)))._allOptions=Object.assign({},src_options,canvas_local_options_localOptions),_this._registry={},_this._composition={},_this._cachedProps={},_this._alias=null,_this._renderedResolve=null,_this._renderedPromise=new Promise(function(resolve){_this._renderedResolve=resolve}),_this._composition.layout=new layout_GridLayout,_this._store=new store_Store(APP_INITIAL_STATE),_this._throwback=new store_Store((canvas_defineProperty(_ref={},common_props.MATRIX_CREATED,!1),canvas_defineProperty(_ref,common_props.ON_LAYER_DRAW,null),canvas_defineProperty(_ref,"propagationInfo",null),_ref));var namespace=namespace_namespaceObject.CANVAS_LOCAL_NAMESPACE,allOptions=Object.assign({},src_options,canvas_local_options_localOptions,canvasOptions);return store_transactor(canvas_assertThisInitialized(_this),allOptions,_this._store,{namespace:namespace}),_this.dependencies(Object.assign({},globalDependencies,_this._dependencies)),_this.firebolt(new canvas_firebolt(canvas_assertThisInitialized(_this),{behavioural:Object.assign({},behavioural_namespaceObject,{brush:brush_UnitBrushBehaviour}),physical:physicalActions,physicalBehaviouralMap:{}},src_side_effects_namespaceObject,behaviour_effect_map_behaviourEffectMap)),_this.alias("canvas-".concat(getUniqueId())),_this.title("",{}),_this.subtitle("",{}),_this.legend({}),_this.color({}),_this.shape({}),_this.size({}),helper_setupChangeListener(canvas_assertThisInitialized(_this)),_this._layoutManager=helper_createLayoutManager(),_this}return function canvas_inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&canvas_setPrototypeOf(subClass,superClass)}(Canvas,transaction_support_TransactionSupport),function canvas_createClass(Constructor,protoProps,staticProps){return protoProps&&canvas_defineProperties(Constructor.prototype,protoProps),staticProps&&canvas_defineProperties(Constructor,staticProps),Constructor}(Canvas,[{key:"layout",value:function layout(){return arguments.length?this:this.composition().layout}},{key:"composition",value:function composition(){return arguments.length?this:this._composition}},{key:"done",value:function done(){return this._renderedPromise}},{key:"alias",value:function alias(){if(arguments.length){var visualGroup=this.composition().visualGroup;return this._alias=arguments.length<=0?void 0:arguments[0],visualGroup&&visualGroup.alias(this.alias()),this}return this._alias}},{key:"firebolt",value:function firebolt(){return arguments.length?(this._firebolt=arguments.length<=0?void 0:arguments[0],this):this._firebolt}},{key:"registry",value:function registry(){if(arguments.length){var param=arguments.length<=0?void 0:arguments[0],components=Object.assign({},param.components),componentSubRegistry=Object.assign({},param.componentSubRegistry),interactionRegistry=Object.assign({},param.interactions);this._registry={components:components,componentSubRegistry:componentSubRegistry,interactions:interactionRegistry};var initedComponents=function initCanvas(context){return[new context._registry.components.VisualGroup(context._registry,Object.assign({throwback:context._throwback},context.dependencies()))]}(this);return this._composition.visualGroup=initedComponents[0],function createGroupState(context){var _VisualGroup$getState2=canvas_helper_slicedToArray(visual_group.getState(),2),globalState=_VisualGroup$getState2[0],localState=_VisualGroup$getState2[1],store=context._store;store.append("app.group",globalState),store.append("local.group",localState)}(this),this.composition().visualGroup.alias(this.alias()).store(this._store),this}return this._registry}},{key:"dependencies",value:function dependencies(){return arguments.length?(this._dependencies=arguments.length<=0?void 0:arguments[0],this):this._dependencies}},{key:"lifeCycle",value:function lifeCycle(lifeCycles){var lifeCycleManager=this.dependencies().lifeCycleManager;return lifeCycles?(lifeCycleManager.register(lifeCycles),this):lifeCycleManager}},{key:"legend",value:function legend(){return arguments.length?this:this.composition().legend}},{key:"once",value:function once(eventName){return this.dependencies().lifeCycleManager.retrieve(eventName)}},{key:"render",value:function render(){var mount=this.mount(),lifeCycleManager=this.dependencies().lifeCycleManager,renderDetails=layout_maker_getRenderDetails(this,mount);lifeCycleManager.notify({client:this,action:"beforedraw"}),function prepareLayout(layout,renderDetails){var components=renderDetails.components,layoutConfig=renderDetails.layoutConfig,measurement=renderDetails.measurement,rows=components.rows,columns=components.columns,values=components.values,cornerMatrices=components.cornerMatrices,topLeft=cornerMatrices.topLeft,topRight=cornerMatrices.topRight,bottomLeft=cornerMatrices.bottomLeft,bottomRight=cornerMatrices.bottomRight;rows&&columns&&layout.measurement(measurement).config(layoutConfig).matrices({top:[topLeft,columns[0],topRight],center:[rows[0],values,rows[1]],bottom:[bottomLeft,columns[1],bottomRight]}).triggerReflow()}(this.layout(),renderDetails),this._layoutManager.dimension({height:renderDetails.measurement.canvasHeight,width:renderDetails.measurement.canvasWidth}),this._layoutManager.renderAt(mount),layout_maker_renderLayout(this,renderDetails),function setLayoutInfForUnits(context){var layoutManager=context._layoutManager,gridLayout=layoutManager.getComponent("grid"),legend=layoutManager.getComponent("legend"),boundBox=gridLayout&&gridLayout.getBoundBox(),valueMatrix=context.composition().visualGroup.matrixInstance().value,parentContainer=renderer_utils_selectElement("#".concat(layoutManager.getRootNodeId())).node();legend&&legend.setComponentInfo({rootNode:parentContainer}),valueMatrix.each(function(cell){cell.valueOf().parentContainerInf({el:parentContainer,dimensions:boundBox})})}(this),function setLabelRotationForAxes(context){var rotation=0,xAxes=context.xAxes()||[];!function(){for(var i=0;i<xAxes.length;i++)for(var j=0;j<xAxes[i].length;j++){var rotationVal=xAxes[i][j].renderConfig().labels.rotation;if(rotationVal&&0!==rotationVal)return void(rotation=rotationVal)}}(),rotation&&xAxes.forEach(function(axes){axes.forEach(function(axis){axis.renderConfig({labels:{rotation:rotation}}),axis.smartTicks(axis.setTickConfig())})})}(this),this.firebolt().mapActionsAndBehaviour()}},{key:"xAxes",value:function xAxes(){return this.composition().visualGroup.getAxes("x")}},{key:"yAxes",value:function yAxes(){return this.composition().visualGroup.getAxes("y")}},{key:"getRetinalAxes",value:function getRetinalAxes(){return this.composition().visualGroup.getAxes("retinal")}},{key:"mount",value:function mount(){if(arguments.length){var value=arguments.length<=0?void 0:arguments[0];return"string"==typeof(arguments.length<=0?void 0:arguments[0])&&(value=renderer_utils_selectElement(arguments.length<=0?void 0:arguments[0]).node()),this._mount=value,this}return this._mount}}],[{key:"withSettings",value:function withSettings(initialSettings,regEntry,globalDependencies){var instance=new Canvas(globalDependencies);for(var key in initialSettings)instance[key](initialSettings[key]);return instance.registry(regEntry),instance}},{key:"formalName",value:function formalName(){return"canvas"}}]),Canvas}();function default_registry_defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var COMPONENTS=(default_registry_defineProperty(_COMPONENTS={},visual_group.formalName(),visual_group),default_registry_defineProperty(_COMPONENTS,visual_unit_VisualUnit.formalName(),visual_unit_VisualUnit),_COMPONENTS),SUBREGISTRIES={cells:cell_registry,layers:layer_registry},default_registry_registry={components:function componentRegistry(){var components=arguments.length>0&&void 0!==arguments[0]?arguments[0]:COMPONENTS,reg=Object.assign({},components);return{register:function register(cls){var key=cls.formalName();return reg[key]=cls,componentRegistry},get:function get(){return reg}}}(COMPONENTS),cells:cell_registry(),layers:layer_registry(),interactions:registry_registry};__webpack_require__(39);function muze_slicedToArray(arr,i){return function muze_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function muze_iterableToArrayLimit(arr,i){if(!(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function muze_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var muze_transactor=store_transactor,Smartlabel=SmartlabelManager_default.a,muze_enableChainedTransaction=enableChainedTransaction,muze_LifeCycleManager=lifecycle_manager,DataModel=datamodel_default.a,muze_Store=store_Store,globalCache={},defaultRegistry=default_registry_registry.components,overrideRegistryDefinitions=function overrideRegistryDefinitions(overrideRegistry,registry){overrideRegistry.forEach(function(def){registry.register(def)})},muze_muze=function muze(){var _transactor2=muze_slicedToArray(muze_transactor({},src_options),2),env=_transactor2[0],globalStore=_transactor2[1],components=Object.assign({},default_registry_registry.components.get()),componentSubRegistryDef=Object.assign({},SUBREGISTRIES),componentSubRegistry={};for(var prop in componentSubRegistryDef)componentSubRegistry[prop]=componentSubRegistryDef[prop](default_registry_registry[prop].get());return env.canvas=function(){var settings=globalStore.serialize(),canvas=canvas_Canvas.withSettings(settings,{components:components,componentSubRegistry:componentSubRegistry,interactions:default_registry_registry.interactions},env.globalDependencies());return muze_enableChainedTransaction(globalStore,canvas,Object.keys(settings)),canvas},env.globalDependencies=function(){return globalCache.smartlabel||(globalCache.smartlabel=new Smartlabel(1,"body")),{smartlabel:globalCache.smartlabel,lifeCycleManager:new muze_LifeCycleManager}},env.settings=function(){return globalStore.serialize()},env.registry=function(){for(var _len=arguments.length,overrideRegistry=new Array(_len),_key=0;_key<_len;_key++)overrideRegistry[_key]=arguments[_key];return overrideRegistry.length?(overrideRegistry.forEach(function(def){var prop=def.formalName();prop in defaultRegistry&&(components[prop]=def)}),env):components},env.cellRegistry=function(){for(var cellRegistry=componentSubRegistry.cellRegistry,_len2=arguments.length,overrideRegistry=new Array(_len2),_key2=0;_key2<_len2;_key2++)overrideRegistry[_key2]=arguments[_key2];return overrideRegistry.length?(overrideRegistryDefinitions(overrideRegistry,cellRegistry),env):cellRegistry.get()},env.layerRegistry=function(){for(var layerRegistry=componentSubRegistry.layerRegistry,_len3=arguments.length,overrideRegistry=new Array(_len3),_key3=0;_key3<_len3;_key3++)overrideRegistry[_key3]=arguments[_key3];return overrideRegistry.length?(overrideRegistryDefinitions(overrideRegistry,layerRegistry),env):layerRegistry.get()},env};muze_muze.registry=default_registry_registry,muze_muze.Components={VisualLayer:{layers:{BaseLayer:base_layer_BaseLayer,LineLayer:line_LineLayer,TextLayer:TextLayer,TickLayer:TickLayer,PointLayer:point_PointLayer,SimpleLayer:simple_layer_SimpleLayer,AreaLayer:area_AreaLayer,ArcLayer:ArcLayer},helpers:helpers,enums:src_enums_namespaceObject,layerMixins:layerMixins},VisualUnit:{constructor:visual_unit_VisualUnit,helpers:visual_unit_src_helper_namespaceObject,enums:visual_unit_src_enums_namespaceObject,UnitFireBolt:firebolt_UnitFireBolt},VisualGroup:{constructor:visual_group,Encoders:encoder_namespaceObject,encoderHelpers:encoder_helper_namespaceObject,groupUtils:group_utils_namespaceObject,enums:visual_group_src_enums_constants_namespaceObject},Canvas:{constructor:canvas_Canvas},Firebolt:{constructor:firebolt_Firebolt}};var SideEffects={sideEffects:src_side_effects_namespaceObject,standards:{SurrogateSideEffect:SurrogateSideEffect,SpawnableSideEffect:spawnable_SpawnableSideEffect,GenericSideEffect:generic}},Behaviours={behaviouralActions:behavioural_namespaceObject,standards:{GenericBehaviour:generic_GenericBehaviour,PersistentBehaviour:persistent_PersistentBehaviour,VolatileBehaviour:volatile_VolatileBehaviour}};muze_muze.DataModel=DataModel,muze_muze.version=muze_package.version,muze_muze.SideEffects=SideEffects,muze_muze.ActionModel=actionModel,muze_muze.layerFactory=src_layer_factory,muze_muze.Operators=operators_namespaceObject,muze_muze.Behaviours=Behaviours,muze_muze.utils=muze_utils_src_namespaceObject,muze_muze.Model=(new muze_Store).model.constructor;__webpack_exports__.default=muze_muze}])});
//# sourceMappingURL=muze.js.map